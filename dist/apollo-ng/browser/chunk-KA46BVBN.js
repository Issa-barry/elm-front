import{b as mt}from"./chunk-QTPK4WUM.js";import{a as ot}from"./chunk-UTPN3HX3.js";import{b as ae}from"./chunk-PWRH4TVB.js";import{b as at}from"./chunk-OAYELUTM.js";import{a as H}from"./chunk-SUWPPEDH.js";import{a as lt,b as Me}from"./chunk-IMZITBI5.js";import{b as Fe}from"./chunk-6MAGWI7U.js";import{a as Ie}from"./chunk-2L636W5W.js";import{a as Ee,b as De}from"./chunk-LOBJQVB7.js";import{a as Se,b as we}from"./chunk-3HDW43E7.js";import{a as he,d as xe,e as Ce,k as Pe}from"./chunk-KYBPPGZP.js";import"./chunk-KKEZTC3T.js";import{a as st,b as be}from"./chunk-QAU7W4US.js";import"./chunk-GO7AEQHW.js";import"./chunk-44MNQRCX.js";import{b as ve,c as U}from"./chunk-FHJ3HI6Y.js";import"./chunk-MGFZT6L3.js";import{b as Oe}from"./chunk-2M2YESUI.js";import"./chunk-Q737E3VB.js";import"./chunk-GVSJPEUD.js";import"./chunk-CQGFVLY5.js";import"./chunk-ZOHIMUT6.js";import"./chunk-TB7JIXSI.js";import{a as ye,b as ke}from"./chunk-D4ZZGRXJ.js";import"./chunk-USWDVUUM.js";import"./chunk-KHGHC55C.js";import{a as _e}from"./chunk-UQ2UE4DV.js";import{a as it,b as nt}from"./chunk-HYG7NLCW.js";import"./chunk-MYGUYXAJ.js";import{b as rt}from"./chunk-UWJ6EXCC.js";import"./chunk-NIW5LLYW.js";import{b as Ze,d as ne}from"./chunk-BKUS5BNA.js";import"./chunk-TZVXXQOJ.js";import{a as ie,d as Ye}from"./chunk-PPJOJKS5.js";import{a as se,b as Xe,c as le,d as me,e as G}from"./chunk-P557RNKH.js";import"./chunk-PALTTDOF.js";import{c as ge,d as fe}from"./chunk-WF73AWMM.js";import"./chunk-SXW2RLBH.js";import"./chunk-LSUA6MZX.js";import"./chunk-M2LTT3HJ.js";import"./chunk-JYP5AZVX.js";import"./chunk-T7HI4VPR.js";import{a as et,b as ce,c as tt,d as pe}from"./chunk-II7RVJNR.js";import{a as Je,b as re}from"./chunk-PW7MMR7K.js";import{e as W,h as j,p as z}from"./chunk-3LUOICNH.js";import{a as de,b as ue}from"./chunk-3G6KBQ3S.js";import"./chunk-D7FY7VLK.js";import"./chunk-BODZH67C.js";import"./chunk-7UZYWCAJ.js";import{j as oe}from"./chunk-IK72ORTM.js";import"./chunk-Z2XDSDL7.js";import{la as q,pa as I}from"./chunk-344GK45C.js";import{i as te,k as L,v as F}from"./chunk-6PXXCRY5.js";import"./chunk-4O3FVBGX.js";import{$ as _,$b as d,Ab as p,Bb as k,Cb as M,Db as V,Hb as b,Lb as f,Mb as c,Na as s,Qb as He,R as je,Rb as Ue,Sa as K,Sb as $e,V as ze,Vb as X,Wb as ee,Xb as A,Ya as y,Yb as N,_b as o,aa as g,ac as T,bb as D,dc as S,ec as w,fc as O,hb as h,hc as B,ia as J,ic as E,lc as Ke,ma as Ge,mc as Qe,sc as C,uc as P,wc as x,xb as m,yb as i,zb as n}from"./chunk-E5DLUAUS.js";import"./chunk-GAL4ENT6.js";var Q={especes:"Esp\xE8ces",virement:"Virement bancaire",cheque:"Ch\xE8que",mobile_money:"Mobile Money"},bt={impayee:"Impay\xE9e",partielle:"Partiellement pay\xE9e",payee:"Pay\xE9e",annulee:"Annul\xE9e"},ct={impayee:"danger",partielle:"warn",payee:"success",annulee:"secondary"};var Te=class{id;reference;prestataire_id;date;montant_total;nb_packings;date_paiement;mode_paiement;statut;notes;created_by;validated_by;created_at;updated_at;deleted_at;statut_label;prestataire_nom;montant_verse;montant_restant;mode_paiement_label;total_rouleaux;prix_par_rouleau;prestataire;packings;versements;creator;constructor(t={}){this.id=t.id??0,this.reference=t.reference??"",this.prestataire_id=t.prestataire_id??0,this.date=t.date??"",this.montant_total=t.montant_total??0,this.nb_packings=t.nb_packings??0,this.date_paiement=t.date_paiement??null,this.mode_paiement=t.mode_paiement??null,this.statut=t.statut??"impayee",this.notes=t.notes??null,this.created_by=t.created_by??null,this.validated_by=t.validated_by??null,this.created_at=t.created_at??"",this.updated_at=t.updated_at??"",this.deleted_at=t.deleted_at??null,this.statut_label=t.statut_label??bt[this.statut]??"",this.prestataire_nom=t.prestataire_nom??null,this.montant_verse=t.montant_verse??0,this.montant_restant=t.montant_restant??0,this.mode_paiement_label=t.mode_paiement_label??"",this.total_rouleaux=t.total_rouleaux??0,this.prix_par_rouleau=t.prix_par_rouleau??0,this.prestataire=t.prestataire,this.packings=t.packings,this.versements=t.versements,this.creator=t.creator}},qe=class{prestataire_id;prestataire_nom;prestataire_phone;prestataire_type;nb_packings_non_factures;montant_non_facture;nb_factures_en_cours;montant_facture;montant_verse;montant_restant_facture;montant_total_du;derniere_date;statut;constructor(t={}){this.prestataire_id=t.prestataire_id??0,this.prestataire_nom=t.prestataire_nom??"",this.prestataire_phone=t.prestataire_phone??"",this.prestataire_type=t.prestataire_type??"",this.nb_packings_non_factures=t.nb_packings_non_factures??0,this.montant_non_facture=t.montant_non_facture??0,this.nb_factures_en_cours=t.nb_factures_en_cours??0,this.montant_facture=t.montant_facture??0,this.montant_verse=t.montant_verse??0,this.montant_restant_facture=t.montant_restant_facture??0,this.montant_total_du=t.montant_total_du??0,this.derniere_date=t.derniere_date??null,this.statut=this.montant_total_du===0?"solde":this.montant_verse>0?"partiel":"impaye"}},$=class{date_debut;date_fin;nb_prestataires;total_non_facture;total_facture;total_verse;total_restant_facture;montant_global_du;montant_total;prestataires;constructor(t={}){this.date_debut=t.date_debut??null,this.date_fin=t.date_fin??null,this.nb_prestataires=t.nb_prestataires??0,this.total_non_facture=t.total_non_facture??0,this.total_facture=t.total_facture??0,this.total_verse=t.total_verse??0,this.total_restant_facture=t.total_restant_facture??0,this.montant_global_du=t.montant_global_du??0,this.montant_total=this.total_facture+this.total_non_facture,this.prestataires=(t.prestataires??[]).map(e=>new qe(e))}},Ve=class{prestataire_id;date_debut;date_fin;nb_packings;montant_total;total_rouleaux;packings;constructor(t={}){this.prestataire_id=t.prestataire_id??0,this.date_debut=t.date_debut??"",this.date_fin=t.date_fin??"",this.nb_packings=t.nb_packings??0,this.montant_total=t.montant_total??0,this.total_rouleaux=t.total_rouleaux??0,this.packings=t.packings??[]}};var R=class r{constructor(t){this.http=t}apiUrl=`${it.apiUrl}/facture-packings`;getFactures(t){let e=new ie;return t&&(t.prestataire_id&&(e=e.set("prestataire_id",t.prestataire_id.toString())),t.date_debut&&(e=e.set("date_debut",t.date_debut)),t.date_fin&&(e=e.set("date_fin",t.date_fin)),t.statut&&(e=e.set("statut",t.statut)),t.soldee!==void 0&&(e=e.set("soldee",t.soldee.toString())),t.search&&(e=e.set("search",t.search)),t.sort_by&&(e=e.set("sort_by",t.sort_by)),t.sort_order&&(e=e.set("sort_order",t.sort_order)),t.per_page&&(e=e.set("per_page",t.per_page.toString()))),this.http.get(this.apiUrl,{params:e})}getFacture(t){return this.http.get(`${this.apiUrl}/${t}`)}getPreview(t,e,a){let l=new ie().set("prestataire_id",t.toString()).set("date_debut",e).set("date_fin",a);return this.http.get(`${this.apiUrl}/preview`,{params:l})}getComptabilite(t){let e=new ie;return t&&(t.date_debut&&(e=e.set("date_debut",t.date_debut)),t.date_fin&&(e=e.set("date_fin",t.date_fin)),t.prestataire_id&&(e=e.set("prestataire_id",t.prestataire_id.toString()))),this.http.get(`${this.apiUrl}/comptabilite`,{params:e})}createFacture(t){return this.http.post(this.apiUrl,t)}deleteFacture(t){return this.http.delete(`${this.apiUrl}/${t}`)}getVersements(t){return this.http.get(`${this.apiUrl}/${t}/versements`)}createVersement(t,e){return this.http.post(`${this.apiUrl}/${t}/versements`,e)}deleteVersement(t,e){return this.http.delete(`${this.apiUrl}/${t}/versements/${e}`)}static \u0275fac=function(e){return new(e||r)(ze(Ye))};static \u0275prov=je({token:r,factory:r.\u0275fac,providedIn:"root"})};var Re=class r{constructor(t){this.paiementService=t}summary=null;ngOnInit(){this.loadStats()}loadStats(t){this.paiementService.getComptabilite(t).subscribe({next:e=>{this.summary=new $(e.data)}})}formatCurrency(t){return new Intl.NumberFormat("fr-FR",{style:"decimal",minimumFractionDigits:0}).format(t)+" GNF"}static \u0275fac=function(e){return new(e||r)(y(R))};static \u0275cmp=D({type:r,selectors:[["app-stats-comptabilite-packing-widget"]],hostVars:2,hostBindings:function(e,a){e&2&&ee("display","contents")},decls:40,vars:13,consts:[[1,"col-span-12"],[1,"stats-bar"],[1,"stats-bar__item"],[1,"stats-bar__icon","stats-bar__icon--primary"],[1,"pi","pi-wallet"],[1,"stats-bar__value"],[1,"stats-bar__label"],[1,"stats-bar__divider"],[1,"stats-bar__icon","stats-bar__icon--success"],[1,"pi","pi-check-circle"],[1,"stats-bar__value","stats-bar__value--success"],[1,"stats-bar__icon","stats-bar__icon--warning"],[1,"pi","pi-arrow-right"],[1,"stats-bar__value","stats-bar__value--warning"],[1,"stats-bar__icon","stats-bar__icon--info"],[1,"pi","pi-users"],[1,"stats-bar__value","stats-bar__value--info"]],template:function(e,a){e&1&&(k(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),V(4,"i",4),M(),k(5,"div")(6,"div",5),o(7),C(8,"money"),M(),k(9,"div",6),o(10,"Montant total"),M()()(),V(11,"div",7),k(12,"div",2)(13,"div",8),V(14,"i",9),M(),k(15,"div")(16,"div",10),o(17),C(18,"money"),M(),k(19,"div",6),o(20,"Total pay\xE9"),M()()(),V(21,"div",7),k(22,"div",2)(23,"div",11),V(24,"i",12),M(),k(25,"div")(26,"div",13),o(27),C(28,"money"),M(),k(29,"div",6),o(30,"Reste \xE0 payer"),M()()(),V(31,"div",7),k(32,"div",2)(33,"div",14),V(34,"i",15),M(),k(35,"div")(36,"div",16),o(37),M(),k(38,"div",6),o(39,"Prestataires"),M()()()()()),e&2&&(s(7),d(a.summary?P(8,4,a.summary.montant_total,"GNF"):"--"),s(10),d(a.summary?P(18,7,a.summary.total_verse,"GNF"):"--"),s(10),d(a.summary?P(28,10,a.summary.montant_global_du,"GNF"):"--"),s(10),d(a.summary?a.summary.nb_prestataires:"--"))},dependencies:[F,H],styles:[".stats-bar[_ngcontent-%COMP%]{display:flex;align-items:center;background:var(--p-surface-0);border:1px solid var(--p-surface-200);border-radius:14px;padding:1.25rem 2rem;gap:0;box-shadow:0 1px 3px #0000000a}.stats-bar__item[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:1rem;padding:.5rem 1.5rem}.stats-bar__divider[_ngcontent-%COMP%]{width:1px;height:40px;background:var(--p-surface-200);flex-shrink:0}.stats-bar__icon[_ngcontent-%COMP%]{width:42px;height:42px;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:1.1rem}.stats-bar__icon--primary[_ngcontent-%COMP%]{background:var(--p-primary-50);color:var(--p-primary-500)}.stats-bar__icon--success[_ngcontent-%COMP%]{background:#ecfdf5;color:#10b981}.stats-bar__icon--warning[_ngcontent-%COMP%]{background:#fff7ed;color:#f59e0b}.stats-bar__icon--info[_ngcontent-%COMP%]{background:#eef2ff;color:#6366f1}.stats-bar__value[_ngcontent-%COMP%]{font-size:1.35rem;font-weight:700;color:var(--p-surface-900);letter-spacing:-.02em;line-height:1.2}.stats-bar__value--success[_ngcontent-%COMP%]{color:#059669}.stats-bar__value--warning[_ngcontent-%COMP%]{color:#d97706}.stats-bar__value--info[_ngcontent-%COMP%]{color:#4f46e5}.stats-bar__label[_ngcontent-%COMP%]{font-size:.78rem;color:var(--p-surface-400);margin-top:2px}@media (max-width: 768px){.stats-bar[_ngcontent-%COMP%]{flex-direction:column;gap:.35rem;padding:.75rem;border-radius:16px;box-shadow:none}.stats-bar__item[_ngcontent-%COMP%]{padding:.65rem .5rem;width:100%;gap:.75rem}.stats-bar__divider[_ngcontent-%COMP%]{width:100%;height:1px}.stats-bar__icon[_ngcontent-%COMP%]{width:38px;height:38px;border-radius:10px;font-size:1rem}.stats-bar__value[_ngcontent-%COMP%]{font-size:1.2rem}}.dark[_nghost-%COMP%]   .stats-bar[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar[_ngcontent-%COMP%]{background:var(--p-surface-800);border-color:var(--p-surface-700);box-shadow:0 1px 3px #00000026}.dark[_nghost-%COMP%]   .stats-bar__divider[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar__divider[_ngcontent-%COMP%]{background:var(--p-surface-600)}.dark[_nghost-%COMP%]   .stats-bar__icon--primary[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar__icon--primary[_ngcontent-%COMP%]{background:#3b82f61f}.dark[_nghost-%COMP%]   .stats-bar__icon--success[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar__icon--success[_ngcontent-%COMP%]{background:#10b9811f}.dark[_nghost-%COMP%]   .stats-bar__icon--warning[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar__icon--warning[_ngcontent-%COMP%]{background:#f59e0b1f}.dark[_nghost-%COMP%]   .stats-bar__icon--info[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar__icon--info[_ngcontent-%COMP%]{background:#6366f11f}.dark[_nghost-%COMP%]   .stats-bar__value[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar__value[_ngcontent-%COMP%]{color:var(--p-surface-0)}.dark[_nghost-%COMP%]   .stats-bar__label[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar__label[_ngcontent-%COMP%]{color:var(--p-surface-400)}"]})};var St=["dt"],wt=()=>[10,20,30],Ot=()=>({width:"800px"}),Et=()=>({width:"450px"}),Dt=(r,t,e)=>({"status-badge--danger":r,"status-badge--warn":t,"status-badge--success":e});function Ft(r,t){if(r&1){let e=b();i(0,"div",13)(1,"p-datepicker",14),O("ngModelChange",function(l){_(e);let u=c();return w(u.filtrePeriodeDebut,l)||(u.filtrePeriodeDebut=l),g(l)}),n(),i(2,"p-datepicker",15),O("ngModelChange",function(l){_(e);let u=c();return w(u.filtrePeriodeFin,l)||(u.filtrePeriodeFin=l),g(l)}),n(),i(3,"p-button",16),f("onClick",function(){_(e);let l=c();return g(l.loadComptabilite())}),n()()}if(r&2){let e=c();s(),S("ngModel",e.filtrePeriodeDebut),m("showIcon",!0),s(),S("ngModel",e.filtrePeriodeFin),m("showIcon",!0),s(),m("rounded",!0)("outlined",!0)}}function It(r,t){if(r&1){let e=b();i(0,"div",17)(1,"p-select",18),O("ngModelChange",function(l){_(e);let u=c();return w(u.filtreStatut,l)||(u.filtreStatut=l),g(l)}),f("onChange",function(){_(e);let l=c();return g(l.applyStatutFilter())}),n(),i(2,"p-button",19),f("onClick",function(){_(e);let l=c();return g(l.exportCSV())}),n()()}if(r&2){let e=c();s(),S("ngModel",e.filtreStatut),m("options",e.statutOptions)}}function Tt(r,t){if(r&1){let e=b();i(0,"div",20)(1,"h5",21),o(2,"Comptabilit\xE9 Packing"),n(),i(3,"p-iconfield",22),p(4,"p-inputicon",23),i(5,"input",24),f("input",function(l){_(e);let u=c(),v=X(8);return g(u.onGlobalFilter(v,l))}),n()()()}}function Vt(r,t){r&1&&(i(0,"tr")(1,"th",25)(2,"span",26),o(3,"Prestataire "),p(4,"p-sortIcon",27),n()(),i(5,"th")(6,"span",26),o(7,"T\xE9l\xE9phone"),n()(),i(8,"th",28)(9,"span",26),o(10,"Date "),p(11,"p-sortIcon",29),n()(),i(12,"th",30)(13,"span",31),o(14,"Total "),p(15,"p-sortIcon",32),n()(),i(16,"th",33)(17,"span",31),o(18,"Pay\xE9 "),p(19,"p-sortIcon",34),n()(),i(20,"th",35)(21,"span",31),o(22,"Reste d\xFB "),p(23,"p-sortIcon",36),n()(),i(24,"th",37)(25,"span",38),o(26,"Statut "),p(27,"p-sortIcon",39),n()(),p(28,"th",40),n())}function Rt(r,t){if(r&1){let e=b();i(0,"tr",41),f("dblclick",function(){let l=_(e).$implicit,u=c();return g(u.goToDetail(l))}),i(1,"td")(2,"div",42)(3,"span",43),o(4),n(),i(5,"span",44),o(6),n()()(),i(7,"td",45),o(8),C(9,"phoneFormat"),n(),i(10,"td",45),o(11),n(),i(12,"td",46),o(13),n(),i(14,"td",47),o(15),n(),i(16,"td",46),o(17),n(),i(18,"td",48)(19,"span",49),o(20),n()(),i(21,"td",48)(22,"p-button",50),f("click",function(){let l=_(e).$implicit,u=c();return g(u.goToDetail(l))}),n()()()}if(r&2){let e=t.$implicit,a=c();s(3),ee("background","var(--p-primary-50)")("color","var(--p-primary-600)"),s(),T(" ",a.getInitials(e.prestataire_nom)," "),s(2),d(e.prestataire_nom),s(2),d(P(9,15,e.prestataire_phone,"INT")),s(3),d(a.formatDateDisplay(e.derniere_date)),s(2),d(a.formatCurrency(e.montant_facture)),s(2),d(a.formatCurrency(e.montant_verse)),s(2),d(a.formatCurrency(e.montant_restant_facture)),s(2),m("ngClass",Ke(18,Dt,e.statut==="impaye",e.statut==="partiel",e.statut==="solde")),s(),T(" ",e.statut==="impaye"?"Impay\xE9":e.statut==="partiel"?"Partiel":"Sold\xE9"," "),s(2),m("text",!0)("rounded",!0)}}function Nt(r,t){r&1&&(i(0,"tr")(1,"td",51)(2,"div",52),p(3,"i",53),i(4,"span"),o(5,"Aucun prestataire trouv\xE9"),n()()()())}function At(r,t){r&1&&(i(0,"tr")(1,"th"),o(2,"R\xE9f\xE9rence"),n(),i(3,"th"),o(4,"Date"),n(),i(5,"th",61),o(6,"Rouleaux"),n(),i(7,"th",61),o(8,"Montant"),n()())}function Bt(r,t){if(r&1&&(i(0,"tr")(1,"td",62),o(2),n(),i(3,"td",63),o(4),n(),i(5,"td",61),o(6),n(),i(7,"td",64),o(8),n()()),r&2){let e=t.$implicit,a=c(3);s(2),d(e.reference),s(2),d(a.formatDateDisplay(e.date)),s(2),d(e.nb_rouleaux),s(2),d(a.formatCurrency(e.montant))}}function Lt(r,t){if(r&1&&(i(0,"div",56)(1,"div",57)(2,"span")(3,"strong"),o(4),n(),o(5," packings"),n(),p(6,"span",58),i(7,"span")(8,"strong"),o(9),n(),o(10," rouleaux"),n(),i(11,"span",59),o(12),n()(),i(13,"p-table",60),h(14,At,9,0,"ng-template",null,4,x)(16,Bt,9,4,"ng-template",null,5,x),n()()),r&2){let e=c(2);s(4),d(e.previewData.nb_packings),s(5),d(e.previewData.total_rouleaux),s(3),d(e.formatCurrency(e.previewData.montant_total)),s(),m("value",e.previewData.packings)("rows",10)("paginator",e.previewData.packings.length>10)("rowHover",!0)}}function qt(r,t){r&1&&(i(0,"div",65),p(1,"i",66),n())}function Wt(r,t){if(r&1&&h(0,Lt,18,7,"div",54)(1,qt,2,0,"div",55),r&2){let e=c();m("ngIf",e.previewData),s(),m("ngIf",e.previewLoading)}}function jt(r,t){if(r&1){let e=b();i(0,"p-button",67),f("click",function(){_(e);let l=c();return g(l.previewDialog=!1)}),n()}r&2&&m("text",!0)}var Ae=class r{constructor(t,e,a){this.router=t;this.factureService=e;this.messageService=a}dataChanged=new K;filterFields=["prestataire_nom","prestataire_phone","montant_total_du"];prestataires=J([]);selectedPrestataires=null;comptaSummary=null;loading=!1;filtrePeriodeDebut=null;filtrePeriodeFin=null;filtreStatut=null;statutOptions=[{label:"Tous",value:null},{label:"Impay\xE9",value:"impaye"},{label:"Partiel",value:"partiel"},{label:"Sold\xE9",value:"solde"}];selectedItem=null;previewDialog=!1;previewData=null;previewLoading=!1;facturerLoading=!1;dt;exportColumns;cols;ngOnInit(){this.loadComptabilite(),this.initColumns()}initColumns(){this.cols=[{field:"prestataire_nom",header:"Prestataire"},{field:"prestataire_phone",header:"T\xE9l\xE9phone"},{field:"nb_packings_non_factures",header:"Non factur\xE9s"},{field:"montant_non_facture",header:"Mnt non factur\xE9"},{field:"montant_facture",header:"Factur\xE9"},{field:"montant_verse",header:"Vers\xE9"},{field:"montant_restant_facture",header:"Reste facture"},{field:"montant_total_du",header:"Total d\xFB"}],this.exportColumns=this.cols.map(t=>({title:t.header,dataKey:t.field}))}loadComptabilite(){this.loading=!0;let t={};this.filtrePeriodeDebut&&(t.date_debut=this.formatDate(this.filtrePeriodeDebut)),this.filtrePeriodeFin&&(t.date_fin=this.formatDate(this.filtrePeriodeFin)),this.factureService.getComptabilite(t).subscribe({next:e=>{this.comptaSummary=new $(e.data),this.applyStatutFilter(),this.loading=!1,this.dataChanged.emit(t)},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger la comptabilit\xE9",life:3e3}),this.loading=!1}})}applyStatutFilter(){this.comptaSummary&&(this.filtreStatut?this.prestataires.set(this.comptaSummary.prestataires.filter(t=>t.statut===this.filtreStatut)):this.prestataires.set(this.comptaSummary.prestataires))}exportCSV(){this.dt.exportCSV()}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}openPreview(t){let e=this.filtrePeriodeDebut?this.formatDate(this.filtrePeriodeDebut):"2000-01-01",a=this.filtrePeriodeFin?this.formatDate(this.filtrePeriodeFin):"2099-12-31";this.selectedItem=t,this.previewDialog=!0,this.previewLoading=!0,this.previewData=null,this.factureService.getPreview(t.prestataire_id,e,a).subscribe({next:l=>{this.previewData=new Ve(l.data),this.previewLoading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger la pr\xE9visualisation",life:3e3}),this.previewLoading=!1,this.previewDialog=!1}})}facturerNonFactures(){if(!this.selectedItem||this.facturerLoading)return;this.facturerLoading=!0;let t=this.filtrePeriodeDebut?this.formatDate(this.filtrePeriodeDebut):"2000-01-01",e=this.filtrePeriodeFin?this.formatDate(this.filtrePeriodeFin):"2099-12-31",a={prestataire_id:this.selectedItem.prestataire_id,date_debut:t,date_fin:e};this.factureService.createFacture(a).subscribe({next:l=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`Facture ${l.data.reference} cr\xE9\xE9e`,life:3e3}),this.facturerLoading=!1,this.selectedItem&&(this.selectedItem.nb_packings_non_factures=0,this.selectedItem.montant_non_facture=0),this.loadComptabilite()},error:l=>{let u=l?.error?.message||"Impossible de cr\xE9er la facture";this.messageService.add({severity:"error",summary:"Erreur",detail:u,life:5e3}),this.facturerLoading=!1}})}formatDate(t){return t?typeof t=="string"?t:new Date(t).toISOString().split("T")[0]:""}formatCurrency(t){return new Intl.NumberFormat("fr-FR",{style:"decimal",minimumFractionDigits:0}).format(t)+" GNF"}formatDateDisplay(t){return t?new Date(t).toLocaleDateString("fr-FR"):""}goToDetail(t){this.router.navigate(["/comptabilite/comptabilite-packing-detail",t.prestataire_id],{queryParams:{prestataire_nom:t.prestataire_nom,prestataire_phone:t.prestataire_phone}})}getInitials(t){if(!t||!t.trim())return"--";let e=t.trim().split(/\s+/).filter(Boolean);return e.length===1?e[0].slice(0,2).toUpperCase():`${e[0][0]}${e[e.length-1][0]}`.toUpperCase()}static \u0275fac=function(e){return new(e||r)(y(ne),y(R),y(I))};static \u0275cmp=D({type:r,selectors:[["app-comptabilite-packing-tableau"]],viewQuery:function(e,a){if(e&1&&He(St,5),e&2){let l;Ue(l=$e())&&(a.dt=l.first)}},outputs:{dataChanged:"dataChanged"},features:[B([I])],decls:23,vars:20,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["emptymessage",""],["content",""],["footer",""],[1,"card","tableau-card","compta-table-card"],["styleClass","mb-6 compta-toolbar"],["styleClass","compta-data-table","dataKey","prestataire_id","currentPageReportTemplate"," {first} \xE0 {last} sur {totalRecords} prestataires",3,"selectionChange","value","rows","columns","paginator","globalFilterFields","selection","rowHover","showCurrentPageReport","rowsPerPageOptions","loading"],["header","Pr\xE9visualisation",3,"visibleChange","visible","modal","draggable"],[1,"compta-toolbar__start"],["dateFormat","dd/mm/yy","placeholder","Date d\xE9but","inputStyleClass","w-full","styleClass","compta-toolbar__date",3,"ngModelChange","ngModel","showIcon"],["dateFormat","dd/mm/yy","placeholder","Date fin","inputStyleClass","w-full","styleClass","compta-toolbar__date",3,"ngModelChange","ngModel","showIcon"],["icon","pi pi-filter","severity","primary","styleClass","compta-toolbar__filter-btn","pTooltip","Appliquer les filtres",3,"onClick","rounded","outlined"],[1,"compta-toolbar__end"],["optionLabel","label","optionValue","value","placeholder","Statut","styleClass","compta-toolbar__status",3,"ngModelChange","onChange","ngModel","options"],["label","Export","icon","pi pi-download","severity","secondary","styleClass","compta-toolbar__export-btn",3,"onClick"],[1,"table-caption"],[1,"m-0"],[1,"table-caption__search"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Rechercher...",3,"input"],["pSortableColumn","prestataire_nom"],[1,"col-header"],["field","prestataire_nom"],["pSortableColumn","derniere_date"],["field","derniere_date"],["pSortableColumn","montant_facture",1,"text-right"],[1,"col-header","justify-end"],["field","montant_facture"],["pSortableColumn","montant_verse",1,"text-right"],["field","montant_verse"],["pSortableColumn","montant_restant_facture",1,"text-right"],["field","montant_restant_facture"],["pSortableColumn","statut",1,"text-center"],[1,"col-header","justify-center"],["field","statut"],[1,"text-center",2,"width","5rem"],[1,"table-row",3,"dblclick"],[1,"cell-prestataire"],[1,"cell-prestataire__avatar"],[1,"cell-prestataire__name"],[1,"cell-secondary","cell-bold"],[1,"text-right","cell-mono","cell-bold"],[1,"text-right","cell-mono","cell-success"],[1,"text-center"],[1,"status-badge",3,"ngClass"],["icon","pi pi-arrow-right","severity","secondary","pTooltip","D\xE9tail",3,"click","text","rounded"],["colspan","8"],[1,"empty-state"],[1,"pi","pi-inbox"],["class","flex flex-col gap-4",4,"ngIf"],["class","flex items-center justify-center p-12",4,"ngIf"],[1,"flex","flex-col","gap-4"],[1,"preview-summary"],[1,"preview-summary__sep"],[1,"ml-auto","text-xl","font-bold","text-primary"],["styleClass","p-datatable-sm",3,"value","rows","paginator","rowHover"],[1,"text-right"],[1,"font-medium"],[1,"cell-secondary"],[1,"text-right","font-semibold"],[1,"flex","items-center","justify-center","p-12"],[1,"pi","pi-spin","pi-spinner","text-3xl","text-surface-300"],["label","Fermer",3,"click","text"]],template:function(e,a){if(e&1){let l=b();p(0,"p-toast"),i(1,"div",9)(2,"p-toolbar",10),h(3,Ft,4,6,"ng-template",null,0,x)(5,It,3,2,"ng-template",null,1,x),n(),i(7,"p-table",11,2),O("selectionChange",function(v){return _(l),w(a.selectedPrestataires,v)||(a.selectedPrestataires=v),g(v)}),h(9,Tt,6,0,"ng-template",null,3,x)(11,Vt,29,0,"ng-template",null,4,x)(13,Rt,23,22,"ng-template",null,5,x)(15,Nt,6,0,"ng-template",null,6,x),n()(),i(17,"p-dialog",12),O("visibleChange",function(v){return _(l),w(a.previewDialog,v)||(a.previewDialog=v),g(v)}),h(18,Wt,2,2,"ng-template",null,7,x)(20,jt,1,1,"ng-template",null,8,x),n(),p(22,"p-confirmdialog")}e&2&&(s(7),m("value",a.prestataires())("rows",10)("columns",a.cols)("paginator",!0)("globalFilterFields",a.filterFields),S("selection",a.selectedPrestataires),m("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",E(17,wt))("loading",a.loading),s(10),N(E(18,Ot)),S("visible",a.previewDialog),m("modal",!0)("draggable",!1),s(5),N(E(19,Et)))},dependencies:[F,te,L,Pe,he,xe,Ce,z,W,j,G,me,oe,ke,ye,Me,lt,re,Je,fe,ge,we,Se,Oe,pe,tt,ce,et,De,Ee,be,st,Fe,ue,de,U,at,Ie],styles:[".tableau-card[_ngcontent-%COMP%]{border-radius:14px!important;box-shadow:0 1px 3px #0000000a!important;overflow:hidden}.compta-table-card[_ngcontent-%COMP%]{margin-bottom:0}[_nghost-%COMP%]     .compta-toolbar.p-toolbar{padding:1rem;border:1px solid var(--p-surface-200);border-radius:12px;background:var(--p-surface-50)}.compta-toolbar__start[_ngcontent-%COMP%], .compta-toolbar__end[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap}[_nghost-%COMP%]     .compta-toolbar__date.p-datepicker, [_nghost-%COMP%]     .compta-toolbar__status.p-select{width:10rem}[_nghost-%COMP%]     .compta-toolbar__filter-btn.p-button, [_nghost-%COMP%]     .compta-toolbar__export-btn.p-button{height:2.5rem}[_nghost-%COMP%]     .p-datatable .p-datatable-caption{padding:1.5rem 1.75rem 1.75rem;border-bottom:1px solid var(--p-surface-100);margin-bottom:0}.table-caption[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:1.5rem;flex-wrap:wrap}[_nghost-%COMP%]     .table-caption__search .p-iconfield, [_nghost-%COMP%]     .table-caption__search .p-inputtext{width:100%}[_nghost-%COMP%]     .compta-data-table .p-datatable-table{min-width:55rem}[_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th{padding:1rem 1.25rem}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:1.1rem 1.25rem}.col-header[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.35rem;font-size:.8rem;font-weight:600;text-transform:uppercase;letter-spacing:.03em;color:var(--p-surface-500)}.table-row[_ngcontent-%COMP%]{cursor:pointer;transition:background .15s ease}.cell-prestataire[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.cell-prestataire__avatar[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:9px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.8rem;flex-shrink:0}.cell-prestataire__name[_ngcontent-%COMP%]{font-weight:600;font-size:.9rem;color:var(--p-surface-800)}.cell-secondary[_ngcontent-%COMP%]{color:var(--p-surface-400);font-size:.9rem}.cell-mono[_ngcontent-%COMP%]{font-variant-numeric:tabular-nums;font-size:.9rem}.cell-success[_ngcontent-%COMP%]{color:#059669}.cell-bold[_ngcontent-%COMP%]{font-weight:600;color:var(--p-surface-800)}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .75rem;border-radius:20px;font-size:.78rem;font-weight:600;letter-spacing:.01em}.status-badge--danger[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626}.status-badge--warn[_ngcontent-%COMP%]{background:#fffbeb;color:#d97706}.status-badge--success[_ngcontent-%COMP%]{background:#ecfdf5;color:#059669}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.75rem;padding:3rem 0;color:var(--p-surface-300)}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2.5rem}.empty-state[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.9rem}.preview-summary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem 1.25rem;background:var(--p-surface-50);border-radius:10px;font-size:.9rem;color:var(--p-surface-600)}.preview-summary__sep[_ngcontent-%COMP%]{width:4px;height:4px;border-radius:50%;background:var(--p-surface-300)}@media (max-width: 768px){[_nghost-%COMP%]     .compta-table-card.card{padding:1rem;border-radius:16px}[_nghost-%COMP%]     .compta-toolbar.p-toolbar{padding:.75rem;margin-bottom:.75rem;gap:.625rem}[_nghost-%COMP%]     .compta-toolbar .p-toolbar-start, [_nghost-%COMP%]     .compta-toolbar .p-toolbar-end{width:100%}.compta-toolbar__start[_ngcontent-%COMP%]{width:100%;display:grid;grid-template-columns:minmax(0,1fr) minmax(0,1fr) auto;gap:.5rem}.compta-toolbar__end[_ngcontent-%COMP%]{width:100%;display:grid;grid-template-columns:minmax(0,1fr) auto;gap:.5rem}[_nghost-%COMP%]     .compta-toolbar__date.p-datepicker, [_nghost-%COMP%]     .compta-toolbar__status.p-select{width:100%}.table-caption[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:.75rem}[_nghost-%COMP%]     .p-datatable .p-datatable-caption{padding:1rem}[_nghost-%COMP%]     .compta-data-table .p-datatable-table{min-width:46rem}[_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th, [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:.85rem .9rem}}.dark[_nghost-%COMP%]   .cell-prestataire__name[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .cell-prestataire__name[_ngcontent-%COMP%], .dark[_nghost-%COMP%]   .cell-bold[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .cell-bold[_ngcontent-%COMP%]{color:var(--p-surface-100)}.dark[_nghost-%COMP%]   .col-header[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .col-header[_ngcontent-%COMP%]{color:var(--p-surface-400)}.dark[_nghost-%COMP%]   .status-badge--danger[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .status-badge--danger[_ngcontent-%COMP%]{background:#dc26261f}.dark[_nghost-%COMP%]   .status-badge--warn[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .status-badge--warn[_ngcontent-%COMP%]{background:#d977061f}.dark[_nghost-%COMP%]   .status-badge--success[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .status-badge--success[_ngcontent-%COMP%]{background:#0596691f}.dark[_nghost-%COMP%]   .preview-summary[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .preview-summary[_ngcontent-%COMP%]{background:var(--p-surface-700)}.dark[_nghost-%COMP%]     .compta-toolbar.p-toolbar, .dark   [_nghost-%COMP%]     .compta-toolbar.p-toolbar{background:var(--p-surface-700);border-color:var(--p-surface-600)}.dark[_nghost-%COMP%]     .p-datatable .p-datatable-caption, .dark   [_nghost-%COMP%]     .p-datatable .p-datatable-caption{border-bottom-color:var(--p-surface-700)}"]})};var Z=class r{ngOnInit(){}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=D({type:r,selectors:[["app-comptabilite-packing-liste"]],features:[B([I,q,ot])],decls:5,vars:0,consts:[["statsWidget",""],[1,"compta-mobile-shell"],[1,"compta-mobile-shell__stats","grid","grid-cols-12","gap-6","mb-6"],[1,"compta-mobile-shell__table",3,"dataChanged"]],template:function(e,a){if(e&1){let l=b();i(0,"section",1)(1,"div",2),p(2,"app-stats-comptabilite-packing-widget",null,0),n(),i(4,"app-comptabilite-packing-tableau",3),f("dataChanged",function(v){_(l);let ft=X(3);return g(ft.loadStats(v))}),n()()}},dependencies:[F,Re,Ae],styles:["[_nghost-%COMP%]{display:block}.compta-mobile-shell[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.compta-mobile-shell__stats[_ngcontent-%COMP%]{margin-bottom:0}@media (max-width: 768px){.compta-mobile-shell[_ngcontent-%COMP%]{gap:.875rem;padding-bottom:calc(.75rem + env(safe-area-inset-bottom))}.compta-mobile-shell__stats[_ngcontent-%COMP%]{margin-bottom:0!important}}"]})};function Gt(r,t){if(r&1){let e=b();i(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),o(4),n(),i(5,"div",5),o(6,"Versement facture"),n()(),i(7,"button",6),f("click",function(){_(e);let l=c();return g(l.onClose.emit())}),p(8,"i",7),n()(),i(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11),o(13,"Total facture"),n(),i(14,"div",12),o(15),C(16,"money"),n()(),i(17,"div",10)(18,"div",11),o(19,"D\xE9j\xE0 vers\xE9"),n(),i(20,"div",13),o(21),C(22,"money"),n()(),p(23,"div",14),i(24,"div",10)(25,"div",15),o(26,"Reste \xE0 payer"),n(),i(27,"div",16),o(28),C(29,"money"),n()()(),i(30,"div",17)(31,"div",18),o(32,"Montant \xE0 verser"),n(),i(33,"p-inputnumber",19),O("ngModelChange",function(l){_(e);let u=c();return w(u.montant,l)||(u.montant=l),g(l)}),n()(),i(34,"div",17)(35,"div",18),o(36,"Mode de paiement"),n(),i(37,"div",20)(38,"div",21),f("click",function(){_(e);let l=c();return g(l.selectMode("especes"))}),p(39,"i",22),i(40,"span"),o(41,"Esp\xE8ces"),n()(),i(42,"div",21),f("click",function(){_(e);let l=c();return g(l.selectMode("virement"))}),p(43,"i",23),i(44,"span"),o(45,"Virement"),n()(),i(46,"div",21),f("click",function(){_(e);let l=c();return g(l.selectMode("mobile_money"))}),p(47,"i",24),i(48,"span"),o(49,"Mobile"),n()()()()(),i(50,"div",25)(51,"div",26)(52,"div",27)(53,"div",12),o(54,"Montant \xE0 payer"),n()(),i(55,"div",28),o(56),n()(),i(57,"button",29),f("click",function(){_(e);let l=c();return g(l.confirmer())}),p(58,"i",30),i(59,"span",31),o(60,"Confirmer le paiement"),n()()()()}if(r&2){let e=c();s(4),d(e.facture.reference.replace("FACT-PACK-","")),s(3),m("text",!0)("rounded",!0),s(8),d(P(16,19,e.facture.montant_total,"GNF")),s(6),d(P(22,22,e.facture.montant_verse,"GNF")),s(7),d(P(29,25,e.facture.montant_restant,"GNF")),s(5),S("ngModel",e.montant),m("min",1)("max",e.facture.montant_restant)("useGrouping",!0),s(5),A("slideover-mode--active",e.selectedMode==="especes"),s(4),A("slideover-mode--active",e.selectedMode==="virement"),s(4),A("slideover-mode--active",e.selectedMode==="mobile_money"),s(10),d(e.montant?e.formatCurrency(e.montant):"0 GNF"),s(),m("disabled",e.saving||!e.montant)("loading",e.saving)}}var Be=class r{facture=null;saving=!1;onPay=new K;onClose=new K;montant=null;selectedMode="especes";ngOnChanges(){this.facture&&(this.montant=this.facture.montant_restant,this.selectedMode="especes")}selectMode(t){this.selectedMode=t}confirmer(){!this.montant||this.montant<=0||!this.facture||this.onPay.emit({montant:this.montant,mode_paiement:this.selectedMode})}formatCurrency(t){return new Intl.NumberFormat("fr-FR",{style:"decimal",minimumFractionDigits:0}).format(t)+" GNF"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=D({type:r,selectors:[["app-comptabilite-packing-paiement"]],inputs:{facture:"facture",saving:"saving"},outputs:{onPay:"onPay",onClose:"onClose"},features:[Ge],decls:1,vars:1,consts:[["class","flex flex-col h-full bg-surface-0 dark:bg-surface-900",4,"ngIf"],[1,"flex","flex-col","h-full","bg-surface-0","dark:bg-surface-900"],[1,"w-full","p-6","border-b","border-surface-200","dark:border-surface-700","flex","justify-start","items-center"],[1,"flex-1"],[1,"text-surface-900","dark:text-surface-0","text-xl","font-medium","leading-tight"],[1,"text-surface-500","dark:text-surface-400","text-sm","font-normal","mt-1"],["pButton","",1,"w-10","h-10",3,"click","text","rounded"],["pButtonIcon","",1,"pi","pi-times"],[1,"flex-1","w-full","p-6","flex","flex-col","justify-start","items-start","gap-6","overflow-y-auto"],[1,"w-full","p-5","bg-surface-50","dark:bg-surface-800","rounded-xl","flex","flex-col","justify-start","items-start","gap-4"],[1,"w-full","flex","justify-start","items-start","gap-6"],[1,"flex-1","text-surface-500","dark:text-surface-400","text-base","font-normal","leading-tight"],[1,"text-surface-900","dark:text-surface-0","text-base","font-medium","leading-tight"],[1,"text-base","font-semibold","leading-tight",2,"color","#059669"],[1,"w-full","h-px","bg-surface-200","dark:bg-surface-700"],[1,"flex-1","text-surface-900","dark:text-surface-0","text-base","font-semibold","leading-tight"],[1,"text-lg","font-bold","leading-tight",2,"color","#d97706"],[1,"w-full","flex","flex-col","gap-3"],[1,"text-surface-500","dark:text-surface-400","text-xs","font-semibold","uppercase","tracking-wider"],["suffix"," GNF","locale","fr-FR","inputStyleClass","w-full text-right text-xl font-bold py-4","styleClass","w-full","placeholder","0",3,"ngModelChange","ngModel","min","max","useGrouping"],[1,"w-full","flex","gap-3"],[1,"slideover-mode",3,"click"],[1,"pi","pi-money-bill"],[1,"pi","pi-building"],[1,"pi","pi-mobile"],[1,"w-full","border-t","border-surface-200","dark:border-surface-700","p-6","flex","flex-col","gap-5"],[1,"w-full","flex","justify-start","items-start","gap-4"],[1,"flex","justify-start","items-end","gap-2"],[1,"flex-1","text-right","text-surface-900","dark:text-surface-0","text-lg","font-bold","leading-tight"],["pButton","","severity","contrast",1,"w-full","py-3",3,"click","disabled","loading"],["pButtonIcon","",1,"pi","pi-check","mr-2"],["pButtonLabel",""]],template:function(e,a){e&1&&h(0,Gt,61,28,"div",0),e&2&&m("ngIf",a.facture)},dependencies:[F,L,z,W,j,G,le,se,Xe,ae,U,ve,H],styles:[".slideover-mode[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;gap:.5rem;padding:1rem .75rem;border-radius:12px;border:1.5px solid var(--p-surface-200);background:transparent;cursor:pointer;transition:all .15s ease;color:var(--p-surface-500);font-size:.82rem;font-weight:500}.slideover-mode[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.25rem}.slideover-mode[_ngcontent-%COMP%]:hover{border-color:var(--p-surface-300);background:var(--p-surface-50)}.slideover-mode--active[_ngcontent-%COMP%]{border-color:var(--p-primary-500);background:var(--p-primary-50);color:var(--p-primary-600);font-weight:600}.dark[_nghost-%COMP%]   .slideover-mode[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .slideover-mode[_ngcontent-%COMP%]{border-color:var(--p-surface-600);color:var(--p-surface-300)}.dark[_nghost-%COMP%]   .slideover-mode[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .slideover-mode[_ngcontent-%COMP%]:hover{background:var(--p-surface-800);border-color:var(--p-surface-500)}.dark[_nghost-%COMP%]   .slideover-mode--active[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .slideover-mode--active[_ngcontent-%COMP%]{border-color:var(--p-primary-500);background:#3b82f61f;color:var(--p-primary-400)}"]})};var Ht=()=>[10,20,30],Ut=()=>({"min-width":"55rem"}),_t=()=>({width:"750px"}),gt=()=>({"max-height":"70vh",overflow:"auto"}),$t=()=>({width:"450px"}),Kt=(r,t,e,a)=>({"status-badge--danger":r,"status-badge--warn":t,"status-badge--success":e,"status-badge--secondary":a});function Qt(r,t){if(r&1&&(i(0,"span",31),p(1,"i",32),o(2),C(3,"phoneFormat"),n()),r&2){let e=c();s(2),T(" ",P(3,1,e.prestatairePhone,"INT")," ")}}function Yt(r,t){if(r&1){let e=b();i(0,"div",33)(1,"div",34),f("click",function(){_(e);let l=c();return g(l.closeSlideoverPaiement())}),n(),i(2,"div",35)(3,"app-comptabilite-packing-paiement",36),f("onPay",function(l){_(e);let u=c();return g(u.onSlideoverPay(l))})("onClose",function(){_(e);let l=c();return g(l.closeSlideoverPaiement())}),n()()()}if(r&2){let e=c();s(3),m("facture",e.slideoverFacture)("saving",e.slideoverSaving)}}function Zt(r,t){r&1&&(i(0,"div",37)(1,"h5",38),o(2,"Factures"),n()())}function Jt(r,t){r&1&&(i(0,"tr")(1,"th",39)(2,"span",40),o(3,"R\xE9f\xE9rence "),p(4,"p-sortIcon",41),n()(),i(5,"th",42)(6,"span",40),o(7,"Date "),p(8,"p-sortIcon",43),n()(),i(9,"th",44)(10,"span",45),o(11,"Rouleaux "),p(12,"p-sortIcon",46),n()(),i(13,"th",47)(14,"span",45),o(15,"Prix/rouleau"),n()(),i(16,"th",48)(17,"span",45),o(18,"A payer "),p(19,"p-sortIcon",49),n()(),i(20,"th",50)(21,"span",45),o(22,"Vers\xE9 "),p(23,"p-sortIcon",51),n()(),i(24,"th",47)(25,"span",45),o(26,"Restant"),n()(),i(27,"th",52)(28,"span",53),o(29,"Statut "),p(30,"p-sortIcon",54),n()(),p(31,"th",55),n())}function Xt(r,t){if(r&1){let e=b();i(0,"p-button",68),f("click",function(){_(e);let l=c().$implicit,u=c();return g(u.openVersement(l))}),n()}r&2&&m("text",!0)("rounded",!0)}function ei(r,t){if(r&1){let e=b();i(0,"p-button",69),f("click",function(){_(e);let l=c().$implicit,u=c();return g(u.openSlideoverPaiement(l))}),n()}r&2&&m("text",!0)("rounded",!0)}function ti(r,t){if(r&1){let e=b();i(0,"p-button",70),f("click",function(){_(e);let l=c().$implicit,u=c();return g(u.openHistorique(l))}),n()}r&2&&m("text",!0)("rounded",!0)}function ii(r,t){if(r&1){let e=b();i(0,"p-button",71),f("click",function(){_(e);let l=c().$implicit,u=c();return g(u.confirmDeleteFacture(l))}),n()}r&2&&m("text",!0)("rounded",!0)}function ni(r,t){if(r&1&&(i(0,"tr")(1,"td",56),o(2),n(),i(3,"td",57),o(4),n(),i(5,"td",58),o(6),n(),i(7,"td",58),o(8),C(9,"money"),n(),i(10,"td",58),o(11),C(12,"money"),n(),i(13,"td",59),o(14),C(15,"money"),n(),i(16,"td",60),o(17),C(18,"money"),n(),i(19,"td",61)(20,"span",62),o(21),n()(),i(22,"td")(23,"div",63),h(24,Xt,1,2,"p-button",64)(25,ei,1,2,"p-button",65)(26,ti,1,2,"p-button",66)(27,ii,1,2,"p-button",67),n()()()),r&2){let e=t.$implicit,a=c();s(2),d(e.reference.replace("FACT-PACK-","")),s(2),d(a.formatDateDisplay(e.date)),s(2),d(e.total_rouleaux),s(2),d(P(9,13,e.prix_par_rouleau,"GNF")),s(3),d(P(12,16,e.montant_total,"GNF")),s(3),d(P(15,19,e.montant_verse,"GNF")),s(3),d(P(18,22,e.montant_restant,"GNF")),s(3),m("ngClass",Qe(25,Kt,e.statut==="impayee",e.statut==="partielle",e.statut==="payee",e.statut==="annulee")),s(),T(" ",e.statut_label," "),s(3),m("ngIf",a.canCreateVersement&&e.statut!=="payee"),s(),m("ngIf",a.canCreateVersement&&e.statut!=="payee"),s(),m("ngIf",a.canReadVersement),s(),m("ngIf",a.canDeleteFacture&&e.montant_verse===0)}}function ai(r,t){r&1&&(i(0,"tr")(1,"td",72)(2,"div",73),p(3,"i",74),i(4,"span"),o(5,"Aucune facture pour ce prestataire"),n()()()())}function ri(r,t){r&1&&(i(0,"small",85),o(1,"Montant requis."),n())}function oi(r,t){if(r&1){let e=b();i(0,"div",75)(1,"div",76)(2,"span",77),o(3),n(),p(4,"span",78),i(5,"span"),o(6,"Total : "),i(7,"strong"),o(8),C(9,"money"),n()(),p(10,"span",78),i(11,"span",79),o(12,"Vers\xE9 : "),i(13,"strong"),o(14),C(15,"money"),n()(),p(16,"span",78),i(17,"span",80),o(18),C(19,"money"),n()(),i(20,"div",75)(21,"div",28)(22,"label",81),o(23,"Mode de paiement"),n(),i(24,"p-select",82),O("ngModelChange",function(l){_(e);let u=c();return w(u.versementData.mode_paiement,l)||(u.versementData.mode_paiement=l),g(l)}),n()(),i(25,"div",28)(26,"label",81),o(27,"Montant \xE0 verser"),n(),i(28,"p-inputnumber",83),O("ngModelChange",function(l){_(e);let u=c();return w(u.versementData.montant,l)||(u.versementData.montant=l),g(l)}),n(),h(29,ri,2,0,"small",84),n()()()}if(r&2){let e=c();s(3),d(e.selectedFacture.reference.replace("FACT-PACK-","")),s(5),d(P(9,11,e.selectedFacture.montant_total,"GNF")),s(6),d(P(15,14,e.selectedFacture.montant_verse,"GNF")),s(4),T("Restant : ",P(19,17,e.selectedFacture.montant_restant,"GNF")),s(6),S("ngModel",e.versementData.mode_paiement),m("options",e.modesPaiement),s(4),S("ngModel",e.versementData.montant),m("min",1)("max",e.selectedFacture.montant_restant)("useGrouping",!0),s(),m("ngIf",e.versementSubmitted&&!e.versementData.montant)}}function si(r,t){if(r&1){let e=b();i(0,"button",86),f("click",function(){_(e);let l=c();return g(l.hideVersementDialog())}),i(1,"span",87),o(2,"Annuler"),n()(),i(3,"button",88),f("click",function(){_(e);let l=c();return g(l.saveVersement())}),i(4,"span",87),o(5,"Enregistrer"),n()()}if(r&2){let e=c();m("outlined",!0),s(3),m("disabled",e.versementSaving)("loading",e.versementSaving)}}function li(r,t){r&1&&(i(0,"div",89),p(1,"i",90),n())}function mi(r,t){r&1&&p(0,"th",98)}function ci(r,t){if(r&1&&(i(0,"tr")(1,"th")(2,"span",40),o(3,"Date"),n()(),i(4,"th",47)(5,"span",45),o(6,"Montant"),n()(),i(7,"th")(8,"span",40),o(9,"Mode"),n()(),i(10,"th")(11,"span",40),o(12,"Notes"),n()(),h(13,mi,1,0,"th",97),n()),r&2){let e=c(3);s(13),m("ngIf",e.canDeleteVersement)}}function pi(r,t){if(r&1){let e=b();i(0,"td",61)(1,"p-button",71),f("click",function(){_(e);let l=c().$implicit,u=c(3);return g(u.confirmDeleteVersement(u.historiqueData.facture_id,l))}),n()()}r&2&&(s(),m("text",!0)("rounded",!0))}function di(r,t){if(r&1&&(i(0,"tr")(1,"td",99),o(2),n(),i(3,"td",100),o(4),n(),i(5,"td"),o(6),n(),i(7,"td",99),o(8),n(),h(9,pi,2,2,"td",101),n()),r&2){let e=t.$implicit,a=c(3);s(2),d(a.formatDateDisplay(e.date_versement)),s(2),d(a.formatCurrency(e.montant)),s(2),d(e.mode_paiement_label),s(2),d(e.notes||"-"),s(),m("ngIf",a.canDeleteVersement)}}function ui(r,t){if(r&1&&(i(0,"p-table",96),h(1,ci,14,1,"ng-template",null,1,x)(3,di,10,5,"ng-template",null,2,x),n()),r&2){let e=c(2);m("value",e.historiqueData.versements)("rowHover",!0)}}function _i(r,t){r&1&&(i(0,"div",73),p(1,"i",74),i(2,"span"),o(3,"Aucun versement enregistr\xE9"),n()())}function gi(r,t){if(r&1&&(i(0,"div",75)(1,"div",76)(2,"span",91),o(3),n(),p(4,"span",78),i(5,"span"),o(6,"Total: "),i(7,"strong"),o(8),n()(),p(9,"span",78),i(10,"span",79),o(11,"Vers\xE9: "),i(12,"strong"),o(13),n()(),p(14,"span",78),i(15,"span",92),o(16),n(),i(17,"span",93)(18,"span",62),o(19),n()()(),h(20,ui,5,2,"p-table",94)(21,_i,4,0,"div",95),n()),r&2){let e=c();s(3),d(e.historiqueData.reference.replace("FACT-PACK-","")),s(5),d(e.formatCurrency(e.historiqueData.montant_total)),s(5),d(e.formatCurrency(e.historiqueData.montant_verse)),s(3),T("Restant: ",e.formatCurrency(e.historiqueData.montant_restant)),s(2),m("ngClass",e.historiqueData.is_soldee?"status-badge--success":"status-badge--warn"),s(),T(" ",e.historiqueData.is_soldee?"Sold\xE9":"En cours"," "),s(),m("ngIf",e.historiqueData.versements.length>0),s(),m("ngIf",e.historiqueData.versements.length===0)}}function fi(r,t){if(r&1){let e=b();i(0,"p-button",102),f("click",function(){_(e);let l=c();return g(l.historiqueDialog=!1)}),n()}r&2&&m("text",!0)}var Le=class r{constructor(t,e,a,l,u,v){this.route=t;this.router=e;this.factureService=a;this.messageService=l;this.confirmationService=u;this.authService=v;this.canReadVersement=this.authService.hasPermission("versements.read"),this.canCreateVersement=this.authService.hasPermission("versements.create"),this.canDeleteVersement=this.authService.hasPermission("versements.delete"),this.canDeleteFacture=this.authService.hasPermission("facture-packings.delete")}prestataireId=0;prestataireNom="";prestatairePhone="";factures=J([]);loading=!1;totalFacture=0;totalVerse=0;totalRestant=0;versementDialog=!1;selectedFacture=null;versementData={montant:null,date_versement:new Date,mode_paiement:"especes",notes:""};versementSaving=!1;versementSubmitted=!1;modesPaiement=[{label:Q.especes,value:"especes"},{label:Q.virement,value:"virement"},{label:Q.cheque,value:"cheque"},{label:Q.mobile_money,value:"mobile_money"}];historiqueDialog=!1;historiqueData=null;historiqueLoading=!1;canReadVersement=!1;canCreateVersement=!1;canDeleteVersement=!1;canDeleteFacture=!1;ngOnInit(){this.route.params.subscribe(t=>{this.prestataireId=+t.id||0}),this.route.queryParams.subscribe(t=>{this.prestataireNom=t.prestataire_nom||"",this.prestatairePhone=t.prestataire_phone||""}),this.prestataireId&&this.loadFactures()}loadFactures(){this.loading=!0,this.factureService.getFactures({prestataire_id:this.prestataireId}).subscribe({next:t=>{let e=(t.data||[]).map(a=>new Te(a));this.factures.set(e),this.calculateTotals(e),this.loading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger les factures",life:3e3}),this.loading=!1}})}calculateTotals(t){this.totalFacture=t.reduce((e,a)=>e+a.montant_total,0),this.totalVerse=t.reduce((e,a)=>e+a.montant_verse,0),this.totalRestant=t.reduce((e,a)=>e+a.montant_restant,0)}openVersement(t){this.selectedFacture=t,this.versementDialog=!0,this.versementSubmitted=!1,this.versementData={montant:t.montant_restant,date_versement:new Date,mode_paiement:"especes",notes:""}}hideVersementDialog(){this.versementDialog=!1,this.selectedFacture=null,this.versementSubmitted=!1}saveVersement(){if(this.versementSubmitted=!0,!this.selectedFacture||!this.versementData.montant||!this.versementData.date_versement||this.versementSaving)return;this.versementSaving=!0;let t={montant:this.versementData.montant,date_versement:this.formatDate(this.versementData.date_versement),mode_paiement:this.versementData.mode_paiement,notes:this.versementData.notes||void 0};this.factureService.createVersement(this.selectedFacture.id,t).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`Versement de ${this.formatCurrency(t.montant)} enregistr\xE9`,life:3e3}),this.versementSaving=!1,this.versementDialog=!1,this.loadFactures()},error:e=>{let a=e?.error?.message||"Impossible d'enregistrer le versement";this.messageService.add({severity:"error",summary:"Erreur",detail:a,life:5e3}),this.versementSaving=!1}})}openHistorique(t){this.historiqueDialog=!0,this.historiqueLoading=!0,this.historiqueData=null,this.factureService.getVersements(t.id).subscribe({next:e=>{this.historiqueData=e.data,this.historiqueLoading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger les versements",life:3e3}),this.historiqueLoading=!1,this.historiqueDialog=!1}})}confirmDeleteVersement(t,e){this.confirmationService.confirm({message:`Supprimer le versement de ${this.formatCurrency(e.montant)} ?`,header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptLabel:"Supprimer",rejectLabel:"Annuler",accept:()=>{this.factureService.deleteVersement(t,e.id).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Versement supprim\xE9",life:3e3}),this.historiqueData&&this.openHistorique({id:t}),this.loadFactures()},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de supprimer le versement",life:3e3})}})}})}confirmDeleteFacture(t){this.confirmationService.confirm({message:`Supprimer la facture ${t.reference} ?`,header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptLabel:"Supprimer",rejectLabel:"Annuler",accept:()=>{this.factureService.deleteFacture(t.id).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Facture supprim\xE9e",life:3e3}),this.loadFactures()},error:e=>{let a=e?.error?.message||"Impossible de supprimer la facture";this.messageService.add({severity:"error",summary:"Erreur",detail:a,life:5e3})}})}})}getStatutSeverity(t){return ct[t]??"info"}formatDate(t){return t?typeof t=="string"?t:new Date(t).toISOString().split("T")[0]:""}formatCurrency(t){return new Intl.NumberFormat("fr-FR",{style:"decimal",minimumFractionDigits:0}).format(t)+" GNF"}formatDateDisplay(t){return t?new Date(t).toLocaleDateString("fr-FR"):""}goBack(){this.router.navigate(["/comptabilite/comptabilite-packing-liste"])}slideoverVisible=!1;slideoverFacture=null;slideoverSaving=!1;openSlideoverPaiement(t){this.slideoverFacture=t,this.slideoverVisible=!0}closeSlideoverPaiement(){this.slideoverVisible=!1,this.slideoverFacture=null}onSlideoverPay(t){if(!this.slideoverFacture||this.slideoverSaving)return;this.slideoverSaving=!0;let e={montant:t.montant,date_versement:this.formatDate(new Date),mode_paiement:t.mode_paiement};this.factureService.createVersement(this.slideoverFacture.id,e).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`Versement de ${this.formatCurrency(e.montant)} enregistr\xE9`,life:3e3}),this.slideoverSaving=!1,this.closeSlideoverPaiement(),this.loadFactures()},error:a=>{let l=a?.error?.message||"Impossible d'enregistrer le versement";this.messageService.add({severity:"error",summary:"Erreur",detail:l,life:5e3}),this.slideoverSaving=!1}})}static \u0275fac=function(e){return new(e||r)(y(Ze),y(ne),y(R),y(I),y(q),y(nt))};static \u0275cmp=D({type:r,selectors:[["app-comptabilite-packing-detail"]],features:[B([I,q])],decls:57,vars:48,consts:[["caption",""],["header",""],["body",""],["emptymessage",""],["footer",""],["position","top-right","appendTo","body",3,"baseZIndex","preventOpenDuplicates"],[1,"detail-header"],[1,"detail-header__left"],["icon","pi pi-arrow-left","severity","secondary","pTooltip","Retour",3,"click","rounded","text"],[1,"detail-header__name"],["class","detail-header__phone",4,"ngIf"],["class","fixed inset-0 z-50",4,"ngIf"],[1,"stats-bar","mb-6"],[1,"stats-bar__item"],[1,"stats-bar__icon","stats-bar__icon--primary"],[1,"pi","pi-wallet"],[1,"stats-bar__value"],[1,"stats-bar__label"],[1,"stats-bar__divider"],[1,"stats-bar__icon","stats-bar__icon--success"],[1,"pi","pi-check-circle"],[1,"stats-bar__value","stats-bar__value--success"],[1,"stats-bar__icon","stats-bar__icon--warning"],[1,"pi","pi-arrow-right"],[1,"card","tableau-card"],["dataKey","id","currentPageReportTemplate","{first} \xE0 {last} sur {totalRecords} factures",3,"value","rows","paginator","rowHover","showCurrentPageReport","rowsPerPageOptions","loading","tableStyle"],["header","Enregistrer un versement",3,"visibleChange","visible","contentStyle","modal","blockScroll","dismissableMask","closeOnEscape"],["class","flex flex-col gap-4",4,"ngIf"],[1,"mt-4"],["header","Historique des versements",3,"visibleChange","visible","contentStyle","modal","blockScroll","dismissableMask","closeOnEscape"],["class","flex items-center justify-center p-12",4,"ngIf"],[1,"detail-header__phone"],[1,"pi","pi-phone"],[1,"fixed","inset-0","z-50"],[1,"absolute","inset-0","bg-black/50","animate-fadein",3,"click"],[1,"bg-surface-0","dark:bg-surface-900","absolute","top-0","right-0","shadow-xl","w-full","md:w-108","h-full","animate-fadeinright"],[3,"onPay","onClose","facture","saving"],[1,"table-caption"],[1,"table-caption__title"],["pSortableColumn","reference"],[1,"col-header"],["field","reference"],["pSortableColumn","date"],["field","date"],["pSortableColumn","total_rouleaux",1,"text-right"],[1,"col-header","justify-end"],["field","total_rouleaux"],[1,"text-right"],["pSortableColumn","montant_total",1,"text-right"],["field","montant_total"],["pSortableColumn","montant_verse",1,"text-right"],["field","montant_verse"],["pSortableColumn","statut",1,"text-center"],[1,"col-header","justify-center"],["field","statut"],[2,"width","10rem"],[1,"font-semibold"],[1,"cell-secondary","font-semibold"],[1,"text-right","cell-mono","font-semibold"],[1,"text-right","cell-mono","cell-success","font-semibold"],[1,"text-right","cell-mono","cell-bold"],[1,"text-center"],[1,"status-badge",3,"ngClass"],[1,"flex","items-center","justify-end","gap-1"],["icon","pi pi-money-bill","severity","success","pTooltip","Payer (dialogue)",3,"text","rounded","click",4,"ngIf"],["icon","pi pi-wallet","severity","warn","pTooltip","Payer (panneau)",3,"text","rounded","click",4,"ngIf"],["icon","pi pi-list","severity","info","pTooltip","Historique versements",3,"text","rounded","click",4,"ngIf"],["icon","pi pi-trash","severity","danger","pTooltip","Supprimer",3,"text","rounded","click",4,"ngIf"],["icon","pi pi-money-bill","severity","success","pTooltip","Payer (dialogue)",3,"click","text","rounded"],["icon","pi pi-wallet","severity","warn","pTooltip","Payer (panneau)",3,"click","text","rounded"],["icon","pi pi-list","severity","info","pTooltip","Historique versements",3,"click","text","rounded"],["icon","pi pi-trash","severity","danger","pTooltip","Supprimer",3,"click","text","rounded"],["colspan","9"],[1,"empty-state"],[1,"pi","pi-inbox"],[1,"flex","flex-col","gap-4"],[1,"preview-summary"],[1,"font-bold"],[1,"preview-summary__sep"],[1,"cell-success"],[1,"font-bold",2,"color","#d97706"],[1,"block","font-bold","mb-2"],["optionLabel","label","optionValue","value","styleClass","w-full","appendTo","body",3,"ngModelChange","ngModel","options"],["suffix"," GNF","locale","fr-FR","inputStyleClass","w-full","styleClass","w-full",3,"ngModelChange","ngModel","min","max","useGrouping"],["class","text-red-500",4,"ngIf"],[1,"text-red-500"],["pButton","",3,"click","outlined"],["pButtonLabel",""],["pButton","",3,"click","disabled","loading"],[1,"flex","items-center","justify-center","p-12"],[1,"pi","pi-spin","pi-spinner","text-3xl","text-surface-300"],[1,"font-bold","text-lg"],[1,"cell-bold"],[1,"ml-auto"],[3,"value","rowHover",4,"ngIf"],["class","empty-state",4,"ngIf"],[3,"value","rowHover"],["style","width: 4rem",4,"ngIf"],[2,"width","4rem"],[1,"cell-secondary"],[1,"text-right","cell-mono","cell-success","font-bold"],["class","text-center",4,"ngIf"],["label","Fermer",3,"click","text"]],template:function(e,a){if(e&1){let l=b();p(0,"p-toast",5),i(1,"div",6)(2,"div",7)(3,"p-button",8),f("click",function(){return _(l),g(a.goBack())}),n(),i(4,"div")(5,"h4",9),o(6),n(),h(7,Qt,4,4,"span",10),n()(),p(8,"div"),n(),h(9,Yt,4,2,"div",11),i(10,"div",12)(11,"div",13)(12,"div",14),p(13,"i",15),n(),i(14,"div")(15,"div",16),o(16),n(),i(17,"div",17),o(18,"Total \xE0 payer"),n()()(),p(19,"div",18),i(20,"div",13)(21,"div",19),p(22,"i",20),n(),i(23,"div")(24,"div",21),o(25),n(),i(26,"div",17),o(27,"Total vers\xE9"),n()()(),p(28,"div",18),i(29,"div",13)(30,"div",22),p(31,"i",23),n(),i(32,"div")(33,"div",16),o(34),n(),i(35,"div",17),o(36,"Reste \xE0 payer"),n()()()(),i(37,"div",24)(38,"p-table",25),h(39,Zt,3,0,"ng-template",null,0,x)(41,Jt,32,0,"ng-template",null,1,x)(43,ni,28,30,"ng-template",null,2,x)(45,ai,6,0,"ng-template",null,3,x),n()(),i(47,"p-dialog",26),O("visibleChange",function(v){return _(l),w(a.versementDialog,v)||(a.versementDialog=v),g(v)}),h(48,oi,30,20,"div",27)(49,si,6,3,"ng-template",28,4,x),n(),i(51,"p-dialog",29),O("visibleChange",function(v){return _(l),w(a.historiqueDialog,v)||(a.historiqueDialog=v),g(v)}),h(52,li,2,0,"div",30)(53,gi,22,8,"div",27)(54,fi,1,1,"ng-template",null,4,x),n(),p(56,"p-confirmdialog")}e&2&&(m("baseZIndex",1100)("preventOpenDuplicates",!0),s(3),m("rounded",!0)("text",!0),s(3),d(a.prestataireNom),s(),m("ngIf",a.prestatairePhone),s(2),m("ngIf",a.slideoverVisible),s(7),d(a.formatCurrency(a.totalFacture)),s(9),d(a.formatCurrency(a.totalVerse)),s(8),A("stats-bar__value--warning",a.totalRestant>0),s(),d(a.formatCurrency(a.totalRestant)),s(4),m("value",a.factures())("rows",10)("paginator",!0)("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",E(41,Ht))("loading",a.loading)("tableStyle",E(42,Ut)),s(9),N(E(43,_t)),S("visible",a.versementDialog),m("contentStyle",E(44,gt))("modal",!0)("blockScroll",!0)("dismissableMask",!1)("closeOnEscape",!1),s(),m("ngIf",a.selectedFacture),s(3),N(E(45,_t)),S("visible",a.historiqueDialog),m("contentStyle",E(46,gt))("modal",!0)("blockScroll",!0)("dismissableMask",!1)("closeOnEscape",!1),s(),m("ngIf",a.historiqueLoading),s(),m("ngIf",a.historiqueData),s(3),N(E(47,$t)))},dependencies:[F,te,L,Pe,he,xe,Ce,z,W,j,G,le,me,se,oe,ke,ye,Me,re,fe,ge,U,ve,we,Se,Oe,pe,ce,De,Ee,be,Fe,ue,de,ae,Be,mt,rt,Ie,H],styles:[".detail-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;background:var(--p-surface-0);border-radius:14px;padding:1.25rem 1.75rem;margin-bottom:1.5rem;box-shadow:0 1px 3px #0000000a}.detail-header__left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.detail-header__name[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:700;color:var(--p-surface-800)}.detail-header__phone[_ngcontent-%COMP%]{font-size:.85rem;color:var(--p-surface-400);display:flex;align-items:center;gap:.35rem;margin-top:.15rem}.stats-bar[_ngcontent-%COMP%]{display:flex;align-items:center;background:var(--p-surface-0);border-radius:14px;padding:1.25rem 2rem;box-shadow:0 1px 3px #0000000a}.stats-bar__item[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:1rem;padding:.5rem 1.5rem}.stats-bar__divider[_ngcontent-%COMP%]{width:1px;height:40px;background:var(--p-surface-200);flex-shrink:0}.stats-bar__icon[_ngcontent-%COMP%]{width:42px;height:42px;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:1.1rem}.stats-bar__icon--primary[_ngcontent-%COMP%]{background:var(--p-primary-50);color:var(--p-primary-500)}.stats-bar__icon--success[_ngcontent-%COMP%]{background:#ecfdf5;color:#10b981}.stats-bar__icon--warning[_ngcontent-%COMP%]{background:#fff7ed;color:#f59e0b}.stats-bar__value[_ngcontent-%COMP%]{font-size:1.35rem;font-weight:700;color:var(--p-surface-900);letter-spacing:-.02em;line-height:1.2}.stats-bar__value--success[_ngcontent-%COMP%]{color:#059669}.stats-bar__value--warning[_ngcontent-%COMP%]{color:#d97706}.stats-bar__label[_ngcontent-%COMP%]{font-size:.78rem;color:var(--p-surface-400);margin-top:2px}.tableau-card[_ngcontent-%COMP%]{border-radius:14px!important;box-shadow:0 1px 3px #0000000a!important;overflow:hidden}.table-caption__title[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:600;color:var(--p-surface-700)}.col-header[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.35rem;font-size:.8rem;font-weight:600;text-transform:uppercase;letter-spacing:.03em;color:var(--p-surface-500)}.cell-secondary[_ngcontent-%COMP%]{color:var(--p-surface-500);font-size:.9rem}.cell-mono[_ngcontent-%COMP%]{font-variant-numeric:tabular-nums;font-size:.9rem}.cell-success[_ngcontent-%COMP%]{color:#059669}.cell-bold[_ngcontent-%COMP%]{font-weight:600;color:var(--p-surface-800)}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .75rem;border-radius:20px;font-size:.78rem;font-weight:600}.status-badge--danger[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626}.status-badge--warn[_ngcontent-%COMP%]{background:#fffbeb;color:#d97706}.status-badge--success[_ngcontent-%COMP%]{background:#ecfdf5;color:#059669}.status-badge--secondary[_ngcontent-%COMP%]{background:var(--p-surface-100);color:var(--p-surface-500)}.preview-summary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem 1.25rem;background:var(--p-surface-50);border-radius:10px;font-size:.9rem;color:var(--p-surface-600);flex-wrap:wrap}.preview-summary__sep[_ngcontent-%COMP%]{width:4px;height:4px;border-radius:50%;background:var(--p-surface-300)}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.75rem;padding:3rem 0;color:var(--p-surface-300)}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2.5rem}.empty-state[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.9rem}[_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th{padding:1rem 1.25rem}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:1.1rem 1.25rem}@media (max-width: 768px){.stats-bar[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem;padding:1rem}.stats-bar__item[_ngcontent-%COMP%]{padding:.75rem 1rem;width:100%}.stats-bar__divider[_ngcontent-%COMP%]{width:100%;height:1px}}.dark[_nghost-%COMP%]   .detail-header[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .detail-header[_ngcontent-%COMP%]{background:var(--p-surface-800)}.dark[_nghost-%COMP%]   .detail-header__name[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .detail-header__name[_ngcontent-%COMP%]{color:var(--p-surface-0)}.dark[_nghost-%COMP%]   .stats-bar[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar[_ngcontent-%COMP%]{background:var(--p-surface-800);box-shadow:0 1px 3px #00000026}.dark[_nghost-%COMP%]   .stats-bar__divider[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar__divider[_ngcontent-%COMP%]{background:var(--p-surface-600)}.dark[_nghost-%COMP%]   .stats-bar__icon--primary[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar__icon--primary[_ngcontent-%COMP%]{background:#3b82f61f}.dark[_nghost-%COMP%]   .stats-bar__icon--success[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar__icon--success[_ngcontent-%COMP%]{background:#10b9811f}.dark[_nghost-%COMP%]   .stats-bar__icon--warning[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar__icon--warning[_ngcontent-%COMP%]{background:#f59e0b1f}.dark[_nghost-%COMP%]   .stats-bar__value[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .stats-bar__value[_ngcontent-%COMP%]{color:var(--p-surface-0)}.dark[_nghost-%COMP%]   .cell-prestataire__name[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .cell-prestataire__name[_ngcontent-%COMP%], .dark[_nghost-%COMP%]   .cell-bold[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .cell-bold[_ngcontent-%COMP%]{color:var(--p-surface-100)}.dark[_nghost-%COMP%]   .table-caption__title[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .table-caption__title[_ngcontent-%COMP%]{color:var(--p-surface-200)}.dark[_nghost-%COMP%]   .status-badge--danger[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .status-badge--danger[_ngcontent-%COMP%]{background:#dc26261f}.dark[_nghost-%COMP%]   .status-badge--warn[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .status-badge--warn[_ngcontent-%COMP%]{background:#d977061f}.dark[_nghost-%COMP%]   .status-badge--success[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .status-badge--success[_ngcontent-%COMP%]{background:#0596691f}.dark[_nghost-%COMP%]   .status-badge--secondary[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .status-badge--secondary[_ngcontent-%COMP%]{background:var(--p-surface-700)}.dark[_nghost-%COMP%]   .preview-summary[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .preview-summary[_ngcontent-%COMP%]{background:var(--p-surface-700)}"]})};var ga=[{path:"",component:Z,canActivate:[_e],data:{permissions:["facture-packings.read"]}},{path:"comptabilite-packing-liste",component:Z,canActivate:[_e],data:{permissions:["facture-packings.read"]}},{path:"comptabilite-packing-detail/:id",component:Le,canActivate:[_e],data:{permissions:["facture-packings.read"]}},{path:"**",redirectTo:"/notfound"}];export{ga as default};
