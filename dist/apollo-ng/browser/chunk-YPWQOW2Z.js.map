{
  "version": 3,
  "sources": ["src/app/services/usine/usine-context.service.ts", "src/environments/environment.ts", "src/app/services/auth/auth.service.ts"],
  "sourcesContent": ["import { Injectable, computed, signal } from '@angular/core';\nimport { AccessibleUsine, MeResponse } from '@/models/usine.model';\n\nconst STORAGE_KEY = 'usine_context';\n\ninterface PersistedUsineContext {\n  currentUsineId:   number | null;\n  defaultUsineId:   number | null;\n  isSiegeUser:      boolean;\n  accessibleUsines: AccessibleUsine[];\n  isConsolidated:   boolean;\n}\n\n/**\n * Store signals pour le contexte multi-usine.\n * Persiste dans sessionStorage (même durée de vie que le token auth).\n */\n@Injectable({ providedIn: 'root' })\nexport class UsineContextService {\n  // ── État interne ──────────────────────────────────────\n  private readonly _currentUsineId   = signal<number | null>(null);\n  private readonly _defaultUsineId   = signal<number | null>(null);\n  private readonly _isSiegeUser      = signal<boolean>(false);\n  private readonly _accessibleUsines = signal<AccessibleUsine[]>([]);\n  private readonly _isConsolidated   = signal<boolean>(false);\n\n  // ── Signaux publics (lecture seule) ──────────────────\n  readonly currentUsineId   = this._currentUsineId.asReadonly();\n  readonly defaultUsineId   = this._defaultUsineId.asReadonly();\n  readonly isSiegeUser      = this._isSiegeUser.asReadonly();\n  readonly accessibleUsines = this._accessibleUsines.asReadonly();\n  readonly isConsolidated   = this._isConsolidated.asReadonly();\n\n  /** Objet AccessibleUsine correspondant à l'usine courante */\n  readonly currentUsine = computed<AccessibleUsine | null>(() => {\n    const id = this._currentUsineId();\n    if (id === null) return null;\n    return this._accessibleUsines().find(u => u.id === id) ?? null;\n  });\n\n  /**\n   * Valeur à envoyer dans le header X-Usine-Id.\n   * null = ne pas envoyer le header (vue consolidée siège).\n   */\n  readonly headerUsineId = computed<number | null>(() => {\n    if (this._isConsolidated()) return null;\n    return this._currentUsineId();\n  });\n\n  constructor() {\n    this.restoreFromStorage();\n  }\n\n  // ── Actions publiques ─────────────────────────────────\n\n  /**\n   * Hydrate le store depuis la réponse /auth/me.\n   * Appelé après chaque login ET après rafraîchissement du profil.\n   */\n  hydrateFromMe(me: MeResponse): void {\n    this._isSiegeUser.set(me.is_siege_user);\n    this._accessibleUsines.set(me.accessible_usines ?? []);\n    this._defaultUsineId.set(me.default_usine_id);\n\n    const currentId = me.current_usine_id ?? me.default_usine_id;\n    this._currentUsineId.set(currentId);\n\n    // Siège sans usine courante → vue consolidée par défaut\n    const goConsolidated = me.is_siege_user && currentId === null;\n    this._isConsolidated.set(goConsolidated);\n\n    this.persist();\n  }\n\n  /**\n   * Changer d'usine active.\n   */\n  switchUsine(usineId: number): void {\n    this._currentUsineId.set(usineId);\n    this._isConsolidated.set(false);\n    this.persist();\n  }\n\n  /**\n   * Activer la vue consolidée (siège uniquement).\n   * Ignoré silencieusement pour les non-siège (sécurité).\n   */\n  enableConsolidatedView(): void {\n    if (!this._isSiegeUser()) return;\n    this._currentUsineId.set(null);\n    this._isConsolidated.set(true);\n    this.persist();\n  }\n\n  /**\n   * Revenir à l'usine par défaut (fallback après erreur 403/404).\n   */\n  fallbackToDefault(): void {\n    const defaultId = this._defaultUsineId();\n\n    if (defaultId !== null) {\n      this.switchUsine(defaultId);\n      return;\n    }\n\n    if (this._isSiegeUser()) {\n      this.enableConsolidatedView();\n      return;\n    }\n\n    // Cas extrême : pas de défaut, prendre la première accessible\n    const first = this._accessibleUsines()[0];\n    if (first) {\n      this.switchUsine(first.id);\n    }\n  }\n\n  /**\n   * Réinitialiser complètement (déconnexion).\n   */\n  clear(): void {\n    this._currentUsineId.set(null);\n    this._defaultUsineId.set(null);\n    this._isSiegeUser.set(false);\n    this._accessibleUsines.set([]);\n    this._isConsolidated.set(false);\n    sessionStorage.removeItem(STORAGE_KEY);\n  }\n\n  // ── Persistance ───────────────────────────────────────\n\n  private persist(): void {\n    const ctx: PersistedUsineContext = {\n      currentUsineId:   this._currentUsineId(),\n      defaultUsineId:   this._defaultUsineId(),\n      isSiegeUser:      this._isSiegeUser(),\n      accessibleUsines: this._accessibleUsines(),\n      isConsolidated:   this._isConsolidated(),\n    };\n    sessionStorage.setItem(STORAGE_KEY, JSON.stringify(ctx));\n  }\n\n  private restoreFromStorage(): void {\n    try {\n      const raw = sessionStorage.getItem(STORAGE_KEY);\n      if (!raw) return;\n      const ctx: PersistedUsineContext = JSON.parse(raw);\n      this._currentUsineId.set(ctx.currentUsineId ?? null);\n      this._defaultUsineId.set(ctx.defaultUsineId ?? null);\n      this._isSiegeUser.set(ctx.isSiegeUser ?? false);\n      this._accessibleUsines.set(ctx.accessibleUsines ?? []);\n      this._isConsolidated.set(ctx.isConsolidated ?? false);\n    } catch {\n      // Ignore les erreurs de parsing silencieusement\n    }\n  }\n}\n", "export const environment = {\n  production: false,\n  apiUrl: 'http://127.0.0.1:8000/api/v1',\n  // Chemin de base pour les images produits\n  productImagesPath: 'assets/demo/images/produits/'\n};\n", "import { Injectable, inject, signal } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Router } from '@angular/router';\r\nimport { Observable, BehaviorSubject, tap, catchError, throwError } from 'rxjs';\r\n\r\nimport { environment } from 'src/environments/environment';\r\nimport { User } from '@/models/user.model';\r\nimport { ApiResponse, AuthResponse, ChangePasswordRequest, LoginRequest, RegisterRequest, UpdateProfileRequest } from '@/models/auth.model';\r\nimport { MeResponse } from '@/models/usine.model';\r\nimport { UsineContextService } from '@/services/usine/usine-context.service';\r\n \r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AuthService {\r\n  private http         = inject(HttpClient);\r\n  private router       = inject(Router);\r\n  private usineContext = inject(UsineContextService);\r\n\r\n  private readonly API_URL = `${environment.apiUrl}/auth`;\r\n  private readonly TOKEN_KEY = 'access_token';\r\n  private readonly USER_KEY = 'user';\r\n\r\n  // Signals pour gérer l'état\r\n  currentUser = signal<User | null>(this.getUserFromStorage());\r\n  isAuthenticated = signal<boolean>(this.hasToken());\r\n\r\n  // BehaviorSubject pour compatibilité avec les observables\r\n  private currentUserSubject = new BehaviorSubject<User | null>(this.getUserFromStorage());\r\n  public currentUser$ = this.currentUserSubject.asObservable();\r\n\r\n  constructor() {\r\n    // Initialiser l'état au démarrage\r\n    this.initializeAuth();\r\n  } \r\n\r\n  /**\r\n   * Initialiser l'authentification au démarrage\r\n   */\r\n  private initializeAuth(): void {\r\n    const token = this.getToken();\r\n    const user = this.getUserFromStorage();\r\n\r\n    if (token && user) {\r\n      this.currentUser.set(user);\r\n      this.isAuthenticated.set(true);\r\n      this.currentUserSubject.next(user);\r\n      this.refreshCurrentUserProfile();\r\n    } else {\r\n      this.clearAuth();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Inscription\r\n   */\r\n  register(data: RegisterRequest): Observable<AuthResponse> {\r\n    return this.http.post<AuthResponse>(`${this.API_URL}/register`, data).pipe(\r\n      tap(response => {\r\n        if (response.success && response.data) {\r\n          this.handleAuthSuccess(response.data);\r\n        }\r\n      }),\r\n      catchError(error => this.handleError(error))\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Connexion\r\n   */\r\n  login(credentials: LoginRequest): Observable<AuthResponse> {\r\n    return this.http.post<AuthResponse>(`${this.API_URL}/login`, credentials).pipe(\r\n      tap(response => {\r\n        if (response.success && response.data) {\r\n          this.handleAuthSuccess(response.data);\r\n        }\r\n      }),\r\n      catchError(error => this.handleError(error))\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Déconnexion\r\n   */ \r\n  logout(): Observable<ApiResponse> {\r\n    return this.http.post<ApiResponse>(`${this.API_URL}/logout`, {}).pipe(\r\n      tap(() => {\r\n        this.clearAuth();\r\n        this.router.navigate(['/auth/login']);\r\n      }),\r\n      catchError(error => {\r\n        // Même en cas d'erreur, on déconnecte l'utilisateur localement\r\n        this.clearAuth();\r\n        this.router.navigate(['/auth/login']);\r\n        return this.handleError(error);\r\n      })\r\n    ); \r\n  }\r\n\r\n  /**\r\n   * Déconnexion de tous les appareils\r\n   */\r\n  logoutAll(): Observable<ApiResponse> {\r\n    return this.http.post<ApiResponse>(`${this.API_URL}/logout-all`, {}).pipe(\r\n      tap(() => {\r\n        this.clearAuth();\r\n        this.router.navigate(['/auth/login']);\r\n      }),\r\n      catchError(error => this.handleError(error))\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Obtenir le profil de l'utilisateur connecté.\r\n   * La réponse /auth/me retourne un MeResponse enrichi (usines, rôles, permissions).\r\n   * On hydrate le store usine après chaque appel réussi.\r\n   */\r\n  me(): Observable<ApiResponse<MeResponse>> {\r\n    return this.http.get<ApiResponse<MeResponse>>(`${this.API_URL}/me`).pipe(\r\n      tap(response => {\r\n        if (response.success && response.data) {\r\n          // Extraire et persister le User (conserve la logique existante)\r\n          const user = this.extractUserFromPayload(response.data);\r\n          if (user) {\r\n            this.setUser(user);\r\n          }\r\n          // Hydrater le contexte usine avec les données multi-usine\r\n          this.usineContext.hydrateFromMe(response.data);\r\n        }\r\n      }),\r\n      catchError(error => this.handleError(error))\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Mettre à jour le profil\r\n   */\r\n  updateProfile(data: UpdateProfileRequest): Observable<ApiResponse<User>> {\r\n    return this.http.put<ApiResponse<User>>(`${this.API_URL}/profile`, data).pipe(\r\n      tap(response => {\r\n        if (response.success && response.data) {\r\n          this.setUser(response.data);\r\n        }\r\n      }),\r\n      catchError(error => this.handleError(error))\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Changer le mot de passe\r\n   */\r\n  changePassword(data: ChangePasswordRequest): Observable<ApiResponse> {\r\n    return this.http.post<ApiResponse>(`${this.API_URL}/change-password`, data).pipe(\r\n      catchError(error => this.handleError(error))\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Rafraîchir le token\r\n   */\r\n  refreshToken(): Observable<ApiResponse<{ access_token: string; token_type: string; expires_in: number }>> {\r\n    return this.http.post<ApiResponse<{ access_token: string; token_type: string; expires_in: number }>>(\r\n      `${this.API_URL}/refresh-token`,\r\n      {}\r\n    ).pipe(\r\n      tap(response => {\r\n        if (response.success && response.data) {\r\n          this.setToken(response.data.access_token);\r\n        }\r\n      }),\r\n      catchError(error => this.handleError(error))\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Vérifier la validité du token\r\n   */\r\n  checkToken(): Observable<ApiResponse<{ valid: boolean; user: User }>> {\r\n    return this.http.get<ApiResponse<{ valid: boolean; user: User }>>(`${this.API_URL}/check-token`).pipe(\r\n      tap(response => {\r\n        if (response.success && response.data?.user) {\r\n          this.setUser(response.data.user);\r\n        }\r\n      }),\r\n      catchError(error => this.handleError(error))\r\n    );\r\n  }\r\n\r\n  /** \r\n   * Gérer le succès de l'authentification\r\n   */\r\n  private handleAuthSuccess(data: { user: User; access_token: string }): void {\r\n    this.setToken(data.access_token);\r\n    const user = this.extractUserFromPayload(data) ?? data.user;\r\n    this.setUser(user);\r\n    this.refreshCurrentUserProfile();\r\n  }\r\n\r\n  /**\r\n   * Sauvegarder le token\r\n   */\r\n  setToken(token: string): void {\r\n    sessionStorage.setItem(this.TOKEN_KEY, token);\r\n  }\r\n\r\n  /**\r\n   * Récupérer le token\r\n   */\r\n  getToken(): string | null {\r\n    return sessionStorage.getItem(this.TOKEN_KEY);\r\n  }\r\n\r\n  /**\r\n   * Vérifier si un token existe\r\n   */\r\n  hasToken(): boolean {\r\n    return !!this.getToken();\r\n  }\r\n\r\n  /**\r\n   * Sauvegarder l'utilisateur\r\n   */\r\n  private setUser(user: User): void {\r\n    sessionStorage.setItem(this.USER_KEY, JSON.stringify(user));\r\n    this.currentUser.set(user);\r\n    this.isAuthenticated.set(true);\r\n    this.currentUserSubject.next(user);\r\n  }\r\n\r\n  /**\r\n   * Récupérer l'utilisateur depuis le storage\r\n   */\r\n  private getUserFromStorage(): User | null {\r\n    const userJson = sessionStorage.getItem(this.USER_KEY);\r\n    if (!userJson) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const parsed = JSON.parse(userJson);\r\n      return this.extractUserFromPayload(parsed);\r\n    } catch {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  private refreshCurrentUserProfile(): void {\r\n    this.me().subscribe({\r\n      next: () => {},\r\n      error: () => {},\r\n    });\r\n  }\r\n\r\n  private extractUserFromPayload(payload: any): User | null {\r\n    const source = payload?.user ?? payload;\r\n    if (!source || typeof source !== 'object') {\r\n      return null;\r\n    }\r\n\r\n    const user = { ...source } as User;\r\n\r\n    const permissions = this.mergeUniqueStrings(\r\n      this.normalizePermissions(source?.permissions),\r\n      this.normalizePermissions(payload?.permissions)\r\n    );\r\n    if (permissions.length > 0) {\r\n      user.permissions = permissions;\r\n    }\r\n\r\n    const roles = this.mergeUniqueStrings(\r\n      this.normalizeStringList(source?.roles),\r\n      this.normalizeStringList(payload?.roles)\r\n    );\r\n    if (roles.length > 0) {\r\n      user.roles = roles;\r\n    }\r\n\r\n    return user;\r\n  }\r\n\r\n  private normalizeStringList(value: any): string[] {\r\n    if (!Array.isArray(value)) {\r\n      return [];\r\n    }\r\n\r\n    return value\r\n      .map((item) => {\r\n        if (typeof item === 'string') {\r\n          return item.trim();\r\n        }\r\n\r\n        if (item && typeof item === 'object' && typeof item.name === 'string') {\r\n          return item.name.trim();\r\n        }\r\n\r\n        return '';\r\n      })\r\n      .filter((item) => item.length > 0);\r\n  }\r\n\r\n  private normalizePermissions(value: any): string[] {\r\n    if (!value) {\r\n      return [];\r\n    }\r\n\r\n    if (Array.isArray(value)) {\r\n      return value\r\n        .map((item) => {\r\n          if (typeof item === 'string') {\r\n            return item.trim();\r\n          }\r\n\r\n          if (item && typeof item === 'object' && typeof item.name === 'string') {\r\n            return item.name.trim();\r\n          }\r\n\r\n          return '';\r\n        })\r\n        .filter((item) => item.length > 0);\r\n    }\r\n\r\n    if (typeof value === 'object') {\r\n      return Object.entries(value).flatMap(([module, actions]) => {\r\n        if (Array.isArray(actions)) {\r\n          return actions\r\n            .filter((action) => typeof action === 'string' && action.trim().length > 0)\r\n            .map((action) => `${module}.${action.trim()}`);\r\n        }\r\n\r\n        if (actions && typeof actions === 'object') {\r\n          return Object.entries(actions)\r\n            .filter(([, enabled]) => !!enabled)\r\n            .map(([action]) => `${module}.${action}`);\r\n        }\r\n\r\n        if (typeof actions === 'string' && actions.trim().length > 0) {\r\n          return [`${module}.${actions.trim()}`];\r\n        }\r\n\r\n        return [];\r\n      });\r\n    }\r\n\r\n    return [];\r\n  }\r\n\r\n  private mergeUniqueStrings(...arrays: string[][]): string[] {\r\n    const set = new Set<string>();\r\n    arrays.flat().forEach((item) => {\r\n      const value = item.trim();\r\n      if (value.length > 0) {\r\n        set.add(value);\r\n      }\r\n    });\r\n    return Array.from(set);\r\n  }\r\n\r\n  /**\r\n   * Nettoyer toutes les données d'authentification (y compris contexte usine)\r\n   */\r\n  private clearAuth(): void {\r\n    sessionStorage.removeItem(this.TOKEN_KEY);\r\n    sessionStorage.removeItem(this.USER_KEY);\r\n    this.currentUser.set(null);\r\n    this.isAuthenticated.set(false);\r\n    this.currentUserSubject.next(null);\r\n    this.usineContext.clear();\r\n  }\r\n\r\n  /**\r\n   * Gérer les erreurs HTTP\r\n   */\r\n  private handleError(error: any): Observable<never> {\r\n    console.error('Erreur API:', error);\r\n    \r\n    // Si erreur 401, déconnecter l'utilisateur\r\n    if (error.status === 401) {\r\n      this.clearAuth();\r\n      this.router.navigate(['/auth/login']);\r\n    }\r\n    \r\n    return throwError(() => error);\r\n  }\r\n\r\n  /**\r\n * Vérifier si l'utilisateur est connecté\r\n */\r\n  isLoggedIn(): boolean {\r\n    return this.hasToken() && this.currentUser() !== null;\r\n  }\r\n\r\n  /**\r\n   * Vérifier si l'utilisateur possède une permission\r\n   */\r\n  hasPermission(permission: string): boolean {\r\n    const user = this.currentUser();\r\n    if (!user) return false;\r\n    const permissions = user.permissions ?? [];\r\n    if (permissions.length === 0) return true; // Fallback permissif\r\n    return permissions.includes(permission);\r\n  }\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
