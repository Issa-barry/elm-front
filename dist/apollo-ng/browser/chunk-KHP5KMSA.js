import{a as z,b as Q}from"./chunk-Y5CXWWM7.js";import{a as lt}from"./chunk-IMEHSH2Q.js";import{a as mt}from"./chunk-6MPWZMCU.js";import{b as it}from"./chunk-XLX4KHCH.js";import{b as st}from"./chunk-LK4T7DDW.js";import{a as he,b as xe}from"./chunk-DHO5ZECZ.js";import{a as Ce,b as Pe}from"./chunk-ZWTNMQUT.js";import{a as ye,b as Se}from"./chunk-XMGAWN6O.js";import{a as be,b as ve}from"./chunk-FCSZSTKZ.js";import"./chunk-62XMJ7OZ.js";import{b as ke}from"./chunk-NXMTA3Z5.js";import{b as Ye,d as K}from"./chunk-22WVEZDH.js";import"./chunk-6UNS6ATT.js";import"./chunk-VBF7BBWX.js";import{a as ce,d as ue,e as de,h as rt,i as ot,k as _e}from"./chunk-KL27V2YF.js";import"./chunk-DKGKIQYD.js";import"./chunk-6R56UM77.js";import{a as at,b as le}from"./chunk-C76D6YHB.js";import"./chunk-L2T5JW7K.js";import"./chunk-C35SDHAO.js";import"./chunk-IENEWIOW.js";import{b as se,c as q}from"./chunk-V7HYCLOH.js";import"./chunk-GCJYWVBV.js";import"./chunk-PZUT5QF4.js";import{c as me,d as pe}from"./chunk-QK2KLPR7.js";import"./chunk-IQ3I63NM.js";import"./chunk-KAT22IHP.js";import"./chunk-2MYVVGAW.js";import"./chunk-VRCAH26M.js";import"./chunk-4O43JDMY.js";import"./chunk-LNM7OC6P.js";import{a as fe,b as ge}from"./chunk-BFGT4G5C.js";import"./chunk-D3EQSYXL.js";import{b as nt}from"./chunk-FR7DTH2N.js";import"./chunk-E6N6EGUJ.js";import"./chunk-2PEJZBD7.js";import{a as et,b as ne,c as tt,d as ae}from"./chunk-BDIOYTKC.js";import{a as Xe,b as X}from"./chunk-H5W5OS5D.js";import{e as Z,h as Y,o as N}from"./chunk-CRGNDKCR.js";import{a as re,b as oe}from"./chunk-BGXPLMJT.js";import{a as U,c as Ze}from"./chunk-CSKRJUWU.js";import"./chunk-UWIKY6DF.js";import{a as ee,b as Je,c as te,d as ie,e as A}from"./chunk-CYEUP4PV.js";import"./chunk-BODZH67C.js";import"./chunk-7UZYWCAJ.js";import"./chunk-UAZ37PIZ.js";import{j as J}from"./chunk-ZN2HQ4SK.js";import"./chunk-SEL7WNEU.js";import{la as L,pa as I}from"./chunk-6ETCFPPD.js";import{k as G,u as T}from"./chunk-6PDKYY6Q.js";import"./chunk-4O3FVBGX.js";import{$ as _,Ab as C,Bb as D,Bc as H,Cb as $e,Gb as v,Kb as x,Lb as c,Ma as l,Pb as je,Qb as He,R as Ne,Ra as We,Rb as Ge,Ub as j,V as Ae,Vb as Ue,Wb as Ke,Xa as y,Xb as V,Zb as o,_b as p,aa as f,ab as w,ba as qe,ca as Oe,cc as P,db as Be,dc as k,ec as E,gb as b,gc as R,hc as S,ia as M,rc as ze,tc as Qe,wb as m,wc as g,xb as a,yb as n,zb as u}from"./chunk-KCZYDF4B.js";import"./chunk-GAL4ENT6.js";var B={especes:"Esp\xE8ces",virement:"Virement bancaire",cheque:"Ch\xE8que",mobile_money:"Mobile Money"},_t={impayee:"Impay\xE9e",partielle:"Partiellement pay\xE9e",payee:"Pay\xE9e",annulee:"Annul\xE9e"},pt={impayee:"danger",partielle:"warn",payee:"success",annulee:"secondary"};var Ee=class{id;reference;prestataire_id;date;montant_total;nb_packings;date_paiement;mode_paiement;statut;notes;created_by;validated_by;created_at;updated_at;deleted_at;statut_label;prestataire_nom;montant_verse;montant_restant;mode_paiement_label;total_rouleaux;prix_par_rouleau;prestataire;packings;versements;creator;constructor(e={}){this.id=e.id??0,this.reference=e.reference??"",this.prestataire_id=e.prestataire_id??0,this.date=e.date??"",this.montant_total=e.montant_total??0,this.nb_packings=e.nb_packings??0,this.date_paiement=e.date_paiement??null,this.mode_paiement=e.mode_paiement??null,this.statut=e.statut??"impayee",this.notes=e.notes??null,this.created_by=e.created_by??null,this.validated_by=e.validated_by??null,this.created_at=e.created_at??"",this.updated_at=e.updated_at??"",this.deleted_at=e.deleted_at??null,this.statut_label=e.statut_label??_t[this.statut]??"",this.prestataire_nom=e.prestataire_nom??null,this.montant_verse=e.montant_verse??0,this.montant_restant=e.montant_restant??0,this.mode_paiement_label=e.mode_paiement_label??"",this.total_rouleaux=e.total_rouleaux??0,this.prix_par_rouleau=e.prix_par_rouleau??0,this.prestataire=e.prestataire,this.packings=e.packings,this.versements=e.versements,this.creator=e.creator}},Re=class{prestataire_id;prestataire_nom;prestataire_phone;prestataire_type;nb_packings_non_factures;montant_non_facture;nb_factures_en_cours;montant_facture;montant_verse;montant_restant_facture;montant_total_du;statut;constructor(e={}){this.prestataire_id=e.prestataire_id??0,this.prestataire_nom=e.prestataire_nom??"",this.prestataire_phone=e.prestataire_phone??"",this.prestataire_type=e.prestataire_type??"",this.nb_packings_non_factures=e.nb_packings_non_factures??0,this.montant_non_facture=e.montant_non_facture??0,this.nb_factures_en_cours=e.nb_factures_en_cours??0,this.montant_facture=e.montant_facture??0,this.montant_verse=e.montant_verse??0,this.montant_restant_facture=e.montant_restant_facture??0,this.montant_total_du=e.montant_total_du??0,this.statut=this.montant_total_du===0?"solde":this.montant_verse>0?"partiel":"impaye"}},O=class{date_debut;date_fin;nb_prestataires;total_non_facture;total_facture;total_verse;total_restant_facture;montant_global_du;montant_total;prestataires;constructor(e={}){this.date_debut=e.date_debut??null,this.date_fin=e.date_fin??null,this.nb_prestataires=e.nb_prestataires??0,this.total_non_facture=e.total_non_facture??0,this.total_facture=e.total_facture??0,this.total_verse=e.total_verse??0,this.total_restant_facture=e.total_restant_facture??0,this.montant_global_du=e.montant_global_du??0,this.montant_total=this.total_facture+this.total_non_facture,this.prestataires=(e.prestataires??[]).map(t=>new Re(t))}},we=class{prestataire_id;date_debut;date_fin;nb_packings;montant_total;total_rouleaux;packings;constructor(e={}){this.prestataire_id=e.prestataire_id??0,this.date_debut=e.date_debut??"",this.date_fin=e.date_fin??"",this.nb_packings=e.nb_packings??0,this.montant_total=e.montant_total??0,this.total_rouleaux=e.total_rouleaux??0,this.packings=e.packings??[]}};var F=class r{constructor(e){this.http=e}apiUrl=`${mt.apiUrl}/facture-packings`;getFactures(e){let t=new U;return e&&(e.prestataire_id&&(t=t.set("prestataire_id",e.prestataire_id.toString())),e.date_debut&&(t=t.set("date_debut",e.date_debut)),e.date_fin&&(t=t.set("date_fin",e.date_fin)),e.statut&&(t=t.set("statut",e.statut)),e.soldee!==void 0&&(t=t.set("soldee",e.soldee.toString())),e.search&&(t=t.set("search",e.search)),e.sort_by&&(t=t.set("sort_by",e.sort_by)),e.sort_order&&(t=t.set("sort_order",e.sort_order)),e.per_page&&(t=t.set("per_page",e.per_page.toString()))),this.http.get(this.apiUrl,{params:t})}getFacture(e){return this.http.get(`${this.apiUrl}/${e}`)}getPreview(e,t,i){let s=new U().set("prestataire_id",e.toString()).set("date_debut",t).set("date_fin",i);return this.http.get(`${this.apiUrl}/preview`,{params:s})}getComptabilite(e){let t=new U;return e&&(e.date_debut&&(t=t.set("date_debut",e.date_debut)),e.date_fin&&(t=t.set("date_fin",e.date_fin)),e.prestataire_id&&(t=t.set("prestataire_id",e.prestataire_id.toString()))),this.http.get(`${this.apiUrl}/comptabilite`,{params:t})}createFacture(e){return this.http.post(this.apiUrl,e)}deleteFacture(e){return this.http.delete(`${this.apiUrl}/${e}`)}getVersements(e){return this.http.get(`${this.apiUrl}/${e}/versements`)}createVersement(e,t){return this.http.post(`${this.apiUrl}/${e}/versements`,t)}deleteVersement(e,t){return this.http.delete(`${this.apiUrl}/${e}/versements/${t}`)}static \u0275fac=function(t){return new(t||r)(Ae(Ze))};static \u0275prov=Ne({token:r,factory:r.\u0275fac,providedIn:"root"})};var De=class r{constructor(e){this.paiementService=e}summary=null;ngOnInit(){this.loadStats()}loadStats(){this.paiementService.getComptabilite().subscribe({next:e=>{this.summary=new O(e.data)}})}formatCurrency(e){return new Intl.NumberFormat("fr-FR",{style:"decimal",minimumFractionDigits:0}).format(e)+" GNF"}static \u0275fac=function(t){return new(t||r)(y(F))};static \u0275cmp=w({type:r,selectors:[["app-stats-comptabilite-packing-widget"]],hostVars:2,hostBindings:function(t,i){t&2&&Ue("display","contents")},decls:29,vars:4,consts:[[1,"col-span-12","md:col-span-6","xl:col-span-3"],[1,"card","relative","overflow-hidden","h-40"],["id","visual","viewBox","0 0 900 600","xmlns","http://www.w3.org/2000/svg","xmlnsXlink","http://www.w3.org/1999/xlink","version","1.1","preserveAspectRatio","none",1,"absolute","left-0","top-0","h-full","w-full"],["x","0","y","0","width","900","height","600","fill","var(--p-primary-600)"],["d","M0 400L30 386.5C60 373 120 346 180 334.8C240 323.7 300 328.3 360 345.2C420 362 480 391 540 392C600 393 660 366 720 355.2C780 344.3 840 349.7 870 352.3L900 355L900 601L870 601C840 601 780 601 720 601C660 601 600 601 540 601C480 601 420 601 360 601C300 601 240 601 180 601C120 601 60 601 30 601L0 601Z","fill","var(--p-primary-500)","strokeLinecap","round","strokeLinejoin","miter"],[1,"z-20","relative","text-white"],[1,"text-xl","font-semibold","mb-4"],[1,"text-2xl","mb-8","font-bold"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-surface-900","dark:text-surface-0","text-xl","font-semibold"],[1,"text-2xl","text-green-600","mb-8","font-bold"],[1,"card","relative","overflow-hidden","h-40","flex","flex-col","items-center","justify-center"],[1,"text-surface-900","dark:text-surface-0","text-lg","mb-6","font-medium"],[1,"text-2xl","text-orange-500","font-bold"],[1,"text-2xl","text-primary","font-bold"]],template:function(t,i){t&1&&(C(0,"div",0)(1,"div",1),qe(),C(2,"svg",2),$e(3,"rect",3)(4,"path",4),D(),Oe(),C(5,"div",5)(6,"div",6),o(7,"Montant Total"),D(),C(8,"div",7),o(9),D()()()(),C(10,"div",0)(11,"div",1)(12,"div",8)(13,"div",9),o(14,"Total pay\xE9"),D()(),C(15,"div",10),o(16),D()()(),C(17,"div",0)(18,"div",11)(19,"span",12),o(20,"Reste \xE0 payer"),D(),C(21,"span",13),o(22),D()()(),C(23,"div",0)(24,"div",11)(25,"span",12),o(26,"Prestataires"),D(),C(27,"span",14),o(28),D()()()),t&2&&(l(9),p(i.summary?i.formatCurrency(i.summary.montant_total):"..."),l(7),p(i.summary?i.formatCurrency(i.summary.total_verse):"..."),l(6),p(i.summary?i.formatCurrency(i.summary.montant_global_du):"..."),l(6),p(i.summary?i.summary.nb_prestataires:"..."))},dependencies:[T],encapsulation:2})};var wt=["dt"],Dt=()=>({"min-width":"90rem"}),Tt=()=>[10,20,30],It=()=>({width:"850px"}),Ft=()=>({width:"450px"});function Mt(r,e){if(r&1){let t=v();a(0,"div",12)(1,"div")(2,"label",13),o(3,"P\xE9riode d\xE9but"),n(),a(4,"p-datepicker",14),E("ngModelChange",function(s){_(t);let d=c();return k(d.filtrePeriodeDebut,s)||(d.filtrePeriodeDebut=s),f(s)}),n()(),a(5,"div")(6,"label",13),o(7,"P\xE9riode fin"),n(),a(8,"p-datepicker",15),E("ngModelChange",function(s){_(t);let d=c();return k(d.filtrePeriodeFin,s)||(d.filtrePeriodeFin=s),f(s)}),n()(),a(9,"div")(10,"label",13),o(11,"Statut"),n(),a(12,"p-select",16),E("ngModelChange",function(s){_(t);let d=c();return k(d.filtreStatut,s)||(d.filtreStatut=s),f(s)}),x("onChange",function(){_(t);let s=c();return f(s.applyStatutFilter())}),n()(),a(13,"div",17)(14,"p-button",18),x("onClick",function(){_(t);let s=c();return f(s.loadComptabilite())}),n()()()}if(r&2){let t=c();l(4),P("ngModel",t.filtrePeriodeDebut),m("showIcon",!0),l(4),P("ngModel",t.filtrePeriodeFin),m("showIcon",!0),l(4),P("ngModel",t.filtreStatut),m("options",t.statutOptions)}}function Vt(r,e){if(r&1){let t=v();a(0,"p-button",19),x("onClick",function(){_(t);let s=c();return f(s.exportCSV())}),n()}}function Rt(r,e){if(r&1){let t=v();a(0,"div",20)(1,"h5",21),o(2,"Comptabilit\xE9 Packings - R\xE9capitulatif par prestataire"),n(),a(3,"p-iconfield"),u(4,"p-inputicon",22),a(5,"input",23),x("input",function(s){_(t);let d=c(),h=j(8);return f(d.onGlobalFilter(h,s))}),n()()()}}function Lt(r,e){r&1&&(a(0,"tr")(1,"th",24),u(2,"p-tableHeaderCheckbox"),n(),a(3,"th",25)(4,"span",26),o(5,"Prestataire "),u(6,"p-sortIcon",27),n()(),a(7,"th",28),o(8,"T\xE9l\xE9phone"),n(),a(9,"th",29)(10,"span",26),o(11,"Total "),u(12,"p-sortIcon",30),n()(),a(13,"th",31)(14,"span",26),o(15,"Pay\xE9 "),u(16,"p-sortIcon",32),n()(),a(17,"th",33)(18,"span",26),o(19,"Total d\xFB "),u(20,"p-sortIcon",34),n()(),a(21,"th",35)(22,"span",26),o(23,"Statut "),u(24,"p-sortIcon",36),n()(),u(25,"th",28),n())}function Nt(r,e){r&1&&u(0,"p-tag",44)}function At(r,e){r&1&&u(0,"p-tag",45)}function qt(r,e){r&1&&u(0,"p-tag",46)}function Ot(r,e){if(r&1){let t=v();a(0,"p-button",47),x("click",function(){_(t);let s=c().$implicit,d=c();return f(d.openPreview(s))}),n()}r&2&&m("rounded",!0)("outlined",!0)}function Wt(r,e){if(r&1){let t=v();a(0,"tr")(1,"td",24),u(2,"p-tableCheckbox",37),n(),a(3,"td")(4,"span",38),o(5),n()(),a(6,"td"),o(7),n(),a(8,"td"),o(9),n(),a(10,"td"),o(11),n(),a(12,"td"),o(13),n(),a(14,"td"),b(15,Nt,1,0,"p-tag",39)(16,At,1,0,"p-tag",40)(17,qt,1,0,"p-tag",41),n(),a(18,"td")(19,"p-button",42),x("click",function(){let s=_(t).$implicit,d=c();return f(d.goToDetail(s))}),n(),b(20,Ot,1,2,"p-button",43),n()()}if(r&2){let t=e.$implicit,i=c();l(2),m("value",t),l(3),p(t.prestataire_nom),l(2),p(t.prestataire_phone),l(2),p(i.formatCurrency(t.montant_facture)),l(2),p(i.formatCurrency(t.montant_verse)),l(2),p(i.formatCurrency(t.montant_restant_facture)),l(2),m("ngIf",t.statut==="impaye"),l(),m("ngIf",t.statut==="partiel"),l(),m("ngIf",t.statut==="solde"),l(2),m("rounded",!0)("outlined",!0),l(),m("ngIf",t.nb_packings_non_factures>0)}}function Bt(r,e){r&1&&(a(0,"tr")(1,"th"),o(2,"R\xE9f\xE9rence"),n(),a(3,"th"),o(4,"Date"),n(),a(5,"th"),o(6,"Rouleaux"),n(),a(7,"th"),o(8,"Montant"),n()())}function $t(r,e){if(r&1&&(a(0,"tr")(1,"td"),o(2),n(),a(3,"td"),o(4),n(),a(5,"td"),o(6),n(),a(7,"td",52),o(8),n()()),r&2){let t=e.$implicit,i=c(3);l(2),p(t.reference),l(2),p(i.formatDateDisplay(t.date)),l(2),p(t.nb_rouleaux),l(2),p(i.formatCurrency(t.montant))}}function jt(r,e){if(r&1&&(a(0,"div",50)(1,"div",51)(2,"div")(3,"span",52),o(4),n(),o(5," packing(s) - "),a(6,"span",52),o(7),n(),o(8," rouleaux "),n(),a(9,"div",53),o(10),n()(),a(11,"p-table",54),b(12,Bt,9,0,"ng-template",null,4,g)(14,$t,9,4,"ng-template",null,5,g),n()()),r&2){let t=c(2);l(4),p(t.previewData.nb_packings),l(3),p(t.previewData.total_rouleaux),l(3),p(t.formatCurrency(t.previewData.montant_total)),l(),m("value",t.previewData.packings)("rows",10)("paginator",t.previewData.packings.length>10)("rowHover",!0)}}function Ht(r,e){r&1&&(a(0,"div",55),u(1,"i",56),n())}function Gt(r,e){if(r&1&&b(0,jt,16,7,"div",48)(1,Ht,2,0,"div",49),r&2){let t=c();m("ngIf",t.previewData),l(),m("ngIf",t.previewLoading)}}function Ut(r,e){if(r&1){let t=v();a(0,"p-button",57),x("click",function(){_(t);let s=c();return f(s.previewDialog=!1)}),n()}}var Ie=class r{constructor(e,t,i){this.router=e;this.factureService=t;this.messageService=i}dataChanged=new We;filterFields=["prestataire_nom","prestataire_phone","montant_total_du"];prestataires=M([]);selectedPrestataires=null;comptaSummary=null;loading=!1;filtrePeriodeDebut=null;filtrePeriodeFin=null;filtreStatut=null;statutOptions=[{label:"Tous",value:null},{label:"Impay\xE9",value:"impaye"},{label:"Partiel",value:"partiel"},{label:"Sold\xE9",value:"solde"}];selectedItem=null;previewDialog=!1;previewData=null;previewLoading=!1;facturerLoading=!1;dt;exportColumns;cols;ngOnInit(){this.loadComptabilite(),this.initColumns()}initColumns(){this.cols=[{field:"prestataire_nom",header:"Prestataire"},{field:"prestataire_phone",header:"T\xE9l\xE9phone"},{field:"nb_packings_non_factures",header:"Non factur\xE9s"},{field:"montant_non_facture",header:"Mnt non factur\xE9"},{field:"montant_facture",header:"Factur\xE9"},{field:"montant_verse",header:"Vers\xE9"},{field:"montant_restant_facture",header:"Reste facture"},{field:"montant_total_du",header:"Total d\xFB"}],this.exportColumns=this.cols.map(e=>({title:e.header,dataKey:e.field}))}loadComptabilite(){this.loading=!0;let e={};this.filtrePeriodeDebut&&(e.date_debut=this.formatDate(this.filtrePeriodeDebut)),this.filtrePeriodeFin&&(e.date_fin=this.formatDate(this.filtrePeriodeFin)),this.factureService.getComptabilite(e).subscribe({next:t=>{this.comptaSummary=new O(t.data),this.applyStatutFilter(),this.loading=!1,this.dataChanged.emit()},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger la comptabilit\xE9",life:3e3}),this.loading=!1}})}applyStatutFilter(){this.comptaSummary&&(this.filtreStatut?this.prestataires.set(this.comptaSummary.prestataires.filter(e=>e.statut===this.filtreStatut)):this.prestataires.set(this.comptaSummary.prestataires))}exportCSV(){this.dt.exportCSV()}onGlobalFilter(e,t){e.filterGlobal(t.target.value,"contains")}openPreview(e){let t=this.filtrePeriodeDebut?this.formatDate(this.filtrePeriodeDebut):"2000-01-01",i=this.filtrePeriodeFin?this.formatDate(this.filtrePeriodeFin):"2099-12-31";this.selectedItem=e,this.previewDialog=!0,this.previewLoading=!0,this.previewData=null,this.factureService.getPreview(e.prestataire_id,t,i).subscribe({next:s=>{this.previewData=new we(s.data),this.previewLoading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger la pr\xE9visualisation",life:3e3}),this.previewLoading=!1,this.previewDialog=!1}})}facturerNonFactures(){if(!this.selectedItem||this.facturerLoading)return;this.facturerLoading=!0;let e=this.filtrePeriodeDebut?this.formatDate(this.filtrePeriodeDebut):"2000-01-01",t=this.filtrePeriodeFin?this.formatDate(this.filtrePeriodeFin):"2099-12-31",i={prestataire_id:this.selectedItem.prestataire_id,date_debut:e,date_fin:t};this.factureService.createFacture(i).subscribe({next:s=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`Facture ${s.data.reference} cr\xE9\xE9e`,life:3e3}),this.facturerLoading=!1,this.selectedItem&&(this.selectedItem.nb_packings_non_factures=0,this.selectedItem.montant_non_facture=0),this.loadComptabilite()},error:s=>{let d=s?.error?.message||"Impossible de cr\xE9er la facture";this.messageService.add({severity:"error",summary:"Erreur",detail:d,life:5e3}),this.facturerLoading=!1}})}formatDate(e){return e?typeof e=="string"?e:new Date(e).toISOString().split("T")[0]:""}formatCurrency(e){return new Intl.NumberFormat("fr-FR",{style:"decimal",minimumFractionDigits:0}).format(e)+" GNF"}formatDateDisplay(e){return e?new Date(e).toLocaleDateString("fr-FR"):""}goToDetail(e){this.router.navigate(["/comptabilite/comptabilite-packing-detail",e.prestataire_id],{queryParams:{prestataire_nom:e.prestataire_nom,prestataire_phone:e.prestataire_phone}})}static \u0275fac=function(t){return new(t||r)(y(K),y(F),y(I))};static \u0275cmp=w({type:r,selectors:[["app-comptabilite-packing-tableau"]],viewQuery:function(t,i){if(t&1&&je(wt,5),t&2){let s;He(s=Ge())&&(i.dt=s.first)}},outputs:{dataChanged:"dataChanged"},features:[R([I])],decls:21,vars:21,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["content",""],["footer",""],[1,"card"],["styleClass","mb-12"],["dataKey","prestataire_id","currentPageReportTemplate","  {first} \xE0 {last} sur {totalRecords} prestataires",3,"selectionChange","value","rows","columns","paginator","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions","loading"],["header","Pr\xE9visualisation des packings",3,"visibleChange","visible","modal"],[1,"flex","items-center","gap-4"],[1,"block","text-sm","font-medium","mb-1"],["dateFormat","dd/mm/yy","placeholder","D\xE9but","inputStyleClass","w-full","styleClass","w-48",3,"ngModelChange","ngModel","showIcon"],["dateFormat","dd/mm/yy","placeholder","Fin","inputStyleClass","w-full","styleClass","w-48",3,"ngModelChange","ngModel","showIcon"],["optionLabel","label","optionValue","value","placeholder","Tous","styleClass","w-40",3,"ngModelChange","onChange","ngModel","options"],[1,"flex","items-end","h-full","pt-5"],["label","Filtrer","icon","pi pi-filter","severity","secondary",3,"onClick"],["label","Export","icon","pi pi-download","severity","secondary",3,"onClick"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Rechercher...",3,"input"],[2,"width","3rem"],["pSortableColumn","prestataire_nom",2,"min-width","14rem"],[1,"flex","items-center","gap-2"],["field","prestataire_nom"],[2,"min-width","10rem"],["pSortableColumn","montant_non_facture",2,"min-width","10rem"],["field","montant_non_facture"],["pSortableColumn","montant_facture",2,"min-width","10rem"],["field","montant_facture"],["pSortableColumn","montant_total_du",2,"min-width","12rem"],["field","montant_total_du"],["pSortableColumn","statut",2,"min-width","12rem"],["field","statut"],[3,"value"],[1,"font-semibold"],["value","Impay\xE9","severity","danger",4,"ngIf"],["value","Partiel","severity","warn",4,"ngIf"],["value","Sold\xE9","severity","success",4,"ngIf"],["icon","pi pi-eye","severity","info","pTooltip","D\xE9tail",1,"mr-2",3,"click","rounded","outlined"],["icon","pi pi-file","severity","warn","pTooltip","Facturer",3,"rounded","outlined","click",4,"ngIf"],["value","Impay\xE9","severity","danger"],["value","Partiel","severity","warn"],["value","Sold\xE9","severity","success"],["icon","pi pi-file","severity","warn","pTooltip","Facturer",3,"click","rounded","outlined"],["class","flex flex-col gap-4",4,"ngIf"],["class","flex items-center justify-center p-8",4,"ngIf"],[1,"flex","flex-col","gap-4"],[1,"flex","items-center","justify-between","bg-surface-100","dark:bg-surface-800","rounded-lg","p-4"],[1,"font-bold"],[1,"text-xl","font-bold","text-primary"],[3,"value","rows","paginator","rowHover"],[1,"flex","items-center","justify-center","p-8"],[1,"pi","pi-spin","pi-spinner","text-4xl"],["label","Fermer","icon","pi pi-times","text","",3,"click"]],template:function(t,i){if(t&1){let s=v();u(0,"p-toast"),a(1,"div",8)(2,"p-toolbar",9),b(3,Mt,15,6,"ng-template",null,0,g)(5,Vt,1,0,"ng-template",null,1,g),n(),a(7,"p-table",10,2),E("selectionChange",function(h){return _(s),k(i.selectedPrestataires,h)||(i.selectedPrestataires=h),f(h)}),b(9,Rt,6,0,"ng-template",null,3,g)(11,Lt,26,0,"ng-template",null,4,g)(13,Wt,21,12,"ng-template",null,5,g),n()(),a(15,"p-dialog",11),E("visibleChange",function(h){return _(s),k(i.previewDialog,h)||(i.previewDialog=h),f(h)}),b(16,Gt,2,2,"ng-template",null,6,g)(18,Ut,1,0,"ng-template",null,7,g),n(),u(20,"p-confirmdialog")}t&2&&(l(7),m("value",i.prestataires())("rows",10)("columns",i.cols)("paginator",!0)("globalFilterFields",i.filterFields)("tableStyle",S(17,Dt)),P("selection",i.selectedPrestataires),m("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",S(18,Tt))("loading",i.loading),l(8),V(S(19,It)),P("visible",i.previewDialog),m("modal",!0),l(5),V(S(20,Ft)))},dependencies:[T,G,_e,ce,ue,de,rt,ot,N,Z,Y,A,ie,J,ve,be,xe,he,X,Xe,pe,me,Se,ye,ge,fe,ae,tt,ne,et,Pe,Ce,le,at,ke,oe,re,q,it],encapsulation:2})};var $=class r{ngOnInit(){}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=w({type:r,selectors:[["app-comptabilite-packing-liste"]],features:[R([I,L,lt])],decls:4,vars:0,consts:[["statsWidget",""],[1,"grid","grid-cols-12","gap-8","mb-8"],[3,"dataChanged"]],template:function(t,i){if(t&1){let s=v();a(0,"div",1),u(1,"app-stats-comptabilite-packing-widget",null,0),n(),a(3,"app-comptabilite-packing-tableau",2),x("dataChanged",function(){_(s);let h=j(2);return f(h.loadStats())}),n()}},dependencies:[T,De,Ie],encapsulation:2})};var Fe=class r{transform(e,t="GN"){if(!e)return"";let i=e.replace(/\D/g,"");switch(t){case"GN":return i.startsWith("224")?i="+"+i:i.length===9&&(i="+224"+i),i.replace(/(\+224)(\d{2})(\d{2})(\d{2})(\d{2})/,"$1 $2 $3 $4 $5");case"FR":return i.startsWith("33")&&(i="0"+i.substring(2)),i.replace(/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/,"$1 $2 $3 $4 $5");case"SL":return i.startsWith("232")?i="+"+i:i.length===8&&(i="+232"+i),i.replace(/(\+232)(\d{2})(\d{3})(\d{3})/,"$1 $2 $3 $4");case"SN":return i.startsWith("221")?i="+"+i:i.length===9&&(i="+221"+i),i.replace(/(\+221)(\d{2})(\d{3})(\d{2})(\d{2})/,"$1 $2 $3 $4 $5");case"CI":return i.startsWith("225")?i="+"+i:i.length===10&&(i="+225"+i),i.replace(/(\+225)(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/,"$1 $2 $3 $4 $5 $6");case"INT":return i.startsWith("+")||(i="+"+i),i.replace(/(\+\d{1,3})(\d{2})(\d{2})(\d{2})(\d{2})/,"$1 $2 $3 $4 $5");default:return e}}static \u0275fac=function(t){return new(t||r)};static \u0275pipe=Be({name:"phoneFormat",type:r,pure:!0})};var Me=class r{products=M([{id:"0",name:"20260201-0001",description:"Light Grey",quantity:1,price:39}]);subtotal=H(()=>this.products().reduce((e,t)=>e+t.quantity*t.price,0));removeProduct(e,t){t.stopPropagation();let i=this.products();i.splice(e,1),this.products.set([...i])}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=w({type:r,selectors:[["app-comptabilite-packing-paiement"]],decls:38,vars:4,consts:[[1,"flex","flex-col","h-full"],[1,"bg-surface-0","dark:bg-surface-900","p-4","flex","items-center","justify-between"],[1,"text-surface-900","dark:text-surface-0","text-xl","font-medium","leading-tight"],["pButton","","pStyleClass","#slideover-cart","leaveToClass","hidden","leaveActiveClass","animate-fadeoutright","severity","secondary",3,"text","rounded"],["pButtonIcon","",1,"pi","pi-times"],[1,"flex-auto","overflow-y-auto","p-4"],[1,"list-none","p-0","m-0"],[1,"flex","items-center","gap-4","pb-6","mb-6","border-b","border-surface-200","dark:border-surface-700","last:border-none","last:mb-0","last:pb-0"],[1,"flex-auto"],[1,"flex","items-start","justify-between","gap-2","mb-2"],[1,"text-surface-900","dark:text-surface-0","font-medium","leading-tight"],[1,"text-surface-900","dark:text-surface-0","font-semibold","leading-tight"],[1,"text-surface-900","dark:text-surface-0","font-bold"],[1,"flex","items-center","justify-between"],["buttonLayout","horizontal","inputStyleClass"," text-center py-2 px-1 border-transparent",3,"min"],[1,"border-t","border-surface","p-8"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-surface-900","dark:text-surface-0","font-medium"],[1,"text-surface-600","dark:text-surface-200","text-sm"],["pButton","","severity","contrast",1,"mb-4","w-full"],["pButtonLabel",""],["pButton","","pStyleClass","#slideover-cart","leaveToClass","hidden","leaveActiveClass","animate-fadeoutright","severity","secondary",1,"w-full",3,"outlined"]],template:function(t,i){t&1&&(a(0,"div",0)(1,"div",1)(2,"span",2),o(3,"20250102-0001"),n(),a(4,"button",3),u(5,"i",4),n()(),a(6,"div",5)(7,"ul",6)(8,"li",7)(9,"div",8)(10,"div",9)(11,"span",10),o(12,"Total \xE0 payer"),n(),a(13,"span",11),o(14,"1000 GNF"),n()(),a(15,"div",9)(16,"span",10),o(17,"D\xE9j\xE0 pay\xE9"),n(),a(18,"span",12),o(19,"120 000 GNF"),n()(),a(20,"div",13)(21,"span",10),o(22,"Reste \xE0 payer"),n(),u(23,"p-inputnumber",14),n()()()()(),a(24,"div",15)(25,"div",16)(26,"span",17),o(27,"Payer "),a(28,"span",18),o(29,":"),n()(),a(30,"span",12),o(31,"120 000 GNF"),n()(),a(32,"button",19)(33,"span",20),o(34,"Payer"),n()(),a(35,"button",21)(36,"span",20),o(37,"Annuler"),n()()()()),t&2&&(l(4),m("text",!0)("rounded",!0),l(19),m("min",0),l(12),m("outlined",!0))},dependencies:[T,N,A,te,ee,Je,Q,z,q,se],encapsulation:2})};var Qt=()=>[10,20,30],ut=()=>({width:"750px"}),dt=()=>({"max-height":"70vh",overflow:"auto"}),Zt=()=>({width:"450px"});function Yt(r,e){if(r&1&&(a(0,"span"),u(1,"i",30),o(2),ze(3,"phoneFormat"),n()),r&2){let t=c(2);l(2),p(Qe(3,1,t.prestatairePhone,"INT"))}}function Xt(r,e){if(r&1){let t=v();a(0,"div",25)(1,"p-button",26),x("click",function(){_(t);let s=c();return f(s.goBack())}),n(),a(2,"div")(3,"h4",27),o(4),n(),a(5,"p",28),b(6,Yt,4,4,"span",29),n()()()}if(r&2){let t=c();l(),m("rounded",!0)("outlined",!0),l(3),p(t.prestataireNom),l(2),m("ngIf",t.prestatairePhone)}}function Jt(r,e){r&1&&(a(0,"button",31)(1,"span",32),o(2,"Display"),n()()),r&2&&m("hideOnOutsideClick",!0)}function ei(r,e){r&1&&(a(0,"div",33)(1,"h5",34),o(2,"Factures"),n()())}function ti(r,e){r&1&&(a(0,"tr")(1,"th",35)(2,"span",36),o(3,"R\xE9f\xE9rence "),u(4,"p-sortIcon",37),n()(),a(5,"th",38)(6,"span",36),o(7,"Date "),u(8,"p-sortIcon",39),n()(),a(9,"th",40)(10,"span",36),o(11,"Rouleaux "),u(12,"p-sortIcon",41),n()(),a(13,"th",42),o(14,"Prix/rouleau"),n(),a(15,"th",43)(16,"span",36),o(17,"A payer "),u(18,"p-sortIcon",44),n()(),a(19,"th",45)(20,"span",36),o(21,"Vers\xE9 "),u(22,"p-sortIcon",46),n()(),a(23,"th",47),o(24,"Restant"),n(),a(25,"th",48)(26,"span",36),o(27,"Statut "),u(28,"p-sortIcon",49),n()(),u(29,"th",50),n())}function ii(r,e){if(r&1){let t=v();a(0,"p-button",58),x("click",function(){_(t);let s=c().$implicit,d=c();return f(d.openVersement(s))}),n()}r&2&&m("rounded",!0)("outlined",!0)}function ni(r,e){if(r&1){let t=v();a(0,"p-button",59),x("click",function(){_(t);let s=c().$implicit,d=c();return f(d.confirmDeleteFacture(s))}),n()}r&2&&m("rounded",!0)("outlined",!0)}function ai(r,e){if(r&1){let t=v();a(0,"tr")(1,"td",51),o(2),n(),a(3,"td")(4,"span",52),o(5),n()(),a(6,"td"),o(7),n(),a(8,"td"),o(9),n(),a(10,"td"),o(11),n(),a(12,"td"),o(13),n(),a(14,"td"),o(15),n(),a(16,"td"),u(17,"p-tag",53),n(),a(18,"td")(19,"div",54),b(20,ii,1,2,"p-button",55),a(21,"p-button",56),x("click",function(){let s=_(t).$implicit,d=c();return f(d.openHistorique(s))}),n(),b(22,ni,1,2,"p-button",57),n()()()}if(r&2){let t=e.$implicit,i=c();l(2),p(t.reference.replace("FACT-PACK-","")),l(3),p(i.formatDateDisplay(t.date)),l(2),p(t.total_rouleaux),l(2),p(i.formatCurrency(t.prix_par_rouleau)),l(2),p(i.formatCurrency(t.montant_total)),l(2),p(i.formatCurrency(t.montant_verse)),l(2),p(i.formatCurrency(t.montant_restant)),l(2),m("value",t.statut_label)("severity",i.getStatutSeverity(t.statut)),l(3),m("ngIf",t.statut!=="payee"),l(),m("rounded",!0)("outlined",!0),l(),m("ngIf",t.montant_verse===0)}}function ri(r,e){r&1&&(a(0,"tr")(1,"td",60),o(2," Aucune facture pour ce prestataire. "),n()())}function oi(r,e){r&1&&(a(0,"small",74),o(1,"Montant requis."),n())}function li(r,e){if(r&1){let t=v();a(0,"div",62)(1,"div",63)(2,"div",64)(3,"span",65),o(4),n(),u(5,"p-tag",53),n(),a(6,"div",66)(7,"div")(8,"span",67),o(9,"Total"),n(),a(10,"div",65),o(11),n()(),a(12,"div")(13,"span",67),o(14,"Vers\xE9"),n(),a(15,"div",68),o(16),n()(),a(17,"div")(18,"span",67),o(19,"Restant"),n(),a(20,"div",69),o(21),n()()()(),a(22,"div",62)(23,"div",23)(24,"label",70),o(25,"Mode de paiement"),n(),a(26,"p-select",71),E("ngModelChange",function(s){_(t);let d=c(2);return k(d.versementData.mode_paiement,s)||(d.versementData.mode_paiement=s),f(s)}),n()(),a(27,"div",23)(28,"label",70),o(29,"Montant \xE0 verser"),n(),a(30,"p-inputnumber",72),E("ngModelChange",function(s){_(t);let d=c(2);return k(d.versementData.montant,s)||(d.versementData.montant=s),f(s)}),n(),b(31,oi,2,0,"small",73),n()()()}if(r&2){let t=c(2);l(4),p(t.selectedFacture.reference.replace("FACT-PACK-","")),l(),m("value",t.selectedFacture.statut_label)("severity",t.getStatutSeverity(t.selectedFacture.statut)),l(6),p(t.formatCurrency(t.selectedFacture.montant_total)),l(5),p(t.formatCurrency(t.selectedFacture.montant_verse)),l(5),p(t.formatCurrency(t.selectedFacture.montant_restant)),l(5),P("ngModel",t.versementData.mode_paiement),m("options",t.modesPaiement),l(4),P("ngModel",t.versementData.montant),m("min",1)("max",t.selectedFacture.montant_restant)("useGrouping",!0),l(),m("ngIf",t.versementSubmitted&&!t.versementData.montant)}}function si(r,e){if(r&1&&b(0,li,32,13,"div",61),r&2){let t=c();m("ngIf",t.selectedFacture)}}function mi(r,e){if(r&1){let t=v();a(0,"button",75),x("click",function(){_(t);let s=c();return f(s.hideVersementDialog())}),a(1,"span",32),o(2,"Annuler"),n()(),a(3,"button",76),x("click",function(){_(t);let s=c();return f(s.saveVersement())}),a(4,"span",32),o(5,"Enregistrer"),n()()}if(r&2){let t=c();m("outlined",!0),l(3),m("disabled",t.versementSaving)("loading",t.versementSaving)}}function pi(r,e){r&1&&(a(0,"div",78),u(1,"i",79),n())}function ci(r,e){r&1&&(a(0,"tr")(1,"th"),o(2,"Date"),n(),a(3,"th"),o(4,"Montant"),n(),a(5,"th"),o(6,"Mode"),n(),a(7,"th"),o(8,"Notes"),n(),u(9,"th"),n())}function ui(r,e){if(r&1){let t=v();a(0,"tr")(1,"td"),o(2),n(),a(3,"td",88),o(4),n(),a(5,"td"),o(6),n(),a(7,"td"),o(8),n(),a(9,"td")(10,"p-button",89),x("click",function(){let s=_(t).$implicit,d=c(4);return f(d.confirmDeleteVersement(d.historiqueData.facture_id,s))}),n()()()}if(r&2){let t=e.$implicit,i=c(4);l(2),p(i.formatDateDisplay(t.date_versement)),l(2),p(i.formatCurrency(t.montant)),l(2),p(t.mode_paiement_label),l(2),p(t.notes||"-"),l(2),m("rounded",!0)("outlined",!0)("text",!0)}}function di(r,e){if(r&1&&(a(0,"p-table",87),b(1,ci,10,0,"ng-template",null,3,g)(3,ui,11,7,"ng-template",null,4,g),n()),r&2){let t=c(3);m("value",t.historiqueData.versements)("rowHover",!0)}}function _i(r,e){r&1&&(a(0,"div",90),o(1," Aucun versement enregistr\xE9. "),n())}function fi(r,e){if(r&1&&(a(0,"div",62)(1,"div",80)(2,"div",81)(3,"span",82),o(4),n(),u(5,"p-tag",53),n(),a(6,"div",83)(7,"div",15)(8,"span",84),o(9,"Montant total"),n(),a(10,"div",65),o(11),n()(),a(12,"div",15)(13,"span",84),o(14,"Vers\xE9"),n(),a(15,"div",68),o(16),n()(),a(17,"div",15)(18,"span",84),o(19,"Restant"),n(),a(20,"div",69),o(21),n()()()(),b(22,di,5,2,"p-table",85)(23,_i,2,0,"div",86),n()),r&2){let t=c(2);l(4),p(t.historiqueData.reference.replace("FACT-PACK-","")),l(),m("value",t.historiqueData.is_soldee?"Sold\xE9":"En cours")("severity",t.historiqueData.is_soldee?"success":"warn"),l(6),p(t.formatCurrency(t.historiqueData.montant_total)),l(5),p(t.formatCurrency(t.historiqueData.montant_verse)),l(5),p(t.formatCurrency(t.historiqueData.montant_restant)),l(),m("ngIf",t.historiqueData.versements.length>0),l(),m("ngIf",t.historiqueData.versements.length===0)}}function gi(r,e){if(r&1&&b(0,pi,2,0,"div",77)(1,fi,24,8,"div",61),r&2){let t=c();m("ngIf",t.historiqueLoading),l(),m("ngIf",t.historiqueData)}}function bi(r,e){if(r&1){let t=v();a(0,"p-button",91),x("click",function(){_(t);let s=c();return f(s.historiqueDialog=!1)}),n()}}var Ve=class r{constructor(e,t,i,s,d){this.route=e;this.router=t;this.factureService=i;this.messageService=s;this.confirmationService=d}prestataireId=0;prestataireNom="";prestatairePhone="";products=M([{id:"0",name:"Everlight Canvas Backpack",description:"Light Grey",quantity:1,price:39},{id:"1",name:"Stride Low-Top Sneakers",description:"Crimson Sole",quantity:1,price:52},{id:"2",name:"Cozy Knit Beanie",description:"Mustard",quantity:1,price:21}]);subtotal=H(()=>this.products().reduce((e,t)=>e+t.quantity*t.price,0));factures=M([]);loading=!1;totalFacture=0;totalVerse=0;totalRestant=0;versementDialog=!1;selectedFacture=null;versementData={montant:null,date_versement:new Date,mode_paiement:"especes",notes:""};versementSaving=!1;versementSubmitted=!1;modesPaiement=[{label:B.especes,value:"especes"},{label:B.virement,value:"virement"},{label:B.cheque,value:"cheque"},{label:B.mobile_money,value:"mobile_money"}];historiqueDialog=!1;historiqueData=null;historiqueLoading=!1;ngOnInit(){this.route.params.subscribe(e=>{this.prestataireId=+e.id||0}),this.route.queryParams.subscribe(e=>{this.prestataireNom=e.prestataire_nom||"",this.prestatairePhone=e.prestataire_phone||""}),this.prestataireId&&this.loadFactures()}loadFactures(){this.loading=!0,this.factureService.getFactures({prestataire_id:this.prestataireId}).subscribe({next:e=>{let t=(e.data||[]).map(i=>new Ee(i));this.factures.set(t),this.calculateTotals(t),this.loading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger les factures",life:3e3}),this.loading=!1}})}calculateTotals(e){this.totalFacture=e.reduce((t,i)=>t+i.montant_total,0),this.totalVerse=e.reduce((t,i)=>t+i.montant_verse,0),this.totalRestant=e.reduce((t,i)=>t+i.montant_restant,0)}openVersement(e){this.selectedFacture=e,this.versementDialog=!0,this.versementSubmitted=!1,this.versementData={montant:e.montant_restant,date_versement:new Date,mode_paiement:"especes",notes:""}}hideVersementDialog(){this.versementDialog=!1,this.selectedFacture=null,this.versementSubmitted=!1}saveVersement(){if(this.versementSubmitted=!0,!this.selectedFacture||!this.versementData.montant||!this.versementData.date_versement||this.versementSaving)return;this.versementSaving=!0;let e={montant:this.versementData.montant,date_versement:this.formatDate(this.versementData.date_versement),mode_paiement:this.versementData.mode_paiement,notes:this.versementData.notes||void 0};this.factureService.createVersement(this.selectedFacture.id,e).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`Versement de ${this.formatCurrency(e.montant)} enregistr\xE9`,life:3e3}),this.versementSaving=!1,this.versementDialog=!1,this.loadFactures()},error:t=>{let i=t?.error?.message||"Impossible d'enregistrer le versement";this.messageService.add({severity:"error",summary:"Erreur",detail:i,life:5e3}),this.versementSaving=!1}})}openHistorique(e){this.historiqueDialog=!0,this.historiqueLoading=!0,this.historiqueData=null,this.factureService.getVersements(e.id).subscribe({next:t=>{this.historiqueData=t.data,this.historiqueLoading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger les versements",life:3e3}),this.historiqueLoading=!1,this.historiqueDialog=!1}})}confirmDeleteVersement(e,t){this.confirmationService.confirm({message:`Supprimer le versement de ${this.formatCurrency(t.montant)} ?`,header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptLabel:"Supprimer",rejectLabel:"Annuler",accept:()=>{this.factureService.deleteVersement(e,t.id).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Versement supprim\xE9",life:3e3}),this.historiqueData&&this.openHistorique({id:e}),this.loadFactures()},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de supprimer le versement",life:3e3})}})}})}confirmDeleteFacture(e){this.confirmationService.confirm({message:`Supprimer la facture ${e.reference} ?`,header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptLabel:"Supprimer",rejectLabel:"Annuler",accept:()=>{this.factureService.deleteFacture(e.id).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Facture supprim\xE9e",life:3e3}),this.loadFactures()},error:t=>{let i=t?.error?.message||"Impossible de supprimer la facture";this.messageService.add({severity:"error",summary:"Erreur",detail:i,life:5e3})}})}})}getStatutSeverity(e){return pt[e]??"info"}formatDate(e){return e?typeof e=="string"?e:new Date(e).toISOString().split("T")[0]:""}formatCurrency(e){return new Intl.NumberFormat("fr-FR",{style:"decimal",minimumFractionDigits:0}).format(e)+" GNF"}formatDateDisplay(e){return e?new Date(e).toLocaleDateString("fr-FR"):""}removeProduct(e,t){t.stopPropagation();let i=this.products();i.splice(e,1),this.products.set([...i])}goBack(){this.router.navigate(["/comptabilite/comptabilite-packing-liste"])}openPaiement(){this.paiementDialog=!0}paiementDialog=!1;static \u0275fac=function(t){return new(t||r)(y(Ye),y(K),y(F),y(I),y(L))};static \u0275cmp=w({type:r,selectors:[["app-comptabilite-packing-detail"]],features:[R([I,L])],decls:50,vars:38,consts:[["start",""],["end",""],["caption",""],["header",""],["body",""],["emptymessage",""],["content",""],["footer",""],["position","top-right","appendTo","body",3,"baseZIndex","preventOpenDuplicates"],[1,"card","relative"],["styleClass","mb-6"],["id","slideover-cart",1,"hidden","fixed","inset-0","z-50"],["pStyleClass","#slideover-cart","leaveToClass","hidden","leaveActiveClass","animate-fadeoutright",1,"absolute","inset-0","bg-black/50"],[1,"bg-surface-0","dark:bg-surface-900","absolute","top-0","right-0","shadow-xl","w-full","md:w-108","h-full"],[1,"grid","grid-cols-12","gap-4","mb-6"],[1,"col-span-4"],[1,"bg-surface-100","dark:bg-surface-800","rounded-lg","p-4","text-center"],[1,"text-sm","text-surface-500","block","mb-1"],[1,"text-xl","font-bold","text-primary"],[1,"text-xl","font-bold","text-green-600"],[1,"text-xl","font-bold"],["dataKey","id","currentPageReportTemplate","  {first} \xE0 {last} sur {totalRecords} factures",3,"value","rows","paginator","rowHover","showCurrentPageReport","rowsPerPageOptions","loading"],["header","Enregistrer un versement",3,"visibleChange","visible","contentStyle","modal","blockScroll","dismissableMask","closeOnEscape"],[1,"mt-4"],["header","Historique des versements",3,"visibleChange","visible","contentStyle","modal","blockScroll","dismissableMask","closeOnEscape"],[1,"flex","items-center","gap-4"],["icon","pi pi-arrow-left","severity","secondary","pTooltip","Retour",3,"click","rounded","outlined"],[1,"m-0","font-bold"],[1,"text-sm","text-surface-500","mt-2"],[4,"ngIf"],[1,"pi","pi-phone","mr-1"],["pButton","","pStyleClass","#slideover-cart","enterFromClass","hidden","enterActiveClass","animate-fadeinright","leaveToClass","hidden","leaveActiveClass","animate-fadeoutright",3,"hideOnOutsideClick"],["pButtonLabel",""],[1,"flex","items-center","justify-between"],[1,"m-0"],["pSortableColumn","reference",2,"min-width","12rem"],[1,"flex","items-center","gap-2"],["field","reference"],["pSortableColumn","date",2,"min-width","10rem"],["field","date"],["pSortableColumn","total_rouleaux",2,"min-width","8rem"],["field","total_rouleaux"],[2,"min-width","8rem"],["pSortableColumn","montant_total",2,"min-width","10rem"],["field","montant_total"],["pSortableColumn","montant_verse",2,"min-width","10rem"],["field","montant_verse"],[2,"min-width","10rem"],["pSortableColumn","statut",2,"min-width","10rem"],["field","statut"],[2,"min-width","12rem"],[1,"font-semibold"],[1,"text-sm"],[3,"value","severity"],[1,"flex","gap-2"],["icon","pi pi-money-bill","severity","success","pTooltip","Payer",3,"rounded","outlined","click",4,"ngIf"],["icon","pi pi-list","severity","info","pTooltip","Historique versements",3,"click","rounded","outlined"],["icon","pi pi-trash","severity","danger","pTooltip","Supprimer",3,"rounded","outlined","click",4,"ngIf"],["icon","pi pi-money-bill","severity","success","pTooltip","Payer",3,"click","rounded","outlined"],["icon","pi pi-trash","severity","danger","pTooltip","Supprimer",3,"click","rounded","outlined"],["colspan","9",1,"text-center","p-8","text-surface-500"],["class","flex flex-col gap-4",4,"ngIf"],[1,"flex","flex-col","gap-4"],[1,"bg-surface-100","dark:bg-surface-800","rounded-lg","p-3"],[1,"flex","items-center","justify-between","mb-1"],[1,"font-bold"],[1,"grid","grid-cols-3","gap-2","mt-2"],[1,"text-xs","text-surface-500"],[1,"font-bold","text-green-600"],[1,"font-bold","text-orange-500"],[1,"block","font-bold","mb-2"],["optionLabel","label","optionValue","value","styleClass","w-full","appendTo","body",3,"ngModelChange","ngModel","options"],["suffix"," GNF","locale","fr-FR","inputStyleClass","w-full","styleClass","w-full",3,"ngModelChange","ngModel","min","max","useGrouping"],["class","text-red-500",4,"ngIf"],[1,"text-red-500"],["pButton","",3,"click","outlined"],["pButton","",3,"click","disabled","loading"],["class","flex items-center justify-center p-8",4,"ngIf"],[1,"flex","items-center","justify-center","p-8"],[1,"pi","pi-spin","pi-spinner","text-4xl"],[1,"bg-surface-100","dark:bg-surface-800","rounded-lg","p-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-bold","text-lg"],[1,"grid","grid-cols-12","gap-4"],[1,"text-sm","text-surface-500"],[3,"value","rowHover",4,"ngIf"],["class","text-center p-4 text-surface-500",4,"ngIf"],[3,"value","rowHover"],[1,"text-green-600","font-bold"],["icon","pi pi-trash","severity","danger","pTooltip","Supprimer",3,"click","rounded","outlined","text"],[1,"text-center","p-4","text-surface-500"],["label","Fermer","icon","pi pi-times","text","",3,"click"]],template:function(t,i){if(t&1){let s=v();u(0,"p-toast",8),a(1,"div",9)(2,"p-toolbar",10),b(3,Xt,7,4,"ng-template",null,0,g)(5,Jt,3,1,"ng-template",null,1,g),n(),a(7,"div",11),u(8,"div",12),a(9,"div",13),u(10,"app-comptabilite-packing-paiement"),n()(),a(11,"div",14)(12,"div",15)(13,"div",16)(14,"span",17),o(15,"Total \xE0 payer"),n(),a(16,"span",18),o(17),n()()(),a(18,"div",15)(19,"div",16)(20,"span",17),o(21,"Total vers\xE9"),n(),a(22,"span",19),o(23),n()()(),a(24,"div",15)(25,"div",16)(26,"span",17),o(27,"Reste \xE0 payer"),n(),a(28,"span",20),o(29),n()()()(),a(30,"p-table",21),b(31,ei,3,0,"ng-template",null,2,g)(33,ti,30,0,"ng-template",null,3,g)(35,ai,23,13,"ng-template",null,4,g)(37,ri,3,0,"ng-template",null,5,g),n()(),a(39,"p-dialog",22),E("visibleChange",function(h){return _(s),k(i.versementDialog,h)||(i.versementDialog=h),f(h)}),b(40,si,1,1,"ng-template",null,6,g)(42,mi,6,3,"ng-template",23,7,g),n(),a(44,"p-dialog",24),E("visibleChange",function(h){return _(s),k(i.historiqueDialog,h)||(i.historiqueDialog=h),f(h)}),b(45,gi,2,2,"ng-template",null,6,g)(47,bi,1,0,"ng-template",null,7,g),n(),u(49,"p-confirmdialog")}t&2&&(m("baseZIndex",1100)("preventOpenDuplicates",!0),l(17),p(i.formatCurrency(i.totalFacture)),l(6),p(i.formatCurrency(i.totalVerse)),l(5),Ke("text-orange-500",i.totalRestant>0),l(),p(i.formatCurrency(i.totalRestant)),l(),m("value",i.factures())("rows",10)("paginator",!0)("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",S(32,Qt))("loading",i.loading),l(9),V(S(33,ut)),P("visible",i.versementDialog),m("contentStyle",S(34,dt))("modal",!0)("blockScroll",!0)("dismissableMask",!1)("closeOnEscape",!1),l(5),V(S(35,ut)),P("visible",i.historiqueDialog),m("contentStyle",S(36,dt))("modal",!0)("blockScroll",!0)("dismissableMask",!1)("closeOnEscape",!1),l(5),V(S(37,Zt)))},dependencies:[T,G,_e,ce,ue,de,N,Z,Y,A,te,ie,ee,J,ve,be,xe,he,X,pe,me,q,se,Se,ye,ge,fe,ae,ne,Pe,Ce,le,ke,oe,re,Q,z,Me,st,nt,Fe],encapsulation:2})};var aa=[{path:"",component:$},{path:"comptabilite-packing-liste",component:$},{path:"comptabilite-packing-detail/:id",component:Ve},{path:"**",redirectTo:"/notfound"}];export{aa as default};
