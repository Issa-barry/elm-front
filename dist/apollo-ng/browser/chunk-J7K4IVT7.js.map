{
  "version": 3,
  "sources": ["src/app/services/role/role.service.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable, catchError, throwError } from 'rxjs';\nimport { environment } from 'src/environments/environment';\r\nimport {\n  RoleWithModules,\n  CreateRoleDto,\n  UpdateRoleDto,\n  UpdatePermissionsDto,\n  ModulePermission,\n  PermissionCatalogModule,\n  AssignedUserRoleData,\n  UserRoles,\n} from '@/models/role.model';\n\r\nexport interface ApiResponse<T> {\r\n  success: boolean;\r\n  message: string;\r\n  data: T;\r\n}\r\n\r\n@Injectable({\n  providedIn: 'root',\n})\nexport class RoleService {\n  private readonly apiUrl = `${environment.apiUrl}/roles`;\n  private readonly permissionsUrl = `${environment.apiUrl}/permissions`;\n  private readonly usersUrl = `${environment.apiUrl}/users`;\n\n  constructor(private http: HttpClient) {}\n\r\n  getRoles(): Observable<ApiResponse<RoleWithModules[]>> {\r\n    return this.http.get<ApiResponse<RoleWithModules[]>>(this.apiUrl);\r\n  }\r\n\r\n  getRole(id: number): Observable<ApiResponse<RoleWithModules>> {\r\n    return this.http.get<ApiResponse<RoleWithModules>>(`${this.apiUrl}/${id}`);\r\n  }\r\n\r\n  createRole(dto: CreateRoleDto): Observable<ApiResponse<{ role: { id: number; name: string; created_at: string } }>> {\r\n    return this.http.post<ApiResponse<{ role: { id: number; name: string; created_at: string } }>>(this.apiUrl, dto);\r\n  }\r\n\r\n  updateRole(id: number, dto: UpdateRoleDto): Observable<ApiResponse<{ role: { id: number; name: string; created_at: string } }>> {\r\n    return this.http.put<ApiResponse<{ role: { id: number; name: string; created_at: string } }>>(`${this.apiUrl}/${id}`, dto);\r\n  }\r\n\r\n  deleteRole(id: number): Observable<ApiResponse<null>> {\r\n    return this.http.delete<ApiResponse<null>>(`${this.apiUrl}/${id}`);\r\n  }\r\n\r\n  updatePermissions(id: number, dto: UpdatePermissionsDto): Observable<ApiResponse<{ role: { id: number; name: string }; modules: ModulePermission[] }>> {\r\n    return this.http.put<ApiResponse<{ role: { id: number; name: string }; modules: ModulePermission[] }>>(\r\n      `${this.apiUrl}/${id}/permissions`,\r\n      dto\r\n    );\r\n  }\r\n\r\n  getPermissions(): Observable<ApiResponse<PermissionCatalogModule[]>> {\n    return this.http.get<ApiResponse<PermissionCatalogModule[]>>(this.permissionsUrl).pipe(\n      catchError((error) => {\n        if (error?.status === 404) {\n          return this.http.get<ApiResponse<PermissionCatalogModule[]>>(`${this.apiUrl}/permissions`);\n        }\n\n        return throwError(() => error);\n      })\n    );\n  }\n\n  assignRole(userId: number, role: string): Observable<ApiResponse<AssignedUserRoleData>> {\n    return this.http.post<ApiResponse<AssignedUserRoleData>>(`${this.apiUrl}/assign/${userId}`, { role });\n  }\n\r\n  getUserRoles(userId: number): Observable<ApiResponse<UserRoles>> {\r\n    return this.http.get<ApiResponse<UserRoles>>(`${this.usersUrl}/${userId}/roles`);\r\n  }\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;AAwBM,IAAO,cAAP,MAAO,aAAW;EAKF;EAJH,SAAS,GAAG,YAAY,MAAM;EAC9B,iBAAiB,GAAG,YAAY,MAAM;EACtC,WAAW,GAAG,YAAY,MAAM;EAEjD,YAAoB,MAAgB;AAAhB,SAAA,OAAA;EAAmB;EAEvC,WAAQ;AACN,WAAO,KAAK,KAAK,IAAoC,KAAK,MAAM;EAClE;EAEA,QAAQ,IAAU;AAChB,WAAO,KAAK,KAAK,IAAkC,GAAG,KAAK,MAAM,IAAI,EAAE,EAAE;EAC3E;EAEA,WAAW,KAAkB;AAC3B,WAAO,KAAK,KAAK,KAA8E,KAAK,QAAQ,GAAG;EACjH;EAEA,WAAW,IAAY,KAAkB;AACvC,WAAO,KAAK,KAAK,IAA6E,GAAG,KAAK,MAAM,IAAI,EAAE,IAAI,GAAG;EAC3H;EAEA,WAAW,IAAU;AACnB,WAAO,KAAK,KAAK,OAA0B,GAAG,KAAK,MAAM,IAAI,EAAE,EAAE;EACnE;EAEA,kBAAkB,IAAY,KAAyB;AACrD,WAAO,KAAK,KAAK,IACf,GAAG,KAAK,MAAM,IAAI,EAAE,gBACpB,GAAG;EAEP;EAEA,iBAAc;AACZ,WAAO,KAAK,KAAK,IAA4C,KAAK,cAAc,EAAE,KAChF,WAAW,CAAC,UAAS;AACnB,UAAI,OAAO,WAAW,KAAK;AACzB,eAAO,KAAK,KAAK,IAA4C,GAAG,KAAK,MAAM,cAAc;MAC3F;AAEA,aAAO,WAAW,MAAM,KAAK;IAC/B,CAAC,CAAC;EAEN;EAEA,WAAW,QAAgB,MAAY;AACrC,WAAO,KAAK,KAAK,KAAwC,GAAG,KAAK,MAAM,WAAW,MAAM,IAAI,EAAE,KAAI,CAAE;EACtG;EAEA,aAAa,QAAc;AACzB,WAAO,KAAK,KAAK,IAA4B,GAAG,KAAK,QAAQ,IAAI,MAAM,QAAQ;EACjF;;qCApDW,cAAW,mBAAA,UAAA,CAAA;EAAA;4EAAX,cAAW,SAAX,aAAW,WAAA,YAFV,OAAM,CAAA;;;sEAEP,aAAW,CAAA;UAHvB;WAAW;MACV,YAAY;KACb;;;",
  "names": []
}
