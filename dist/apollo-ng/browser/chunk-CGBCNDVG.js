import{a as Ce}from"./chunk-334QLNG6.js";import{a as De,b as Fe}from"./chunk-GO5YAF3T.js";import{a as ke,b as Ee}from"./chunk-CVH73O44.js";import{a as Ne,b as Ve}from"./chunk-XDXU5A6L.js";import{a as Te,b as Ie}from"./chunk-R3EAI2YQ.js";import{a as H,b as K}from"./chunk-QFEFJCNI.js";import"./chunk-RLRCSE6J.js";import"./chunk-4NSD52R5.js";import{a as B}from"./chunk-4SCZYFYR.js";import{b as fe,d as T}from"./chunk-H5BNHAT7.js";import"./chunk-Q3QYWOBT.js";import{a as Ae,b as Oe}from"./chunk-ZSMYH3SO.js";import{a as ye,d as we,e as Pe,k as Se}from"./chunk-566VITEB.js";import"./chunk-PFQBBUG2.js";import"./chunk-ZKOS3DIQ.js";import"./chunk-TF3WUBGP.js";import"./chunk-CIG3UH2L.js";import"./chunk-LKI2OA3Y.js";import{a as Me,b as Re}from"./chunk-LLIVY2RR.js";import"./chunk-ACCAPG7B.js";import"./chunk-GQZMGDXE.js";import"./chunk-EMSXNTNI.js";import"./chunk-CAPWCZXM.js";import"./chunk-EJ36MVS3.js";import"./chunk-N7WUB32N.js";import"./chunk-4OYOH73G.js";import"./chunk-E7ZA2RP6.js";import"./chunk-NFFITYYI.js";import"./chunk-QKYHST3S.js";import"./chunk-26DLLJPL.js";import"./chunk-CKLQ5QYB.js";import"./chunk-LEXXM723.js";import{c as _e}from"./chunk-PR732LFS.js";import"./chunk-YPI3USWF.js";import{a as he,b as ve,c as xe,d as be}from"./chunk-E2A55PMK.js";import{a as U,b as L}from"./chunk-ROFMEOOL.js";import{b as N,e as V,h as D,p as F}from"./chunk-AQNIYYGH.js";import{a as $,b as j}from"./chunk-UEYH4F7Z.js";import"./chunk-YU5WWNZ3.js";import"./chunk-BODZH67C.js";import"./chunk-7UZYWCAJ.js";import{d as W,e as z}from"./chunk-FXG7SSDN.js";import"./chunk-C3BTHMVA.js";import"./chunk-D772OSYX.js";import"./chunk-N4GWINB2.js";import{la as I,pa as R}from"./chunk-DRU5BJUS.js";import{j as de,k as ue,q as ge,v as E}from"./chunk-3CNM3VZD.js";import"./chunk-4O3FVBGX.js";import{$ as d,$b as me,Gb as h,Kb as g,Lb as m,Ma as l,Pb as re,Qb as oe,R as ee,Rb as ne,Ub as se,V as te,Vb as ae,Wb as le,Xa as x,Xb as J,Zb as v,_b as y,aa as u,ab as O,cc as P,dc as S,ec as A,gb as b,gc as k,hc as M,ia as ie,l as Y,rc as ce,sc as pe,wb as p,wc as C,xb as s,yb as n,z as Z,zb as _}from"./chunk-U3BUAVLN.js";import"./chunk-GAL4ENT6.js";var G=["create","read","update","delete"];var w=class o{constructor(t){this.http=t}apiUrl=`${B.apiUrl}/roles`;permissionsUrl=`${B.apiUrl}/permissions`;usersUrl=`${B.apiUrl}/users`;getRoles(){return this.http.get(this.apiUrl)}getRole(t){return this.http.get(`${this.apiUrl}/${t}`)}createRole(t){return this.http.post(this.apiUrl,t)}updateRole(t,e){return this.http.put(`${this.apiUrl}/${t}`,e)}deleteRole(t){return this.http.delete(`${this.apiUrl}/${t}`)}updatePermissions(t,e){return this.http.put(`${this.apiUrl}/${t}/permissions`,e)}getPermissions(){return this.http.get(this.permissionsUrl).pipe(Z(t=>t?.status===404?this.http.get(`${this.apiUrl}/permissions`):Y(()=>t)))}assignRole(t,e){return this.http.post(`${this.apiUrl}/assign/${t}`,{role:e})}getUserRoles(t){return this.http.get(`${this.usersUrl}/${t}/roles`)}static \u0275fac=function(e){return new(e||o)(te(_e))};static \u0275prov=ee({token:o,factory:o.\u0275fac,providedIn:"root"})};var qe=["dt"],Je=()=>["role.name"],Xe=()=>({"min-width":"40rem"}),Ye=()=>[10,20,30],We=()=>({width:"450px"});function Ze(o,t){if(o&1){let e=h();s(0,"p-button",13),g("onClick",function(){d(e);let i=m();return u(i.goToParametres())}),n()}o&2&&p("text",!0)("rounded",!0)}function et(o,t){if(o&1){let e=h();s(0,"p-button",14),g("onClick",function(){d(e);let i=m();return u(i.openCreateDialog())}),n()}}function tt(o,t){if(o&1){let e=h();s(0,"div",15)(1,"h5",16),v(2,"Gestion des R\xF4les"),n(),s(3,"p-iconfield"),_(4,"p-inputicon",17),s(5,"input",18),g("input",function(i){d(e);let a=m(),c=se(8);return u(a.onGlobalFilter(c,i))}),n()()()}}function it(o,t){o&1&&(s(0,"tr")(1,"th",19)(2,"span",20),v(3,"Nom "),_(4,"p-sortIcon",21),n()(),s(5,"th",22)(6,"span",23),v(7,"Permissions"),n()(),s(8,"th",24)(9,"span",20),v(10,"Date de cr\xE9ation "),_(11,"p-sortIcon",25),n()(),_(12,"th",26),n())}function rt(o,t){if(o&1){let e=h();s(0,"tr",27),g("dblclick",function(){let i=d(e).$implicit,a=m();return u(a.editRole(i))}),s(1,"td")(2,"div",28)(3,"span",29),_(4,"i",30),n(),s(5,"span",31),v(6),n()()(),s(7,"td",22),_(8,"p-tag",32),n(),s(9,"td",33),v(10),n(),s(11,"td",22)(12,"p-button",34),g("click",function(i){let a=d(e).$implicit;return m().deleteRole(a),u(i.stopPropagation())}),n(),s(13,"p-button",35),g("click",function(){let i=d(e).$implicit,a=m();return u(a.editRole(i))}),n()()()}if(o&2){let e=t.$implicit,r=m();l(3),ae("background","var(--p-primary-50)")("color","var(--p-primary-600)"),l(3),y(e.role.name),l(2),p("value",r.countPermissions(e)+" permissions"),l(2),y(r.formatDate(e.role.created_at)),l(2),p("text",!0)("rounded",!0),l(),p("text",!0)("rounded",!0)}}function ot(o,t){o&1&&(s(0,"tr")(1,"td",36)(2,"div",37),_(3,"i",30),s(4,"span"),v(5,"Aucun r\xF4le trouv\xE9"),n()()()())}function nt(o,t){if(o&1){let e=h();s(0,"div",38)(1,"div")(2,"label",39),v(3,"Nom du r\xF4le"),n(),s(4,"input",40),A("ngModelChange",function(i){d(e);let a=m();return S(a.newRoleName,i)||(a.newRoleName=i),u(i)}),g("keydown.enter",function(){d(e);let i=m();return u(i.createRole())}),n()()()}if(o&2){let e=m();l(4),P("ngModel",e.newRoleName)}}function st(o,t){if(o&1){let e=h();s(0,"p-button",41),g("click",function(){d(e);let i=m();return u(i.createDialog=!1)}),n(),s(1,"p-button",42),g("click",function(){d(e);let i=m();return u(i.createRole())}),n()}if(o&2){let e=m();p("text",!0)("disabled",e.creating),l(),p("disabled",e.creating||!e.newRoleName.trim())("loading",e.creating)}}var Q=class o{constructor(t,e,r,i){this.roleService=t;this.messageService=e;this.confirmationService=r;this.router=i}roles=ie([]);loading=!1;createDialog=!1;newRoleName="";creating=!1;dt;ngOnInit(){this.loadRoles()}loadRoles(){this.loading=!0,this.roleService.getRoles().subscribe({next:t=>{let e=t?.data,r=Array.isArray(e)?e:Array.isArray(e?.roles)?e.roles:Array.isArray(e?.data)?e.data:[];this.roles.set(r.map(i=>this.normalizeRoleItem(i))),this.loading=!1},error:t=>{this.messageService.add({severity:"error",summary:"Erreur",detail:t?.error?.message||"Impossible de charger les r\xF4les",life:5e3}),this.loading=!1}})}countPermissions(t){return t.modules.reduce((e,r)=>e+G.filter(i=>r.permissions[i]).length,0)}normalizeRoleItem(t){if(t?.role&&Array.isArray(t?.modules))return t;let e={id:Number(t?.id??0),name:String(t?.name??""),created_at:String(t?.created_at??"")},r=Array.isArray(t?.permissions)?t.permissions.map(c=>typeof c=="string"?c:c?.name).filter(c=>typeof c=="string"&&c.includes(".")):[],i=new Map;r.forEach(c=>{let[f,X]=c.split(".");!f||!X||(i.has(f)||i.set(f,new Set),i.get(f)?.add(X))});let a=Array.from(i.entries()).map(([c,f])=>({module:c,permissions:{create:f.has("create"),read:f.has("read"),update:f.has("update"),delete:f.has("delete")}}));return{role:e,modules:a}}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}openCreateDialog(){this.newRoleName="",this.createDialog=!0}goToParametres(){this.router.navigate(["/parametres"])}createRole(){!this.newRoleName.trim()||this.creating||(this.creating=!0,this.roleService.createRole({name:this.newRoleName.trim()}).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"R\xF4le cr\xE9\xE9 avec succ\xE8s",life:3e3}),this.createDialog=!1,this.creating=!1,this.loadRoles()},error:t=>{this.messageService.add({severity:"error",summary:"Erreur",detail:t?.error?.message||"Impossible de cr\xE9er le r\xF4le",life:5e3}),this.creating=!1}}))}editRole(t){this.router.navigate(["/roles/edit",t.role.id])}deleteRole(t){if(t.role.name==="admin"){this.messageService.add({severity:"warn",summary:"Attention",detail:"Le r\xF4le admin ne peut pas \xEAtre supprim\xE9",life:3e3});return}this.confirmationService.confirm({message:`\xCAtes-vous s\xFBr de vouloir supprimer le r\xF4le "${t.role.name}" ?`,header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{this.roleService.deleteRole(t.role.id).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"R\xF4le supprim\xE9",life:3e3}),this.loadRoles()},error:e=>{this.messageService.add({severity:"error",summary:"Erreur",detail:e?.error?.message||"Impossible de supprimer le r\xF4le",life:5e3})}})}})}formatDate(t){return t?new Date(t).toLocaleDateString("fr-FR"):""}static \u0275fac=function(e){return new(e||o)(x(w),x(R),x(I),x(T))};static \u0275cmp=O({type:o,selectors:[["app-roles-liste"]],viewQuery:function(e,r){if(e&1&&re(qe,5),e&2){let i;oe(i=ne())&&(r.dt=i.first)}},features:[k([R,I])],decls:23,vars:20,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["emptymessage",""],["content",""],["footer",""],[1,"card"],["styleClass","mb-12"],["dataKey","role.id","currentPageReportTemplate","Affichage {first} \xE0 {last} sur {totalRecords} r\xF4les",3,"value","rows","paginator","globalFilterFields","tableStyle","rowHover","showCurrentPageReport","rowsPerPageOptions","loading"],["header","Nouveau r\xF4le",3,"visibleChange","visible","modal"],["icon","pi pi-arrow-left","severity","secondary","pTooltip","Retour param\xE9tres",3,"onClick","text","rounded"],["label","Ajouter un r\xF4le","icon","pi pi-plus","severity","secondary",3,"onClick"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Rechercher...",3,"input"],["pSortableColumn","role.name"],[1,"col-header"],["field","role.name"],[1,"text-center"],[1,"col-header","justify-center"],["pSortableColumn","role.created_at"],["field","role.created_at"],[1,"text-center",2,"width","8rem"],[1,"table-row",3,"dblclick"],[1,"cell-role"],[1,"cell-role__icon"],[1,"pi","pi-shield"],[1,"cell-role__name"],["severity","info",3,"value"],[1,"cell-secondary"],["icon","pi pi-trash","severity","danger","pTooltip","Supprimer",1,"mr-2",3,"click","text","rounded"],["icon","pi pi-arrow-right","severity","secondary","pTooltip","Modifier",3,"click","text","rounded"],["colspan","4"],[1,"empty-state"],[1,"flex","flex-col","gap-4"],["for","roleName",1,"block","font-bold","mb-2"],["pInputText","","id","roleName","placeholder","Ex: editeur, manager...",1,"w-full",3,"ngModelChange","keydown.enter","ngModel"],["label","Annuler","icon","pi pi-times",3,"click","text","disabled"],["label","Cr\xE9er","icon","pi pi-check",3,"click","disabled","loading"]],template:function(e,r){if(e&1){let i=h();_(0,"p-toast"),s(1,"div",9)(2,"p-toolbar",10),b(3,Ze,1,2,"ng-template",null,0,C)(5,et,1,0,"ng-template",null,1,C),n(),s(7,"p-table",11,2),b(9,tt,6,0,"ng-template",null,3,C)(11,it,13,0,"ng-template",null,4,C)(13,rt,14,11,"ng-template",null,5,C)(15,ot,6,0,"ng-template",null,6,C),n()(),s(17,"p-dialog",12),A("visibleChange",function(c){return d(i),S(r.createDialog,c)||(r.createDialog=c),u(c)}),b(18,nt,5,1,"ng-template",null,7,C)(20,st,2,4,"ng-template",null,8,C),n(),_(22,"p-confirmdialog")}e&2&&(l(7),p("value",r.roles())("rows",10)("paginator",!0)("globalFilterFields",M(15,Je))("tableStyle",M(16,Xe))("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",M(17,Ye))("loading",r.loading),l(10),J(M(18,We)),P("visible",r.createDialog),p("modal",!0),l(5),J(M(19,We)))},dependencies:[E,F,N,V,D,Se,ye,we,Pe,z,W,K,H,Ee,ke,L,U,Ie,Te,Oe,Ae,be,xe,ve,he,Ve,Ne,j,$],styles:[".col-header[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.35rem;font-size:.8rem;font-weight:600;text-transform:uppercase;letter-spacing:.03em;color:var(--p-surface-400)}.table-row[_ngcontent-%COMP%]{cursor:pointer;transition:background .15s ease}.cell-role[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.cell-role__icon[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:.9rem;flex-shrink:0}.cell-role__name[_ngcontent-%COMP%]{font-weight:600;font-size:.9rem;color:var(--p-surface-800);text-transform:capitalize}.cell-secondary[_ngcontent-%COMP%]{color:var(--p-surface-400);font-size:.9rem}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.75rem;padding:3rem 0;color:var(--p-surface-300)}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2.5rem}.empty-state[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.9rem}[_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th{padding:1rem 1.25rem}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:1.1rem 1.25rem}.dark[_nghost-%COMP%]   .cell-role__name[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .cell-role__name[_ngcontent-%COMP%]{color:var(--p-surface-100)}"]})};var at=()=>[1,2,3,4,5];function lt(o,t){if(o&1){let e=h();s(0,"div",8)(1,"input",9),A("ngModelChange",function(i){d(e);let a=m();return S(a.roleName,i)||(a.roleName=i),u(i)}),g("blur",function(){d(e);let i=m();return u(i.saveName())})("keydown.enter",function(){d(e);let i=m();return u(i.saveName())}),n()()}if(o&2){let e=m();l(),P("ngModel",e.roleName),p("disabled",e.originalName==="admin")}}function mt(o,t){o&1&&_(0,"p-skeleton",10)}function ct(o,t){if(o&1){let e=h();s(0,"div",17)(1,"span",18),v(2),ce(3,"uppercase"),n(),s(4,"p-checkbox",19),g("onChange",function(){let i=d(e).$implicit,a=m(2);return u(a.toggleColumn(i))}),n()()}if(o&2){let e=t.$implicit,r=m(2);l(2),y(pe(3,5,e)),l(2),p("binary",!0)("ngModel",r.isColumnAllChecked(e))("indeterminate",r.isColumnIndeterminate(e))("disabled",r.isColumnToggleDisabled(e))}}function pt(o,t){if(o&1){let e=h();s(0,"div",17)(1,"p-checkbox",22),g("onChange",function(){let i=d(e).$implicit,a=m().$implicit,c=m(2);return u(c.togglePermission(a,i))}),n()()}if(o&2){let e=t.$implicit,r=m().$implicit,i=m(2);l(),p("binary",!0)("ngModel",r.permissions[e])("disabled",!i.isActionAllowed(r,e))}}function dt(o,t){if(o&1){let e=h();s(0,"div",20)(1,"div",14)(2,"p-checkbox",19),g("onChange",function(){let i=d(e).$implicit,a=m(2);return u(a.toggleRow(i))}),n(),s(3,"span",21),v(4),n()(),b(5,pt,2,3,"div",15),n()}if(o&2){let e=t.$implicit,r=t.odd,i=m(2);le("permission-matrix__row--alt",r),l(2),p("binary",!0)("ngModel",i.isRowAllChecked(e))("indeterminate",i.isRowIndeterminate(e))("disabled",i.isRowToggleDisabled(e)),l(2),y(e.module),l(),p("ngForOf",i.actions)}}function ut(o,t){if(o&1&&(s(0,"div",0)(1,"h5",11),v(2),n(),s(3,"div",12)(4,"div",13),_(5,"div",14),b(6,ct,5,7,"div",15),n(),b(7,dt,6,8,"div",16),n()()),o&2){let e=m();l(2),me('Permissions du r\xF4le "',e.originalName,'"'),l(4),p("ngForOf",e.actions),l(),p("ngForOf",e.modules)}}function gt(o,t){o&1&&(s(0,"div",25),_(1,"p-skeleton",26)(2,"p-skeleton",27)(3,"p-skeleton",27)(4,"p-skeleton",27)(5,"p-skeleton",27),n())}function _t(o,t){o&1&&(s(0,"div",0),_(1,"p-skeleton",23),b(2,gt,6,0,"div",24),n()),o&2&&(l(2),p("ngForOf",M(1,at)))}var q=class o{constructor(t,e,r,i,a){this.route=t;this.router=e;this.roleService=r;this.messageService=i;this.authService=a}roleId;roleName="";originalName="";modules=[];loading=!0;saving=!1;savingName=!1;availableActionsByModule=new Map;actions=G;ngOnInit(){this.roleId=+this.route.snapshot.params.id,this.loadRole()}loadRole(){this.loading=!0,this.roleService.getRole(this.roleId).subscribe({next:t=>{let e=this.normalizeRolePayload(t?.data);if(!e){this.messageService.add({severity:"error",summary:"Erreur",detail:"Format de r\xE9ponse invalide pour le r\xF4le",life:5e3}),this.loading=!1;return}this.roleName=e.role.name,this.originalName=e.role.name,this.modules=e.modules,this.loadPermissionsCatalog()},error:t=>{this.messageService.add({severity:"error",summary:"Erreur",detail:t?.error?.message||"Impossible de charger le r\xF4le",life:5e3}),this.loading=!1}})}loadPermissionsCatalog(){this.roleService.getPermissions().subscribe({next:t=>{let e=Array.isArray(t?.data)?t.data:[];this.applyPermissionCatalog(e),this.loading=!1},error:()=>{this.modules.length||(this.modules=[]),this.loading=!1}})}applyPermissionCatalog(t){if(!t.length)return;let e=new Map(this.modules.map(i=>[this.normalizeModuleKey(i.module),i]));this.availableActionsByModule.clear();let r=t.map(i=>{let a=this.normalizeModuleKey(i.module),c=e.get(a),f=this.getAllowedActionsFromCatalog(i);return this.availableActionsByModule.set(a,f),e.delete(a),{module:i.module,permissions:{create:f.has("create")?!!c?.permissions?.create:!1,read:f.has("read")?!!c?.permissions?.read:!1,update:f.has("update")?!!c?.permissions?.update:!1,delete:f.has("delete")?!!c?.permissions?.delete:!1}}});e.forEach((i,a)=>{this.availableActionsByModule.set(a,new Set(this.actions)),r.push(i)}),this.modules=r}getAllowedActionsFromCatalog(t){let r=(Array.isArray(t.actions)?t.actions:[]).map(i=>i?.toLowerCase().trim()).filter(i=>this.actions.includes(i));return r.length>0?new Set(r):new Set(this.actions)}normalizeModuleKey(t){return String(t??"").trim().toLowerCase()}normalizeRolePayload(t){let e=t?.data??t;return e?.role?.name?{role:e.role,modules:Array.isArray(e.modules)?e.modules:[]}:e?.name?{role:{id:Number(e.id??this.roleId),name:String(e.name)},modules:Array.isArray(e.modules)?e.modules:[]}:null}togglePermission(t,e){this.isActionAllowed(t,e)&&(t.permissions[e]=!t.permissions[e])}isRowAllChecked(t){let e=this.actions.filter(r=>this.isActionAllowed(t,r));return e.length===0?!1:e.every(r=>t.permissions[r])}isRowIndeterminate(t){let e=this.actions.filter(i=>this.isActionAllowed(t,i));if(e.length===0)return!1;let r=e.filter(i=>t.permissions[i]).length;return r>0&&r<e.length}toggleRow(t){let e=this.actions.filter(i=>this.isActionAllowed(t,i));if(e.length===0)return;let r=this.isRowAllChecked(t);e.forEach(i=>{t.permissions[i]=!r})}isColumnAllChecked(t){let e=this.modules.filter(r=>this.isActionAllowed(r,t));return e.length>0&&e.every(r=>r.permissions[t])}isColumnIndeterminate(t){let e=this.modules.filter(i=>this.isActionAllowed(i,t));if(e.length===0)return!1;let r=e.filter(i=>i.permissions[t]).length;return r>0&&r<e.length}toggleColumn(t){let e=this.modules.filter(i=>this.isActionAllowed(i,t));if(e.length===0)return;let r=this.isColumnAllChecked(t);e.forEach(i=>{i.permissions[t]=!r})}isActionAllowed(t,e){let r=this.availableActionsByModule.get(this.normalizeModuleKey(t.module));return!r||r.size===0?!0:r.has(e)}isRowToggleDisabled(t){return this.actions.every(e=>!this.isActionAllowed(t,e))}isColumnToggleDisabled(t){return!this.modules.some(e=>this.isActionAllowed(e,t))}savePermissions(){if(this.saving)return;this.saving=!0;let t={};this.modules.forEach(r=>{let i=this.actions.filter(a=>this.isActionAllowed(r,a)&&r.permissions[a]);i.length>0&&(t[r.module]=i)});let e={permissions:t};this.roleService.updatePermissions(this.roleId,e).subscribe({next:r=>{this.modules=r.data.modules,this.refreshCurrentUserPermissions(),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Permissions mises \xE0 jour",life:3e3}),this.saving=!1},error:r=>{this.messageService.add({severity:"error",summary:"Erreur",detail:r?.error?.message||"Impossible de sauvegarder les permissions",life:5e3}),this.saving=!1}})}saveName(){this.savingName||!this.roleName.trim()||this.roleName===this.originalName||(this.savingName=!0,this.roleService.updateRole(this.roleId,{name:this.roleName.trim()}).subscribe({next:()=>{this.originalName=this.roleName.trim(),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Nom du r\xF4le mis \xE0 jour",life:3e3}),this.savingName=!1},error:t=>{this.messageService.add({severity:"error",summary:"Erreur",detail:t?.error?.message||"Impossible de renommer le r\xF4le",life:5e3}),this.savingName=!1}}))}refreshCurrentUserPermissions(){this.authService.me().subscribe({next:()=>{},error:()=>{}})}goBack(){this.router.navigate(["/parametres"])}static \u0275fac=function(e){return new(e||o)(x(fe),x(T),x(w),x(R),x(Ce))};static \u0275cmp=O({type:o,selectors:[["app-roles-edit"]],features:[k([R])],decls:10,vars:8,consts:[[1,"card"],[1,"role-header"],[1,"role-header__left"],["icon","pi pi-arrow-left","severity","secondary","pTooltip","Retour",3,"click","text","rounded"],["class","role-header__title",4,"ngIf"],["width","200px","height","2.2rem",4,"ngIf"],["label","Sauvegarder","icon","pi pi-save",3,"click","loading","disabled"],["class","card",4,"ngIf"],[1,"role-header__title"],["pInputText","",1,"role-name-input",3,"ngModelChange","blur","keydown.enter","ngModel","disabled"],["width","200px","height","2.2rem"],[1,"permission-title"],[1,"permission-matrix"],[1,"permission-matrix__header"],[1,"permission-matrix__module-col"],["class","permission-matrix__action-col",4,"ngFor","ngForOf"],["class","permission-matrix__row",3,"permission-matrix__row--alt",4,"ngFor","ngForOf"],[1,"permission-matrix__action-col"],[1,"permission-matrix__action-label"],[3,"onChange","binary","ngModel","indeterminate","disabled"],[1,"permission-matrix__row"],[1,"permission-matrix__module-name"],[3,"onChange","binary","ngModel","disabled"],["width","250px","height","1.5rem","styleClass","mb-6"],["class","flex items-center gap-8 mb-4",4,"ngFor","ngForOf"],[1,"flex","items-center","gap-8","mb-4"],["width","140px","height","1.2rem"],["width","24px","height","24px"]],template:function(e,r){e&1&&(_(0,"p-toast"),s(1,"div",0)(2,"div",1)(3,"div",2)(4,"p-button",3),g("click",function(){return r.goBack()}),n(),b(5,lt,2,2,"div",4)(6,mt,1,0,"p-skeleton",5),n(),s(7,"p-button",6),g("click",function(){return r.savePermissions()}),n()()(),b(8,ut,8,3,"div",7)(9,_t,3,2,"div",7)),e&2&&(l(4),p("text",!0)("rounded",!0),l(),p("ngIf",!r.loading),l(),p("ngIf",r.loading),l(),p("loading",r.saving)("disabled",r.loading||r.saving),l(),p("ngIf",!r.loading),l(),p("ngIf",r.loading))},dependencies:[E,de,ue,F,N,V,D,z,W,K,H,L,U,Re,Me,j,$,Fe,De,ge],styles:[".role-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:1rem}.role-header__left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.role-header__title[_ngcontent-%COMP%]{display:flex;align-items:center}.role-name-input[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;text-transform:capitalize;border:1px solid transparent;background:transparent;padding:.4rem .6rem;border-radius:8px;transition:all .15s ease}.role-name-input[_ngcontent-%COMP%]:hover{border-color:var(--p-surface-200)}.role-name-input[_ngcontent-%COMP%]:focus{border-color:var(--p-primary-500);background:var(--p-surface-0);box-shadow:0 0 0 2px var(--p-primary-100)}.permission-title[_ngcontent-%COMP%]{margin-bottom:1.5rem;font-size:1.1rem;font-weight:600;color:var(--p-surface-800)}.permission-matrix[_ngcontent-%COMP%]{border:1px solid var(--p-surface-100);border-radius:12px;overflow:hidden}.permission-matrix__header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:1rem 1.25rem;background:var(--p-surface-50);border-bottom:1px solid var(--p-surface-100)}.permission-matrix__row[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.85rem 1.25rem;border-bottom:1px solid var(--p-surface-50);transition:background .12s ease}.permission-matrix__row[_ngcontent-%COMP%]:last-child{border-bottom:none}.permission-matrix__row[_ngcontent-%COMP%]:hover{background:var(--p-primary-50)}.permission-matrix__row--alt[_ngcontent-%COMP%]{background:var(--p-surface-0)}.permission-matrix__module-col[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:.75rem;min-width:160px}.permission-matrix__module-name[_ngcontent-%COMP%]{font-weight:500;font-size:.9rem;color:var(--p-surface-700);text-transform:capitalize}.permission-matrix__action-col[_ngcontent-%COMP%]{width:120px;display:flex;flex-direction:column;align-items:center;gap:.35rem;flex-shrink:0}.permission-matrix__action-label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.04em;color:var(--p-surface-400)}.dark[_nghost-%COMP%]   .role-name-input[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .role-name-input[_ngcontent-%COMP%]{color:var(--p-surface-100)}.dark[_nghost-%COMP%]   .role-name-input[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .role-name-input[_ngcontent-%COMP%]:hover{border-color:var(--p-surface-600)}.dark[_nghost-%COMP%]   .role-name-input[_ngcontent-%COMP%]:focus, .dark   [_nghost-%COMP%]   .role-name-input[_ngcontent-%COMP%]:focus{background:var(--p-surface-800);box-shadow:0 0 0 2px var(--p-primary-800)}.dark[_nghost-%COMP%]   .permission-title[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .permission-title[_ngcontent-%COMP%]{color:var(--p-surface-100)}.dark[_nghost-%COMP%]   .permission-matrix[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .permission-matrix[_ngcontent-%COMP%]{border-color:var(--p-surface-700)}.dark[_nghost-%COMP%]   .permission-matrix__header[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .permission-matrix__header[_ngcontent-%COMP%]{background:var(--p-surface-800);border-bottom-color:var(--p-surface-700)}.dark[_nghost-%COMP%]   .permission-matrix__row[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .permission-matrix__row[_ngcontent-%COMP%]{border-bottom-color:var(--p-surface-800)}.dark[_nghost-%COMP%]   .permission-matrix__row[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .permission-matrix__row[_ngcontent-%COMP%]:hover{background:var(--p-surface-800)}.dark[_nghost-%COMP%]   .permission-matrix__module-name[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .permission-matrix__module-name[_ngcontent-%COMP%]{color:var(--p-surface-200)}"]})};var hi=[{path:"",component:Q},{path:"edit/:id",component:q},{path:"**",redirectTo:"/notfound"}];export{hi as default};
