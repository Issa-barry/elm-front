import{a as dt,b as ct,c as ut,d as _t,e as gt,f as ft}from"./chunk-MWSLOWH7.js";import{e as mt}from"./chunk-G3EWAPCI.js";import{a as lt,b as pt}from"./chunk-YN5NEZXT.js";import"./chunk-IQMD5EXF.js";import{a as re}from"./chunk-76H2XSLD.js";import{a as ce,b as ue}from"./chunk-JFBSWTEJ.js";import{a as D}from"./chunk-IUCT6ZC4.js";import{a as st,b as ot}from"./chunk-B343KFHS.js";import{a as at}from"./chunk-BODMXXTX.js";import{a as Ge,b as Ye}from"./chunk-S6GQEZ25.js";import{a as rt,b as nt}from"./chunk-OSPOBHXF.js";import"./chunk-W6ATTUIF.js";import{a as Ze,d as Je,e as Xe,f as $e,k as et}from"./chunk-H3KUFEZW.js";import"./chunk-J2NAM4JI.js";import{a as Qe}from"./chunk-HAPAEHXV.js";import"./chunk-UWQRO6Z5.js";import"./chunk-KBIYZYNQ.js";import"./chunk-PLDQAYOC.js";import"./chunk-OODPPDAJ.js";import{a as tt,b as it}from"./chunk-LBJBWH2H.js";import"./chunk-QRO5GYCP.js";import"./chunk-6XF2XUWF.js";import"./chunk-KMJ4YXQB.js";import"./chunk-BJ3DV25B.js";import"./chunk-CKKBGSMP.js";import"./chunk-UUZ5LIFL.js";import{a as ie}from"./chunk-F3DTTKBG.js";import{a as Ke,b as A,c as He}from"./chunk-6H43JJA3.js";import"./chunk-SIZMBHAK.js";import"./chunk-KE6PKGKV.js";import"./chunk-42H63HPA.js";import{b as Fe,d as F}from"./chunk-7G5MAEGV.js";import{a as q,b as K}from"./chunk-QTD5PLHI.js";import"./chunk-WU36US54.js";import"./chunk-OAY6NCLF.js";import{a as M,d as W}from"./chunk-64S7HSEB.js";import{c as Y,e as Q}from"./chunk-OPAF3U63.js";import"./chunk-QO7YANFN.js";import{c as te,d as qe}from"./chunk-3ZFUBRWI.js";import"./chunk-VV6ELWME.js";import"./chunk-VSD657XK.js";import"./chunk-Z2X2BPAP.js";import{a as Be,c as je}from"./chunk-F4Z36YAX.js";import{a as ee,b as Ne}from"./chunk-OVLHBJZG.js";import{b as Z,e as J,f as Re,g as Le,h as X,i as Ae,p as $}from"./chunk-4JYGVSAH.js";import{a as We,b as ze}from"./chunk-AGXCPBUM.js";import"./chunk-VPIKZKGZ.js";import"./chunk-YNVQ7POR.js";import"./chunk-3QS7CSSK.js";import"./chunk-BODZH67C.js";import"./chunk-7UZYWCAJ.js";import{i as H,j as G}from"./chunk-LBKL4PXF.js";import"./chunk-G5FZIH5E.js";import{la as z,pa as U,ta as De}from"./chunk-5CRI5L3F.js";import{j as ke,k,v as P}from"./chunk-PVTSUL7D.js";import"./chunk-4O3FVBGX.js";import{$b as Ie,Ab as s,Bb as n,Cb as b,Gb as Ue,Hb as Me,Jb as v,La as le,Na as we,Nb as f,Ob as d,Pa as o,T as B,Ua as pe,X as ve,Xb as S,Y as ye,Zb as Te,_a as w,_b as Pe,ac as p,ba as u,bc as h,ca as _,cc as L,db as T,dc as Ve,fc as y,ga as xe,gc as x,hc as C,ic as Oe,jb as g,jc as O,kc as j,oa as Ce,rb as E,ub as Se,uc as me,vb as Ee,wc as de,yc as V,zb as l}from"./chunk-WZ5FQRRG.js";import{a as he,b as be}from"./chunk-GAL4ENT6.js";var I=class a{constructor(t){this.http=t}apiUrl=`${A.apiUrl}/users`;authUrl=`${A.apiUrl}/auth`;createUser(t){return this.http.post(`${this.authUrl}/register`,t)}createUserViaApi(t){return this.http.post(this.apiUrl,t)}getUsers(t){let e=new M;return t&&(t.is_active!==void 0&&(e=e.set("is_active",t.is_active.toString())),t.search&&(e=e.set("search",t.search)),t.pays&&(e=e.set("pays",t.pays)),t.ville&&(e=e.set("ville",t.ville)),t.sort_by&&(e=e.set("sort_by",t.sort_by)),t.sort_order&&(e=e.set("sort_order",t.sort_order)),t.per_page&&(e=e.set("per_page",t.per_page.toString())),t.page&&(e=e.set("page",t.page.toString()))),this.http.get(this.apiUrl,{params:e})}getUser(t){return this.http.get(`${this.apiUrl}/${t}`)}updateUser(t,e){return this.http.put(`${this.apiUrl}/${t}`,e)}toggleUserStatus(t){return this.http.patch(`${this.apiUrl}/${t}/toggle-status`,{})}deleteUser(t){return this.http.delete(`${this.apiUrl}/${t}`)}searchUsers(t){let e=new M().set("search",t);return this.http.get(this.apiUrl,{params:e})}getActiveUsers(){let t=new M().set("is_active","true");return this.http.get(this.apiUrl,{params:t})}getInactiveUsers(){let t=new M().set("is_active","false");return this.http.get(this.apiUrl,{params:t})}getUsersByCountry(t){let e=new M().set("pays",t);return this.http.get(this.apiUrl,{params:e})}getUsersByCity(t){let e=new M().set("ville",t);return this.http.get(this.apiUrl,{params:e})}getUsersPaginated(t=1,e=10,r){let i=new M().set("page",t.toString()).set("per_page",e.toString());return r&&(r.is_active!==void 0&&(i=i.set("is_active",r.is_active.toString())),r.search&&(i=i.set("search",r.search)),r.pays&&(i=i.set("pays",r.pays)),r.ville&&(i=i.set("ville",r.ville)),r.sort_by&&(i=i.set("sort_by",r.sort_by)),r.sort_order&&(i=i.set("sort_order",r.sort_order))),this.http.get(this.apiUrl,{params:i})}sortUsers(t,e="asc"){let r=new M().set("sort_by",t||"created_at").set("sort_order",e);return this.http.get(this.apiUrl,{params:r})}static \u0275fac=function(e){return new(e||a)(ve(W))};static \u0275prov=B({token:a,factory:a.\u0275fac,providedIn:"root"})};var Et=()=>[10,25,50],Ut=()=>["nom_complet","email","phone","reference","pays","ville"],Mt=()=>({"min-width":"150px"});function Tt(a,t){if(a&1){let e=v();s(0,"button",37),f("click",function(i){u(e);let m=d().$implicit,c=d(2);return i.stopPropagation(),_(c.deleteUser(i,m.id))}),n()}a&2&&l("pTooltip","Supprimer")}function Pt(a,t){if(a&1){let e=v();s(0,"article",27),f("click",function(i){let m=u(e).$implicit,c=d(2);return _(c.goToEdit(i,m.id))}),s(1,"div",28),p(2),n(),s(3,"div",29)(4,"div",30),p(5),n(),s(6,"div",31),p(7),me(8,"phoneFormat"),n(),s(9,"div",32),b(10,"p-tag",33),s(11,"div",34)(12,"button",35),f("click",function(i){let m=u(e).$implicit,c=d(2);return _(c.goToEdit(i,m.id))}),n(),g(13,Tt,1,1,"button",36),n()()()()}if(a&2){let e=t.$implicit,r=d(2);o(2),L(" ",r.getInitials(e.nom_complet)," "),o(3),h(e.nom_complet),o(2),h(e.email||de(8,8,e.phone,"INT")),o(3),l("value",e.is_active?"Actif":"Inactif")("severity",e.is_active?"success":"danger"),o(2),l("pTooltip",r.canUpdate?"Modifier":"Voir")("disabled",!r.canUpdate),o(),l("ngIf",r.canDelete)}}function It(a,t){if(a&1&&(s(0,"section",25),g(1,Pt,14,11,"article",26),n()),a&2){let e=d();o(),l("ngForOf",e.mobileVisibleUsers)("ngForTrackBy",e.trackByUserId)}}function Vt(a,t){a&1&&(s(0,"div",39),p(1,"Chargement..."),n())}function Ot(a,t){a&1&&(s(0,"div",39),p(1,"Aucun utilisateur."),n())}function kt(a,t){if(a&1&&g(0,Vt,2,0,"div",38)(1,Ot,2,0,"div",38),a&2){let e=d();l("ngIf",e.loading),o(),l("ngIf",!e.loading&&!e.mobileFilteredUsers.length)}}function Ft(a,t){if(a&1){let e=v();s(0,"div",40)(1,"button",41),f("click",function(){u(e);let i=d();return _(i.loadMoreMobile())}),n()()}}function Dt(a,t){if(a&1){let e=v();s(0,"button",42),f("click",function(){u(e);let i=d();return _(i.navigateToCreate())}),b(1,"i",43),n()}}function Rt(a,t){if(a&1){let e=v();s(0,"button",50),f("click",function(){u(e);let i=d(2);return _(i.navigateToCreate())}),n()}}function Lt(a,t){if(a&1){let e=v();s(0,"div",44)(1,"p-icon-field",45),b(2,"p-inputicon",18),s(3,"input",46),f("input",function(i){u(e);let m=d(),c=S(24);return _(m.onGlobalFilter(c,i))}),n()(),s(4,"div",47)(5,"p-select",48),C("ngModelChange",function(i){u(e);let m=d();return x(m.selectedStatus,i)||(m.selectedStatus=i),_(i)}),f("onChange",function(){u(e);let i=d();return _(i.filterByStatus())}),n(),g(6,Rt,1,0,"button",49),n()()}if(a&2){let e=d();o(5),Pe(j(6,Mt)),l("options",e.statusOptions),y("ngModel",e.selectedStatus),l("showClear",!0),o(),l("ngIf",e.canCreate)}}function At(a,t){a&1&&(s(0,"tr")(1,"th",51)(2,"span",52),p(3," Nom complet "),b(4,"p-sortIcon",53),n()(),s(5,"th",54)(6,"span",52),p(7," T\xE9l\xE9phone "),b(8,"p-sortIcon",55),n()(),s(9,"th",56)(10,"span",52),p(11," R\xF4le "),n()(),s(12,"th",57)(13,"span",52),p(14," Adresse "),b(15,"p-sortIcon",58),n()(),s(16,"th",59)(17,"span",52),p(18," Statut "),b(19,"p-sortIcon",60),n()(),s(20,"th",61),p(21," Actions "),n()())}function Nt(a,t){if(a&1&&b(0,"p-tag",75),a&2){let e=t.$implicit,r=d(3);l("value",e)("severity",r.getRoleSeverity(e))}}function Bt(a,t){if(a&1&&(Ue(0),g(1,Nt,1,2,"p-tag",74),Me()),a&2){let e=d().$implicit;o(),l("ngForOf",e.role_names||e.roles)}}function jt(a,t){a&1&&(s(0,"span",76),p(1,"-"),n())}function Wt(a,t){if(a&1){let e=v();s(0,"button",77),f("click",function(i){u(e);let m=d().$implicit,c=d();return _(c.toggleStatus(i,m.id))}),n()}if(a&2){let e=d().$implicit;Te("p-button-success",e.is_active)("p-button-danger",!e.is_active),l("icon",e.is_active?"pi pi-lock-open":"pi pi-lock")("pTooltip",e.is_active?"D\xE9sactiver":"Activer")}}function zt(a,t){if(a&1){let e=v();s(0,"button",37),f("click",function(i){u(e);let m=d().$implicit,c=d();return _(c.deleteUser(i,m.id))}),n()}a&2&&l("pTooltip","Supprimer")}function qt(a,t){if(a&1){let e=v();s(0,"tr",62)(1,"td")(2,"div",52)(3,"div",63),p(4),n(),s(5,"div")(6,"div",64),p(7),n(),s(8,"div",65),p(9),n()()()(),s(10,"td")(11,"div",66)(12,"span",67),p(13),me(14,"phoneFormat"),n()()(),s(15,"td"),g(16,Bt,2,1,"ng-container",68)(17,jt,2,0,"ng-template",null,7,V),n(),s(19,"td")(20,"div",52),b(21,"span"),s(22,"div")(23,"div",69),p(24),n(),s(25,"div",70),p(26),n()()()(),s(27,"td"),b(28,"p-tag",71),n(),s(29,"td")(30,"div",72)(31,"button",35),f("click",function(i){let m=u(e).$implicit,c=d();return _(c.goToEdit(i,m.id))}),n(),g(32,Wt,1,6,"button",73)(33,zt,1,1,"button",36),n()()()}if(a&2){let e=t.$implicit,r=S(18),i=d();l("pSelectableRow",e),o(4),L(" ",i.getInitials(e.nom_complet)," "),o(3),h(e.nom_complet),o(2),h(e.reference),o(4),h(de(14,18,e.phone,"INT")),o(3),l("ngIf",(e.role_names==null?null:e.role_names.length)||(e.roles==null?null:e.roles.length))("ngIfElse",r),o(5),Ie(Oe("fi fi-",e.code_pays==null?null:e.code_pays.toLowerCase()," text-xl")),o(3),h(e.ville),o(2),h(e.quartier),o(2),l("value",e.is_active?"Actif":"Inactif")("severity",e.is_active?"success":"danger"),o(3),l("pTooltip",i.canUpdate?"Modifier":"Voir")("disabled",!i.canUpdate),o(),l("ngIf",i.canUpdate),o(),l("ngIf",i.canDelete)}}function Kt(a,t){a&1&&(s(0,"tr")(1,"td",78)(2,"div",79),b(3,"i",80),s(4,"span"),p(5,"Aucun utilisateur trouv\xE9"),n()()()())}var ne=class a{constructor(t,e,r,i,m,c){this.userService=t;this.router=e;this.messageService=r;this.confirmationService=i;this.authService=m;this.document=c;this.canCreate=this.authService.hasPermission("users.create"),this.canUpdate=this.authService.hasPermission("users.update"),this.canDelete=this.authService.hasPermission("users.delete")}users=[];selectedUser=null;loading=!1;selectedStatus=null;mobileSearchTerm="";mobilePageSize=10;mobileVisibleCount=this.mobilePageSize;mobileBreakpoint=768;mobilePwaClass="utilisateurs-mobile-pwa";statusOptions=[{label:"Actif",value:!0},{label:"Inactif",value:!1}];mobileStatusMenuItems=[{label:"Tous les statuts",command:()=>this.applyMobileStatusFilter(null)},{label:"Actif",command:()=>this.applyMobileStatusFilter(!0)},{label:"Inactif",command:()=>this.applyMobileStatusFilter(!1)}];canCreate=!1;canUpdate=!1;canDelete=!1;ngOnInit(){this.loadUsers(),this.syncMobilePwaMode()}ngOnDestroy(){this.document.body.classList.remove(this.mobilePwaClass)}onWindowResize(){this.syncMobilePwaMode()}goHome(){this.router.navigate(["/"])}onMobileSearchChange(){this.mobileVisibleCount=this.mobilePageSize}get mobileFilteredUsers(){let t=this.mobileSearchTerm.trim().toLowerCase();return t?this.users.filter(e=>e.nom_complet&&e.nom_complet.toLowerCase().includes(t)||e.email&&e.email.toLowerCase().includes(t)||e.phone&&e.phone.replace(/\s/g,"").includes(t)||e.reference&&e.reference.toLowerCase().includes(t)):this.users}get mobileVisibleUsers(){return this.mobileFilteredUsers.slice(0,this.mobileVisibleCount)}get canLoadMoreMobile(){return this.mobileVisibleCount<this.mobileFilteredUsers.length}loadMoreMobile(){this.mobileVisibleCount+=this.mobilePageSize}trackByUserId(t,e){return e.id}syncMobilePwaMode(){typeof window>"u"||(window.innerWidth<=this.mobileBreakpoint?this.document.body.classList.add(this.mobilePwaClass):this.document.body.classList.remove(this.mobilePwaClass))}loadUsers(){this.loading=!0;let t=this.selectedStatus!==null?{is_active:this.selectedStatus}:void 0;this.userService.getUsers(t).subscribe({next:e=>{e.success&&(this.users=Array.isArray(e.data)?e.data:e.data.data,this.mobileVisibleCount=this.mobilePageSize),this.loading=!1},error:e=>{console.error("Erreur lors du chargement des utilisateurs:",e),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger les utilisateurs"}),this.loading=!1}})}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}filterByStatus(){this.loadUsers()}applyMobileStatusFilter(t){this.selectedStatus=t,this.loadUsers()}navigateToCreate(){this.router.navigate(["contacts/utilisateurs/new"])}onRowSelect(t){this.router.navigate(["contacts/utilisateurs/edit",t.data.id])}goToEdit(t,e){t.stopPropagation(),this.router.navigate(["contacts/utilisateurs/edit/",e])}toggleStatus(t,e){t.stopPropagation();let i=this.users.find(m=>m.id===e)?.is_active?"d\xE9sactiver":"activer";this.confirmationService.confirm({message:`Voulez-vous vraiment ${i} cet utilisateur ?`,header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>{this.userService.toggleUserStatus(e).subscribe({next:m=>{m.success&&(this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:m.message}),this.loadUsers())},error:m=>{console.error("Erreur:",m),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de changer le statut de l'utilisateur"})}})}})}deleteUser(t,e){t.stopPropagation(),this.confirmationService.confirm({message:"\xCAtes-vous s\xFBr de vouloir supprimer cet utilisateur ? Cette action est irr\xE9versible.",header:"Confirmation de suppression",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui, supprimer",rejectLabel:"Annuler",acceptButtonStyleClass:"p-button-danger",accept:()=>{this.userService.deleteUser(e).subscribe({next:r=>{r.success&&(this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Utilisateur supprim\xE9 avec succ\xE8s"}),this.loadUsers())},error:r=>{console.error("Erreur:",r),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de supprimer l'utilisateur"})}})}})}getInitials(t){if(!t)return"??";let e=t.trim().split(" ");return e.length>=2?(e[0][0]+e[e.length-1][0]).toUpperCase():t.substring(0,2).toUpperCase()}getRoleSeverity(t){return{admin:"danger",manager:"warn",employe:"info",superviseur:"success"}[t?.toLowerCase()]||"secondary"}static \u0275fac=function(e){return new(e||a)(w(I),w(F),w(U),w(z),w(He),w(xe))};static \u0275cmp=T({type:a,selectors:[["app-utilisateurs-liste"]],hostBindings:function(e,r){e&1&&f("resize",function(){return r.onWindowResize()},we)},features:[O([U,z])],decls:33,vars:20,consts:[["statusMenu",""],["mobileListState",""],["dt",""],["caption",""],["header",""],["body",""],["emptymessage",""],["noRole",""],[1,"utilisateurs-mobile-app"],[1,"mobile-header"],["pButton","","pRipple","","icon","pi pi-arrow-left","aria-label","Retour \xE0 l'accueil",1,"p-button-rounded","p-button-text","mobile-back",3,"click"],[1,"mobile-title-wrap"],[1,"mobile-title"],[1,"mobile-subtitle"],["appendTo","body","styleClass","mobile-status-menu",3,"model","popup"],["pButton","","pRipple","","icon","pi pi-filter","aria-label","Filtrer par statut",1,"p-button-rounded","p-button-text","mobile-add",3,"click"],[1,"mobile-scroll"],[1,"mobile-search"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Nom, email, t\xE9l\xE9phone...",1,"w-full",3,"ngModelChange","ngModel"],["class","mobile-list",4,"ngIf","ngIfElse"],["class","mobile-load-more",4,"ngIf"],["type","button","class","mobile-fab","aria-label","Nouveau utilisateur",3,"click",4,"ngIf"],[1,"card","utilisateurs-desktop"],["paginatorDropdownAppendTo","body","responsiveLayout","scroll","currentPageReportTemplate","  {first} / {last} de {totalRecords} entr\xE9es","selectionMode","single","styleClass","cursor-pointer",3,"selectionChange","onRowSelect","value","paginator","rows","showCurrentPageReport","loading","rowsPerPageOptions","globalFilterFields","selection","rowHover"],[1,"mobile-list"],["class","mobile-user-card",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mobile-user-card",3,"click"],["aria-hidden","true",1,"mobile-card-avatar"],[1,"mobile-card-body"],[1,"mobile-card-name"],[1,"mobile-card-meta"],[1,"mobile-card-footer"],["styleClass","mobile-status-tag",3,"value","severity"],[1,"mobile-card-actions"],["pButton","","pRipple","","icon","pi pi-eye","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","pTooltip","disabled"],["pButton","","pRipple","","icon","pi pi-trash","class","p-button-rounded p-button-text p-button-danger p-button-sm","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-trash","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-danger","p-button-sm",3,"click","pTooltip"],["class","mobile-state",4,"ngIf"],[1,"mobile-state"],[1,"mobile-load-more"],["pButton","","label","Charger plus","icon","pi pi-angle-down",1,"mobile-load-more-btn",3,"click"],["type","button","aria-label","Nouveau utilisateur",1,"mobile-fab",3,"click"],[1,"pi","pi-user-plus"],[1,"flex","flex-wrap","gap-2","items-center","justify-between"],[1,"w-full","sm:w-80","order-1","sm:order-0"],["pInputText","","type","text","placeholder","Rechercher un utilisateur...",1,"w-full",3,"input"],[1,"flex","gap-2","w-full","sm:w-auto","flex-order-0","sm:flex-order-1"],["placeholder","Tous les statuts",3,"ngModelChange","onChange","options","ngModel","showClear"],["pButton","","outlined","","class","flex-shrink-0","icon","pi pi-user-plus","label","Nouveau",3,"click",4,"ngIf"],["pButton","","outlined","","icon","pi pi-user-plus","label","Nouveau",1,"flex-shrink-0",3,"click"],["pSortableColumn","nom_complet",1,"white-space-nowrap",2,"width","25%"],[1,"flex","items-center","gap-2"],["field","nom_complet"],["pSortableColumn","phone",1,"white-space-nowrap",2,"width","15%"],["field","phone"],[1,"white-space-nowrap",2,"width","12%"],["pSortableColumn","pays",1,"white-space-nowrap",2,"width","18%"],["field","pays"],["pSortableColumn","is_active",1,"white-space-nowrap",2,"width","10%"],["field","is_active"],[1,"white-space-nowrap",2,"width","10%"],[3,"pSelectableRow"],[1,"flex","items-center","justify-center","w-10","h-10","rounded-full","bg-primary-100","text-primary-700","font-semibold"],[1,"font-semibold"],[1,"text-sm","text-surface-500","mt-1"],[1,"flex","items-center","gap-1"],[1,"text-surface-700"],[4,"ngIf","ngIfElse"],[1,"font-medium"],[1,"text-sm","text-surface-500"],[3,"value","severity"],[1,"flex","gap-2"],["pButton","","pRipple","","class","p-button-rounded p-button-text p-button-sm","tooltipPosition","top",3,"icon","p-button-success","p-button-danger","pTooltip","click",4,"ngIf"],["class","mr-1",3,"value","severity",4,"ngFor","ngForOf"],[1,"mr-1",3,"value","severity"],[1,"text-surface-400"],["pButton","","pRipple","","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","icon","pTooltip"],["colspan","6",1,"text-center","py-8"],[1,"flex","flex-col","items-center","gap-3","text-surface-500"],[1,"pi","pi-users","text-4xl"]],template:function(e,r){if(e&1){let i=v();b(0,"p-confirmDialog"),s(1,"div",8)(2,"header",9)(3,"button",10),f("click",function(){return u(i),_(r.goHome())}),n(),s(4,"div",11)(5,"h1",12),p(6,"Utilisateurs"),n(),s(7,"p",13),p(8),n()(),b(9,"p-menu",14,0),s(11,"button",15),f("click",function(c){u(i);let xt=S(10);return _(xt.toggle(c))}),n()(),s(12,"div",16)(13,"section",17)(14,"p-icon-field"),b(15,"p-inputicon",18),s(16,"input",19),C("ngModelChange",function(c){return u(i),x(r.mobileSearchTerm,c)||(r.mobileSearchTerm=c),_(c)}),f("ngModelChange",function(){return u(i),_(r.onMobileSearchChange())}),n()()(),g(17,It,2,2,"section",20)(18,kt,2,2,"ng-template",null,1,V)(20,Ft,2,0,"div",21),n(),g(21,Dt,2,0,"button",22),n(),s(22,"div",23)(23,"p-table",24,2),C("selectionChange",function(c){return u(i),x(r.selectedUser,c)||(r.selectedUser=c),_(c)}),f("onRowSelect",function(c){return u(i),_(r.onRowSelect(c))}),g(25,Lt,7,7,"ng-template",null,3,V)(27,At,22,0,"ng-template",null,4,V)(29,qt,34,21,"ng-template",null,5,V)(31,Kt,6,0,"ng-template",null,6,V),n()()}if(e&2){let i=S(19);o(8),Ve("",r.mobileFilteredUsers.length," utilisateur",r.mobileFilteredUsers.length!==1?"s":""),o(),l("model",r.mobileStatusMenuItems)("popup",!0),o(7),y("ngModel",r.mobileSearchTerm),o(),l("ngIf",!r.loading&&r.mobileVisibleUsers.length)("ngIfElse",i),o(3),l("ngIf",!r.loading&&r.canLoadMoreMobile),o(),l("ngIf",r.canCreate),o(2),l("value",r.users)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("loading",r.loading)("rowsPerPageOptions",j(18,Et))("globalFilterFields",j(19,Ut)),y("selection",r.selectedUser),l("rowHover",!0)}},dependencies:[P,ke,k,$,Z,J,X,et,Ze,Je,$e,Xe,Ne,ee,Q,Y,G,H,Be,je,it,tt,ze,We,qe,te,nt,rt,Ye,Ge,at],styles:["[_nghost-%COMP%]{display:block}.utilisateurs-mobile-app[_ngcontent-%COMP%]{display:none}@media screen and (max-width: 768px){[_nghost-%COMP%]{--mobile-primary: #5f6bff;--mobile-text: #334155;--mobile-muted: #7f8ca3;--mobile-card: #ffffff;--mobile-border: #e2e8f0}.utilisateurs-desktop[_ngcontent-%COMP%]{display:none}.utilisateurs-mobile-app[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;min-height:100dvh;height:100vh;height:100dvh;overflow:hidden;margin-top:calc(-.25rem - env(safe-area-inset-top));margin-left:-.875rem;margin-right:-.875rem;margin-bottom:calc(-.875rem - env(safe-area-inset-bottom));padding:0 .875rem env(safe-area-inset-bottom);padding-left:calc(.875rem + env(safe-area-inset-left));padding-right:calc(.875rem + env(safe-area-inset-right));background:#f8fafc;animation:_ngcontent-%COMP%_mobileFade .24s ease-out}.mobile-header[_ngcontent-%COMP%]{flex-shrink:0;display:flex;align-items:center;gap:.55rem;margin:0 -.875rem;padding:calc(.5rem + env(safe-area-inset-top)) calc(.875rem + env(safe-area-inset-right)) .6rem calc(.875rem + env(safe-area-inset-left));background:var(--mobile-card);border-bottom:1px solid var(--mobile-border);box-shadow:0 1px 3px #0f172a0f;position:sticky;top:0;z-index:30}.mobile-scroll[_ngcontent-%COMP%]{flex:1;min-height:0;overflow-y:auto;-webkit-overflow-scrolling:touch;padding-top:.75rem;padding-bottom:calc(4rem + env(safe-area-inset-bottom))}.mobile-back[_ngcontent-%COMP%], .mobile-add[_ngcontent-%COMP%]{width:2.25rem;height:2.25rem;border-radius:50%;flex-shrink:0;color:var(--mobile-primary)!important;background:#5f6bff1a!important}.mobile-title-wrap[_ngcontent-%COMP%]{flex:1;min-width:0;text-align:center}.mobile-title[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:700;color:var(--mobile-text)}.mobile-subtitle[_ngcontent-%COMP%]{margin:.15rem 0 0;font-size:.8rem;font-weight:500;color:var(--mobile-muted)}.mobile-search[_ngcontent-%COMP%]{background:var(--mobile-card);border:1px solid var(--mobile-border);border-radius:.75rem;padding:.4rem .6rem}.mobile-search[_ngcontent-%COMP%]   .p-iconfield[_ngcontent-%COMP%], .mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]{width:100%}.mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]{border:0;box-shadow:none;background:transparent;font-size:.95rem}.mobile-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.6rem;margin-top:1rem}.mobile-user-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.875rem;background:var(--mobile-card);border:1px solid var(--mobile-border);border-radius:.875rem;padding:.875rem;box-shadow:0 1px 3px #0000000d;cursor:pointer;transition:box-shadow .2s ease}.mobile-user-card[_ngcontent-%COMP%]:active{box-shadow:0 2px 8px #00000014}.mobile-card-avatar[_ngcontent-%COMP%]{width:2.75rem;height:2.75rem;min-width:2.75rem;min-height:2.75rem;border-radius:50%;background:linear-gradient(135deg,var(--mobile-primary) 0%,#7c8aff 100%);color:#fff;font-size:.8rem;font-weight:700;display:flex;align-items:center;justify-content:center}.mobile-card-body[_ngcontent-%COMP%]{flex:1;min-width:0}.mobile-card-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:var(--mobile-text);line-height:1.3}.mobile-card-meta[_ngcontent-%COMP%]{font-size:.85rem;color:var(--mobile-muted);margin-top:.2rem}.mobile-card-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:.5rem;margin-top:.5rem;flex-wrap:wrap}.mobile-card-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.mobile-card-actions[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]{width:2rem;height:2rem}[_nghost-%COMP%]     .mobile-status-tag{font-size:.75rem;padding:.2rem .5rem;border-radius:999px}.mobile-state[_ngcontent-%COMP%]{margin-top:1rem;background:var(--mobile-card);border:1px dashed var(--mobile-border);border-radius:.875rem;padding:1.5rem;text-align:center;color:var(--mobile-muted);font-size:.9rem}.mobile-load-more[_ngcontent-%COMP%]{padding-top:.5rem}.mobile-load-more-btn[_ngcontent-%COMP%]{width:100%;border-radius:999px;font-weight:600}.mobile-fab[_ngcontent-%COMP%]{position:fixed;bottom:calc(1rem + env(safe-area-inset-bottom));right:calc(1rem + env(safe-area-inset-right));z-index:25;width:3.5rem;height:3.5rem;min-width:3.5rem;min-height:3.5rem;padding:0;border:none;border-radius:50%;background:var(--mobile-primary);color:#fff;box-shadow:0 4px 14px #5f6bff66;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease;-webkit-tap-highlight-color:transparent}.mobile-fab[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1.35rem}.mobile-fab[_ngcontent-%COMP%]:active{transform:scale(.96)}.app-dark   [_nghost-%COMP%]{--mobile-primary: var(--p-primary-400);--mobile-text: var(--p-surface-100);--mobile-muted: var(--p-surface-400);--mobile-card: var(--p-surface-800);--mobile-border: var(--p-surface-600)}.app-dark[_nghost-%COMP%]   .utilisateurs-mobile-app[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .utilisateurs-mobile-app[_ngcontent-%COMP%]{background:var(--p-surface-950)}.app-dark[_nghost-%COMP%]   .mobile-header[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-header[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0003}.app-dark[_nghost-%COMP%]   .mobile-user-card[_ngcontent-%COMP%]:active, .app-dark   [_nghost-%COMP%]   .mobile-user-card[_ngcontent-%COMP%]:active{box-shadow:0 2px 8px #00000040}.app-dark[_nghost-%COMP%]   .mobile-state[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-state[_ngcontent-%COMP%]{background:var(--p-surface-800);border-color:var(--p-surface-600);color:var(--p-surface-400)}}@keyframes _ngcontent-%COMP%_mobileFade{0%{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}"]})};var vt={M:"M.",Mme:"Mme",Mlle:"Mlle"},yt={cni:"Carte nationale d'identit\xE9",passeport:"Passeport",permis:"Permis de conduire",carte_sejour:"Carte de s\xE9jour"};function Gt(a,t){a&1&&(s(0,"p-step",15),p(1,"Pi\xE8ce d'identit\xE9"),n()),a&2&&l("value",5)}function Yt(a,t){a&1&&(s(0,"span",32),p(1,"*"),n())}function Qt(a,t){if(a&1&&(s(0,"div",33),b(1,"img",34),s(2,"span",35),p(3),n(),s(4,"span"),p(5),n()()),a&2){let e=t.$implicit;o(),l("src",e.flag,le)("alt",e.name),o(2),h(e.dialCode),o(2),h(e.name)}}function Zt(a,t){if(a&1&&(s(0,"div",33),b(1,"img",34),s(2,"span",35),p(3),n(),s(4,"span"),p(5),n()()),a&2){let e=d().$implicit;o(),l("src",e.flag,le)("alt",e.name),o(2),h(e.dialCode),o(2),h(e.name)}}function Jt(a,t){if(a&1&&g(0,Zt,6,4,"div",36),a&2){let e=t.$implicit;l("ngIf",e)}}function Xt(a,t){a&1&&(s(0,"small",37),p(1,"Pays obligatoire."),n())}function $t(a,t){a&1&&(s(0,"span",32),p(1,"*"),n())}function ei(a,t){a&1&&(s(0,"small",38),p(1,"T\xE9l\xE9phone obligatoire."),n())}function ti(a,t){if(a&1&&(s(0,"small",39),p(1),n()),a&2){let e=d(2);o(),h(e.phoneError)}}function ii(a,t){if(a&1){let e=v();s(0,"div",40)(1,"button",41),f("click",function(){u(e);let i=d(2);return _(i.onCancel())}),n(),s(2,"button",42),f("click",function(){u(e);let i=d(2);return _(i.goNext())}),n()()}if(a&2){let e=d(2);o(),l("disabled",e.loading),o(),l("disabled",!e.isStep1Valid()||e.formDisabled)}}function ri(a,t){if(a&1){let e=v();s(0,"section",18)(1,"div",19)(2,"div",20)(3,"label",21),p(4,"Pays "),g(5,Yt,2,0,"span",22),n(),s(6,"p-select",23,0),C("ngModelChange",function(i){u(e);let m=d();return x(m.phoneCountry,i)||(m.phoneCountry=i),_(i)}),f("onCountryChange",function(){u(e);let i=d();return _(i.onCountryChange())}),g(8,Qt,6,4,"ng-template",24)(9,Jt,1,1,"ng-template",25),n(),g(10,Xt,2,0,"small",26),n(),s(11,"div",20)(12,"label",27),p(13,"T\xE9l\xE9phone "),g(14,$t,2,0,"span",22),n(),s(15,"input",28,1),C("ngModelChange",function(i){u(e);let m=d();return x(m.model.phone,i)||(m.model.phone=i),_(i)}),f("input",function(){u(e);let i=d();return _(i.onPhoneInput())})("blur",function(){u(e);let i=d();return _(i.onPhoneBlur())}),n(),g(17,ei,2,0,"small",29)(18,ti,2,1,"small",30),n()()(),g(19,ii,3,2,"div",31)}if(a&2){let e=S(7),r=S(16),i=d();o(5),l("ngIf",i.isEditing),o(),y("ngModel",i.phoneCountry),l("options",i.countries)("disabled",i.fieldsDisabled)("appendTo","body"),E("aria-invalid",(i.submitted||e.touched||e.dirty)&&!i.phoneCountry),o(4),l("ngIf",(i.submitted||e.touched||e.dirty)&&!i.phoneCountry&&i.isEditing),o(4),l("ngIf",i.isEditing),o(),y("ngModel",i.model.phone),l("invalid",(i.submitted||r.touched||r.dirty||i.phoneError)&&(!(i.model.phone!=null&&i.model.phone.trim())||!!i.phoneError))("disabled",i.fieldsDisabled),E("aria-invalid",(i.submitted||r.touched||r.dirty)&&(!(i.model.phone!=null&&i.model.phone.trim())||!!i.phoneError))("aria-describedby",i.phoneError||!(i.model.phone!=null&&i.model.phone.trim())?"phone-error":null),o(2),l("ngIf",(i.submitted||r.touched||r.dirty)&&!(i.model.phone!=null&&i.model.phone.trim())&&i.isEditing),o(),l("ngIf",(i.submitted||r.touched||r.dirty)&&i.phoneError&&(i.model.phone==null?null:i.model.phone.trim())&&i.isEditing),o(),l("ngIf",i.isEditing)}}function ni(a,t){a&1&&(s(0,"span",32),p(1,"*"),n())}function ai(a,t){a&1&&(s(0,"small",48),p(1,"Type de compte obligatoire."),n())}function si(a,t){a&1&&(s(0,"span",32),p(1,"*"),n())}function oi(a,t){a&1&&(s(0,"small",52),p(1,"R\xF4le obligatoire."),n())}function li(a,t){if(a&1){let e=v();s(0,"div",20)(1,"label",49),p(2,"R\xF4le "),g(3,si,2,0,"span",22),n(),s(4,"p-select",50,3),C("ngModelChange",function(i){u(e);let m=d(2);return x(m.model.role,i)||(m.model.role=i),_(i)}),n(),g(6,oi,2,0,"small",51),n()}if(a&2){let e=S(5),r=d(2);o(3),l("ngIf",r.isEditing),o(),y("ngModel",r.model.role),l("options",r.filteredRoles)("appendTo","body")("disabled",r.fieldsDisabled)("invalid",(r.submitted||e.touched||e.dirty)&&!r.model.role),E("aria-invalid",(r.submitted||e.touched||e.dirty)&&!r.model.role),o(2),l("ngIf",(r.submitted||e.touched||e.dirty)&&!r.model.role&&r.isEditing)}}function pi(a,t){if(a&1){let e=v();s(0,"div",53)(1,"button",54),f("click",function(){u(e);let i=d(2);return _(i.goPrev())}),n(),s(2,"div",55)(3,"button",41),f("click",function(){u(e);let i=d(2);return _(i.onCancel())}),n(),s(4,"button",42),f("click",function(){u(e);let i=d(2);return _(i.goNext())}),n()()()}if(a&2){let e=d(2);o(),l("disabled",e.loading),o(2),l("disabled",e.loading),o(),l("disabled",!e.isStep2Valid()||e.formDisabled)}}function mi(a,t){if(a&1){let e=v();s(0,"section",18)(1,"div",19)(2,"div",20)(3,"label",43),p(4,"Type de compte "),g(5,ni,2,0,"span",22),n(),s(6,"p-select",44,2),C("ngModelChange",function(i){u(e);let m=d();return x(m.model.type,i)||(m.model.type=i),_(i)}),f("onChange",function(){u(e);let i=d();return _(i.onTypeChange())}),n(),g(8,ai,2,0,"small",45),n(),g(9,li,7,8,"div",46),n()(),g(10,pi,5,3,"div",47)}if(a&2){let e=S(7),r=d();o(5),l("ngIf",r.isEditing),o(),y("ngModel",r.model.type),l("options",r.userTypeOptions)("disabled",r.fieldsDisabled)("invalid",(r.submitted||e.touched||e.dirty)&&!r.model.type)("appendTo","body"),E("aria-invalid",(r.submitted||e.touched||e.dirty)&&!r.model.type),o(2),l("ngIf",(r.submitted||e.touched||e.dirty)&&!r.model.type&&r.isEditing),o(),l("ngIf",r.isRoleSelectable),o(),l("ngIf",r.isEditing)}}function di(a,t){a&1&&(s(0,"span",32),p(1,"*"),n())}function ci(a,t){a&1&&(s(0,"small",68),p(1,"Nom obligatoire."),n())}function ui(a,t){a&1&&(s(0,"span",32),p(1,"*"),n())}function _i(a,t){a&1&&(s(0,"small",69),p(1,"Pr\xE9nom obligatoire."),n())}function gi(a,t){a&1&&(s(0,"span",32),p(1,"*"),n())}function fi(a,t){a&1&&(s(0,"small",70),p(1,"Ville obligatoire."),n())}function hi(a,t){a&1&&(s(0,"span",32),p(1,"*"),n())}function bi(a,t){a&1&&(s(0,"small",71),p(1,"Quartier obligatoire."),n())}function vi(a,t){if(a&1){let e=v();s(0,"div",53)(1,"button",54),f("click",function(){u(e);let i=d(2);return _(i.goPrev())}),n(),s(2,"div",55)(3,"button",41),f("click",function(){u(e);let i=d(2);return _(i.onCancel())}),n(),s(4,"button",42),f("click",function(){u(e);let i=d(2);return _(i.goNext())}),n()()()}if(a&2){let e=d(2);o(),l("disabled",e.loading),o(2),l("disabled",e.loading),o(),l("disabled",!e.isStep3Valid()||e.formDisabled)}}function yi(a,t){if(a&1){let e=v();s(0,"section",18)(1,"div",19)(2,"div",20)(3,"label",56),p(4,"Nom "),g(5,di,2,0,"span",22),n(),s(6,"input",57,4),C("ngModelChange",function(i){u(e);let m=d();return x(m.model.nom,i)||(m.model.nom=i),_(i)}),n(),g(8,ci,2,0,"small",58),n(),s(9,"div",20)(10,"label",59),p(11,"Pr\xE9nom "),g(12,ui,2,0,"span",22),n(),s(13,"input",60,5),C("ngModelChange",function(i){u(e);let m=d();return x(m.model.prenom,i)||(m.model.prenom=i),_(i)}),n(),g(15,_i,2,0,"small",61),n(),s(16,"div",20)(17,"label",62),p(18,"Ville "),g(19,gi,2,0,"span",22),n(),s(20,"input",63,6),C("ngModelChange",function(i){u(e);let m=d();return x(m.model.ville,i)||(m.model.ville=i),_(i)}),n(),g(22,fi,2,0,"small",64),n(),s(23,"div",20)(24,"label",65),p(25,"Quartier "),g(26,hi,2,0,"span",22),n(),s(27,"input",66,7),C("ngModelChange",function(i){u(e);let m=d();return x(m.model.quartier,i)||(m.model.quartier=i),_(i)}),n(),g(29,bi,2,0,"small",67),n()()(),g(30,vi,5,3,"div",47)}if(a&2){let e=S(7),r=S(14),i=S(21),m=S(28),c=d();o(5),l("ngIf",c.isEditing),o(),y("ngModel",c.model.nom),l("invalid",(c.submitted||e.touched||e.dirty)&&!(c.model.nom!=null&&c.model.nom.trim()))("disabled",c.fieldsDisabled),E("aria-invalid",(c.submitted||e.touched||e.dirty)&&!(c.model.nom!=null&&c.model.nom.trim())),o(2),l("ngIf",(c.submitted||e.touched||e.dirty)&&!(c.model.nom!=null&&c.model.nom.trim())&&c.isEditing),o(4),l("ngIf",c.isEditing),o(),y("ngModel",c.model.prenom),l("invalid",(c.submitted||r.touched||r.dirty)&&!(c.model.prenom!=null&&c.model.prenom.trim()))("disabled",c.fieldsDisabled),E("aria-invalid",(c.submitted||r.touched||r.dirty)&&!(c.model.prenom!=null&&c.model.prenom.trim())),o(2),l("ngIf",(c.submitted||r.touched||r.dirty)&&!(c.model.prenom!=null&&c.model.prenom.trim())&&c.isEditing),o(4),l("ngIf",c.isEditing),o(),y("ngModel",c.model.ville),l("invalid",(c.submitted||i.touched||i.dirty)&&!(c.model.ville!=null&&c.model.ville.trim()))("disabled",c.fieldsDisabled),E("aria-invalid",(c.submitted||i.touched||i.dirty)&&!(c.model.ville!=null&&c.model.ville.trim())),o(2),l("ngIf",(c.submitted||i.touched||i.dirty)&&!(c.model.ville!=null&&c.model.ville.trim())&&c.isEditing),o(4),l("ngIf",c.isEditing),o(),y("ngModel",c.model.quartier),l("invalid",(c.submitted||m.touched||m.dirty)&&!(c.model.quartier!=null&&c.model.quartier.trim()))("disabled",c.fieldsDisabled),E("aria-invalid",(c.submitted||m.touched||m.dirty)&&!(c.model.quartier!=null&&c.model.quartier.trim())),o(2),l("ngIf",(c.submitted||m.touched||m.dirty)&&!(c.model.quartier!=null&&c.model.quartier.trim())&&c.isEditing),o(),l("ngIf",c.isEditing)}}function xi(a,t){if(a&1&&(s(0,"small",79),p(1),n()),a&2){let e=d(3);o(),h(e.passwordError)}}function Ci(a,t){if(a&1){let e=v();s(0,"div",72)(1,"label",76),p(2,"Mot de passe "),s(3,"span",32),p(4,"*"),n()(),s(5,"p-password",77,8),C("ngModelChange",function(i){u(e);let m=d(2);return x(m.model.password,i)||(m.model.password=i),_(i)}),n(),g(7,xi,2,1,"small",78),n()}if(a&2){let e=S(6),r=d(2);o(5),y("ngModel",r.model.password),l("toggleMask",!0)("feedback",!0)("invalid",(r.submitted||e.touched||e.dirty)&&!!r.passwordError)("disabled",r.fieldsDisabled),E("aria-invalid",(r.submitted||e.touched||e.dirty)&&!!r.passwordError),o(2),l("ngIf",(r.submitted||e.touched||e.dirty)&&r.passwordError&&r.isEditing)}}function wi(a,t){if(a&1){let e=v();s(0,"div",53)(1,"button",54),f("click",function(){u(e);let i=d(2);return _(i.goPrev())}),n(),s(2,"div",55)(3,"button",41),f("click",function(){u(e);let i=d(2);return _(i.onCancel())}),n(),s(4,"button",42),f("click",function(){u(e);let i=d(2);return _(i.goNext())}),n()()()}if(a&2){let e=d(2);o(),l("disabled",e.loading),o(2),l("disabled",e.loading),o(),l("disabled",!e.isStep4Valid()||e.loading||e.formDisabled)}}function Si(a,t){if(a&1){let e=v();s(0,"section",18)(1,"div",19)(2,"div",72)(3,"label",73),p(4,"Email"),n(),s(5,"input",74),C("ngModelChange",function(i){u(e);let m=d();return x(m.model.email,i)||(m.model.email=i),_(i)}),n()(),g(6,Ci,8,7,"div",75),n()(),g(7,wi,5,3,"div",47)}if(a&2){let e=d();o(5),y("ngModel",e.model.email),l("disabled",e.fieldsDisabled),o(),l("ngIf",e.mode==="create"),o(),l("ngIf",e.isEditing)}}function Ei(a,t){a&1&&(s(0,"small",101),p(1,"Tous les champs ci-dessous sont requis."),n())}function Ui(a,t){a&1&&(s(0,"span",32),p(1,"*"),n())}function Mi(a,t){if(a&1&&(s(0,"small",102),p(1),n()),a&2){let e=d(3);o(),h(e.kycErrors.piece_numero)}}function Ti(a,t){a&1&&(s(0,"span",32),p(1,"*"),n())}function Pi(a,t){if(a&1&&(s(0,"small",103),p(1),n()),a&2){let e=d(3);o(),h(e.kycErrors.piece_pays)}}function Ii(a,t){a&1&&(s(0,"span",32),p(1,"*"),n())}function Vi(a,t){if(a&1&&(s(0,"small",104),p(1),n()),a&2){let e=d(3);o(),h(e.kycErrors.piece_delivree_le)}}function Oi(a,t){a&1&&(s(0,"span",32),p(1,"*"),n())}function ki(a,t){if(a&1&&(s(0,"small",105),p(1),n()),a&2){let e=d(3);o(),h(e.kycErrors.piece_expire_le)}}function Fi(a,t){if(a&1&&(s(0,"div",106)(1,"small",107),b(2,"i",108),p(3),n()()),a&2){let e=d(3);o(3),L(" ",e.kycErrors.dates," ")}}function Di(a,t){if(a&1){let e=v();s(0,"div",109)(1,"button",54),f("click",function(){u(e);let i=d(3);return _(i.goPrev())}),n(),s(2,"div",55)(3,"button",41),f("click",function(){u(e);let i=d(3);return _(i.onCancel())}),n(),s(4,"button",42),f("click",function(){u(e);let i=d(3);return _(i.goNext())}),n()()()}if(a&2){let e=d(3);o(),l("disabled",e.loading),o(2),l("disabled",e.loading),o(),l("disabled",e.loading||e.formDisabled)}}function Ri(a,t){if(a&1){let e=v();s(0,"section",80)(1,"p",81),p(2,"Ces informations peuvent etre ajoutees plus tard."),n(),s(3,"div",19)(4,"div",20)(5,"label",82),p(6,"Date de naissance"),n(),s(7,"p-datepicker",83),C("ngModelChange",function(i){u(e);let m=d(2);return x(m.dateNaissanceObj,i)||(m.dateNaissanceObj=i),_(i)}),n()(),s(8,"div",20)(9,"label",84),p(10,"Type de piece"),n(),s(11,"p-select",85),C("ngModelChange",function(i){u(e);let m=d(2);return x(m.model.piece_type,i)||(m.model.piece_type=i),_(i)}),f("onChange",function(){u(e);let i=d(2);return _(i.onPieceTypeChange())}),n(),g(12,Ei,2,0,"small",86),n(),s(13,"div",20)(14,"label",87),p(15,"Numero de piece "),g(16,Ui,2,0,"span",22),n(),s(17,"input",88),C("ngModelChange",function(i){u(e);let m=d(2);return x(m.model.piece_numero,i)||(m.model.piece_numero=i),_(i)}),f("ngModelChange",function(){u(e);let i=d(2);return _(i.onKycFieldChange())}),n(),g(18,Mi,2,1,"small",89),n(),s(19,"div",20)(20,"label",90),p(21,"Pays de delivrance "),g(22,Ti,2,0,"span",22),n(),s(23,"p-select",91),C("ngModelChange",function(i){u(e);let m=d(2);return x(m.model.piece_pays,i)||(m.model.piece_pays=i),_(i)}),f("onChange",function(){u(e);let i=d(2);return _(i.onKycFieldChange())}),n(),g(24,Pi,2,1,"small",92),n(),s(25,"div",20)(26,"label",93),p(27,"Delivree le "),g(28,Ii,2,0,"span",22),n(),s(29,"input",94),C("ngModelChange",function(i){u(e);let m=d(2);return x(m.model.piece_delivree_le,i)||(m.model.piece_delivree_le=i),_(i)}),f("change",function(){u(e);let i=d(2);return _(i.onKycFieldChange())}),n(),g(30,Vi,2,1,"small",95),n(),s(31,"div",20)(32,"label",96),p(33,"Expire le "),g(34,Oi,2,0,"span",22),n(),s(35,"input",97),C("ngModelChange",function(i){u(e);let m=d(2);return x(m.model.piece_expire_le,i)||(m.model.piece_expire_le=i),_(i)}),f("change",function(){u(e);let i=d(2);return _(i.onKycFieldChange())}),n(),g(36,ki,2,1,"small",98),n()()(),g(37,Fi,4,1,"div",99)(38,Di,5,3,"div",100)}if(a&2){let e=d(2);o(7),y("ngModel",e.dateNaissanceObj),l("showIcon",!0)("disabled",e.fieldsDisabled)("maxDate",e.today),o(4),y("ngModel",e.model.piece_type),l("options",e.pieceTypeOptions)("appendTo","body")("disabled",e.fieldsDisabled)("showClear",!0),o(),l("ngIf",e.isKycActive),o(4),l("ngIf",e.isKycActive),o(),y("ngModel",e.model.piece_numero),l("disabled",e.fieldsDisabled)("invalid",!!e.kycErrors.piece_numero),E("aria-invalid",!!e.kycErrors.piece_numero)("aria-describedby",e.kycErrors.piece_numero?"piece_numero-error":null),o(),l("ngIf",e.kycErrors.piece_numero),o(4),l("ngIf",e.isKycActive),o(),y("ngModel",e.model.piece_pays),l("options",e.countries)("appendTo","body")("disabled",e.fieldsDisabled)("showClear",!0)("invalid",!!e.kycErrors.piece_pays),E("aria-invalid",!!e.kycErrors.piece_pays),o(),l("ngIf",e.kycErrors.piece_pays),o(4),l("ngIf",e.isKycActive),o(),y("ngModel",e.model.piece_delivree_le),l("disabled",e.fieldsDisabled)("invalid",!!e.kycErrors.piece_delivree_le),E("aria-invalid",!!e.kycErrors.piece_delivree_le),o(),l("ngIf",e.kycErrors.piece_delivree_le),o(4),l("ngIf",e.isKycActive),o(),y("ngModel",e.model.piece_expire_le),l("disabled",e.fieldsDisabled)("invalid",!!e.kycErrors.piece_expire_le||!!e.kycErrors.dates),E("aria-invalid",!!e.kycErrors.piece_expire_le||!!e.kycErrors.dates),o(),l("ngIf",e.kycErrors.piece_expire_le),o(),l("ngIf",e.kycErrors.dates),o(),l("ngIf",e.isEditing)}}function Li(a,t){a&1&&(s(0,"p-step-panel",15),g(1,Ri,39,40,"ng-template",17),n()),a&2&&l("value",5)}function Ai(a,t){if(a&1&&(s(0,"div",116)(1,"h3",113),p(2,"Piece d'identite"),n(),s(3,"div",117)(4,"div",114)(5,"span"),p(6,"Date de naissance"),n(),s(7,"strong"),p(8),n()(),s(9,"div",114)(10,"span"),p(11,"Type de piece"),n(),s(12,"strong"),p(13),n()(),s(14,"div",114)(15,"span"),p(16,"Numero de piece"),n(),s(17,"strong"),p(18),n()(),s(19,"div",114)(20,"span"),p(21,"Pays de delivrance"),n(),s(22,"strong"),p(23),n()(),s(24,"div",114)(25,"span"),p(26,"Delivree le"),n(),s(27,"strong"),p(28),n()(),s(29,"div",114)(30,"span"),p(31,"Expire le"),n(),s(32,"strong"),p(33),n()()()()),a&2){let e=d(2);o(8),h(e.formatDateObjectForDisplay(e.dateNaissanceObj)),o(5),h(e.selectedPieceTypeLabel),o(5),h(e.displayValue(e.model.piece_numero)),o(5),h(e.model.piece_pays?e.getCountryName(e.model.piece_pays):"-"),o(5),h(e.formatDateForDisplay(e.model.piece_delivree_le)),o(5),h(e.formatDateForDisplay(e.model.piece_expire_le))}}function Ni(a,t){if(a&1){let e=v();s(0,"div",109)(1,"button",54),f("click",function(){u(e);let i=d(2);return _(i.goPrev())}),n(),s(2,"div",55)(3,"button",41),f("click",function(){u(e);let i=d(2);return _(i.onCancel())}),n(),b(4,"button",118),n()()}if(a&2){let e=d(2);o(),l("disabled",e.loading),o(2),l("disabled",e.loading),o(),l("label",e.mode==="create"?"Enregistrer":"Sauvegarder")("loading",e.loading)("disabled",!e.isValid()||e.loading||e.formDisabled)}}function Bi(a,t){if(a&1&&(s(0,"section",110)(1,"p",81),p(2,"Verifiez les informations avant validation."),n(),s(3,"div",111)(4,"div",112)(5,"h3",113),p(6,"Telephone"),n(),s(7,"div",114)(8,"span"),p(9,"Pays"),n(),s(10,"strong"),p(11),n()(),s(12,"div",114)(13,"span"),p(14,"Numero"),n(),s(15,"strong"),p(16),n()(),s(17,"div",114)(18,"span"),p(19,"Email"),n(),s(20,"strong"),p(21),n()()(),s(22,"div",112)(23,"h3",113),p(24,"Type et role"),n(),s(25,"div",114)(26,"span"),p(27,"Type de compte"),n(),s(28,"strong"),p(29),n()(),s(30,"div",114)(31,"span"),p(32,"Role"),n(),s(33,"strong"),p(34),n()()(),s(35,"div",112)(36,"h3",113),p(37,"Informations personnelles"),n(),s(38,"div",114)(39,"span"),p(40,"Nom"),n(),s(41,"strong"),p(42),n()(),s(43,"div",114)(44,"span"),p(45,"Prenom"),n(),s(46,"strong"),p(47),n()(),s(48,"div",114)(49,"span"),p(50,"Ville"),n(),s(51,"strong"),p(52),n()(),s(53,"div",114)(54,"span"),p(55,"Quartier"),n(),s(56,"strong"),p(57),n()()(),g(58,Ai,34,6,"div",115),n()(),g(59,Ni,5,5,"div",100)),a&2){let e=d();o(11),h(e.getCountryName(e.phoneCountry)),o(5),h(e.displayValue(e.model.phone)),o(5),h(e.displayValue(e.model.email)),o(8),h(e.selectedTypeLabel),o(5),h(e.selectedRoleLabel),o(8),h(e.displayValue(e.model.nom)),o(5),h(e.displayValue(e.model.prenom)),o(5),h(e.displayValue(e.model.ville)),o(5),h(e.displayValue(e.model.quartier)),o(),l("ngIf",e.hasIdentityStep),o(),l("ngIf",e.isEditing)}}var R=class a{constructor(t){this.roleService=t}mode="create";initialData=null;loading=!1;formDisabled=!1;submitForm=new pe;cancel=new pe;submitted=!1;isEditing=!1;model={};activeStep=1;get hasIdentityStep(){return this.mode!=="create"}get summaryStep(){return this.hasIdentityStep?6:5}get lastStep(){return this.summaryStep}dateNaissanceObj=null;today=new Date;userTypeOptions=[{label:"Staff",value:"staff"},{label:"Client",value:"client"},{label:"Prestataire",value:"prestataire"},{label:"Investisseur",value:"investisseur"}];civiliteOptions=Object.entries(vt).map(([t,e])=>({label:e,value:t}));STAFF_ROLES=["admin","manager","comptable","agent_vente","employe"];availableRoles=[];pieceTypeOptions=Object.entries(yt).map(([t,e])=>({label:e,value:t}));phoneError=null;phoneCountry="GN";passwordError=null;kycErrors={};countries=D;ngOnInit(){this.loadRoles(),this.initializeModel()}ngOnChanges(t){if(t.initialData){let e=t.initialData;e.currentValue&&Object.keys(e.currentValue).length>0&&this.initializeModel()}}loadRoles(){this.roleService.getRoles().subscribe({next:t=>{t.success&&(this.availableRoles=t.data.map(e=>({label:e.role.name.charAt(0).toUpperCase()+e.role.name.slice(1),value:e.role.name})))},error:()=>{this.availableRoles=[{label:"Admin",value:"admin"},{label:"Manager",value:"manager"},{label:"Employe",value:"employe"}]}})}get filteredRoles(){return this.model.type==="staff"?this.availableRoles.filter(t=>this.STAFF_ROLES.includes(t.value)):[]}get isRoleSelectable(){return this.model.type==="staff"}onTypeChange(){this.model.type&&(this.model.type==="staff"?this.model.role=void 0:this.model.role=this.model.type)}get isKycActive(){return!!this.model.piece_type}onPieceTypeChange(){this.model.piece_type?this.submitted&&this.setKycErrors():(this.model.piece_numero=void 0,this.model.piece_pays=void 0,this.model.piece_delivree_le=void 0,this.model.piece_expire_le=void 0,this.kycErrors={})}onKycFieldChange(){this.submitted&&this.isKycActive&&this.setKycErrors()}checkKyc(){if(!this.model.piece_type)return!0;if(!this.model.piece_numero?.trim()||!this.model.piece_pays||!this.model.piece_delivree_le||!this.model.piece_expire_le)return!1;let t=new Date;t.setHours(23,59,59,999);let e=new Date(this.model.piece_delivree_le);return!(e>t||new Date(this.model.piece_expire_le)<=e)}setKycErrors(){if(this.kycErrors={},!!this.model.piece_type){if(this.model.piece_numero?.trim()||(this.kycErrors.piece_numero="Numero de piece obligatoire."),this.model.piece_pays||(this.kycErrors.piece_pays="Pays de delivrance obligatoire."),!this.model.piece_delivree_le)this.kycErrors.piece_delivree_le="Date de delivrance obligatoire.";else{let t=new Date;t.setHours(23,59,59,999),new Date(this.model.piece_delivree_le)>t&&(this.kycErrors.piece_delivree_le="La date de delivrance ne peut pas etre dans le futur.")}if(this.model.piece_expire_le||(this.kycErrors.piece_expire_le="Date d'expiration obligatoire."),this.model.piece_delivree_le&&this.model.piece_expire_le){let t=new Date(this.model.piece_delivree_le);new Date(this.model.piece_expire_le)<=t&&(this.kycErrors.dates="La date d'expiration doit etre posterieure a la date de delivrance.")}}}initializeModel(){this.initialData?(this.model={nom:this.initialData.nom,prenom:this.initialData.prenom,phone:this.initialData.phone,email:this.initialData.email,pays:this.initialData.pays,code_pays:this.initialData.code_pays,code_phone_pays:this.initialData.code_phone_pays,ville:this.initialData.ville??void 0,quartier:this.initialData.quartier??void 0,type:this.initialData.type,role:this.initialData.role_names?.[0]??this.initialData.roles?.[0],reference:this.initialData.reference,civilite:this.initialData.civilite??void 0,piece_type:this.initialData.piece_type??void 0,piece_numero:this.initialData.piece_numero??void 0,piece_delivree_le:this.initialData.piece_delivree_le??void 0,piece_expire_le:this.initialData.piece_expire_le??void 0,piece_pays:this.initialData.piece_pays??void 0},this.dateNaissanceObj=this.initialData.date_naissance?new Date(this.initialData.date_naissance):null):(this.model={},this.dateNaissanceObj=null),this.mode==="create"&&!this.model.ville?.trim()&&(this.model.ville="Conakry"),this.mode==="create"?this.isEditing=!0:this.mode==="edit"&&this.initialData&&(this.isEditing=!0),this.model.code_pays?this.phoneCountry=this.model.code_pays:this.model.phone&&this.detectPhoneCountry(this.model.phone),this.submitted=!1,this.phoneError=null,this.passwordError=null,this.kycErrors={},this.activeStep=1}detectPhoneCountry(t){try{let e=ce(t);e&&e.country&&(this.phoneCountry=e.country)}catch{}}validatePhone(){if(!this.model.phone?.trim())return this.phoneError="Telephone obligatoire.",!1;try{if(!ue(this.model.phone,this.phoneCountry))return this.phoneError=`Numero invalide pour ${this.getCountryName(this.phoneCountry)}.`,!1;let e=ce(this.model.phone,this.phoneCountry);return e?(this.model.phone=e.formatInternational(),this.model.code_pays=this.phoneCountry,this.model.pays=this.getCountryName(this.phoneCountry),this.phoneError=null,!0):(this.phoneError="Format de numero invalide.",!1)}catch{return this.phoneError="Format de numero invalide.",!1}}validatePassword(){if(this.mode==="edit"&&!this.model.password?.trim())return this.passwordError=null,!0;if(this.mode==="create"&&!this.model.password?.trim())return this.passwordError="Mot de passe obligatoire.",!1;let t=this.model.password||"";return t.length<8?(this.passwordError="Le mot de passe doit contenir au moins 8 caracteres.",!1):!/[a-z]/.test(t)||!/[A-Z]/.test(t)?(this.passwordError="Le mot de passe doit contenir des majuscules et des minuscules.",!1):/[0-9]/.test(t)?(this.passwordError=null,!0):(this.passwordError="Le mot de passe doit contenir au moins un chiffre.",!1)}formatDate(t){return t?t.toISOString().split("T")[0]:null}getCountryName(t){let e=this.countries.find(r=>r.code===t);return e?e.name:t}getSelectedCountryDialCode(){let t=this.countries.find(e=>e.code===this.phoneCountry);return t?t.dialCode:""}displayValue(t){let e=t?.trim();return e||"-"}get selectedTypeLabel(){if(!this.model.type)return"-";let t=this.userTypeOptions.find(e=>e.value===this.model.type);return t?t.label:this.model.type}get selectedRoleLabel(){if(!this.model.role)return"-";let t=this.availableRoles.find(e=>e.value===this.model.role);return t?t.label:this.model.role.charAt(0).toUpperCase()+this.model.role.slice(1).replace(/_/g," ")}get selectedPieceTypeLabel(){if(!this.model.piece_type)return"-";let t=this.pieceTypeOptions.find(e=>e.value===this.model.piece_type);return t?t.label:this.model.piece_type}get passwordSummary(){let t=!!this.model.password?.trim();return this.mode==="create"?t?"Defini":"-":t?"Mis a jour":"Non modifie"}formatDateForDisplay(t){if(!t)return"-";let e=new Date(t);return Number.isNaN(e.getTime())?t:e.toLocaleDateString("fr-FR")}formatDateObjectForDisplay(t){return t?t.toLocaleDateString("fr-FR"):"-"}onCountryChange(){this.model.phone&&this.validatePhone()}onPhoneInput(){this.submitted&&this.validatePhone()}onPhoneBlur(){this.model.phone?.trim()&&this.validatePhone()}isStep1Valid(){if(!this.phoneCountry||!this.model.phone?.trim())return!1;try{return ue(this.model.phone,this.phoneCountry)}catch{return!1}}isStep2Valid(){return!(!this.model.type||this.isRoleSelectable&&!this.model.role)}isStep3Valid(){return!!(this.model.nom?.trim()&&this.model.prenom?.trim()&&this.model.ville?.trim()&&this.model.quartier?.trim())}isStep4Valid(){return!(this.mode==="create"&&!this.validatePassword())}isStep5Valid(){return!0}isValid(){return!(!this.isStep1Valid()||!this.isStep2Valid()||!this.isStep3Valid()||!this.isStep4Valid()||!this.checkKyc())}goNext(){if(this.submitted=!0,this.activeStep===1){this.validatePhone()&&(this.activeStep=2,this.submitted=!1);return}if(this.activeStep===2&&this.isStep2Valid()){this.activeStep=3,this.submitted=!1;return}if(this.activeStep===3&&this.isStep3Valid()){this.activeStep=4,this.submitted=!1;return}if(this.activeStep===4&&this.isStep4Valid()){this.activeStep=this.hasIdentityStep?5:this.summaryStep,this.submitted=!1;return}this.hasIdentityStep&&this.activeStep===5&&this.isStep5Valid()&&(this.activeStep=this.summaryStep,this.submitted=!1)}goPrev(){this.activeStep>1&&(this.activeStep=this.activeStep-1,this.submitted=!1)}enableEditing(){this.isEditing=!0}cancelEditing(){this.isEditing=!1,this.submitted=!1,this.phoneError=null,this.passwordError=null,this.kycErrors={},this.initializeModel()}goToFirstInvalidStep(){if(!this.isStep1Valid()){this.activeStep=1;return}if(!this.isStep2Valid()){this.activeStep=2;return}if(!this.isStep3Valid()){this.activeStep=3;return}if(!this.isStep4Valid()){this.activeStep=4;return}this.hasIdentityStep&&!this.checkKyc()&&(this.activeStep=5)}onSubmit(){if(this.submitted=!0,this.setKycErrors(),!this.isValid()){this.goToFirstInvalidStep();return}this.submitForm.emit(be(he({},this.model),{password_confirmation:this.model.password,date_naissance:this.formatDate(this.dateNaissanceObj)??void 0}))}onCancel(){this.cancel.emit()}get fieldsDisabled(){return this.mode==="edit"&&!this.isEditing||this.loading||this.formDisabled}get formTitle(){if(this.mode==="create")return"Creer un compte utilisateur";let t=this.model.reference?.trim();return t?`Modification compte utilisateur : ${t}`:"Modification compte utilisateur"}static \u0275fac=function(e){return new(e||a)(w(re))};static \u0275cmp=T({type:a,selectors:[["app-utilisateurs-form"]],inputs:{mode:"mode",initialData:"initialData",loading:"loading",formDisabled:"formDisabled"},outputs:{submitForm:"submitForm",cancel:"cancel"},features:[Ce],decls:32,vars:14,consts:[["codePaysModel","ngModel"],["phoneModel","ngModel"],["typeModel","ngModel"],["roleModel","ngModel"],["nomModel","ngModel"],["prenomModel","ngModel"],["villeModel","ngModel"],["quartierModel","ngModel"],["passwordModel","ngModel"],[1,"card"],[1,"mb-6"],[1,"text-2xl","sm:text-3xl","font-bold","text-gray-900","tracking-tight"],[1,"mt-2","text-sm","sm:text-base","text-gray-600"],[1,"utilisateurs-form-fields",3,"ngSubmit"],[1,"w-full","utilisateurs-form-stepper","mb-10",3,"valueChange","value"],[3,"value"],[3,"value",4,"ngIf"],["pTemplate","content"],[1,"space-y-8"],[1,"grid","grid-cols-1","xl:grid-cols-2","gap-x-8","gap-y-7","py-1"],[1,"utilisateurs-form-field"],["for","codePays",1,"utilisateurs-form-label"],["class","text-red-500","aria-hidden","true",4,"ngIf"],["id","codePays","name","codePays","optionLabel","name","optionValue","code","fluid","","aria-describedby","codePays-error",3,"ngModelChange","onCountryChange","ngModel","options","disabled","appendTo"],["pTemplate","item"],["pTemplate","selectedItem"],["id","codePays-error","class","utilisateurs-form-error","role","alert",4,"ngIf"],["for","phone",1,"utilisateurs-form-label"],["id","phone","name","phone","type","tel","pInputText","","fluid","","placeholder","Exemple: 622 00 00 00",1,"w-full",3,"ngModelChange","input","blur","ngModel","invalid","disabled"],["id","phone-error","class","utilisateurs-form-error","role","alert",4,"ngIf"],["class","utilisateurs-form-error","role","alert",4,"ngIf"],["class","utilisateurs-form-step-actions flex flex-wrap items-center justify-end gap-3 pt-8 mt-8",4,"ngIf"],["aria-hidden","true",1,"text-red-500"],[1,"flex","items-center","gap-2"],[1,"w-5","h-auto","rounded-sm",3,"src","alt"],[1,"font-semibold","text-primary"],["class","flex items-center gap-2",4,"ngIf"],["id","codePays-error","role","alert",1,"utilisateurs-form-error"],["id","phone-error","role","alert",1,"utilisateurs-form-error"],["role","alert",1,"utilisateurs-form-error"],[1,"utilisateurs-form-step-actions","flex","flex-wrap","items-center","justify-end","gap-3","pt-8","mt-8"],["type","button","pButton","","pRipple","","label","Annuler","icon","pi pi-times","severity","secondary",1,"utilisateurs-form-cancel",3,"click","disabled"],["type","button","pButton","","pRipple","","label","Suivant","icon","pi pi-arrow-right","iconPos","right",1,"utilisateurs-form-next",3,"click","disabled"],["for","type",1,"utilisateurs-form-label"],["id","type","name","type","optionLabel","label","optionValue","value","fluid","","aria-describedby","type-error",3,"ngModelChange","onChange","ngModel","options","disabled","invalid","appendTo"],["id","type-error","class","utilisateurs-form-error","role","alert",4,"ngIf"],["class","utilisateurs-form-field",4,"ngIf"],["class","utilisateurs-form-step-actions flex flex-wrap items-center justify-between gap-3 pt-8 mt-8",4,"ngIf"],["id","type-error","role","alert",1,"utilisateurs-form-error"],["for","role",1,"utilisateurs-form-label"],["id","role","name","role","optionLabel","label","optionValue","value","fluid","","aria-describedby","role-error",3,"ngModelChange","ngModel","options","appendTo","disabled","invalid"],["id","role-error","class","utilisateurs-form-error","role","alert",4,"ngIf"],["id","role-error","role","alert",1,"utilisateurs-form-error"],[1,"utilisateurs-form-step-actions","flex","flex-wrap","items-center","justify-between","gap-3","pt-8","mt-8"],["type","button","pButton","","pRipple","","label","Pr\xE9c\xE9dent","icon","pi pi-arrow-left","severity","secondary",1,"utilisateurs-form-prev",3,"click","disabled"],[1,"flex","flex-wrap","items-center","gap-3"],["for","nom",1,"utilisateurs-form-label"],["id","nom","name","nom","type","text","pInputText","","fluid","","aria-describedby","nom-error",1,"w-full",3,"ngModelChange","ngModel","invalid","disabled"],["id","nom-error","class","utilisateurs-form-error","role","alert",4,"ngIf"],["for","prenom",1,"utilisateurs-form-label"],["id","prenom","name","prenom","type","text","pInputText","","fluid","","aria-describedby","prenom-error",1,"w-full",3,"ngModelChange","ngModel","invalid","disabled"],["id","prenom-error","class","utilisateurs-form-error","role","alert",4,"ngIf"],["for","ville",1,"utilisateurs-form-label"],["id","ville","name","ville","type","text","pInputText","","fluid","","aria-describedby","ville-error",1,"w-full",3,"ngModelChange","ngModel","invalid","disabled"],["id","ville-error","class","utilisateurs-form-error","role","alert",4,"ngIf"],["for","quartier",1,"utilisateurs-form-label"],["id","quartier","name","quartier","type","text","pInputText","","fluid","","aria-describedby","quartier-error",1,"w-full",3,"ngModelChange","ngModel","invalid","disabled"],["id","quartier-error","class","utilisateurs-form-error","role","alert",4,"ngIf"],["id","nom-error","role","alert",1,"utilisateurs-form-error"],["id","prenom-error","role","alert",1,"utilisateurs-form-error"],["id","ville-error","role","alert",1,"utilisateurs-form-error"],["id","quartier-error","role","alert",1,"utilisateurs-form-error"],[1,"utilisateurs-form-field","xl:col-span-2"],["for","user_email",1,"utilisateurs-form-label"],["id","user_email","name","user_email","type","email","pInputText","","fluid","","placeholder","exemple@email.com","autocomplete","off","autocapitalize","none","autocorrect","off","spellcheck","false",1,"w-full",3,"ngModelChange","ngModel","disabled"],["class","utilisateurs-form-field xl:col-span-2",4,"ngIf"],["for","new_user_password",1,"utilisateurs-form-label"],["id","password","inputId","new_user_password","name","new_user_password","autocomplete","new-password","fluid","","placeholder","Min. 8 caracteres, majuscules, minuscules et chiffres","promptLabel","Entrez un mot de passe","weakLabel","Faible","mediumLabel","Moyen","strongLabel","Fort","aria-describedby","password-error",3,"ngModelChange","ngModel","toggleMask","feedback","invalid","disabled"],["id","password-error","class","utilisateurs-form-error","role","alert",4,"ngIf"],["id","password-error","role","alert",1,"utilisateurs-form-error"],[1,"space-y-6"],[1,"text-sm","text-gray-500"],["for","date_naissance",1,"utilisateurs-form-label"],["id","date_naissance","name","date_naissance","dateFormat","dd/mm/yy","placeholder","jj/mm/aaaa","fluid","",3,"ngModelChange","ngModel","showIcon","disabled","maxDate"],["for","piece_type",1,"utilisateurs-form-label"],["id","piece_type","name","piece_type","optionLabel","label","optionValue","value","fluid","",3,"ngModelChange","onChange","ngModel","options","appendTo","disabled","showClear"],["class","text-gray-500 block mt-1.5 text-sm",4,"ngIf"],["for","piece_numero",1,"utilisateurs-form-label"],["id","piece_numero","name","piece_numero","type","text","pInputText","","fluid","","placeholder","Ex: GN-123456789",1,"w-full",3,"ngModelChange","ngModel","disabled","invalid"],["id","piece_numero-error","class","utilisateurs-form-error","role","alert",4,"ngIf"],["for","piece_pays",1,"utilisateurs-form-label"],["id","piece_pays","name","piece_pays","optionLabel","name","optionValue","code","fluid","","aria-describedby","piece_pays-error",3,"ngModelChange","onChange","ngModel","options","appendTo","disabled","showClear","invalid"],["id","piece_pays-error","class","utilisateurs-form-error","role","alert",4,"ngIf"],["for","piece_delivree_le",1,"utilisateurs-form-label"],["id","piece_delivree_le","name","piece_delivree_le","type","date","pInputText","","fluid","","aria-describedby","piece_delivree_le-error",1,"w-full",3,"ngModelChange","change","ngModel","disabled","invalid"],["id","piece_delivree_le-error","class","utilisateurs-form-error","role","alert",4,"ngIf"],["for","piece_expire_le",1,"utilisateurs-form-label"],["id","piece_expire_le","name","piece_expire_le","type","date","pInputText","","fluid","","aria-describedby","piece_expire_le-error",1,"w-full",3,"ngModelChange","change","ngModel","disabled","invalid"],["id","piece_expire_le-error","class","utilisateurs-form-error","role","alert",4,"ngIf"],["class","mb-4",4,"ngIf"],["class","utilisateurs-form-actions flex flex-wrap items-center justify-between gap-3 pt-8 mt-8",4,"ngIf"],[1,"text-gray-500","block","mt-1.5","text-sm"],["id","piece_numero-error","role","alert",1,"utilisateurs-form-error"],["id","piece_pays-error","role","alert",1,"utilisateurs-form-error"],["id","piece_delivree_le-error","role","alert",1,"utilisateurs-form-error"],["id","piece_expire_le-error","role","alert",1,"utilisateurs-form-error"],[1,"mb-4"],["role","alert",1,"utilisateurs-form-error","flex","items-center","gap-1.5"],["aria-hidden","true",1,"pi","pi-exclamation-triangle","text-xs"],[1,"utilisateurs-form-actions","flex","flex-wrap","items-center","justify-between","gap-3","pt-8","mt-8"],[1,"utilisateurs-form-summary","space-y-6"],[1,"grid","grid-cols-1","xl:grid-cols-2","gap-x-8","gap-y-6"],[1,"utilisateurs-form-summary-card"],[1,"utilisateurs-form-summary-title"],[1,"utilisateurs-form-summary-row"],["class","utilisateurs-form-summary-card xl:col-span-2",4,"ngIf"],[1,"utilisateurs-form-summary-card","xl:col-span-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-x-8","gap-y-2"],["type","submit","pButton","","pRipple","","icon","pi pi-check","aria-busy","loading",1,"utilisateurs-form-submit",3,"label","loading","disabled"]],template:function(e,r){e&1&&(s(0,"div",9)(1,"header",10)(2,"h1",11),p(3),n(),s(4,"p",12),p(5,"Renseignez les informations du compte utilisateur."),n()(),s(6,"form",13),f("ngSubmit",function(){return r.activeStep===r.lastStep?r.onSubmit():r.goNext()}),s(7,"p-stepper",14),C("valueChange",function(m){return x(r.activeStep,m)||(r.activeStep=m),m}),s(8,"p-step-list")(9,"p-step",15),p(10,"T\xE9l\xE9phone"),n(),s(11,"p-step",15),p(12,"Type + R\xF4le"),n(),s(13,"p-step",15),p(14,"Informations personnelles"),n(),s(15,"p-step",15),p(16,"Acc\xE8s"),n(),g(17,Gt,2,1,"p-step",16),s(18,"p-step",15),p(19,"Recapitulatif"),n()(),s(20,"p-step-panels")(21,"p-step-panel",15),g(22,ri,20,16,"ng-template",17),n(),s(23,"p-step-panel",15),g(24,mi,11,10,"ng-template",17),n(),s(25,"p-step-panel",15),g(26,yi,31,25,"ng-template",17),n(),s(27,"p-step-panel",15),g(28,Si,8,4,"ng-template",17),n(),g(29,Li,2,1,"p-step-panel",16),s(30,"p-step-panel",15),g(31,Bi,60,11,"ng-template",17),n()()()()()),e&2&&(o(3),h(r.formTitle),o(4),y("value",r.activeStep),o(2),l("value",1),o(2),l("value",2),o(2),l("value",3),o(2),l("value",4),o(2),l("ngIf",r.hasIdentityStep),o(),l("value",r.summaryStep),o(3),l("value",1),o(2),l("value",2),o(2),l("value",3),o(2),l("value",4),o(2),l("ngIf",r.hasIdentityStep),o(),l("value",r.summaryStep))},dependencies:[P,k,te,ee,Q,Y,De,G,H,$,Ae,Z,J,Re,X,Le,pt,lt,mt,Qe,ft,gt,dt,_t,ut,ct],styles:[".utilisateurs-form-fields[_ngcontent-%COMP%]{display:block}.utilisateurs-form-label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-size:.92rem;font-weight:500;line-height:1.4;color:var(--p-text-color, var(--text-color))}.utilisateurs-form-field[_ngcontent-%COMP%]{margin-bottom:0}.utilisateurs-form-error[_ngcontent-%COMP%]{display:block;margin-top:.45rem;font-size:.82rem;line-height:1.35;color:var(--p-red-600, #b91c1c)}@media (prefers-contrast: high){.utilisateurs-form-error[_ngcontent-%COMP%]{color:var(--p-red-700, #991b1b);font-weight:500}}.utilisateurs-form-summary-card[_ngcontent-%COMP%]{border:1px solid var(--p-surface-300, #d1d5db);border-radius:.75rem;padding:1rem 1rem .75rem;background:var(--p-surface-0, #fff)}.utilisateurs-form-summary-title[_ngcontent-%COMP%]{margin:0 0 .65rem;font-size:.95rem;font-weight:600;color:var(--p-text-color, var(--text-color))}.utilisateurs-form-summary-row[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between;gap:1rem;padding:.3rem 0}.utilisateurs-form-summary-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--p-text-muted-color, #6b7280);font-size:.88rem;line-height:1.35}.utilisateurs-form-summary-row[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--p-text-color, var(--text-color));font-size:.9rem;font-weight:600;text-align:right;overflow-wrap:anywhere}.utilisateurs-form-stepper[_ngcontent-%COMP%]     .p-stepper .p-step-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(10.5rem,1fr));gap:.75rem 1rem;align-items:stretch;margin-bottom:2rem;padding-bottom:.25rem;overflow:visible;scrollbar-width:none}.utilisateurs-form-stepper[_ngcontent-%COMP%]     .p-stepper .p-step-list::-webkit-scrollbar{display:none}.utilisateurs-form-stepper[_ngcontent-%COMP%]     .p-stepper .p-step{min-width:0}.utilisateurs-form-stepper[_ngcontent-%COMP%]     .p-stepper .p-step-header{width:100%;min-height:3rem;padding:.35rem .5rem;border-radius:.75rem}.utilisateurs-form-stepper[_ngcontent-%COMP%]     .p-stepper .p-step-number{width:2rem;height:2rem;font-size:.95rem;line-height:1;flex-shrink:0}.utilisateurs-form-stepper[_ngcontent-%COMP%]     .p-stepper .p-step-title{font-size:.98rem;font-weight:500;line-height:1.3;white-space:normal;overflow-wrap:anywhere}.utilisateurs-form-stepper[_ngcontent-%COMP%]     .p-stepper .p-stepper-separator{display:none}.utilisateurs-form-stepper[_ngcontent-%COMP%]     .p-stepper .p-step-panels{padding-top:.25rem;overflow:visible}.utilisateurs-form-stepper[_ngcontent-%COMP%]     .p-stepper .p-step-panel, .utilisateurs-form-stepper[_ngcontent-%COMP%]     .p-stepper .p-step-content{overflow:visible}.utilisateurs-form-step-actions[_ngcontent-%COMP%]     .p-button, .utilisateurs-form-actions[_ngcontent-%COMP%]     .p-button{min-height:2.75rem;min-width:7.25rem;border-radius:.6rem}.utilisateurs-form-submit[_ngcontent-%COMP%]     .p-button{font-weight:600}[_nghost-%COMP%]     .p-inputtext, [_nghost-%COMP%]     .p-select, [_nghost-%COMP%]     .p-datepicker, [_nghost-%COMP%]     .p-password{width:100%}[_nghost-%COMP%]     .p-inputtext, [_nghost-%COMP%]     .p-password .p-inputtext, [_nghost-%COMP%]     .p-datepicker .p-inputtext, [_nghost-%COMP%]     .p-select .p-select-label{min-height:2.75rem}[_nghost-%COMP%]     .p-select .p-select-label{display:flex;align-items:center}[_nghost-%COMP%]     .p-inputtext:focus-visible, [_nghost-%COMP%]     .p-select .p-select-label:focus-visible, [_nghost-%COMP%]     .p-datepicker .p-inputtext:focus-visible, [_nghost-%COMP%]     .p-password input:focus-visible{outline:1px solid var(--p-primary-color, var(--primary-color));outline-offset:0}[_nghost-%COMP%]     .p-button:focus-visible{outline:2px solid var(--p-primary-color, var(--primary-color));outline-offset:2px}@media (max-width: 1024px){.utilisateurs-form-stepper[_ngcontent-%COMP%]     .p-stepper .p-step-list{grid-template-columns:repeat(auto-fit,minmax(9rem,1fr))}.utilisateurs-form-stepper[_ngcontent-%COMP%]     .p-stepper .p-step-header{min-height:2.75rem}.utilisateurs-form-stepper[_ngcontent-%COMP%]     .p-stepper .p-step-title{font-size:.92rem}}@media (max-width: 768px){.utilisateurs-form-step-actions[_ngcontent-%COMP%], .utilisateurs-form-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.utilisateurs-form-step-actions[_ngcontent-%COMP%]     .p-button, .utilisateurs-form-actions[_ngcontent-%COMP%]     .p-button{width:100%;justify-content:center;min-width:unset}.utilisateurs-form-summary-row[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.2rem}.utilisateurs-form-summary-row[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{text-align:left}}"]})};var ae=class a{http=ye(W);apiBase=`${A.apiUrl}/usines`;getAll(){return this.http.get(this.apiBase)}create(t){return this.http.post(this.apiBase,t)}update(t,e){return this.http.patch(`${this.apiBase}/${t}`,e)}setDefault(t){return this.http.patch(`${this.apiBase}/${t}/set-default`,{})}assignUser(t,e){return this.http.post(`${this.apiBase}/${t}/users`,e)}removeUser(t,e){return this.http.delete(`${this.apiBase}/${t}/users/${e}`)}static \u0275fac=function(e){return new(e||a)};static \u0275prov=B({token:a,factory:a.\u0275fac,providedIn:"root"})};function zi(a,t){a&1&&b(0,"p-message",6),a&2&&l("text","Veuillez s\xE9lectionner une usine dans la barre du haut pour pouvoir cr\xE9er un utilisateur.")}function qi(a,t){a&1&&(s(0,"div",7),b(1,"i",10),s(2,"span"),p(3,"L'utilisateur sera assign\xE9 \xE0 : "),s(4,"strong"),p(5),n()()()),a&2&&(o(5),h(t.nom))}var se=class a{constructor(t,e,r,i,m){this.userService=t;this.messageService=e;this.router=r;this.usineContext=i;this.usineService=m}loading=!1;onCancel(){this.router.navigate(["contacts/utilisateurs"])}onSubmit(t){let e=this.usineContext.currentUsineId();if(e===null){this.messageService.add({severity:"warn",summary:"Usine requise",detail:"Veuillez s\xE9lectionner une usine avant de cr\xE9er un utilisateur.",life:5e3});return}this.loading=!0;let r={nom:t.nom||"",prenom:t.prenom||"",phone:(t.phone||"").replace(/\s+/g,""),email:t.email||void 0,pays:t.pays||"Guin\xE9e",code_pays:t.code_pays||"GN",code_phone_pays:this.getCodePhonePays(t.code_pays||"GN"),ville:t.ville||"",quartier:t.quartier||"",password:t.password||"",password_confirmation:t.password_confirmation||"",type:t.type??"staff",role:t.role||"",civilite:t.civilite||void 0,date_naissance:t.date_naissance||void 0,piece_type:t.piece_type||void 0,piece_numero:t.piece_numero||void 0,piece_delivree_le:t.piece_delivree_le||void 0,piece_expire_le:t.piece_expire_le||void 0,piece_pays:t.piece_pays||void 0};this.userService.createUserViaApi(r).subscribe({next:i=>{if(!i.success||!i.data?.id){this.messageService.add({severity:"error",summary:"Erreur",detail:i.message||"Utilisateur cr\xE9\xE9 mais r\xE9ponse invalide."}),this.loading=!1;return}let m=i.data;this.usineService.assignUser(e,{user_id:m.id,role:r.role||void 0}).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Utilisateur cr\xE9\xE9 et assign\xE9 \xE0 l'usine."}),setTimeout(()=>{this.router.navigate(["contacts/utilisateurs/edit",m.id])},600),this.loading=!1},error:c=>{console.error("Erreur assignation usine:",c),this.messageService.add({severity:"error",summary:"Erreur",detail:c.error?.message||"Utilisateur cr\xE9\xE9 mais l'assignation \xE0 l'usine a \xE9chou\xE9.",life:6e3}),this.loading=!1}})},error:i=>{console.error("Erreur lors de la cr\xE9ation:",i),this.messageService.add({severity:"error",summary:"Erreur",detail:i.error?.message||"Erreur lors de la cr\xE9ation de l'utilisateur"}),this.loading=!1}})}getCodePhonePays(t){let e=D.find(r=>r.code===t);return e?e.dialCode:"+224"}static \u0275fac=function(e){return new(e||a)(w(I),w(U),w(F),w(Ke),w(ae))};static \u0275cmp=T({type:a,selectors:[["app-utilisateurs-new"]],features:[O([U])],decls:12,vars:4,consts:[[1,"edit-page"],[1,"edit-mobile-header"],["type","button","aria-label","Retour \xE0 la liste",1,"edit-back",3,"click"],[1,"pi","pi-arrow-left"],[1,"edit-title"],[1,"edit-header-spacer"],["severity","warn","styleClass","usine-context-message mb-3",3,"text"],[1,"usine-assignation-reminder","mb-3"],[1,"edit-content"],[3,"submitForm","cancel","mode","loading","formDisabled"],[1,"pi","pi-building"]],template:function(e,r){if(e&1&&(b(0,"p-toast"),s(1,"div",0)(2,"header",1)(3,"button",2),f("click",function(){return r.onCancel()}),b(4,"i",3),n(),s(5,"h1",4),p(6,"Nouvel utilisateur"),n(),b(7,"span",5),n(),Se(8,zi,1,1,"p-message",6)(9,qi,6,1,"div",7),s(10,"div",8)(11,"app-utilisateurs-form",9),f("submitForm",function(m){return r.onSubmit(m)})("cancel",function(){return r.onCancel()}),n()()()),e&2){let i;o(8),Ee(r.usineContext.isConsolidated()?8:(i=r.usineContext.currentUsine())?9:-1,i),o(3),l("mode","create")("loading",r.loading)("formDisabled",r.usineContext.isConsolidated())}},dependencies:[P,K,q,ot,st,R],styles:["[_nghost-%COMP%]{display:block}.usine-assignation-reminder[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem .75rem;border-radius:6px;background:var(--blue-50, #eff6ff);color:var(--blue-800, #1e40af);font-size:.875rem;border:1px solid var(--blue-200, #bfdbfe)}.usine-assignation-reminder[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1rem;opacity:.9}.usine-context-message[_ngcontent-%COMP%]{display:block}.edit-mobile-header[_ngcontent-%COMP%]{display:none}.edit-content[_ngcontent-%COMP%]{padding:1rem}@media screen and (max-width: 768px){.edit-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;min-height:100dvh;margin:calc(-.25rem - env(safe-area-inset-top)) -.875rem calc(-.875rem - env(safe-area-inset-bottom));margin-left:-.875rem;margin-right:-.875rem;padding:0;padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right);padding-bottom:env(safe-area-inset-bottom);background:#fff}.edit-mobile-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex-shrink:0;padding:calc(.5rem + env(safe-area-inset-top)) .75rem .6rem calc(.875rem + env(safe-area-inset-left));padding-right:calc(.875rem + env(safe-area-inset-right));background:var(--surface-card);border-bottom:1px solid var(--surface-border);box-shadow:0 1px 3px #0000000f;position:sticky;top:0;z-index:25}.edit-back[_ngcontent-%COMP%]{width:2.25rem;height:2.25rem;min-width:2.25rem;border:none;border-radius:50%;background:var(--p-primary-50);color:var(--p-primary-500);display:flex;align-items:center;justify-content:center;cursor:pointer;-webkit-tap-highlight-color:transparent}.edit-back[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1.1rem}.edit-title[_ngcontent-%COMP%]{flex:1;margin:0;font-size:1.15rem;font-weight:700;color:var(--text-color);min-width:0;text-align:center}.edit-header-spacer[_ngcontent-%COMP%]{width:2.25rem;min-width:2.25rem}.edit-content[_ngcontent-%COMP%]{flex:1;min-height:0;overflow-y:auto;-webkit-overflow-scrolling:touch;padding:.875rem;padding-bottom:calc(1rem + env(safe-area-inset-bottom))}}"]})};function Ki(a,t){a&1&&(s(0,"div",9),b(1,"i",10),n())}function Hi(a,t){if(a&1){let e=v();s(0,"app-utilisateurs-form",11),f("submitForm",function(i){u(e);let m=d();return _(m.onSubmit(i))})("cancel",function(){u(e);let i=d();return _(i.onCancel())}),n()}if(a&2){let e=d();l("mode","edit")("initialData",e.userData)("loading",e.loading)}}var oe=class a{constructor(t,e,r,i,m){this.route=t;this.router=e;this.userService=r;this.roleService=i;this.messageService=m}loading=!1;userId=null;userData=null;ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t&&(this.userId=parseInt(t,10),this.loadUser(this.userId))}loadUser(t){this.loading=!0,this.userService.getUser(t).subscribe({next:e=>{if(e.success&&e.data){let r=e.data,i={id:r.id,reference:r.reference,nom:r.nom,prenom:r.prenom,phone:r.phone,email:r.email,pays:r.pays,code_pays:r.code_pays,code_phone_pays:r.code_phone_pays,ville:r.ville,quartier:r.quartier,type:r.type,roles:r.role_names||r.roles,role_names:r.role_names,is_active:r.is_active,civilite:r.civilite,date_naissance:r.date_naissance,piece_type:r.piece_type,piece_numero:r.piece_numero,piece_delivree_le:r.piece_delivree_le,piece_expire_le:r.piece_expire_le,piece_pays:r.piece_pays},m=r.role_names||r.roles;!m||m.length===0?this.roleService.getUserRoles(t).subscribe({next:c=>{c.success&&c.data&&(i.roles=c.data.roles),this.userData=i,this.loading=!1},error:()=>{this.userData=i,this.loading=!1}}):(this.userData=i,this.loading=!1)}else this.loading=!1},error:e=>{console.error("Erreur lors du chargement:",e),this.messageService.add({severity:"error",summary:"Erreur",detail:"Erreur lors du chargement de l'utilisateur"}),this.loading=!1}})}onSubmit(t){if(!this.userId)return;this.loading=!0;let e={nom:t.nom,prenom:t.prenom,phone:(t.phone||"").replace(/\s+/g,""),email:t.email||void 0,pays:t.pays,code_pays:t.code_pays,code_phone_pays:this.getCodePhonePays(t.code_pays||"GN"),ville:t.ville,quartier:t.quartier,type:t.type,role:t.role,civilite:t.civilite||null,date_naissance:t.date_naissance||null,piece_type:t.piece_type||null,piece_numero:t.piece_numero||null,piece_delivree_le:t.piece_delivree_le||null,piece_expire_le:t.piece_expire_le||null,piece_pays:t.piece_pays||null};this.userService.updateUser(this.userId,e).subscribe({next:r=>{r.success?(this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Utilisateur modifi\xE9 avec succ\xE8s"}),this.loadUser(this.userId)):this.loading=!1},error:r=>{console.error("Erreur lors de la modification:",r),this.messageService.add({severity:"error",summary:"Erreur",detail:r.error?.message||"Erreur lors de la modification de l'utilisateur"}),this.loading=!1}})}onCancel(){this.router.navigate(["contacts/utilisateurs"])}getCodePhonePays(t){let e=D.find(r=>r.code===t);return e?e.dialCode:"+224"}static \u0275fac=function(e){return new(e||a)(w(Fe),w(F),w(I),w(re),w(U))};static \u0275cmp=T({type:a,selectors:[["app-utilisateurs-edit"]],features:[O([U])],decls:11,vars:2,consts:[[1,"edit-page"],[1,"edit-mobile-header"],["type","button","aria-label","Retour \xE0 la liste",1,"edit-back",3,"click"],[1,"pi","pi-arrow-left"],[1,"edit-title"],[1,"edit-header-spacer"],[1,"edit-content"],["class","flex justify-center items-center h-96",4,"ngIf"],[3,"mode","initialData","loading","submitForm","cancel",4,"ngIf"],[1,"flex","justify-center","items-center","h-96"],[1,"pi","pi-spin","pi-spinner","text-4xl","text-primary"],[3,"submitForm","cancel","mode","initialData","loading"]],template:function(e,r){e&1&&(b(0,"p-toast"),s(1,"div",0)(2,"header",1)(3,"button",2),f("click",function(){return r.onCancel()}),b(4,"i",3),n(),s(5,"h1",4),p(6,"Modifier l'utilisateur"),n(),b(7,"span",5),n(),s(8,"div",6),g(9,Ki,2,0,"div",7)(10,Hi,1,3,"app-utilisateurs-form",8),n()()),e&2&&(o(9),l("ngIf",r.loading&&!r.userData),o(),l("ngIf",r.userData))},dependencies:[P,k,R,K,q],styles:["[_nghost-%COMP%]{display:block}.edit-mobile-header[_ngcontent-%COMP%]{display:none}.edit-content[_ngcontent-%COMP%]{padding:1rem}@media screen and (max-width: 768px){.edit-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;min-height:100dvh;margin:calc(-.25rem - env(safe-area-inset-top)) -.875rem calc(-.875rem - env(safe-area-inset-bottom));margin-left:-.875rem;margin-right:-.875rem;padding:0;padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right);padding-bottom:env(safe-area-inset-bottom);background:#fff}.edit-mobile-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex-shrink:0;padding:calc(.5rem + env(safe-area-inset-top)) .75rem .6rem calc(.875rem + env(safe-area-inset-left));padding-right:calc(.875rem + env(safe-area-inset-right));background:var(--surface-card);border-bottom:1px solid var(--surface-border);box-shadow:0 1px 3px #0000000f;position:sticky;top:0;z-index:25}.edit-back[_ngcontent-%COMP%]{width:2.25rem;height:2.25rem;min-width:2.25rem;border:none;border-radius:50%;background:var(--p-primary-50);color:var(--p-primary-500);display:flex;align-items:center;justify-content:center;cursor:pointer;-webkit-tap-highlight-color:transparent}.edit-back[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1.1rem}.edit-title[_ngcontent-%COMP%]{flex:1;margin:0;font-size:1.15rem;font-weight:700;color:var(--text-color);min-width:0;text-align:center}.edit-header-spacer[_ngcontent-%COMP%]{width:2.25rem;min-width:2.25rem}.edit-content[_ngcontent-%COMP%]{flex:1;min-height:0;overflow-y:auto;-webkit-overflow-scrolling:touch;padding:.875rem;padding-bottom:calc(1rem + env(safe-area-inset-bottom))}}"]})};var En=[{path:"",component:ne,canActivate:[ie],data:{permissions:["users.read"]}},{path:"new",component:se,canActivate:[ie],data:{permissions:["users.create"]}},{path:"edit/:id",component:oe,canActivate:[ie],data:{permissions:["users.update"]}},{path:"**",redirectTo:"/notfound"}];export{En as default};
