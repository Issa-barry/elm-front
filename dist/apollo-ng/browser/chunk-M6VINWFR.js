import{b as bt}from"./chunk-2C634D4G.js";import{a as Ke,b as Xe}from"./chunk-VQCJJPLX.js";import{a as _e,b as fe}from"./chunk-N4EMXPOR.js";import{a as gt,b as _t}from"./chunk-XAPHZIM2.js";import"./chunk-B343KFHS.js";import"./chunk-VBHNODMK.js";import{b as ft}from"./chunk-DY3PXGMS.js";import{a as nt,b as ot}from"./chunk-H75UAUBU.js";import{a as ut,b as mt}from"./chunk-DEFPUDC4.js";import{a as ct,b as pt}from"./chunk-OSPOBHXF.js";import{a as at,b as lt}from"./chunk-W6ATTUIF.js";import{a as Ze,d as $e,e as et,h as tt,i as it,k as rt}from"./chunk-H3KUFEZW.js";import"./chunk-J2NAM4JI.js";import"./chunk-HAPAEHXV.js";import"./chunk-UWQRO6Z5.js";import"./chunk-KBIYZYNQ.js";import{b as be,c as he}from"./chunk-PLDQAYOC.js";import"./chunk-OODPPDAJ.js";import{a as st,b as dt}from"./chunk-LBJBWH2H.js";import"./chunk-QRO5GYCP.js";import"./chunk-6XF2XUWF.js";import"./chunk-KMJ4YXQB.js";import"./chunk-BJ3DV25B.js";import"./chunk-CKKBGSMP.js";import"./chunk-UUZ5LIFL.js";import{a as H}from"./chunk-GBIXBIWJ.js";import{b as Ye,c as Je}from"./chunk-L4DWEOQ4.js";import"./chunk-SIZMBHAK.js";import"./chunk-KE6PKGKV.js";import"./chunk-42H63HPA.js";import{b as te,d as q}from"./chunk-7G5MAEGV.js";import{a as z,b as j}from"./chunk-QTD5PLHI.js";import"./chunk-WU36US54.js";import"./chunk-OAY6NCLF.js";import{a as Se,d as Re}from"./chunk-64S7HSEB.js";import{c as oe,d as Ue,e as ae}from"./chunk-OPAF3U63.js";import"./chunk-QO7YANFN.js";import{c as me,d as ge}from"./chunk-3ZFUBRWI.js";import"./chunk-VV6ELWME.js";import"./chunk-VSD657XK.js";import"./chunk-Z2X2BPAP.js";import{a as qe,b as ze,c as je,d as Ge}from"./chunk-F4Z36YAX.js";import{a as pe,b as ue}from"./chunk-OVLHBJZG.js";import{b as le,e as se,h as de,n as Ne,p as ce}from"./chunk-4JYGVSAH.js";import{a as He,b as Qe}from"./chunk-AGXCPBUM.js";import"./chunk-VPIKZKGZ.js";import"./chunk-YNVQ7POR.js";import"./chunk-3QS7CSSK.js";import"./chunk-BODZH67C.js";import"./chunk-7UZYWCAJ.js";import{i as re,j as ne}from"./chunk-LBKL4PXF.js";import{a as We,b as Be}from"./chunk-G5FZIH5E.js";import{la as ie,pa as w}from"./chunk-5CRI5L3F.js";import{j as Ae,k as N,v as L}from"./chunk-PVTSUL7D.js";import"./chunk-4O3FVBGX.js";import{Ab as a,Bb as n,Cb as f,D as Te,G as Ie,Jb as h,La as F,Na as W,Nb as _,O as Fe,Ob as c,Pa as s,Sb as K,T as Ve,Tb as X,Ua as J,Ub as Z,X as De,Xb as B,Zb as $,_a as y,_b as we,ac as p,ba as u,bc as O,ca as m,cc as E,db as V,dc as ee,f as Me,fc as v,ga as R,gc as P,hc as x,jb as g,jc as D,kc as U,o as M,oa as Le,u as Ee,yc as S,zb as d}from"./chunk-WZ5FQRRG.js";import{a as k,b as Y,c as ye}from"./chunk-GAL4ENT6.js";var A={materiel:"Mat\xE9riel",service:"Service",fabricable:"Fabricable",achat_vente:"Achat/Vente"},T={brouillon:"Brouillon",actif:"Actif",inactif:"Inactif",archive:"Archiv\xE9",rupture_stock:"Rupture de stock"},ve={brouillon:"secondary",actif:"success",inactif:"danger",archive:"danger",rupture_stock:"warn"};var C=class r{id=0;nom="";code="";prix_usine=null;prix_vente=null;prix_achat=null;qte_stock=0;seuil_alerte_stock=null;cout=null;statut="brouillon";type="materiel";in_stock=!0;is_archived=!1;is_critique=!1;last_stockout_notified_at=null;archived_at=null;description=null;image_url=null;created_by=null;updated_by=null;deleted_by=null;archived_by=null;created_at="";updated_at="";deleted_at=null;creator;updater;archiver;deleter;created_by_name;updated_by_name;archived_by_name;deleted_by_name;constructor(t){t&&Object.assign(this,t)}getImageUrl(t="assets/demo/images/no-product.png"){return this.image_url?this.image_url.startsWith("http://")||this.image_url.startsWith("https://")?this.image_url:`assets/demo/images/produits/${this.image_url}`:t}formatPrix(t,e="GNF"){return`${(typeof t=="number"?t:0).toLocaleString("fr-FR")} ${e}`}static fromApi(t){return new r(Y(k({},t),{prix_usine:t?.prix_usine!==null&&t?.prix_usine!==void 0?Number(t.prix_usine):null,prix_vente:t?.prix_vente!==null&&t?.prix_vente!==void 0?Number(t.prix_vente):null,prix_achat:t?.prix_achat!==null&&t?.prix_achat!==void 0?Number(t.prix_achat):null,cout:t?.cout!==null&&t?.cout!==void 0?Number(t.cout):null,is_critique:t?.is_critique??!1,last_stockout_notified_at:t?.last_stockout_notified_at??null,seuil_alerte_stock:t?.seuil_alerte_stock!==null&&t?.seuil_alerte_stock!==void 0?Number(t.seuil_alerte_stock):null}))}static fromApiArray(t){return t.map(e=>r.fromApi(e))}};var I=class r{constructor(t){this.http=t}apiUrl=`${Ye.apiUrl}/produits`;getAll(){return this.http.get(this.apiUrl).pipe(M(t=>C.fromApiArray(t.data)))}getAllFiltered(t={}){let e=new Se;return t.statut&&(e=e.set("statut",t.statut)),t.type&&(e=e.set("type",t.type)),t.in_stock!==null&&t.in_stock!==void 0&&(e=e.set("in_stock",String(t.in_stock))),t.sort_by&&(e=e.set("sort_by",t.sort_by)),t.sort_order&&(e=e.set("sort_order",t.sort_order)),this.http.get(this.apiUrl,{params:e}).pipe(M(i=>C.fromApiArray(i.data)))}getArchived(){return this.http.get(`${this.apiUrl}/archived`).pipe(M(t=>C.fromApiArray(t.data)))}search(t){let e=new Se;return t.search&&(e=e.set("search",t.search)),t.type&&(e=e.set("type",t.type)),t.statut&&(e=e.set("statut",t.statut)),t.in_stock!==void 0&&(e=e.set("in_stock",t.in_stock.toString())),t.page&&(e=e.set("page",t.page.toString())),t.per_page&&(e=e.set("per_page",t.per_page.toString())),t.sort_by&&(e=e.set("sort_by",t.sort_by)),t.sort_order&&(e=e.set("sort_order",t.sort_order)),this.http.get(`${this.apiUrl}/search`,{params:e}).pipe(M(i=>C.fromApiArray(i.data.produits)))}getStatistics(){return this.http.get(`${this.apiUrl}/statistics`).pipe(M(t=>t.data))}getById(t){return this.http.get(`${this.apiUrl}/${t}`).pipe(M(e=>C.fromApi(e.data)))}create(t){let o=t,{image:e}=o,i=ye(o,["image"]);return this.http.post(this.apiUrl,i).pipe(M(l=>C.fromApi(l.data)))}update(t,e){let l=e,{image:i}=l,o=ye(l,["image"]);return this.http.put(`${this.apiUrl}/${t}`,o).pipe(M(b=>C.fromApi(b.data)))}uploadProduitImage(t,e){let i=new FormData;return i.append("image",e,e.name),this.http.post(`${this.apiUrl}/${t}/image`,i).pipe(M(o=>C.fromApi(o.data)))}deleteProduitImage(t){return this.http.delete(`${this.apiUrl}/${t}/image`).pipe(M(e=>C.fromApi(e.data)))}delete(t){return this.http.delete(`${this.apiUrl}/${t}`)}updateStock(t,e){return this.http.patch(`${this.apiUrl}/${t}/stock`,e).pipe(M(i=>C.fromApi(i.data)))}changeStatus(t,e){return this.http.patch(`${this.apiUrl}/${t}/status`,e).pipe(M(i=>C.fromApi(i.data)))}archive(t){return this.http.patch(`${this.apiUrl}/${t}/archive`,{}).pipe(M(e=>C.fromApi(e.data)))}unarchive(t){return this.http.patch(`${this.apiUrl}/${t}/unarchive`,{}).pipe(M(e=>C.fromApi(e.data)))}static \u0275fac=function(e){return new(e||r)(De(Re))};static \u0275prov=Ve({token:r,factory:r.\u0275fac,providedIn:"root"})};var Et=["dt"],Tt=()=>({"min-width":"75rem"}),It=()=>[10,20,30],Ft=()=>({width:"720px",maxWidth:"95vw"}),Vt=()=>({width:"450px"}),Dt=()=>({showDelay:800});function Lt(r,t){if(r&1&&(a(0,"span",47),p(1),n()),r&2){let e=c();s(),O(e.activeFiltersCount)}}function At(r,t){if(r&1&&f(0,"img",66),r&2){let e=c().$implicit;d("src",e.getImageUrl(),F)("alt",e.nom)}}function Rt(r,t){r&1&&(a(0,"div",67),f(1,"i",68),n())}function Wt(r,t){r&1&&f(0,"p-tag",69),r&2&&d("rounded",!0)}function Bt(r,t){if(r&1){let e=h();a(0,"article",50),_("click",function(o){let l=u(e).$implicit,b=c(2);return m(b.goToEditProduit(o,l.id))}),a(1,"div",51),g(2,At,1,2,"img",52)(3,Rt,2,0,"div",53),n(),a(4,"div",54)(5,"div",55)(6,"div",56)(7,"div",57),p(8),n(),a(9,"div",58),p(10),n()(),a(11,"div",59),f(12,"p-tag",60),g(13,Wt,1,1,"p-tag",61),n()(),a(14,"div",62)(15,"span",63),p(16),n(),a(17,"div",64)(18,"button",65),_("click",function(o){let l=u(e).$implicit,b=c(2);return m(b.goToEditProduit(o,l.id))}),n()()()()()}if(r&2){let e=t.$implicit,i=c(2);s(2),d("ngIf",e.image_url),s(),d("ngIf",!e.image_url),s(5),O(e.code||"Sans code"),s(2),O(e.nom),s(2),d("value",i.getStatutLabel(e.statut))("severity",i.getStatutSeverity(e.statut)),s(),d("ngIf",e.is_critique),s(3),ee("",e.qte_stock," en stock \xB7 ",i.formatCurrency(e.prix_vente)),s(2),d("disabled",!i.canUpdate)}}function Ut(r,t){if(r&1&&(a(0,"section",48),g(1,Bt,19,10,"article",49),n()),r&2){let e=c();s(),d("ngForOf",e.mobileVisibleProduits)("ngForTrackBy",e.trackByProduitId)}}function Nt(r,t){r&1&&(a(0,"div",71),p(1,"Chargement des produits..."),n())}function qt(r,t){if(r&1&&(a(0,"div",71),f(1,"i",72),p(2),n()),r&2){let e=c(2);s(2),E(" Aucun produit",e.activeFiltersCount>0?" pour ces filtres":" trouv\xE9",". ")}}function zt(r,t){if(r&1&&g(0,Nt,2,0,"div",70)(1,qt,3,1,"div",70),r&2){let e=c();d("ngIf",e.loading),s(),d("ngIf",!e.loading&&!e.produits.length)}}function jt(r,t){if(r&1){let e=h();a(0,"div",73)(1,"p-button",74),_("onClick",function(){u(e);let o=c();return m(o.loadMoreMobile())}),n()()}}function Gt(r,t){if(r&1){let e=h();a(0,"button",75),_("click",function(){u(e);let o=c();return m(o.goToNewProduits())}),f(1,"i",76),a(2,"span",77),p(3,"Nouveau produit"),n()()}}function Ht(r,t){if(r&1){let e=h();a(0,"div",78)(1,"p-button",79),_("onClick",function(){u(e);let o=c();return m(o.resetMobileFiltersTemp())}),n(),a(2,"p-button",80),_("onClick",function(){u(e);let o=c();return m(o.applyMobileFilters())}),n()()}r&2&&(s(),d("outlined",!0))}function Qt(r,t){if(r&1){let e=h();a(0,"p-button",83),_("onClick",function(){u(e);let o=c(2);return m(o.goToNewProduits())}),n()}if(r&2){let e=c(2);d("disabled",!e.canCreate)}}function Yt(r,t){if(r&1){let e=h();a(0,"p-button",84),_("onClick",function(){u(e);let o=c(2);return m(o.deleteSelectedProducts())}),n()}if(r&2){let e=c(2);d("disabled",!e.selectedProduits||!e.selectedProduits.length)}}function Jt(r,t){if(r&1&&g(0,Qt,1,1,"p-button",81)(1,Yt,1,1,"p-button",82),r&2){let e=c();d("ngIf",e.canCreate),s(),d("ngIf",e.canDelete)}}function Kt(r,t){if(r&1){let e=h();a(0,"p-button",85),_("onClick",function(){u(e);let o=c();return m(o.exportCSV())}),n()}}function Xt(r,t){if(r&1){let e=h();a(0,"p-button",86),_("onClick",function(){u(e);let o=c();return m(o.resetAllFilters())}),n()}r&2&&d("text",!0)}function Zt(r,t){if(r&1&&(a(0,"span",87),p(1),n()),r&2){let e=c();s(),ee(" ",e.produits.length," r\xE9sultat",e.produits.length>1?"s":""," ")}}function $t(r,t){if(r&1){let e=h();a(0,"div",88)(1,"h5",89),p(2,"Gestion des Produits"),n(),a(3,"p-iconfield"),f(4,"p-inputicon",19),a(5,"input",90),_("input",function(o){u(e);let l=c(),b=B(57);return m(l.onGlobalFilter(b,o))}),n()()()}}function ei(r,t){r&1&&(a(0,"tr")(1,"th",91),f(2,"p-tableHeaderCheckbox"),n(),a(3,"th",92),p(4,"Image"),n(),a(5,"th",93)(6,"span",94),p(7,"Code "),f(8,"p-sortIcon",95),n()(),a(9,"th",96)(10,"span",94),p(11,"Nom "),f(12,"p-sortIcon",97),n()(),a(13,"th",98)(14,"span",94),p(15,"Type "),f(16,"p-sortIcon",99),n()(),a(17,"th",100)(18,"span",94),p(19,"Qt\xE9 "),f(20,"p-sortIcon",101),n()(),a(21,"th",102)(22,"span",94),p(23,"Status "),f(24,"p-sortIcon",103),n()(),a(25,"th",104),p(26,"Action"),n()())}function ti(r,t){if(r&1&&f(0,"img",114),r&2){let e=c().$implicit;d("src",e.getImageUrl(),F)("alt",e.nom)}}function ii(r,t){r&1&&f(0,"i",115)}function ri(r,t){r&1&&f(0,"p-tag",116),r&2&&d("rounded",!0)}function ni(r,t){if(r&1){let e=h();a(0,"p-button",117),_("click",function(){u(e);let o=c().$implicit,l=c();return m(l.deleteProduct(o))}),n()}r&2&&d("rounded",!0)("outlined",!0)}function oi(r,t){if(r&1){let e=h();a(0,"tr",105),_("dblclick",function(o){let l=u(e).$implicit,b=c();return m(b.onRowDblClick(o,l))}),a(1,"td",91),f(2,"p-tableCheckbox",106),n(),a(3,"td",92),g(4,ti,1,2,"img",107)(5,ii,1,0,"i",108),n(),a(6,"td",104),p(7),n(),a(8,"td",109)(9,"span"),p(10),n(),g(11,ri,1,1,"p-tag",110),n(),a(12,"td"),p(13),n(),a(14,"td"),p(15),n(),a(16,"td"),f(17,"p-tag",111),n(),a(18,"td")(19,"button",112),_("click",function(o){let l=u(e).$implicit,b=c();return m(b.goToEditProduit(o,l.id))}),n(),g(20,ni,1,2,"p-button",113),n()()}if(r&2){let e=t.$implicit,i=c();d("tooltipOptions",U(15,Dt))("tooltipDisabled",!i.canUpdate),s(2),d("value",e),s(2),d("ngIf",e.image_url),s(),d("ngIf",!e.image_url),s(2),O(e.code),s(3),O(e.nom),s(),d("ngIf",e.is_critique),s(2),O(i.getTypeLabel(e.type)),s(2),O(e.qte_stock),s(2),d("value",i.getStatutLabel(e.statut))("severity",i.getStatutSeverity(e.statut)),s(2),d("pTooltip",i.canUpdate?"Modifier":"Voir")("disabled",!i.canUpdate),s(),d("ngIf",i.canDelete)}}function ai(r,t){if(r&1){let e=h();a(0,"div",140)(1,"label",141),p(2,"Code"),n(),a(3,"input",142),x("ngModelChange",function(o){u(e);let l=c(2);return P(l.produit.code,o)||(l.produit.code=o),m(o)}),n()()}if(r&2){let e=c(2);s(3),v("ngModel",e.produit.code),d("disabled",!0)}}function li(r,t){r&1&&(a(0,"small",143),p(1,"Type obligatoire."),n())}function si(r,t){r&1&&(a(0,"small",143),p(1,"Nom obligatoire."),n())}function di(r,t){if(r&1){let e=h();a(0,"div")(1,"label",144),p(2,"Statut"),n(),a(3,"p-select",145),x("ngModelChange",function(o){u(e);let l=c(2);return P(l.produit.statut,o)||(l.produit.statut=o),m(o)}),n()()}if(r&2){let e=c(2);s(3),v("ngModel",e.produit.statut),d("options",e.statutOptions)}}function ci(r,t){if(r&1){let e=h();g(0,ai,4,2,"div",118),a(1,"div",119)(2,"div")(3,"label",120),p(4,"Type"),n(),a(5,"p-select",121),x("ngModelChange",function(o){u(e);let l=c();return P(l.produit.type,o)||(l.produit.type=o),m(o)}),n(),g(6,li,2,0,"small",122),n(),a(7,"div")(8,"label",123),p(9,"Nom"),n(),a(10,"input",124),x("ngModelChange",function(o){u(e);let l=c();return P(l.produit.nom,o)||(l.produit.nom=o),m(o)}),n(),g(11,si,2,0,"small",122),n(),a(12,"div")(13,"label",125),p(14,"Description"),n(),a(15,"textarea",126),x("ngModelChange",function(o){u(e);let l=c();return P(l.produit.description,o)||(l.produit.description=o),m(o)}),n()(),g(16,di,4,2,"div",127),a(17,"div",128)(18,"div",129)(19,"label",130),p(20,"Quantit\xE9"),n(),a(21,"p-inputnumber",131),x("ngModelChange",function(o){u(e);let l=c();return P(l.produit.qte_stock,o)||(l.produit.qte_stock=o),m(o)}),n()(),a(22,"div",129)(23,"label",132),p(24,"Co\xFBt"),n(),a(25,"p-inputnumber",133),x("ngModelChange",function(o){u(e);let l=c();return P(l.produit.cout,o)||(l.produit.cout=o),m(o)}),n()()(),a(26,"div",128)(27,"div",129)(28,"label",134),p(29,"Prix achat"),n(),a(30,"p-inputnumber",135),x("ngModelChange",function(o){u(e);let l=c();return P(l.produit.prix_achat,o)||(l.produit.prix_achat=o),m(o)}),n()(),a(31,"div",129)(32,"label",136),p(33,"Prix vente"),n(),a(34,"p-inputnumber",137),x("ngModelChange",function(o){u(e);let l=c();return P(l.produit.prix_vente,o)||(l.produit.prix_vente=o),m(o)}),n()()(),a(35,"div")(36,"label",138),p(37,"Prix usine"),n(),a(38,"p-inputnumber",139),x("ngModelChange",function(o){u(e);let l=c();return P(l.produit.prix_usine,o)||(l.produit.prix_usine=o),m(o)}),n()()()}if(r&2){let e=c();d("ngIf",e.produit==null?null:e.produit.id),s(5),v("ngModel",e.produit.type),d("options",e.typeOptions),s(),d("ngIf",e.submitted&&!e.produit.type),s(4),v("ngModel",e.produit.nom),s(),d("ngIf",e.submitted&&!(e.produit.nom!=null&&e.produit.nom.trim())),s(4),v("ngModel",e.produit.description),s(),d("ngIf",e.produit==null?null:e.produit.id),s(5),v("ngModel",e.produit.qte_stock),s(4),v("ngModel",e.produit.cout),s(5),v("ngModel",e.produit.prix_achat),s(4),v("ngModel",e.produit.prix_vente),s(4),v("ngModel",e.produit.prix_usine)}}function pi(r,t){if(r&1){let e=h();a(0,"p-button",146),_("click",function(){u(e);let o=c();return m(o.hideDialog())}),n(),a(1,"p-button",147),_("click",function(){u(e);let o=c();return m(o.saveProduit())}),n()}if(r&2){let e=c();d("disabled",e.saving),s(),d("disabled",e.saving)("loading",e.saving)}}var Q=class r{constructor(t,e,i,o,l,b,sr){this.router=t;this.route=e;this.produitService=i;this.messageService=o;this.confirmationService=l;this.authService=b;this.document=sr;this.canCreate=this.authService.hasPermission("produits.create"),this.canUpdate=this.authService.hasPermission("produits.update"),this.canDelete=this.authService.hasPermission("produits.delete")}produits=[];produit=new C;loading=!0;saving=!1;filterFields=["code","nom","description","type","statut","qte_stock"];produitDialog=!1;selectedProduits;submitted=!1;typeOptions=[];statutOptions=[];dt;exportColumns;cols;canCreate=!1;canUpdate=!1;canDelete=!1;mobileSearchTerm="";mobilePageSize=8;mobileVisibleCount=this.mobilePageSize;mobileBreakpoint=768;mobilePwaClass="produits-mobile-pwa";filterStatut=null;filterType=null;filterInStock=null;sortBy="created_at";sortOrder="desc";mobileFilterVisible=!1;tempFilterStatut=null;tempFilterType=null;tempFilterInStock=null;destroy$=new Me;searchSubject=new Me;ngOnInit(){this.initOptions(),this.initColumns(),this.syncMobilePwaMode(),this.searchSubject.pipe(Te(450),Ie(),Fe(this.destroy$)).subscribe(()=>{this.resetMobilePagination(),this.syncUrl(),this.loadWithFilters()});let t=this.route.snapshot.queryParams;this.filterStatut=t.statut||null,this.filterType=t.type||null,this.filterInStock=t.in_stock!==void 0?t.in_stock==="true":null,this.sortBy=t.sort_by||"created_at",this.sortOrder=t.sort_order==="asc"?"asc":"desc",t.search&&(this.mobileSearchTerm=t.search),this.loadWithFilters()}ngOnDestroy(){this.clearMobilePwaMode(),this.destroy$.next(),this.destroy$.complete()}onWindowResize(){this.syncMobilePwaMode()}loadWithFilters(){this.loading=!0;let t=this.mobileSearchTerm.trim(),e=!!t,i=!!(this.filterStatut||this.filterType||this.filterInStock!==null);(e||i?this.produitService.search(Y(k(k(k(k({},t&&{search:t}),this.filterStatut&&{statut:this.filterStatut}),this.filterType&&{type:this.filterType}),this.filterInStock!==null&&{in_stock:this.filterInStock}),{sort_by:this.sortBy,sort_order:this.sortOrder})):this.produitService.getAllFiltered({sort_by:this.sortBy,sort_order:this.sortOrder})).subscribe({next:l=>{this.produits=l,this.resetMobilePagination(),this.loading=!1},error:l=>{this.loading=!1,this.showApiError(l,"Chargement des produits impossible")}})}syncUrl(){let t={};this.mobileSearchTerm.trim()&&(t.search=this.mobileSearchTerm.trim()),this.filterStatut&&(t.statut=this.filterStatut),this.filterType&&(t.type=this.filterType),this.filterInStock!==null&&(t.in_stock=String(this.filterInStock)),this.sortBy!=="created_at"&&(t.sort_by=this.sortBy),this.sortOrder!=="desc"&&(t.sort_order=this.sortOrder),this.router.navigate([],{relativeTo:this.route,queryParams:t,replaceUrl:!0})}onDesktopFilterChange(){this.resetMobilePagination(),this.syncUrl(),this.loadWithFilters()}resetAllFilters(){this.filterStatut=null,this.filterType=null,this.filterInStock=null,this.mobileSearchTerm="",this.resetMobilePagination(),this.syncUrl(),this.loadWithFilters()}get activeFiltersCount(){return[this.filterStatut,this.filterType,this.filterInStock].filter(t=>t!==null).length}openMobileFilters(){this.tempFilterStatut=this.filterStatut,this.tempFilterType=this.filterType,this.tempFilterInStock=this.filterInStock,this.mobileFilterVisible=!0}applyMobileFilters(){this.filterStatut=this.tempFilterStatut,this.filterType=this.tempFilterType,this.filterInStock=this.tempFilterInStock,this.mobileFilterVisible=!1,this.resetMobilePagination(),this.syncUrl(),this.loadWithFilters()}resetMobileFiltersTemp(){this.tempFilterStatut=null,this.tempFilterType=null,this.tempFilterInStock=null}onMobileSearchChange(t){this.mobileVisibleCount=this.mobilePageSize,this.searchSubject.next(t)}get mobileVisibleProduits(){return this.produits.slice(0,this.mobileVisibleCount)}get canLoadMoreMobile(){return this.mobileVisibleCount<this.produits.length}loadMoreMobile(){this.mobileVisibleCount+=this.mobilePageSize}trackByProduitId(t,e){return e.id||e.code||t}exportCSV(){this.dt.exportCSV()}initOptions(){this.typeOptions=Object.entries(A).map(([t,e])=>({label:e,value:t})),this.statutOptions=Object.entries(T).map(([t,e])=>({label:e,value:t}))}initColumns(){this.cols=[{field:"code",header:"Code",customExportHeader:"Product Code"},{field:"nom",header:"Nom"},{field:"image",header:"Image"},{field:"prix_vente",header:"Prix"},{field:"type",header:"Type"}],this.exportColumns=this.cols.map(t=>({title:t.header,dataKey:t.field}))}openNew(){this.produit=new C,this.submitted=!1,this.produitDialog=!0}editProduct(t){this.produit=new C(k({},t)),this.produitDialog=!0}deleteSelectedProducts(){this.confirmationService.confirm({message:"Are you sure you want to delete the selected products?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{let t=(this.selectedProduits??[]).map(e=>e.id).filter(e=>!!e);t.length!==0&&Ee(t.map(e=>this.produitService.delete(e))).subscribe({next:()=>{this.produits=this.produits.filter(e=>!t.includes(e.id)),this.selectedProduits=null,this.messageService.add({severity:"success",summary:"Successful",detail:"Products Deleted",life:3e3})},error:e=>this.showApiError(e,"Suppression impossible")})}})}hideDialog(){this.produitDialog=!1,this.submitted=!1}deleteProduct(t){this.confirmationService.confirm({message:"Are you sure you want to delete "+(t.nom||"this product")+"?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{t.id&&this.produitService.delete(t.id).subscribe({next:()=>{this.produits=this.produits.filter(e=>e.id!==t.id),this.messageService.add({severity:"success",summary:"Successful",detail:"Product Deleted",life:3e3})},error:e=>this.showApiError(e,"Suppression impossible")})}})}getStatutSeverity(t){return t?ve[t]??ve.brouillon:ve.brouillon}getStatutLabel(t){return t?T[t]??T.brouillon:T.brouillon}getTypeLabel(t){return t?A[t]??t:"-"}formatCurrency(t){return typeof t!="number"?"-":`${new Intl.NumberFormat("fr-GN",{maximumFractionDigits:0}).format(t)} GNF`}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}saveProduit(){if(this.submitted=!0,!this.produit.nom?.trim()||!this.produit.type||this.saving)return;this.saving=!0;let t={nom:this.produit.nom.trim(),type:this.produit.type,qte_stock:this.produit.qte_stock??0,statut:this.produit.statut,cout:this.produit.cout??void 0,description:this.produit.description??void 0,prix_usine:this.produit.prix_usine??void 0,prix_vente:this.produit.prix_vente??void 0,prix_achat:this.produit.prix_achat??void 0},e=!!this.produit.id;(e?this.produitService.update(this.produit.id,t):this.produitService.create(t)).subscribe({next:()=>{this.produitDialog=!1,this.produit=new C,this.submitted=!1,this.saving=!1,this.loadWithFilters(),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:e?"Produit mis \xE0 jour":"Produit cr\xE9\xE9",life:3e3})},error:o=>{this.saving=!1,this.showApiError(o,"Sauvegarde impossible")}})}showApiError(t,e){t.status===422&&t.error?.errors?Object.values(t.error.errors).flat().forEach(o=>this.messageService.add({severity:"error",summary:"Validation",detail:o,life:5e3})):this.messageService.add({severity:"error",summary:"Erreur",detail:this.extractErrorMessage(t,e),life:5e3})}extractErrorMessage(t,e){return typeof t?.error?.message=="string"&&t.error.message.trim()?t.error.message:typeof t?.message=="string"&&t.message.trim()?t.message:e}goToNewProduits(){this.router.navigate(["/produits/produits-new"])}goHome(){this.router.navigate(["/"])}goToEditProduit(t,e){t.stopPropagation(),this.router.navigate(["/produits/produits-edit",e])}onRowDblClick(t,e){window.innerWidth<=this.mobileBreakpoint||t.target.closest('button, a, input, textarea, select, [role="button"], .p-checkbox, .p-button, .p-link')||this.router.navigate(["/produits/produits-edit",e.id])}resetMobilePagination(){this.mobileVisibleCount=this.mobilePageSize}syncMobilePwaMode(){typeof window>"u"||(window.innerWidth<=this.mobileBreakpoint?this.document.body.classList.add(this.mobilePwaClass):this.clearMobilePwaMode())}clearMobilePwaMode(){this.document.body.classList.remove(this.mobilePwaClass)}static \u0275fac=function(e){return new(e||r)(y(q),y(te),y(I),y(w),y(ie),y(Je),y(R))};static \u0275cmp=V({type:r,selectors:[["app-produits-liste"]],viewQuery:function(e,i){if(e&1&&K(Et,5),e&2){let o;X(o=Z())&&(i.dt=o.first)}},hostBindings:function(e,i){e&1&&_("resize",function(){return i.onWindowResize()},W)},features:[D([w,I,ie])],decls:70,vars:49,consts:[["mobileListState",""],["footer",""],["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["content",""],[1,"produits-mobile-app"],[1,"mobile-header"],["pButton","","pRipple","","icon","pi pi-arrow-left","aria-label","Retour \xE0 l'accueil",1,"p-button-rounded","p-button-text","mobile-back",3,"click"],[1,"mobile-title-wrap"],[1,"mobile-title"],[1,"mobile-subtitle"],["pButton","","pRipple","","icon","pi pi-upload","aria-label","Export",1,"p-button-rounded","p-button-text","mobile-add",3,"click"],[1,"mobile-scroll"],[1,"mobile-search-row"],[1,"mobile-search"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Rechercher un produit...",3,"ngModelChange","ngModel"],["type","button","aria-label","Filtres",1,"mobile-filter-btn",3,"click"],[1,"pi","pi-filter"],["class","mobile-filter-badge",4,"ngIf"],["class","mobile-list",4,"ngIf","ngIfElse"],["class","mobile-load-more",4,"ngIf"],["type","button","class","mobile-fab","aria-label","Nouveau produit",3,"click",4,"ngIf"],["position","right","styleClass","mobile-filter-drawer","header","Filtres",3,"visibleChange","visible"],[1,"filter-drawer-body"],[1,"filter-group"],[1,"filter-label"],["optionLabel","label","optionValue","value","placeholder","Tous les statuts","fluid","",3,"ngModelChange","ngModel","options","showClear"],["optionLabel","label","optionValue","value","placeholder","Tous les types","fluid","",3,"ngModelChange","ngModel","options","showClear"],[1,"filter-toggle-row"],[1,"filter-label","filter-label--inline"],[3,"ngModelChange","ngModel"],[1,"card","produits-desktop"],["styleClass","mb-4"],[1,"desktop-filter-bar"],["optionLabel","label","optionValue","value","placeholder","Tous les statuts","styleClass","desktop-filter-select",3,"ngModelChange","onChange","ngModel","options","showClear"],["optionLabel","label","optionValue","value","placeholder","Tous les types","styleClass","desktop-filter-select",3,"ngModelChange","onChange","ngModel","options","showClear"],[1,"desktop-filter-toggle"],[1,"desktop-filter-toggle-label"],["label","R\xE9initialiser","icon","pi pi-times","severity","secondary","size","small",3,"text","onClick",4,"ngIf"],["class","desktop-filter-count",4,"ngIf"],["dataKey","id","currentPageReportTemplate","  {first} \xE0 {last} sur {totalRecords} produits",3,"selectionChange","value","loading","rows","columns","paginator","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions"],[3,"visibleChange","visible","header","modal"],[1,"mobile-filter-badge"],[1,"mobile-list"],["class","mobile-produit-card",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mobile-produit-card",3,"click"],[1,"mobile-card-media"],["class","mobile-card-thumb",3,"src","alt",4,"ngIf"],["class","mobile-card-image-placeholder","aria-hidden","true",4,"ngIf"],[1,"mobile-card-body"],[1,"mobile-card-top"],[1,"mobile-card-main"],[1,"mobile-code"],[1,"mobile-name"],[1,"flex","flex-col","items-end","gap-1"],["styleClass","mobile-status-tag",3,"value","severity"],["value","Critique","severity","warn","icon","pi pi-exclamation-triangle",3,"rounded",4,"ngIf"],[1,"mobile-card-footer"],[1,"mobile-card-summary"],[1,"mobile-card-actions"],["pButton","","pRipple","","icon","pi pi-chevron-right",1,"p-button-rounded","p-button-text","p-button-sm","mobile-chevron-action",3,"click","disabled"],[1,"mobile-card-thumb",3,"src","alt"],["aria-hidden","true",1,"mobile-card-image-placeholder"],[1,"pi","pi-box"],["value","Critique","severity","warn","icon","pi pi-exclamation-triangle",3,"rounded"],["class","mobile-state",4,"ngIf"],[1,"mobile-state"],[1,"pi","pi-inbox",2,"font-size","2rem","display","block","margin-bottom","0.5rem"],[1,"mobile-load-more"],["label","Charger plus","icon","pi pi-angle-down","styleClass","mobile-load-more-btn",3,"onClick"],["type","button","aria-label","Nouveau produit",1,"mobile-fab",3,"click"],[1,"pi","pi-plus"],[1,"mobile-fab-label"],[1,"filter-drawer-footer"],["label","R\xE9initialiser","severity","secondary","styleClass","flex-1",3,"onClick","outlined"],["label","Appliquer","styleClass","flex-1",3,"onClick"],["label","Nouveau","icon","pi pi-plus","severity","secondary","class","mr-2",3,"disabled","onClick",4,"ngIf"],["severity","secondary","label","Delete","icon","pi pi-trash","outlined","",3,"disabled","onClick",4,"ngIf"],["label","Nouveau","icon","pi pi-plus","severity","secondary",1,"mr-2",3,"onClick","disabled"],["severity","secondary","label","Delete","icon","pi pi-trash","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["label","R\xE9initialiser","icon","pi pi-times","severity","secondary","size","small",3,"onClick","text"],[1,"desktop-filter-count"],[1,"flex","items-center","justify-between"],[1,"m-0"],["pInputText","","type","text","placeholder","Rechercher...",3,"input"],[2,"width","3rem"],[2,"width","5rem"],["pSortableColumn","code",2,"min-width","16rem"],[1,"flex","items-center","gap-2"],["field","code"],["pSortableColumn","nom",2,"min-width","16rem"],["field","nom"],["pSortableColumn","type",2,"min-width","10rem"],["field","type"],["pSortableColumn","qte_stock",2,"min-width","12rem"],["field","qte_stock"],["pSortableColumn","statut",2,"min-width","12rem"],["field","statut"],[2,"min-width","12rem"],["pTooltip","Double-cliquez pour modifier","tooltipPosition","left",1,"produit-row",3,"dblclick","tooltipOptions","tooltipDisabled"],[3,"value"],["style","width: 48px; height: 48px; object-fit: contain;","class","rounded border border-surface-200",3,"src","alt",4,"ngIf"],["class","pi pi-image text-surface-300 text-2xl",4,"ngIf"],[2,"min-width","16rem"],["value","Critique","severity","warn","icon","pi pi-exclamation-triangle","styleClass","ml-2",3,"rounded",4,"ngIf"],[3,"value","severity"],["pButton","","pRipple","","icon","pi pi-eye","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm","mr-2",3,"click","pTooltip","disabled"],["icon","pi pi-trash","severity","danger",3,"rounded","outlined","click",4,"ngIf"],[1,"rounded","border","border-surface-200",2,"width","48px","height","48px","object-fit","contain",3,"src","alt"],[1,"pi","pi-image","text-surface-300","text-2xl"],["value","Critique","severity","warn","icon","pi pi-exclamation-triangle","styleClass","ml-2",3,"rounded"],["icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"],["class","mb-4",4,"ngIf"],[1,"flex","flex-col","gap-6"],["for","type",1,"block","font-bold","mb-4"],["inputId","type","optionLabel","label","optionValue","value","placeholder","S\xE9lectionner un type","fluid","",3,"ngModelChange","ngModel","options"],["class","text-red-500",4,"ngIf"],["for","nom",1,"block","font-bold","mb-4"],["type","text","pInputText","","id","nom","required","","autofocus","","fluid","",3,"ngModelChange","ngModel"],["for","description",1,"block","font-bold","mb-4"],["id","description","pTextarea","","rows","3","cols","20","fluid","",3,"ngModelChange","ngModel"],[4,"ngIf"],[1,"grid","grid-cols-12","gap-4"],[1,"col-span-6"],["for","qte_stock",1,"block","font-bold","mb-4"],["id","qte_stock","fluid","",3,"ngModelChange","ngModel"],["for","cout",1,"block","font-bold","mb-4"],["id","cout","mode","currency","currency","GNF","locale","fr-GN","fluid","",3,"ngModelChange","ngModel"],["for","prix_achat",1,"block","font-bold","mb-4"],["id","prix_achat","mode","currency","currency","GNF","locale","fr-GN","fluid","",3,"ngModelChange","ngModel"],["for","prix_vente",1,"block","font-bold","mb-4"],["id","prix_vente","mode","currency","currency","GNF","locale","fr-GN","fluid","",3,"ngModelChange","ngModel"],["for","prix_usine",1,"block","font-bold","mb-4"],["id","prix_usine","mode","currency","currency","GNF","locale","fr-GN","fluid","",3,"ngModelChange","ngModel"],[1,"mb-4"],["for","code",1,"block","font-bold","mb-4"],["type","text","pInputText","","id","code","fluid","",3,"ngModelChange","ngModel","disabled"],[1,"text-red-500"],["for","statut",1,"block","font-bold","mb-4"],["inputId","statut","optionLabel","label","optionValue","value","placeholder","S\xE9lectionner un statut","fluid","",3,"ngModelChange","ngModel","options"],["label","Annuler","icon","pi pi-times","text","",3,"click","disabled"],["label","Enregistrer","icon","pi pi-check",3,"click","disabled","loading"]],template:function(e,i){if(e&1){let o=h();f(0,"p-toast"),a(1,"div",9)(2,"header",10)(3,"button",11),_("click",function(){return u(o),m(i.goHome())}),n(),a(4,"div",12)(5,"h1",13),p(6,"Produits"),n(),a(7,"p",14),p(8),n()(),a(9,"button",15),_("click",function(){return u(o),m(i.exportCSV())}),n()(),a(10,"div",16)(11,"div",17)(12,"section",18)(13,"p-iconfield"),f(14,"p-inputicon",19),a(15,"input",20),x("ngModelChange",function(b){return u(o),P(i.mobileSearchTerm,b)||(i.mobileSearchTerm=b),m(b)}),_("ngModelChange",function(b){return u(o),m(i.onMobileSearchChange(b))}),n()()(),a(16,"button",21),_("click",function(){return u(o),m(i.openMobileFilters())}),f(17,"i",22),g(18,Lt,2,1,"span",23),n()(),g(19,Ut,2,2,"section",24)(20,zt,2,2,"ng-template",null,0,S)(22,jt,2,0,"div",25),n(),g(23,Gt,4,0,"button",26),a(24,"p-drawer",27),x("visibleChange",function(b){return u(o),P(i.mobileFilterVisible,b)||(i.mobileFilterVisible=b),m(b)}),a(25,"div",28)(26,"div",29)(27,"label",30),p(28,"Statut"),n(),a(29,"p-select",31),x("ngModelChange",function(b){return u(o),P(i.tempFilterStatut,b)||(i.tempFilterStatut=b),m(b)}),n()(),a(30,"div",29)(31,"label",30),p(32,"Type"),n(),a(33,"p-select",32),x("ngModelChange",function(b){return u(o),P(i.tempFilterType,b)||(i.tempFilterType=b),m(b)}),n()(),a(34,"div",29)(35,"div",33)(36,"label",34),p(37,"En stock uniquement"),n(),a(38,"p-toggleswitch",35),_("ngModelChange",function(b){return u(o),m(i.tempFilterInStock=b?!0:null)}),n()()()(),g(39,Ht,3,1,"ng-template",null,1,S),n()(),a(41,"div",36)(42,"p-toolbar",37),g(43,Jt,2,2,"ng-template",null,2,S)(45,Kt,1,0,"ng-template",null,3,S),n(),a(47,"div",38)(48,"p-select",39),x("ngModelChange",function(b){return u(o),P(i.filterStatut,b)||(i.filterStatut=b),m(b)}),_("onChange",function(){return u(o),m(i.onDesktopFilterChange())}),n(),a(49,"p-select",40),x("ngModelChange",function(b){return u(o),P(i.filterType,b)||(i.filterType=b),m(b)}),_("onChange",function(){return u(o),m(i.onDesktopFilterChange())}),n(),a(50,"div",41)(51,"p-toggleswitch",35),_("ngModelChange",function(b){return u(o),i.filterInStock=b?!0:null,m(i.onDesktopFilterChange())}),n(),a(52,"span",42),p(53,"En stock"),n()(),g(54,Xt,1,1,"p-button",43)(55,Zt,2,2,"span",44),n(),a(56,"p-table",45,4),x("selectionChange",function(b){return u(o),P(i.selectedProduits,b)||(i.selectedProduits=b),m(b)}),g(58,$t,6,0,"ng-template",null,5,S)(60,ei,27,0,"ng-template",null,6,S)(62,oi,21,16,"ng-template",null,7,S),n()(),a(64,"p-dialog",46),x("visibleChange",function(b){return u(o),P(i.produitDialog,b)||(i.produitDialog=b),m(b)}),g(65,ci,39,13,"ng-template",null,8,S)(67,pi,2,3,"ng-template",null,1,S),n(),f(69,"p-confirmdialog")}if(e&2){let o=B(21);s(8),ee("",i.produits.length," produit",i.produits.length>1?"s":""),s(7),v("ngModel",i.mobileSearchTerm),s(),$("mobile-filter-btn--active",i.activeFiltersCount>0),s(2),d("ngIf",i.activeFiltersCount>0),s(),d("ngIf",!i.loading&&i.mobileVisibleProduits.length)("ngIfElse",o),s(3),d("ngIf",!i.loading&&i.canLoadMoreMobile),s(),d("ngIf",i.canCreate),s(),v("visible",i.mobileFilterVisible),s(5),v("ngModel",i.tempFilterStatut),d("options",i.statutOptions)("showClear",!0),s(4),v("ngModel",i.tempFilterType),d("options",i.typeOptions)("showClear",!0),s(5),d("ngModel",i.tempFilterInStock===!0),s(10),v("ngModel",i.filterStatut),d("options",i.statutOptions)("showClear",!0),s(),v("ngModel",i.filterType),d("options",i.typeOptions)("showClear",!0),s(2),d("ngModel",i.filterInStock===!0),s(3),d("ngIf",i.activeFiltersCount>0),s(),d("ngIf",!i.loading),s(),d("value",i.produits)("loading",i.loading)("rows",10)("columns",i.cols)("paginator",!0)("globalFilterFields",i.filterFields)("tableStyle",U(45,Tt)),v("selection",i.selectedProduits),d("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",U(46,It)),s(8),we(U(47,Ft)),v("visible",i.produitDialog),d("header",i.produit!=null&&i.produit.id?"Modifier un produit":"Nouveau produit")("modal",!0),s(5),we(U(48,Vt))}},dependencies:[L,Ae,N,rt,Ze,$e,et,tt,it,ce,le,se,Ne,de,ae,oe,Ue,ne,re,j,z,ot,nt,ue,pe,mt,ut,ge,me,he,be,lt,at,dt,st,Ge,je,ze,qe,pt,ct,Qe,He,Xe,Ke,fe,_e],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block}.produits-mobile-app[_ngcontent-%COMP%]{display:none}.produits-desktop[_ngcontent-%COMP%]     .produit-row{cursor:pointer}@media screen and (max-width: 768px){[_nghost-%COMP%]{--mobile-primary: #5f6bff;--mobile-text: #334155;--mobile-muted: #7f8ca3;--mobile-card: #f9fbff;--mobile-border: #dbe2ee}.produits-desktop[_ngcontent-%COMP%]{display:none}.produits-mobile-app[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;min-height:100dvh;height:100vh;height:100dvh;overflow:hidden;margin-top:calc(-.25rem - env(safe-area-inset-top));margin-left:-.875rem;margin-right:-.875rem;margin-bottom:calc(-.875rem - env(safe-area-inset-bottom));padding:0 .875rem env(safe-area-inset-bottom);padding-left:calc(.875rem + env(safe-area-inset-left));padding-right:calc(.875rem + env(safe-area-inset-right));background:linear-gradient(180deg,#f3f5f9,#eaedf4 58%,#e5eaf1);animation:_ngcontent-%COMP%_mobileFade .24s ease-out}.mobile-header[_ngcontent-%COMP%]{flex-shrink:0;display:flex;align-items:center;gap:.55rem;margin:0 -.875rem;padding:calc(.5rem + env(safe-area-inset-top)) calc(.875rem + env(safe-area-inset-right)) .6rem calc(.875rem + env(safe-area-inset-left));background:var(--mobile-card);border-bottom:1px solid var(--mobile-border);box-shadow:0 1px 3px #0f172a0f;position:sticky;top:0;z-index:30}.mobile-scroll[_ngcontent-%COMP%]{flex:1;min-height:0;overflow-y:auto;-webkit-overflow-scrolling:touch;padding-top:.75rem;padding-bottom:calc(4rem + env(safe-area-inset-bottom))}.mobile-back[_ngcontent-%COMP%], .mobile-add[_ngcontent-%COMP%]{width:2.15rem;height:2.15rem;border-radius:999px;flex-shrink:0;color:var(--mobile-primary)!important;background:#5f6bff1a!important}.mobile-title-wrap[_ngcontent-%COMP%]{flex:1;min-width:0;text-align:center}.mobile-title[_ngcontent-%COMP%]{margin:0;font-size:1.35rem;line-height:1.1;font-weight:800;color:var(--mobile-text)}.mobile-subtitle[_ngcontent-%COMP%]{margin:.2rem 0 0;font-size:.76rem;font-weight:600;color:var(--mobile-muted)}.mobile-search[_ngcontent-%COMP%]{background:#f7f9fd;border:1.5px solid var(--mobile-border);border-radius:.95rem;padding:.35rem .55rem;box-shadow:inset 0 1px #ffffffb3}.mobile-search[_ngcontent-%COMP%]   .p-iconfield[_ngcontent-%COMP%], .mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]{width:100%}.mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]{border:0;box-shadow:none;background:transparent;color:var(--mobile-text);font-size:.96rem}.mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]::placeholder{color:#92a0b7}.mobile-quick-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.4rem;padding:0 .15rem}.mobile-quick-actions[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]{flex:1}.mobile-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.65rem;margin-top:1rem}.mobile-produit-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem;background:var(--mobile-card);border:1px solid var(--mobile-border);border-radius:1rem;padding:.9rem;box-shadow:0 10px 24px #0f172a0f;cursor:pointer;transition:box-shadow .2s ease}.mobile-produit-card[_ngcontent-%COMP%]:active{box-shadow:0 4px 12px #0f172a14}.mobile-card-media[_ngcontent-%COMP%]{flex-shrink:0}.mobile-card-thumb[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:.65rem;object-fit:contain;border:1px solid var(--mobile-border);background:#fff}.mobile-card-image-placeholder[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:.65rem;background:#eef1f6;border:1px solid var(--mobile-border);display:flex;align-items:center;justify-content:center}.mobile-card-image-placeholder[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1.5rem;color:#92a0b7}.mobile-card-body[_ngcontent-%COMP%]{flex:1;min-width:0}.mobile-card-top[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;gap:.5rem;margin-bottom:.4rem}.mobile-card-main[_ngcontent-%COMP%]{flex:1;min-width:0}.mobile-code[_ngcontent-%COMP%]{margin-bottom:.1rem;font-size:.72rem;line-height:1.2;color:#8b98b0;letter-spacing:.02em;font-weight:700}.mobile-name[_ngcontent-%COMP%]{font-size:1rem;line-height:1.25;font-weight:700;color:var(--mobile-text);word-break:break-word}.mobile-card-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:.5rem;flex-wrap:wrap}.mobile-card-summary[_ngcontent-%COMP%]{font-size:.8rem;color:var(--mobile-muted);font-weight:600}.mobile-card-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.35rem}.mobile-chevron-action[_ngcontent-%COMP%]{width:2.05rem;height:2.05rem;color:var(--mobile-muted)!important;flex-shrink:0}.mobile-state[_ngcontent-%COMP%]{margin-top:1rem;background:#f8faff;border:1px dashed var(--mobile-border);border-radius:1rem;padding:1rem;text-align:center;color:var(--mobile-muted);font-size:.9rem}.mobile-load-more[_ngcontent-%COMP%]{padding-top:.4rem}.mobile-fab[_ngcontent-%COMP%]{position:fixed;bottom:calc(1rem + env(safe-area-inset-bottom));right:calc(1rem + env(safe-area-inset-right));z-index:25;width:3.5rem;height:3.5rem;min-width:3.5rem;min-height:3.5rem;padding:0;border:none;border-radius:50%;background:var(--mobile-primary);color:#fff;box-shadow:0 4px 14px #5f6bff73;display:flex;align-items:center;justify-content:center;gap:.35rem;font-weight:700;font-size:.9rem;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease;-webkit-tap-highlight-color:transparent}.mobile-fab[_ngcontent-%COMP%]:active{transform:scale(.96)}.mobile-fab[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1.35rem}.mobile-fab-label[_ngcontent-%COMP%]{display:none}}@media screen and (max-width: 768px) and (min-width: 400px){.mobile-fab[_ngcontent-%COMP%]{width:auto;height:3rem;min-height:3rem;padding:0 1.25rem;border-radius:999px}.mobile-fab-label[_ngcontent-%COMP%]{display:inline}}@media screen and (max-width: 768px){[_nghost-%COMP%]     .mobile-action-btn{width:100%;justify-content:flex-start;border:0!important;background:transparent!important;color:#4f5d79!important;padding:.35rem .45rem!important;font-weight:700;border-radius:.7rem;box-shadow:none!important}[_nghost-%COMP%]     .mobile-action-btn .p-button-icon{color:var(--mobile-primary);font-size:.95rem}[_nghost-%COMP%]     .mobile-action-btn .p-button-label{font-size:.95rem}[_nghost-%COMP%]     .mobile-status-tag{font-size:.79rem;font-weight:700;border-radius:.55rem;padding:.22rem .55rem}[_nghost-%COMP%]     .mobile-status-tag.p-tag-success{background:#d9f7e5;color:#168f4a}[_nghost-%COMP%]     .mobile-status-tag.p-tag-warn, [_nghost-%COMP%]     .mobile-status-tag.p-tag-warning{background:#ffe8d3;color:#dc6408}[_nghost-%COMP%]     .mobile-status-tag.p-tag-danger{background:#ffe3e1;color:#dd3f39}[_nghost-%COMP%]     .mobile-status-tag.p-tag-secondary{background:#e8edf6;color:#64748b}[_nghost-%COMP%]     .mobile-delete-action{width:2.05rem;height:2.05rem;border-radius:999px!important;border-color:#ffb9b4!important;color:#ef4444!important;background:#ffffffe6!important}[_nghost-%COMP%]     .mobile-delete-action .p-button-icon{font-size:.84rem}[_nghost-%COMP%]     .mobile-load-more-btn{width:100%;border-radius:999px;justify-content:center;font-weight:700;border:1px solid #cfd7ff;background:#eef2ff;color:#4f5df4}.app-dark   [_nghost-%COMP%]{--mobile-primary: var(--p-primary-400);--mobile-text: var(--p-surface-100);--mobile-muted: var(--p-surface-400);--mobile-card: var(--p-surface-800);--mobile-border: var(--p-surface-600)}.app-dark[_nghost-%COMP%]   .produits-mobile-app[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .produits-mobile-app[_ngcontent-%COMP%]{background:var(--p-surface-950)}.app-dark[_nghost-%COMP%]   .mobile-header[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-header[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0003}.app-dark[_nghost-%COMP%]   .mobile-search[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-search[_ngcontent-%COMP%]{background:var(--p-surface-800);border-color:var(--p-surface-600);box-shadow:none}.app-dark[_nghost-%COMP%]   .mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]::placeholder, .app-dark   [_nghost-%COMP%]   .mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]::placeholder{color:var(--p-surface-500)}.app-dark[_nghost-%COMP%]   .mobile-produit-card[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-produit-card[_ngcontent-%COMP%]{box-shadow:0 4px 12px #00000026}.app-dark[_nghost-%COMP%]   .mobile-produit-card[_ngcontent-%COMP%]:active, .app-dark   [_nghost-%COMP%]   .mobile-produit-card[_ngcontent-%COMP%]:active{box-shadow:0 4px 12px #00000040}.app-dark[_nghost-%COMP%]   .mobile-card-image-placeholder[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-card-image-placeholder[_ngcontent-%COMP%]{background:var(--p-surface-700);border-color:var(--p-surface-600)}.app-dark[_nghost-%COMP%]   .mobile-card-image-placeholder[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-card-image-placeholder[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .mobile-code[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-code[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .mobile-state[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-state[_ngcontent-%COMP%]{background:var(--p-surface-800);border-color:var(--p-surface-600);color:var(--p-surface-400)}.app-dark   [_nghost-%COMP%]     .mobile-action-btn{color:var(--p-surface-300)!important}.app-dark   [_nghost-%COMP%]     .mobile-action-btn .p-button-icon{color:var(--p-primary-400)}.app-dark   [_nghost-%COMP%]     .mobile-status-tag.p-tag-success{background:#05966933;color:#34d399}.app-dark   [_nghost-%COMP%]     .mobile-status-tag.p-tag-warn, .app-dark   [_nghost-%COMP%]     .mobile-status-tag.p-tag-warning{background:#d9770633;color:#fbbf24}.app-dark   [_nghost-%COMP%]     .mobile-status-tag.p-tag-danger{background:#dc262633;color:#f87171}.app-dark   [_nghost-%COMP%]     .mobile-status-tag.p-tag-secondary{background:var(--p-surface-700);color:var(--p-surface-300)}.app-dark   [_nghost-%COMP%]     .mobile-delete-action{border-color:var(--p-surface-600)!important;background:var(--p-surface-700)!important;color:#f87171!important}.app-dark   [_nghost-%COMP%]     .mobile-load-more-btn{border-color:var(--p-surface-600);background:var(--p-surface-800);color:var(--p-primary-400)}}@keyframes _ngcontent-%COMP%_mobileFade{0%{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}@media screen and (max-width: 768px){.mobile-search-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.mobile-search-row[_ngcontent-%COMP%]   .mobile-search[_ngcontent-%COMP%]{flex:1}.mobile-filter-btn[_ngcontent-%COMP%]{position:relative;width:2.5rem;height:2.5rem;flex-shrink:0;border-radius:.65rem;border:1.5px solid var(--mobile-border);background:#f7f9fd;color:var(--mobile-muted);display:flex;align-items:center;justify-content:center;cursor:pointer;-webkit-tap-highlight-color:transparent;transition:background .15s ease,border-color .15s ease}.mobile-filter-btn[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1rem}.mobile-filter-btn--active[_ngcontent-%COMP%]{background:#5f6bff1a;border-color:var(--mobile-primary);color:var(--mobile-primary)}.mobile-filter-badge[_ngcontent-%COMP%]{position:absolute;top:-.3rem;right:-.3rem;width:1.15rem;height:1.15rem;border-radius:50%;background:var(--mobile-primary);color:#fff;font-size:.62rem;font-weight:700;display:flex;align-items:center;justify-content:center;line-height:1}[_nghost-%COMP%]     .mobile-filter-drawer{width:min(320px,88vw)!important}[_nghost-%COMP%]     .mobile-filter-drawer .p-drawer-content{padding:1rem 1.25rem;overflow-y:auto}[_nghost-%COMP%]     .mobile-filter-drawer .p-drawer-footer{padding:.75rem 1.25rem 1rem;border-top:1px solid var(--mobile-border)}.filter-drawer-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.filter-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.filter-label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:700;text-transform:uppercase;letter-spacing:.06em;color:#94a3b8;margin-bottom:.1rem}.filter-label--inline[_ngcontent-%COMP%]{margin-bottom:0;font-size:.85rem;text-transform:none;letter-spacing:0;color:#334155;font-weight:600}.filter-toggle-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.65rem 0;border-top:1px solid var(--mobile-border);border-bottom:1px solid var(--mobile-border)}.filter-drawer-footer[_ngcontent-%COMP%]{display:flex;gap:.75rem}.filter-drawer-footer[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]{flex:1}.app-dark[_nghost-%COMP%]   .mobile-filter-btn[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-filter-btn[_ngcontent-%COMP%]{background:var(--p-surface-800);border-color:var(--p-surface-600);color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .mobile-filter-btn--active[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-filter-btn--active[_ngcontent-%COMP%]{background:rgba(var(--p-primary-400-rgb, 95, 107, 255),.15);border-color:var(--p-primary-400);color:var(--p-primary-400)}.app-dark[_nghost-%COMP%]   .filter-label--inline[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .filter-label--inline[_ngcontent-%COMP%]{color:var(--p-surface-200)}.app-dark[_nghost-%COMP%]   .filter-toggle-row[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .filter-toggle-row[_ngcontent-%COMP%]{border-color:var(--p-surface-600)}.app-dark   [_nghost-%COMP%]     .mobile-filter-drawer .p-drawer-footer{border-top-color:var(--p-surface-700)}}.desktop-filter-bar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 0 1rem;flex-wrap:wrap;border-bottom:1px solid var(--p-surface-100);margin-bottom:.5rem}.app-dark[_nghost-%COMP%]   .desktop-filter-bar[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .desktop-filter-bar[_ngcontent-%COMP%]{border-bottom-color:var(--p-surface-700)}[_nghost-%COMP%]     .desktop-filter-select{min-width:11rem}.desktop-filter-toggle[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.desktop-filter-toggle-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:var(--p-surface-600)}.desktop-filter-count[_ngcontent-%COMP%]{margin-left:auto;font-size:.82rem;color:var(--p-surface-400);font-weight:500}.app-dark[_nghost-%COMP%]   .desktop-filter-toggle-label[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .desktop-filter-toggle-label[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .desktop-filter-count[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .desktop-filter-count[_ngcontent-%COMP%]{color:var(--p-surface-500)}']})};var ui=["buttonEl"];function mi(r,t){if(r&1){let e=h();a(0,"button",78),_("click",function(){u(e);let o=c();return m(o.enableEditing())}),n()}}function gi(r,t){r&1&&(a(0,"div",81),f(1,"i",82),a(2,"span"),p(3,"Ajouter une photo"),n()())}function _i(r,t){if(r&1){let e=h();a(0,"button",88),_("click",function(o){u(e);let l=c(4);return m(l.removeImage(o))}),f(1,"i",89),n()}}function fi(r,t){r&1&&(a(0,"div",90),f(1,"i",91),n())}function bi(r,t){if(r&1){let e=h();a(0,"div",92)(1,"p",93),p(2,"Supprimer cette image ?"),n(),a(3,"div",94)(4,"button",95),_("click",function(o){u(e);let l=c(4);return m(l.confirmDeleteImage(o))}),n(),a(5,"button",96),_("click",function(o){u(e);let l=c(4);return m(l.cancelDeleteImage(o))}),n()()()}}function hi(r,t){if(r&1&&(a(0,"div",83),f(1,"img",84),g(2,_i,2,0,"button",85)(3,fi,2,0,"div",86)(4,bi,6,0,"div",87),n()),r&2){let e=c(3);s(),d("src",e.imagePreview||e.product.getImageUrl(),F),s(),d("ngIf",!e.fieldsDisabled&&!e.confirmingDelete&&!e.loading),s(),d("ngIf",e.loading&&e.selectedImageFile),s(),d("ngIf",e.confirmingDelete)}}function vi(r,t){if(r&1){let e=h();a(0,"div",80),_("click",function(){u(e),c();let o=B(2),l=c();return m(!l.fieldsDisabled&&o.advancedFileInput.nativeElement.click())}),g(1,gi,4,0,"div",14)(2,hi,5,4,"div",13),n()}if(r&2){let e=c(2);s(),d("ngIf",!e.imagePreview&&!e.product.image_url),s(),d("ngIf",e.imagePreview||e.product.image_url)}}function Pi(r,t){if(r&1){let e=h();a(0,"div")(1,"p-fileUpload",79,0),_("onSelect",function(o){u(e);let l=c();return m(l.onUpload(o))}),g(3,vi,3,2,"ng-template",null,1,S),n()()}if(r&2){let e=c();s(),d("customUpload",!0)("multiple",!1)("showUploadButton",!1)("showCancelButton",!1)("auto",!0)("disabled",e.fieldsDisabled)}}function xi(r,t){if(r&1&&(a(0,"small",101),f(1,"i",102),p(2),n()),r&2){let e=c(2);s(2),E("",e.imageError," ")}}function Ci(r,t){if(r&1&&(a(0,"div",97)(1,"small",98),f(2,"i",99),p(3,"JPG, PNG, WebP \u2014 5 Mo max "),n(),g(4,xi,3,1,"small",100),n()),r&2){let e=c();s(4),d("ngIf",e.imageError)}}function yi(r,t){if(r&1&&(a(0,"div",83),f(1,"img",84),n()),r&2){let e=c();s(),d("src",e.product.getImageUrl(),F)}}function Mi(r,t){r&1&&(a(0,"div",81),f(1,"i",103),a(2,"span"),p(3,"Aucune image"),n()())}function wi(r,t){r&1&&(a(0,"small",104),f(1,"i",48),p(2," Stock non g\xE9r\xE9 pour les services "),n())}function Si(r,t){r&1&&(a(0,"small",105),p(1," Nom du produit obligatoire. "),n())}function Oi(r,t){r&1&&(a(0,"small",105),p(1," Obligatoire "),n())}function ki(r,t){if(r&1){let e=h();a(0,"div",26)(1,"span",27),p(2,"Achat"),n(),a(3,"p-inputnumber",106),x("ngModelChange",function(o){u(e);let l=c();return P(l.product.prix_achat,o)||(l.product.prix_achat=o),m(o)}),n(),g(4,Oi,2,0,"small",23),n()}if(r&2){let e=c();s(3),v("ngModel",e.product.prix_achat),d("min",0)("disabled",e.fieldsDisabled)("invalid",e.submitted&&e.isPrixAchatRequired()&&e.isPriceMissing(e.product.prix_achat)),s(),d("ngIf",e.submitted&&e.isPrixAchatRequired()&&e.isPriceMissing(e.product.prix_achat)&&e.isEditing)}}function Ei(r,t){r&1&&(a(0,"small",105),p(1," Obligatoire "),n())}function Ti(r,t){if(r&1){let e=h();a(0,"div",26)(1,"span",27),p(2,"Vente"),n(),a(3,"p-inputnumber",106),x("ngModelChange",function(o){u(e);let l=c();return P(l.product.prix_vente,o)||(l.product.prix_vente=o),m(o)}),n(),g(4,Ei,2,0,"small",23),n()}if(r&2){let e=c();s(3),v("ngModel",e.product.prix_vente),d("min",0)("disabled",e.fieldsDisabled)("invalid",e.submitted&&e.isPrixVenteRequired()&&e.isPriceMissing(e.product.prix_vente)),s(),d("ngIf",e.submitted&&e.isPrixVenteRequired()&&e.isPriceMissing(e.product.prix_vente)&&e.isEditing)}}function Ii(r,t){r&1&&(a(0,"small",105),p(1," Obligatoire "),n())}function Fi(r,t){if(r&1){let e=h();a(0,"div",26)(1,"span",27),p(2,"Usine"),n(),a(3,"p-inputnumber",106),x("ngModelChange",function(o){u(e);let l=c();return P(l.product.prix_usine,o)||(l.product.prix_usine=o),m(o)}),n(),g(4,Ii,2,0,"small",23),n()}if(r&2){let e=c();s(3),v("ngModel",e.product.prix_usine),d("min",0)("disabled",e.fieldsDisabled)("invalid",e.submitted&&e.isPrixUsineRequired()&&e.isPriceMissing(e.product.prix_usine)),s(),d("ngIf",e.submitted&&e.isPrixUsineRequired()&&e.isPriceMissing(e.product.prix_usine)&&e.isEditing)}}function Vi(r,t){r&1&&(a(0,"div",107),f(1,"i",108),p(2," Au moins un prix requis pour un service. "),n())}function Di(r,t){if(r&1&&(a(0,"small",105),p(1),n()),r&2){let e=c(2);s(),E(" ",e.getSeuilAlerteStockErrorMessage()," ")}}function Li(r,t){if(r&1){let e=h();a(0,"div",15)(1,"label",18),p(2,"Seuil d'alerte stock"),n(),a(3,"p-inputnumber",109),x("ngModelChange",function(o){u(e);let l=c();return P(l.product.seuil_alerte_stock,o)||(l.product.seuil_alerte_stock=o),m(o)}),n(),a(4,"small",104),f(5,"i",48),p(6," D\xE9clenche l'alerte quand le stock atteint ce seuil. "),n(),g(7,Di,2,1,"small",23),n()}if(r&2){let e=c();s(3),v("ngModel",e.product.seuil_alerte_stock),d("showButtons",!0)("min",0)("minFractionDigits",0)("maxFractionDigits",0)("disabled",e.isSeuilAlerteStockDisabled())("invalid",e.submitted&&e.isSeuilAlerteStockInvalid()),s(4),d("ngIf",e.submitted&&e.isSeuilAlerteStockInvalid()&&e.isEditing)}}function Ai(r,t){if(r&1){let e=h();a(0,"div",110)(1,"button",111),_("click",function(){u(e);let o=c();return m(o.onSubmit())}),n(),a(2,"button",112),_("click",function(){u(e);let o=c();return m(o.mode==="create"?o.onCancel():o.cancelEditing())}),n()()}if(r&2){let e=c();s(),d("label",e.mode==="create"?"Enregistrer":"Sauvegarder")("loading",e.loading)("disabled",!e.isValid()||e.loading),s(),d("disabled",e.loading)}}function Ri(r,t){if(r&1){let e=h();a(0,"button",113),_("click",function(){u(e);let o=c();return m(o.enableEditing())}),n()}}function Wi(r,t){r&1&&(a(0,"span",105),p(1,"*"),n())}function Bi(r,t){r&1&&(a(0,"span",105),p(1,"*"),n())}function Ui(r,t){r&1&&(a(0,"small",105),p(1," Nom du produit obligatoire. "),n())}function Ni(r,t){r&1&&(a(0,"small",105),p(1," Prix d'achat obligatoire pour ce type. "),n())}function qi(r,t){if(r&1){let e=h();a(0,"div",114)(1,"p-inputnumber",115),x("ngModelChange",function(o){u(e);let l=c();return P(l.product.prix_achat,o)||(l.product.prix_achat=o),m(o)}),n(),g(2,Ni,2,0,"small",23),n()}if(r&2){let e=c();s(),v("ngModel",e.product.prix_achat),d("min",0)("disabled",e.fieldsDisabled)("invalid",e.submitted&&e.isPrixAchatRequired()&&e.isPriceMissing(e.product.prix_achat)),s(),d("ngIf",e.submitted&&e.isPrixAchatRequired()&&e.isPriceMissing(e.product.prix_achat)&&e.isEditing)}}function zi(r,t){r&1&&(a(0,"small",105),p(1," Prix de vente obligatoire pour ce type. "),n())}function ji(r,t){if(r&1){let e=h();a(0,"div",114)(1,"p-inputnumber",116),x("ngModelChange",function(o){u(e);let l=c();return P(l.product.prix_vente,o)||(l.product.prix_vente=o),m(o)}),n(),g(2,zi,2,0,"small",23),n()}if(r&2){let e=c();s(),v("ngModel",e.product.prix_vente),d("min",0)("disabled",e.fieldsDisabled)("invalid",e.submitted&&e.isPrixVenteRequired()&&e.isPriceMissing(e.product.prix_vente)),s(),d("ngIf",e.submitted&&e.isPrixVenteRequired()&&e.isPriceMissing(e.product.prix_vente)&&e.isEditing)}}function Gi(r,t){r&1&&(a(0,"small",105),p(1,' Prix usine obligatoire pour "Fabricable". '),n())}function Hi(r,t){if(r&1){let e=h();a(0,"div",114)(1,"p-inputnumber",117),x("ngModelChange",function(o){u(e);let l=c();return P(l.product.prix_usine,o)||(l.product.prix_usine=o),m(o)}),n(),g(2,Gi,2,0,"small",23),n()}if(r&2){let e=c();s(),v("ngModel",e.product.prix_usine),d("min",0)("disabled",e.fieldsDisabled)("invalid",e.submitted&&e.isPrixUsineRequired()&&e.isPriceMissing(e.product.prix_usine)),s(),d("ngIf",e.submitted&&e.isPrixUsineRequired()&&e.isPriceMissing(e.product.prix_usine)&&e.isEditing)}}function Qi(r,t){r&1&&(a(0,"div",118),f(1,"i",119),p(2," Pour un service, renseignez au moins un prix : achat ou vente. "),n())}function Yi(r,t){r&1&&(a(0,"div",126),f(1,"i",127),a(2,"span",128),p(3,"Ajouter une image"),n(),a(4,"span",129),p(5,"Cliquez pour s\xE9lectionner"),n()())}function Ji(r,t){if(r&1){let e=h();a(0,"button",136),_("click",function(o){u(e);let l=c(4);return m(l.removeImage(o))}),f(1,"i",89),n()}}function Ki(r,t){r&1&&(a(0,"div",137),f(1,"i",138),n())}function Xi(r,t){if(r&1){let e=h();a(0,"div",139)(1,"p",140),p(2,"Supprimer cette image ?"),n(),a(3,"div",141)(4,"button",95),_("click",function(o){u(e);let l=c(4);return m(l.confirmDeleteImage(o))}),n(),a(5,"button",96),_("click",function(o){u(e);let l=c(4);return m(l.cancelDeleteImage(o))}),n()()()}}function Zi(r,t){if(r&1&&(a(0,"div",130)(1,"div",131),f(2,"img",132),g(3,Ji,2,0,"button",133)(4,Ki,2,0,"div",134)(5,Xi,6,0,"div",135),n()()),r&2){let e=c(3);s(2),d("src",e.imagePreview||e.product.getImageUrl(),F),s(),d("ngIf",!e.fieldsDisabled&&!e.confirmingDelete&&!e.loading),s(),d("ngIf",e.loading&&e.selectedImageFile),s(),d("ngIf",e.confirmingDelete)}}function $i(r,t){if(r&1){let e=h();a(0,"div",123),_("click",function(){u(e),c();let o=B(2),l=c();return m(!l.fieldsDisabled&&o.advancedFileInput.nativeElement.click())}),g(1,Yi,6,0,"div",124)(2,Zi,6,4,"div",125),n()}if(r&2){let e=c(2);s(),d("ngIf",!e.imagePreview&&!e.product.image_url),s(),d("ngIf",e.imagePreview||e.product.image_url)}}function er(r,t){if(r&1&&(a(0,"small",142),f(1,"i",102),p(2),n()),r&2){let e=c(2);s(2),E("",e.imageError," ")}}function tr(r,t){if(r&1){let e=h();a(0,"div")(1,"p-fileUpload",120,2),_("onSelect",function(o){u(e);let l=c();return m(l.onUpload(o))}),g(3,$i,3,2,"ng-template",null,1,S),n(),a(5,"small",121),f(6,"i",99),p(7,"JPG, PNG, WebP \u2014 5 Mo max "),n(),g(8,er,3,1,"small",122),n()}if(r&2){let e=c();s(),d("customUpload",!0)("multiple",!1)("showUploadButton",!1)("showCancelButton",!1)("auto",!0)("disabled",e.fieldsDisabled),s(7),d("ngIf",e.imageError)}}function ir(r,t){if(r&1&&(a(0,"div",143),f(1,"img",132),n()),r&2){let e=c();s(),d("src",e.product.getImageUrl(),F)}}function rr(r,t){if(r&1&&(a(0,"small",147),p(1),n()),r&2){let e=c(2);s(),E(" ",e.getSeuilAlerteStockErrorMessage()," ")}}function nr(r,t){if(r&1){let e=h();a(0,"div",63)(1,"span",64),p(2,"Seuil d'alerte stock"),n(),a(3,"div",65)(4,"p-inputnumber",144),x("ngModelChange",function(o){u(e);let l=c();return P(l.product.seuil_alerte_stock,o)||(l.product.seuil_alerte_stock=o),m(o)}),n(),a(5,"small",145),f(6,"i",99),p(7,"D\xE9clenche l'alerte quand le stock atteint ce seuil. "),n(),g(8,rr,2,1,"small",146),n()()}if(r&2){let e=c();s(4),v("ngModel",e.product.seuil_alerte_stock),d("showButtons",!0)("min",0)("minFractionDigits",0)("maxFractionDigits",0)("disabled",e.isSeuilAlerteStockDisabled())("invalid",e.submitted&&e.isSeuilAlerteStockInvalid()),s(4),d("ngIf",e.submitted&&e.isSeuilAlerteStockInvalid()&&e.isEditing)}}function or(r,t){r&1&&(a(0,"small",148),f(1,"i",99),p(2,"Le stock n'est pas g\xE9r\xE9 pour les services. "),n())}function ar(r,t){if(r&1){let e=h();a(0,"div",149)(1,"div",150)(2,"button",151),_("click",function(){u(e);let o=c();return m(o.onSubmit())}),n(),a(3,"button",152),_("click",function(){u(e);let o=c();return m(o.mode==="create"?o.onCancel():o.cancelEditing())}),n()()()}if(r&2){let e=c();s(2),d("label",e.mode==="create"?"Enregistrer":"Sauvegarder")("loading",e.loading)("disabled",!e.isValid()||e.loading),s(),d("disabled",e.loading)}}var G=class r{static ALLOWED_TYPES=["image/jpeg","image/png","image/webp"];static MAX_SIZE=5*1024*1024;buttonEl;mode="create";initialData=null;loading=!1;submitForm=new J;cancel=new J;deleteImage=new J;submitted=!1;isEditing=!1;typeOptions=[{label:A.materiel,value:"materiel"},{label:A.service,value:"service"},{label:A.fabricable,value:"fabricable"},{label:A.achat_vente,value:"achat_vente"}];statutOptions=[{label:T.brouillon,value:"brouillon"},{label:T.actif,value:"actif"},{label:T.inactif,value:"inactif"},{label:T.rupture_stock,value:"rupture_stock"}];product=new C({nom:"",code:"",prix_usine:null,prix_achat:null,prix_vente:null,qte_stock:0,cout:null,statut:"actif",type:"materiel",in_stock:!0,is_archived:!1,is_critique:!1,seuil_alerte_stock:null,description:null,image_url:null});selectedImageFile=null;imagePreview=null;imageError=null;confirmingDelete=!1;ngOnInit(){this.initialData&&(this.product=new C(this.initialData),this.imagePreview=this.initialData.image_url),this.mode==="create"&&(this.isEditing=!0)}isPrixUsineVisible(){return this.product.type==="fabricable"}isPrixUsineRequired(){return this.product.type==="fabricable"}isPrixAchatVisible(){return["materiel","service","achat_vente"].includes(this.product.type)}isPrixVenteVisible(){return["service","fabricable","achat_vente"].includes(this.product.type)}isPrixVenteRequired(){return["fabricable","achat_vente"].includes(this.product.type)}ngOnChanges(t){t.initialData?.currentValue&&(this.revokePreviewUrl(),this.product=new C(t.initialData.currentValue),this.imagePreview=t.initialData.currentValue.image_url??null,this.mode==="edit"&&(this.isEditing=!1,this.submitted=!1,this.selectedImageFile=null,this.imageError=null,this.confirmingDelete=!1)),t.mode?.currentValue==="create"&&(this.isEditing=!0)}isPrixAchatRequired(){return["materiel","achat_vente"].includes(this.product.type)}isQteStockDisabled(){return this.product.type==="service"||this.fieldsDisabled}isSeuilAlerteStockDisabled(){return this.product.type==="service"||this.fieldsDisabled}isSeuilAlerteStockVisible(){return this.product.is_critique===!0&&this.product.type!=="service"}isSeuilAlerteStockInvalid(){let t=this.product.seuil_alerte_stock;if(t==null)return!1;let e=Number(t);return!Number.isInteger(e)||e<0}getSeuilAlerteStockErrorMessage(){let t=this.product.seuil_alerte_stock;if(t==null)return"";let e=Number(t);return Number.isInteger(e)?e<0?"Doit \xEAtre sup\xE9rieur ou \xE9gal \xE0 0.":"":"Doit \xEAtre un nombre entier."}isValidPrice(t){return typeof t=="number"&&t>=0}isPriceMissing(t){return t==null}hasServicePrice(){return this.isValidPrice(this.product.prix_achat)||this.isValidPrice(this.product.prix_vente)}showServicePriceError(){return this.submitted&&this.isEditing&&this.product.type==="service"&&!this.hasServicePrice()}get isActifSwitch(){return this.product.statut==="actif"}onStatutToggleChange(t){this.product.statut=t?"actif":"inactif"}onTypeChange(){this.isPrixUsineVisible()||(this.product.prix_usine=null),this.isPrixAchatVisible()||(this.product.prix_achat=null),this.isPrixVenteVisible()||(this.product.prix_vente=null),this.product.type==="service"&&(this.product.qte_stock=0)}isValid(){return!(!this.product.nom?.trim()||!this.product.type||this.isPrixUsineRequired()&&!this.isValidPrice(this.product.prix_usine)||this.isPrixVenteRequired()&&!this.isValidPrice(this.product.prix_vente)||this.isPrixAchatRequired()&&!this.isValidPrice(this.product.prix_achat)||this.product.type==="service"&&!this.hasServicePrice()||this.isSeuilAlerteStockInvalid())}enableEditing(){this.isEditing=!0}cancelEditing(){this.isEditing=!1,this.submitted=!1,this.selectedImageFile=null,this.initialData?(this.product=new C(this.initialData),this.imagePreview=this.initialData.image_url):this.resetForm()}onUpload(t){if(!t?.files?.length)return;let e=t.files[0];if(this.imageError=null,!r.ALLOWED_TYPES.includes(e.type)){this.imageError="Format non support\xE9. Utilisez JPG, PNG ou WebP.";return}if(e.size>r.MAX_SIZE){this.imageError="Fichier trop volumineux. Taille max : 5 Mo.";return}this.revokePreviewUrl(),this.selectedImageFile=e,this.imagePreview=URL.createObjectURL(e)}removeImage(t){t.stopPropagation(),this.selectedImageFile?(this.revokePreviewUrl(),this.selectedImageFile=null,this.imagePreview=null,this.imageError=null):this.product.image_url&&(this.confirmingDelete=!0)}confirmDeleteImage(t){t.stopPropagation(),this.confirmingDelete=!1,this.product.image_url=null,this.imagePreview=null,this.deleteImage.emit()}cancelDeleteImage(t){t.stopPropagation(),this.confirmingDelete=!1}revokePreviewUrl(){this.imagePreview?.startsWith("blob:")&&URL.revokeObjectURL(this.imagePreview)}ngOnDestroy(){this.revokePreviewUrl()}onSubmit(){if(this.submitted=!0,!this.isValid())return;let t={nom:this.product.nom.trim(),type:this.product.type,qte_stock:this.product.qte_stock,description:this.product.description?.trim()||void 0,cout:this.product.cout??void 0};t.statut=this.product.statut,t.is_critique=this.product.is_critique;let e=this.product.seuil_alerte_stock;if(e!=null&&!Number.isNaN(Number(e))){let o=Math.floor(Number(e));t.seuil_alerte_stock=o>=0?o:null}else t.seuil_alerte_stock=null;this.product.prix_usine!==null&&(t.prix_usine=this.product.prix_usine),this.product.prix_vente!==null&&(t.prix_vente=this.product.prix_vente),this.product.prix_achat!==null&&(t.prix_achat=this.product.prix_achat),this.selectedImageFile&&(t.image=this.selectedImageFile),this.submitForm.emit(t)}onCancel(){this.cancel.emit()}get fieldsDisabled(){return this.mode==="edit"&&!this.isEditing||this.loading}getPrixHelperText(){switch(this.product.type){case"materiel":return"Prix d'achat obligatoire";case"service":return"Pour un service, renseignez au moins un prix : achat ou vente";case"fabricable":return"Prix usine et prix de vente obligatoires";case"achat_vente":return"Prix d'achat et prix de vente obligatoires";default:return"S\xC3\xA9lectionnez un type de produit"}}resetForm(){this.revokePreviewUrl(),this.submitted=!1,this.selectedImageFile=null,this.imagePreview=null,this.imageError=null,this.product=new C({nom:"",code:"",prix_usine:null,prix_achat:null,prix_vente:null,qte_stock:0,cout:null,statut:"actif",type:"materiel",in_stock:!0,is_archived:!1,is_critique:!1,seuil_alerte_stock:null,description:null,image_url:null})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=V({type:r,selectors:[["app-produits-form"]],viewQuery:function(e,i){if(e&1&&K(ui,5),e&2){let o;X(o=Z())&&(i.buttonEl=o)}},inputs:{mode:"mode",initialData:"initialData",loading:"loading"},outputs:{submitForm:"submitForm",cancel:"cancel",deleteImage:"deleteImage"},features:[D([w]),Le],decls:127,vars:67,consts:[["mobileFileUploader",""],["content",""],["fileUploader",""],[1,"card","product-form"],[1,"mobile-form-container"],[1,"mobile-form-header"],["pButton","","pRipple","","icon","pi pi-arrow-left",1,"p-button-rounded","p-button-text","mobile-form-back",3,"click"],[1,"mobile-form-title-wrap"],[1,"mobile-form-title"],["pButton","","pRipple","","icon","pi pi-pencil","class","p-button-rounded p-button-text mobile-form-edit",3,"click",4,"ngIf"],[1,"mobile-image-card"],[4,"ngIf"],["class","px-3 pb-2",4,"ngIf"],["class","mobile-upload-preview",4,"ngIf"],["class","mobile-upload-placeholder",4,"ngIf"],[1,"mobile-section-card"],[1,"mobile-meta-row"],[1,"mobile-meta-field"],[1,"mobile-field-label"],["placeholder","Type","fluid","",3,"ngModelChange","onChange","options","ngModel","disabled"],["placeholder","0","fluid","",3,"ngModelChange","ngModel","showButtons","min","disabled"],["class","mobile-info-hint",4,"ngIf"],["pInputText","","type","text","placeholder","Nom du produit","fluid","",3,"ngModelChange","ngModel","disabled","invalid"],["class","text-red-500",4,"ngIf"],[1,"mobile-price-grid"],["class","mobile-price-item",4,"ngIf"],[1,"mobile-price-item"],[1,"mobile-price-label"],["mode","currency","currency","GNF","locale","fr-GN","placeholder","0","fluid","",3,"ngModelChange","ngModel","min","disabled"],["class","mobile-service-alert",4,"ngIf"],[1,"mobile-section-card","mobile-status-row"],[1,"mobile-status-label"],[1,"mobile-status-value"],[1,"ml-auto",3,"ngModelChange","ngModel","disabled"],["class","mobile-section-card",4,"ngIf"],["class","mobile-bottom-actions",4,"ngIf"],[1,"desktop-form-container"],[1,"flex","justify-between","items-start","gap-4","mb-8","form-header"],[1,"block","text-surface-900","dark:text-surface-0","font-bold","text-2xl"],[1,"text-surface-500","dark:text-surface-300"],["pButton","","pRipple","","label","Modifier","icon","pi pi-pencil","severity","warn","class","w-auto",3,"click",4,"ngIf"],[1,"grid","grid-cols-12","gap-6","flex-wrap"],[1,"col-span-12","lg:col-span-8"],[1,"form-section","mb-4"],[1,"type-selector-block"],[1,"form-field-label"],["placeholder","S\xE9lectionner un type","fluid","",3,"ngModelChange","onChange","options","ngModel","disabled"],[1,"form-field-hint"],[1,"pi","pi-info-circle"],[1,"grid","grid-cols-12","gap-5","mt-4"],[1,"col-span-12"],["for","nom",1,"form-field-label"],["id","nom","pInputText","","type","text","fluid","",3,"ngModelChange","ngModel","disabled","invalid"],[1,"prix-section-header"],[1,"flex","gap-4"],["class","flex-1 min-w-0 price-field-anim",4,"ngIf"],[1,"prix-helper-text"],["class","col-span-12 service-alert",4,"ngIf"],[1,"form-section"],[1,"section-title"],[1,"pi","pi-image","mr-2"],["class","flex justify-center mt-2",4,"ngIf"],[1,"col-span-12","lg:col-span-4","flex","flex-col","gap-y-4","mt-7"],[1,"border","border-surface-200","dark:border-surface-700","rounded"],[1,"text-surface-900","dark:text-surface-0","font-bold","block","border-b","border-surface-200","dark:border-surface-700","p-4"],[1,"p-4"],[1,"bg-surface-100","dark:bg-surface-700","py-2","px-4","flex","items-center","rounded"],[1,"text-black/90","dark:text-surface-0!","font-bold","mr-4"],[1,"text-black/60","dark:text-surface-0!","font-semibold"],[1,"bg-surface-100","dark:bg-surface-700","py-2","px-4","flex","items-center","rounded","mt-2"],[1,"flex","flex-col","flex-1"],[1,"text-black/90","dark:text-surface-0!","font-bold"],[1,"text-surface-500"],["class","border border-surface-200 dark:border-surface-700 rounded",4,"ngIf"],["inputId","cout","mode","currency","currency","GNF","locale","fr-GN","placeholder","Co\xFBt","fluid","",3,"ngModelChange","ngModel","min","disabled"],["class","text-gray-500 block mt-2 mb-2 ml-4",4,"ngIf"],[1,"sticky","top-6","flex","flex-col","gap-4"],["class","form-section p-4",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-text","mobile-form-edit",3,"click"],["name","image","accept","image/*","styleClass","mobile-uploader",3,"onSelect","customUpload","multiple","showUploadButton","showCancelButton","auto","disabled"],[1,"mobile-upload-zone",3,"click"],[1,"mobile-upload-placeholder"],[1,"pi","pi-camera"],[1,"mobile-upload-preview"],["alt","Image du produit",3,"src"],["pButton","","pRipple","","rounded","","type","button","severity","danger","class","mobile-remove-img",3,"click",4,"ngIf"],["class","mobile-upload-loading",4,"ngIf"],["class","mobile-delete-confirm",4,"ngIf"],["pButton","","pRipple","","rounded","","type","button","severity","danger",1,"mobile-remove-img",3,"click"],[1,"pi","pi-times"],[1,"mobile-upload-loading"],[1,"pi","pi-spin","pi-spinner","text-white","text-3xl"],[1,"mobile-delete-confirm"],[1,"text-white","text-sm","font-semibold","mb-3","text-center"],[1,"flex","gap-2","justify-center"],["pButton","","type","button","severity","danger","size","small","label","Supprimer",3,"click"],["pButton","","type","button","severity","secondary","size","small","label","Annuler",3,"click"],[1,"px-3","pb-2"],[1,"block","text-center","text-surface-400"],[1,"pi","pi-info-circle","mr-1"],["class","block text-center text-red-500 mt-1",4,"ngIf"],[1,"block","text-center","text-red-500","mt-1"],[1,"pi","pi-exclamation-circle","mr-1"],[1,"pi","pi-image"],[1,"mobile-info-hint"],[1,"text-red-500"],["mode","currency","currency","GNF","locale","fr-GN","placeholder","0","fluid","",3,"ngModelChange","ngModel","min","disabled","invalid"],[1,"mobile-service-alert"],[1,"pi","pi-exclamation-circle"],["placeholder","Ex: 5 (vide = seuil global)","fluid","",3,"ngModelChange","ngModel","showButtons","min","minFractionDigits","maxFractionDigits","disabled","invalid"],[1,"mobile-bottom-actions"],["pButton","","pRipple","","icon","pi pi-check",1,"mobile-btn-save",3,"click","label","loading","disabled"],["pButton","","pRipple","","label","Annuler","icon","pi pi-times","severity","secondary",1,"mobile-btn-cancel",3,"click","disabled"],["pButton","","pRipple","","label","Modifier","icon","pi pi-pencil","severity","warn",1,"w-auto",3,"click"],[1,"flex-1","min-w-0","price-field-anim"],["inputId","prix_achat","mode","currency","currency","GNF","locale","fr-GN","placeholder","Prix d'achat","fluid","",3,"ngModelChange","ngModel","min","disabled","invalid"],["inputId","prix_vente","mode","currency","currency","GNF","locale","fr-GN","placeholder","Prix de vente","fluid","",3,"ngModelChange","ngModel","min","disabled","invalid"],["inputId","prix_usine","mode","currency","currency","GNF","locale","fr-GN","placeholder","Prix usine","fluid","",3,"ngModelChange","ngModel","min","disabled","invalid"],[1,"col-span-12","service-alert"],[1,"pi","pi-exclamation-circle","mr-2"],["name","image","accept","image/*","styleClass","product-uploader border border-surface-200 dark:border-surface-700 bg-surface-0 dark:bg-surface-900 p-0 rounded-lg",3,"onSelect","customUpload","multiple","showUploadButton","showCancelButton","auto","disabled"],[1,"block","mt-2","text-surface-400"],["class","block mt-1 text-red-500",4,"ngIf"],[1,"w-full","py-4","upload-dropzone",3,"click"],["class","h-48 flex flex-col justify-center items-center",4,"ngIf"],["class","relative w-full flex justify-center py-3",4,"ngIf"],[1,"h-48","flex","flex-col","justify-center","items-center"],[1,"pi","pi-image","text-primary","text-4xl","mb-4"],[1,"block","font-semibold","text-surface-900","dark:text-surface-0","text-lg"],[1,"text-surface-500","text-sm","mt-1"],[1,"relative","w-full","flex","justify-center","py-3"],[1,"relative","inline-block"],["alt","Image du produit",1,"max-h-72","rounded","shadow","object-contain",3,"src"],["pButton","","pRipple","","rounded","","type","button","severity","danger","class","absolute -top-2 -right-2",3,"click",4,"ngIf"],["class","absolute inset-0 flex items-center justify-center bg-surface-0/80 dark:bg-surface-900/80 rounded",4,"ngIf"],["class","absolute inset-0 flex flex-col items-center justify-center rounded","style","background: rgba(0,0,0,0.65);",4,"ngIf"],["pButton","","pRipple","","rounded","","type","button","severity","danger",1,"absolute","-top-2","-right-2",3,"click"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-surface-0/80","dark:bg-surface-900/80","rounded"],[1,"pi","pi-spin","pi-spinner","text-primary","text-3xl"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","rounded",2,"background","rgba(0,0,0,0.65)"],[1,"text-white","text-sm","font-semibold","mb-3","px-3","text-center"],[1,"flex","gap-2"],[1,"block","mt-1","text-red-500"],[1,"flex","justify-center","mt-2"],["inputId","seuil_alerte_stock_desktop","placeholder","Ex: 5 (vide = seuil global)","fluid","",3,"ngModelChange","ngModel","showButtons","min","minFractionDigits","maxFractionDigits","disabled","invalid"],[1,"text-surface-500","block","mt-2"],["class","text-red-500 block mt-1",4,"ngIf"],[1,"text-red-500","block","mt-1"],[1,"text-gray-500","block","mt-2","mb-2","ml-4"],[1,"form-section","p-4"],[1,"flex","gap-3"],["pButton","","pRipple","","icon","pi pi-check",1,"flex-1",3,"click","label","loading","disabled"],["pButton","","pRipple","","label","Annuler","icon","pi pi-times","severity","secondary",1,"flex-1",3,"click","disabled"]],template:function(e,i){e&1&&(a(0,"div",3)(1,"div",4)(2,"header",5)(3,"button",6),_("click",function(){return i.onCancel()}),n(),a(4,"div",7)(5,"h1",8),p(6),n()(),g(7,mi,1,0,"button",9),n(),a(8,"div",10),g(9,Pi,5,6,"div",11)(10,Ci,5,1,"div",12)(11,yi,2,1,"div",13)(12,Mi,4,0,"div",14),n(),a(13,"div",15)(14,"div",16)(15,"div",17)(16,"label",18),p(17,"Type"),n(),a(18,"p-select",19),x("ngModelChange",function(l){return P(i.product.type,l)||(i.product.type=l),l}),_("onChange",function(){return i.onTypeChange()}),n()(),a(19,"div",17)(20,"label",18),p(21,"Stock"),n(),a(22,"p-inputnumber",20),x("ngModelChange",function(l){return P(i.product.qte_stock,l)||(i.product.qte_stock=l),l}),n()()(),g(23,wi,3,0,"small",21),n(),a(24,"div",15)(25,"input",22),x("ngModelChange",function(l){return P(i.product.nom,l)||(i.product.nom=l),l}),n(),g(26,Si,2,0,"small",23),n(),a(27,"div",15)(28,"label",18),p(29,"Prix"),n(),a(30,"div",24),g(31,ki,5,5,"div",25)(32,Ti,5,5,"div",25),a(33,"div",26)(34,"span",27),p(35,"Co\xFBt"),n(),a(36,"p-inputnumber",28),x("ngModelChange",function(l){return P(i.product.cout,l)||(i.product.cout=l),l}),n()(),g(37,Fi,5,5,"div",25),n(),g(38,Vi,3,0,"div",29),n(),a(39,"div",30)(40,"span",31),p(41,"Status"),n(),a(42,"span",32),p(43),n(),a(44,"p-toggleswitch",33),_("ngModelChange",function(l){return i.onStatutToggleChange(l)}),n()(),a(45,"div",30)(46,"span",31),p(47,"Produit critique"),n(),a(48,"p-toggleswitch",33),x("ngModelChange",function(l){return P(i.product.is_critique,l)||(i.product.is_critique=l),l}),n()(),g(49,Li,8,8,"div",34)(50,Ai,3,4,"div",35),n(),a(51,"div",36)(52,"div",37)(53,"div")(54,"span",38),p(55),n(),a(56,"small",39),p(57," Renseignez les informations principales, les prix et le statut de publication. "),n()(),g(58,Ri,1,0,"button",40),n(),a(59,"p-fluid",41)(60,"div",42)(61,"div",43)(62,"div",44)(63,"label",45),p(64," Type de produit "),g(65,Wi,2,0,"span",23),n(),a(66,"p-select",46),x("ngModelChange",function(l){return P(i.product.type,l)||(i.product.type=l),l}),_("onChange",function(){return i.onTypeChange()}),n(),a(67,"small",47),f(68,"i",48),p(69," Le type d\xE9termine les champs de prix et la gestion du stock. "),n()(),a(70,"div",49)(71,"div",50)(72,"label",51),p(73,"Nom du produit "),g(74,Bi,2,0,"span",23),n(),a(75,"input",52),x("ngModelChange",function(l){return P(i.product.nom,l)||(i.product.nom=l),l}),n(),g(76,Ui,2,0,"small",23),n(),a(77,"div",50)(78,"div",53)(79,"label",45),p(80,"Prix"),n()(),a(81,"div",54),g(82,qi,3,5,"div",55)(83,ji,3,5,"div",55)(84,Hi,3,5,"div",55),n(),a(85,"small",56),f(86,"i",48),p(87),n()(),g(88,Qi,3,0,"div",57),n()(),a(89,"div",58)(90,"div",59),f(91,"i",60),p(92," Visuel du produit "),n(),g(93,tr,9,7,"div",11)(94,ir,2,1,"div",61),n()(),a(95,"div",62)(96,"div",63)(97,"span",64),p(98,"Etat du produit"),n(),a(99,"div",65)(100,"div",66)(101,"span",67),p(102,"Status:"),n(),a(103,"span",68),p(104),n(),a(105,"p-toggleswitch",33),_("ngModelChange",function(l){return i.onStatutToggleChange(l)}),n()(),a(106,"div",69)(107,"div",70)(108,"span",71),p(109,"Produit critique"),n(),a(110,"small",72),p(111,"D\xE9clenche une alerte en cas de rupture de stock"),n()(),a(112,"p-toggleswitch",33),x("ngModelChange",function(l){return P(i.product.is_critique,l)||(i.product.is_critique=l),l}),n()()()(),g(113,nr,9,8,"div",73),a(114,"div",63)(115,"span",64),p(116,"Co\xFBt"),n(),a(117,"div",65)(118,"p-inputnumber",74),x("ngModelChange",function(l){return P(i.product.cout,l)||(i.product.cout=l),l}),n()()(),a(119,"div",63)(120,"span",64),p(121,"Quantit\xE9 en stock"),n(),a(122,"div",65)(123,"p-inputnumber",20),x("ngModelChange",function(l){return P(i.product.qte_stock,l)||(i.product.qte_stock=l),l}),n()(),g(124,or,3,0,"small",75),n(),a(125,"div",76),g(126,ar,4,4,"div",77),n()()()()()),e&2&&(s(6),E(" ",i.mode==="create"?"Nouveau produit":"D\xE9tails du produit"," "),s(),d("ngIf",i.mode==="edit"&&!i.isEditing),s(2),d("ngIf",i.isEditing),s(),d("ngIf",i.isEditing),s(),d("ngIf",!i.isEditing&&i.product.image_url),s(),d("ngIf",!i.isEditing&&!i.product.image_url),s(6),d("options",i.typeOptions),v("ngModel",i.product.type),d("disabled",i.fieldsDisabled),s(4),v("ngModel",i.product.qte_stock),d("showButtons",!0)("min",0)("disabled",i.isQteStockDisabled()),s(),d("ngIf",i.product.type==="service"),s(2),v("ngModel",i.product.nom),d("disabled",i.fieldsDisabled)("invalid",i.submitted&&!(i.product.nom!=null&&i.product.nom.trim())),s(),d("ngIf",i.submitted&&!(i.product.nom!=null&&i.product.nom.trim())&&i.isEditing),s(5),d("ngIf",i.isPrixAchatVisible()),s(),d("ngIf",i.isPrixVenteVisible()),s(4),v("ngModel",i.product.cout),d("min",0)("disabled",i.fieldsDisabled),s(),d("ngIf",i.isPrixUsineVisible()),s(),d("ngIf",i.showServicePriceError()),s(4),$("active",i.isActifSwitch),s(),O(i.isActifSwitch?"Actif":"Inactif"),s(),d("ngModel",i.isActifSwitch)("disabled",i.fieldsDisabled),s(4),v("ngModel",i.product.is_critique),d("disabled",i.fieldsDisabled),s(),d("ngIf",i.isSeuilAlerteStockVisible()),s(),d("ngIf",i.isEditing),s(5),E(" ",i.mode==="create"?"Cr\xE9er un produit":"D\xE9tails du produit"," "),s(3),d("ngIf",i.mode==="edit"&&!i.isEditing),s(7),d("ngIf",i.isEditing),s(),d("options",i.typeOptions),v("ngModel",i.product.type),d("disabled",i.fieldsDisabled),s(8),d("ngIf",i.isEditing),s(),v("ngModel",i.product.nom),d("disabled",i.fieldsDisabled)("invalid",i.submitted&&!(i.product.nom!=null&&i.product.nom.trim())),s(),d("ngIf",i.submitted&&!(i.product.nom!=null&&i.product.nom.trim())&&i.isEditing),s(6),d("ngIf",i.isPrixAchatVisible()),s(),d("ngIf",i.isPrixVenteVisible()),s(),d("ngIf",i.isPrixUsineVisible()),s(3),E(" ",i.getPrixHelperText()," "),s(),d("ngIf",i.showServicePriceError()),s(5),d("ngIf",i.isEditing),s(),d("ngIf",!i.isEditing&&i.product.image_url),s(10),O(i.isActifSwitch?"Actif":"Inactif"),s(),d("ngModel",i.isActifSwitch)("disabled",i.fieldsDisabled),s(7),v("ngModel",i.product.is_critique),d("disabled",i.fieldsDisabled),s(),d("ngIf",i.isSeuilAlerteStockVisible()),s(5),v("ngModel",i.product.cout),d("min",0)("disabled",i.fieldsDisabled),s(5),v("ngModel",i.product.qte_stock),d("showButtons",!0)("min",0)("disabled",i.isQteStockDisabled()),s(),d("ngIf",i.product.type==="service"),s(2),d("ngIf",i.isEditing))},dependencies:[L,N,bt,ue,pe,ce,le,se,de,_t,gt,ae,oe,ge,me,fe,_e,ne,re,ft,Be,We,he,be],styles:[".product-form[_ngcontent-%COMP%]   .mobile-form-container[_ngcontent-%COMP%]{display:none}.product-form[_ngcontent-%COMP%]   .form-header[_ngcontent-%COMP%]{border-bottom:1px solid var(--surface-200);padding-bottom:1rem}.product-form[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]{border:1px solid var(--surface-200);border-radius:.875rem;background:var(--surface-0);padding:1.25rem}.product-form[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{display:inline-flex;align-items:center;margin-bottom:1rem;font-weight:700;color:var(--text-color)}.product-form[_ngcontent-%COMP%]   .side-title[_ngcontent-%COMP%]{font-weight:700;color:var(--text-color);padding:1rem 1rem .875rem;border-bottom:1px solid var(--surface-200);background:color-mix(in srgb,var(--surface-50) 70%,transparent)}.product-form[_ngcontent-%COMP%]   .helper-chip[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--blue-100) 50%,transparent);border-radius:999px;padding:.35rem .7rem;font-weight:500}.product-form[_ngcontent-%COMP%]   .status-pill[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-size:.8rem;font-weight:700;border-radius:999px;padding:.2rem .6rem}.product-form[_ngcontent-%COMP%]   .status-pill-active[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.product-form[_ngcontent-%COMP%]   .status-pill-inactive[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.product-form[_ngcontent-%COMP%]   .service-alert[_ngcontent-%COMP%]{display:flex;align-items:center;color:#991b1b;background:#fef2f2;border:1px solid #fecaca;border-radius:.5rem;padding:.65rem .8rem;font-size:.9rem}.product-form[_ngcontent-%COMP%]   .upload-dropzone[_ngcontent-%COMP%]{cursor:pointer;border-radius:.75rem;transition:background-color .2s ease}.product-form[_ngcontent-%COMP%]   .upload-dropzone[_ngcontent-%COMP%]:hover{background:color-mix(in srgb,var(--primary-50) 35%,transparent)}.product-form[_ngcontent-%COMP%]   .type-selector-block[_ngcontent-%COMP%]{padding-bottom:.75rem;border-bottom:1px solid var(--surface-200)}.product-form[_ngcontent-%COMP%]   .form-field-label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:var(--surface-900);margin-bottom:.5rem}.product-form[_ngcontent-%COMP%]   .form-field-hint[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;margin-top:.4rem;font-size:.78rem;color:#94a3b8}.product-form[_ngcontent-%COMP%]   .form-field-hint[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.7rem}.product-form[_ngcontent-%COMP%]   .prix-section-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:.5rem}.product-form[_ngcontent-%COMP%]   .prix-helper-text[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;margin-top:.6rem;font-size:.78rem;color:#94a3b8}.product-form[_ngcontent-%COMP%]   .prix-helper-text[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.7rem}.product-form[_ngcontent-%COMP%]   .price-field-anim[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_priceFieldFade .18s ease-out}@keyframes _ngcontent-%COMP%_priceFieldFade{0%{opacity:0;transform:translateY(-4px)}to{opacity:1;transform:translateY(0)}}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .type-selector-block[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .type-selector-block[_ngcontent-%COMP%]{border-bottom-color:var(--p-surface-700)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .form-field-label[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .form-field-label[_ngcontent-%COMP%]{color:var(--p-surface-0)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .form-field-hint[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .form-field-hint[_ngcontent-%COMP%], .app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .prix-helper-text[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .prix-helper-text[_ngcontent-%COMP%]{color:var(--p-surface-500)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .status-pill-active[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .status-pill-active[_ngcontent-%COMP%]{background:#05966933;color:#34d399}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .status-pill-inactive[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .status-pill-inactive[_ngcontent-%COMP%]{background:#d9770633;color:#fbbf24}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .service-alert[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .service-alert[_ngcontent-%COMP%]{background:#dc262626;border-color:var(--p-surface-600);color:#f87171}@media screen and (max-width: 768px){.product-form[_ngcontent-%COMP%]{border:0!important;border-radius:0!important;box-shadow:none!important;background:#f8f9fc!important;margin:-.5rem -.875rem calc(-.5rem - env(safe-area-inset-bottom));padding:0;min-height:100dvh}.product-form[_ngcontent-%COMP%]   .mobile-form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;padding:calc(.75rem + env(safe-area-inset-top)) 1rem calc(5.5rem + env(safe-area-inset-bottom));animation:_ngcontent-%COMP%_mobileFade .24s ease-out}.product-form[_ngcontent-%COMP%]   .desktop-form-container[_ngcontent-%COMP%]{display:none!important}.product-form[_ngcontent-%COMP%]   .mobile-form-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding-bottom:.25rem}.product-form[_ngcontent-%COMP%]   .mobile-form-back[_ngcontent-%COMP%], .product-form[_ngcontent-%COMP%]   .mobile-form-edit[_ngcontent-%COMP%]{width:2.25rem;height:2.25rem;border-radius:999px;flex-shrink:0;color:#1e293b!important;background:transparent!important;border:0!important;box-shadow:none!important}.product-form[_ngcontent-%COMP%]   .mobile-form-title-wrap[_ngcontent-%COMP%]{flex:1;min-width:0}.product-form[_ngcontent-%COMP%]   .mobile-form-title[_ngcontent-%COMP%]{margin:0;font-size:1.15rem;font-weight:700;color:#1e293b;letter-spacing:-.01em;text-align:center}.product-form[_ngcontent-%COMP%]   .mobile-image-card[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;overflow:hidden;box-shadow:0 1px 3px #0000000f,0 4px 12px #0000000a}.product-form   [_nghost-%COMP%]     .mobile-uploader{border:0!important;background:transparent!important;box-shadow:none!important}.product-form   [_nghost-%COMP%]     .mobile-uploader .p-fileupload-header{display:none}.product-form   [_nghost-%COMP%]     .mobile-uploader .p-fileupload-file-list{display:none}.product-form   [_nghost-%COMP%]     .mobile-uploader .p-fileupload-content{padding:0;border:0;min-height:auto;height:auto!important}.product-form[_ngcontent-%COMP%]   .mobile-upload-zone[_ngcontent-%COMP%]{cursor:pointer;min-height:11rem}.product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:11rem;color:#94a3b8;gap:.5rem}.product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem;color:#cbd5e1}.product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600}.product-form[_ngcontent-%COMP%]   .mobile-upload-preview[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;padding:.75rem}.product-form[_ngcontent-%COMP%]   .mobile-upload-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:12rem;width:auto;border-radius:.75rem;object-fit:contain}.product-form[_ngcontent-%COMP%]   .mobile-remove-img[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem;width:1.75rem!important;height:1.75rem!important;border-radius:999px!important}.product-form[_ngcontent-%COMP%]   .mobile-remove-img[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.7rem}.product-form[_ngcontent-%COMP%]   .mobile-upload-loading[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:#00000073;border-radius:.75rem}.product-form[_ngcontent-%COMP%]   .mobile-delete-confirm[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:.75rem;background:#000000a6;padding:1rem}.product-form[_ngcontent-%COMP%]   .mobile-section-card[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;padding:1rem;box-shadow:0 1px 3px #0000000f,0 4px 12px #0000000a}.product-form[_ngcontent-%COMP%]   .mobile-field-label[_ngcontent-%COMP%]{display:block;font-size:.7rem;font-weight:700;color:#94a3b8;text-transform:uppercase;letter-spacing:.06em;margin-bottom:.5rem}.product-form[_ngcontent-%COMP%]   .mobile-price-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}.product-form[_ngcontent-%COMP%]   .mobile-price-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.product-form[_ngcontent-%COMP%]   .mobile-price-label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;color:#64748b}.product-form[_ngcontent-%COMP%]   .mobile-service-alert[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.35rem;margin-top:.6rem;padding:.5rem .65rem;background:#fef2f2;border:1px solid #fecaca;border-radius:.65rem;font-size:.8rem;color:#991b1b}.product-form[_ngcontent-%COMP%]   .mobile-meta-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}.product-form[_ngcontent-%COMP%]   .mobile-meta-field[_ngcontent-%COMP%]{display:flex;flex-direction:column}.product-form[_ngcontent-%COMP%]   .mobile-info-hint[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;margin-top:.5rem;font-size:.75rem;color:#94a3b8;font-weight:500}.product-form[_ngcontent-%COMP%]   .mobile-status-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.product-form[_ngcontent-%COMP%]   .mobile-status-label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:700;color:#334155}.product-form[_ngcontent-%COMP%]   .mobile-status-value[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#94a3b8}.product-form[_ngcontent-%COMP%]   .mobile-status-value.active[_ngcontent-%COMP%]{color:#16a34a}.product-form   [_nghost-%COMP%]     .p-inputtext, .product-form   [_nghost-%COMP%]     .p-inputnumber-input, .product-form   [_nghost-%COMP%]     .p-select-label{font-size:16px!important;min-height:2.65rem}.product-form[_ngcontent-%COMP%]   .mobile-bottom-actions[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;z-index:50;display:flex;gap:.5rem;padding:.75rem 1rem calc(.75rem + env(safe-area-inset-bottom));background:#ffffffeb;backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border-top:1px solid #e2e8f0}.product-form[_ngcontent-%COMP%]   .mobile-btn-save[_ngcontent-%COMP%]{flex:1;border-radius:.75rem!important;font-weight:700!important;min-height:2.75rem}.product-form[_ngcontent-%COMP%]   .mobile-btn-cancel[_ngcontent-%COMP%]{flex:0 0 auto;border-radius:.75rem!important;font-weight:600!important;min-height:2.75rem}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]{background:var(--p-surface-950)!important}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-form-back[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-form-back[_ngcontent-%COMP%], .app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-form-edit[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-form-edit[_ngcontent-%COMP%]{color:var(--p-surface-100)!important}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-form-title[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-form-title[_ngcontent-%COMP%]{color:var(--p-surface-0)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-image-card[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-image-card[_ngcontent-%COMP%]{background:var(--p-surface-800);box-shadow:0 1px 3px #0003}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--p-surface-500)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-section-card[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-section-card[_ngcontent-%COMP%]{background:var(--p-surface-800);box-shadow:0 1px 3px #00000026}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-field-label[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-field-label[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-price-label[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-price-label[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-service-alert[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-service-alert[_ngcontent-%COMP%]{background:#dc262626;border-color:var(--p-surface-600);color:#f87171}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-info-hint[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-info-hint[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-status-label[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-status-label[_ngcontent-%COMP%]{color:var(--p-surface-200)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-status-value[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-status-value[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-status-value.active[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-status-value.active[_ngcontent-%COMP%]{color:#34d399}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-bottom-actions[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-bottom-actions[_ngcontent-%COMP%]{background:#0f172aeb;border-top-color:var(--p-surface-700)}}@keyframes _ngcontent-%COMP%_mobileFade{0%{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}","[_nghost-%COMP%]     .p-fileupload-header{display:none}[_nghost-%COMP%]     .p-fileupload-file-list{display:none}[_nghost-%COMP%]     .p-fileupload-content{height:20rem}"]})};var xe=class r{constructor(t,e,i,o){this.router=t;this.messageService=e;this.produitService=i;this.document=o}loading=!1;mobileBreakpoint=768;mobilePwaClass="produits-mobile-pwa";ngOnInit(){this.updateMobilePwaMode()}ngOnDestroy(){this.document.body.classList.remove(this.mobilePwaClass)}onResize(){this.updateMobilePwaMode()}updateMobilePwaMode(){typeof window>"u"||(window.innerWidth<=this.mobileBreakpoint?this.document.body.classList.add(this.mobilePwaClass):this.document.body.classList.remove(this.mobilePwaClass))}onSubmitForm(t){this.loading=!0;let e=t.image??null;this.produitService.create(t).subscribe({next:i=>{e&&i.id?this.uploadImageAfterCreate(i,e):this.handleSuccess("Produit cr\xE9\xE9 avec succ\xE8s",i)},error:i=>this.handleError("Erreur lors de la cr\xE9ation du produit",i)})}uploadImageAfterCreate(t,e){this.produitService.uploadProduitImage(t.id,e).subscribe({next:i=>{this.handleSuccess("Produit cr\xE9\xE9 avec succ\xE8s",i)},error:()=>{this.messageService.add({severity:"warn",summary:"Attention",detail:"Produit cr\xE9\xE9, mais l'image n'a pas pu \xEAtre envoy\xE9e.",life:5e3}),this.loading=!1,this.router.navigate(["/produits/produits-edit",t.id])}})}onCancel(){this.router.navigate(["/produits"])}handleSuccess(t,e){if(this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:t,life:2e3}),this.loading=!1,e?.id){this.router.navigate(["/produits/produits-edit",e.id]);return}this.router.navigate(["/produits"])}handleError(t,e){let i=e?.error?.message||t;e?.status===422&&e?.error?.errors?Object.values(e.error.errors).flat().forEach(l=>{this.messageService.add({severity:"error",summary:i,detail:l,life:5e3})}):this.messageService.add({severity:"error",summary:"Erreur",detail:i,life:5e3}),this.loading=!1,console.error(e)}static \u0275fac=function(e){return new(e||r)(y(q),y(w),y(I),y(R))};static \u0275cmp=V({type:r,selectors:[["app-produits-new"]],hostBindings:function(e,i){e&1&&_("resize",function(){return i.onResize()},W)},features:[D([w])],decls:2,vars:1,consts:[["mode","create",3,"submitForm","cancel","loading"]],template:function(e,i){e&1&&(f(0,"p-toast"),a(1,"app-produits-form",0),_("submitForm",function(l){return i.onSubmitForm(l)})("cancel",function(){return i.onCancel()}),n()),e&2&&(s(),d("loading",i.loading))},dependencies:[L,G,j,z],encapsulation:2})};function lr(r,t){if(r&1){let e=h();a(0,"app-produits-form",1),_("submitForm",function(o){u(e);let l=c();return m(l.onSubmitForm(o))})("cancel",function(){u(e);let o=c();return m(o.onCancel())})("deleteImage",function(){u(e);let o=c();return m(o.onDeleteImage())}),n()}if(r&2){let e=c();d("initialData",e.initialData)("loading",e.loading)}}var Ce=class r{constructor(t,e,i,o,l){this.route=t;this.router=e;this.produitService=i;this.messageService=o;this.document=l}loading=!1;produitId=null;initialData=null;mobileBreakpoint=768;mobilePwaClass="produits-mobile-pwa";ngOnInit(){this.updateMobilePwaMode();let t=this.route.snapshot.paramMap.get("id"),e=t?Number(t):NaN;if(!Number.isFinite(e)||e<=0){this.router.navigate(["/produits"]);return}this.produitId=e,this.loadProduit(e)}onSubmitForm(t){if(!this.produitId)return;this.loading=!0;let e=t.image??null;this.produitService.update(this.produitId,t).subscribe({next:i=>{e?this.uploadImageAfterUpdate(i,e):(this.initialData=i,this.loading=!1,this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Produit modifi\xE9 avec succ\xE8s",life:3e3}))},error:i=>{this.loading=!1,this.showApiError(i,"Erreur lors de la modification du produit")}})}onDeleteImage(){this.produitId&&(this.loading=!0,this.produitService.deleteProduitImage(this.produitId).subscribe({next:t=>{this.initialData=t,this.loading=!1,this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Image supprim\xE9e avec succ\xE8s",life:3e3})},error:t=>{this.initialData=k({},this.initialData),this.loading=!1,this.showApiError(t,"Impossible de supprimer l'image")}}))}uploadImageAfterUpdate(t,e){this.produitService.uploadProduitImage(t.id,e).subscribe({next:i=>{this.initialData=i,this.loading=!1,this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Produit modifi\xE9 avec succ\xE8s",life:3e3})},error:()=>{this.initialData=t,this.loading=!1,this.messageService.add({severity:"warn",summary:"Attention",detail:"Produit modifi\xE9, mais l'image n'a pas pu \xEAtre envoy\xE9e.",life:5e3})}})}onCancel(){this.router.navigate(["/produits"])}loadProduit(t){this.loading=!0,this.produitService.getById(t).subscribe({next:e=>{this.initialData=e,this.loading=!1},error:e=>{this.loading=!1,this.showApiError(e,"Erreur lors du chargement du produit")}})}ngOnDestroy(){this.document.body.classList.remove(this.mobilePwaClass)}onResize(){this.updateMobilePwaMode()}updateMobilePwaMode(){typeof window>"u"||(window.innerWidth<=this.mobileBreakpoint?this.document.body.classList.add(this.mobilePwaClass):this.document.body.classList.remove(this.mobilePwaClass))}showApiError(t,e){let i=t?.error?.message||e;this.messageService.add({severity:"error",summary:"Erreur",detail:i,life:5e3})}static \u0275fac=function(e){return new(e||r)(y(te),y(q),y(I),y(w),y(R))};static \u0275cmp=V({type:r,selectors:[["app-produits-edit"]],hostBindings:function(e,i){e&1&&_("resize",function(){return i.onResize()},W)},features:[D([w])],decls:2,vars:1,consts:[["mode","edit",3,"initialData","loading","submitForm","cancel","deleteImage",4,"ngIf"],["mode","edit",3,"submitForm","cancel","deleteImage","initialData","loading"]],template:function(e,i){e&1&&(f(0,"p-toast"),g(1,lr,1,2,"app-produits-form",0)),e&2&&(s(),d("ngIf",i.initialData))},dependencies:[L,N,G,j,z],encapsulation:2})};var ao=[{path:"",component:Q,canActivate:[H],data:{permissions:["produits.read"]}},{path:"produits",component:Q,canActivate:[H],data:{permissions:["produits.read"]}},{path:"produits-new",component:xe,canActivate:[H],data:{permissions:["produits.create"]}},{path:"produits-edit/:id",component:Ce,canActivate:[H],data:{permissions:["produits.update"]}},{path:"**",redirectTo:"/notfound"}];export{ao as default};
