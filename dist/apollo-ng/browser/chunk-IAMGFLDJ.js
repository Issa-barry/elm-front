import{b as ze}from"./chunk-MEUB4WWK.js";import{b as Ae}from"./chunk-WEJXN6OG.js";import"./chunk-N5VHCF4T.js";import"./chunk-KAWCBAUU.js";import{a as ne,b as je}from"./chunk-JFBSWTEJ.js";import{a as Ge}from"./chunk-IUCT6ZC4.js";import{a as V}from"./chunk-H7IRGUTT.js";import{b as Be}from"./chunk-6MAGWI7U.js";import{a as We}from"./chunk-2L636W5W.js";import{a as Ee,b as Te}from"./chunk-W3Q6QMRU.js";import{a as Re,b as Ne}from"./chunk-LOBJQVB7.js";import"./chunk-3HDW43E7.js";import{a as Ie,d as ke,e as Fe,f as Oe,k as Ve}from"./chunk-KYBPPGZP.js";import"./chunk-KKEZTC3T.js";import"./chunk-QAU7W4US.js";import"./chunk-GO7AEQHW.js";import"./chunk-44MNQRCX.js";import"./chunk-FHJ3HI6Y.js";import"./chunk-MGFZT6L3.js";import{a as Le,b as De}from"./chunk-2M2YESUI.js";import"./chunk-Q737E3VB.js";import"./chunk-GVSJPEUD.js";import"./chunk-CQGFVLY5.js";import"./chunk-ZOHIMUT6.js";import"./chunk-TB7JIXSI.js";import{a as K,b as X}from"./chunk-D4ZZGRXJ.js";import"./chunk-USWDVUUM.js";import"./chunk-KHGHC55C.js";import{a as D}from"./chunk-MDPPMPGK.js";import{b as we}from"./chunk-3CPQXP4V.js";import"./chunk-MYGUYXAJ.js";import"./chunk-UWJ6EXCC.js";import"./chunk-NIW5LLYW.js";import{b as be,d as O}from"./chunk-C4SKCR7Q.js";import"./chunk-TZVXXQOJ.js";import"./chunk-PPJOJKS5.js";import{c as Y,e as J}from"./chunk-P557RNKH.js";import"./chunk-PALTTDOF.js";import{c as Q,d as Me}from"./chunk-WF73AWMM.js";import"./chunk-SXW2RLBH.js";import"./chunk-LSUA6MZX.js";import"./chunk-M2LTT3HJ.js";import"./chunk-JYP5AZVX.js";import"./chunk-T7HI4VPR.js";import{a as Pe,c as xe}from"./chunk-II7RVJNR.js";import{a as q,b as ye}from"./chunk-PW7MMR7K.js";import{b as A,e as z,h as j,p as G}from"./chunk-3LUOICNH.js";import{a as Ce,b as Se}from"./chunk-3G6KBQ3S.js";import"./chunk-D7FY7VLK.js";import"./chunk-BODZH67C.js";import"./chunk-7UZYWCAJ.js";import{i as U,j as H}from"./chunk-IK72ORTM.js";import"./chunk-Z2XDSDL7.js";import{la as W,pa as S,ta as ve}from"./chunk-344GK45C.js";import{j as he,k as F,v as M}from"./chunk-6PXXCRY5.js";import"./chunk-4O3FVBGX.js";import{$ as u,$b as y,Ab as g,Hb as b,Ja as ee,La as de,Lb as _,Mb as d,Na as o,Sa as te,Vb as N,Xb as ce,Ya as v,Yb as ue,Zb as fe,_b as m,aa as f,ac as T,bb as w,bc as ge,dc as P,ea as pe,ec as x,fc as C,gc as _e,hb as c,hc as I,ic as B,ma as me,sc as ie,uc as re,wc as k,xb as l,yb as a,zb as n}from"./chunk-E5DLUAUS.js";import{a as E,b as le}from"./chunk-GAL4ENT6.js";var Ze=()=>[10,25,50],$e=()=>["nom_complet","email","phone","reference","pays","ville","specialite","type","type_label"],et=()=>({"min-width":"150px"});function tt(r,i){if(r&1){let e=b();a(0,"button",36),_("click",function(s){u(e);let p=d().$implicit,h=d(2);return s.stopPropagation(),f(h.deletePrestataire(s,p.id))}),n()}r&2&&l("pTooltip","Supprimer")}function it(r,i){if(r&1){let e=b();a(0,"article",26),_("click",function(s){let p=u(e).$implicit,h=d(2);return f(h.goToEdit(s,p.id))}),a(1,"div",27),m(2),n(),a(3,"div",28)(4,"div",29),m(5),n(),a(6,"div",30),m(7),ie(8,"phoneFormat"),n(),a(9,"div",31),g(10,"p-tag",32),a(11,"div",33)(12,"button",34),_("click",function(s){let p=u(e).$implicit,h=d(2);return f(h.goToEdit(s,p.id))}),n(),c(13,tt,1,1,"button",35),n()()()()}if(r&2){let e=i.$implicit,t=d(2);o(2),T(" ",t.getInitials(e.nom_complet)," "),o(3),y(e.nom_complet),o(2),y(e.email||re(8,8,e.phone,"INT")),o(3),l("value",e.is_active?"Actif":"Inactif")("severity",e.is_active?"success":"danger"),o(2),l("pTooltip",t.canUpdate?"Modifier":"Voir")("disabled",!t.canUpdate),o(),l("ngIf",t.canDelete)}}function rt(r,i){if(r&1&&(a(0,"section",24),c(1,it,14,11,"article",25),n()),r&2){let e=d();o(),l("ngForOf",e.mobileVisiblePrestataires)("ngForTrackBy",e.trackByPrestataireId)}}function nt(r,i){r&1&&(a(0,"div",38),m(1,"Chargement..."),n())}function at(r,i){r&1&&(a(0,"div",38),m(1,"Aucun prestataire."),n())}function ot(r,i){if(r&1&&c(0,nt,2,0,"div",37)(1,at,2,0,"div",37),r&2){let e=d();l("ngIf",e.loading),o(),l("ngIf",!e.loading&&!e.mobileFilteredPrestataires.length)}}function st(r,i){if(r&1){let e=b();a(0,"div",39)(1,"button",40),_("click",function(){u(e);let s=d();return f(s.loadMoreMobile())}),n()()}}function lt(r,i){if(r&1){let e=b();a(0,"button",41),_("click",function(){u(e);let s=d();return f(s.navigateToCreate())}),g(1,"i",42),n()}}function pt(r,i){if(r&1){let e=b();a(0,"button",49),_("click",function(){u(e);let s=d(2);return f(s.navigateToCreate())}),n()}}function mt(r,i){if(r&1){let e=b();a(0,"div",43)(1,"p-icon-field",44),g(2,"p-inputicon",17),a(3,"input",45),_("input",function(s){u(e);let p=d(),h=N(24);return f(p.onGlobalFilter(h,s))}),n()(),a(4,"div",46)(5,"p-select",47),C("ngModelChange",function(s){u(e);let p=d();return x(p.selectedStatus,s)||(p.selectedStatus=s),f(s)}),_("onChange",function(){u(e);let s=d();return f(s.filterByStatus())}),n(),c(6,pt,1,0,"button",48),n()()}if(r&2){let e=d();o(5),ue(B(6,et)),l("options",e.statusOptions),P("ngModel",e.selectedStatus),l("showClear",!0),o(),l("ngIf",e.canCreate)}}function dt(r,i){r&1&&(a(0,"tr")(1,"th",50)(2,"span",51),m(3," Nom complet "),g(4,"p-sortIcon",52),n()(),a(5,"th",53)(6,"span",51),m(7," T\xE9l\xE9phone "),g(8,"p-sortIcon",54),n()(),a(9,"th",55)(10,"span",51),m(11," Type "),g(12,"p-sortIcon",56),n()(),a(13,"th",57)(14,"span",51),m(15," Adresse "),g(16,"p-sortIcon",58),n()(),a(17,"th",59)(18,"span",51),m(19," Statut "),g(20,"p-sortIcon",60),n()(),a(21,"th",61),m(22," Actions "),n()())}function ct(r,i){if(r&1&&g(0,"p-tag",72),r&2){let e=d().$implicit,t=d();l("value",e.type_label)("severity",t.getTypeSeverity(e.type))}}function ut(r,i){r&1&&(a(0,"span",75),m(1,"-"),n())}function ft(r,i){if(r&1){let e=b();a(0,"button",76),_("click",function(s){u(e);let p=d().$implicit,h=d();return f(h.toggleStatus(s,p.id))}),n()}if(r&2){let e=d().$implicit;ce("p-button-success",e.is_active)("p-button-danger",!e.is_active),l("icon",e.is_active?"pi pi-lock-open":"pi pi-lock")("pTooltip",e.is_active?"D\xE9sactiver":"Activer")}}function gt(r,i){if(r&1){let e=b();a(0,"button",36),_("click",function(s){u(e);let p=d().$implicit,h=d();return f(h.deletePrestataire(s,p.id))}),n()}r&2&&l("pTooltip","Supprimer")}function _t(r,i){if(r&1){let e=b();a(0,"tr",62)(1,"td")(2,"div",51)(3,"div",63),m(4),n(),a(5,"div")(6,"div",64),m(7),n(),a(8,"div",65),m(9),n()()()(),a(10,"td")(11,"div",66)(12,"span",67),m(13),ie(14,"phoneFormat"),n()()(),a(15,"td"),c(16,ct,1,2,"p-tag",68)(17,ut,2,0,"span",69),n(),a(18,"td")(19,"div",51),g(20,"span"),a(21,"div")(22,"div",70),m(23),n(),a(24,"div",71),m(25),n()()()(),a(26,"td"),g(27,"p-tag",72),n(),a(28,"td")(29,"div",73)(30,"button",34),_("click",function(s){let p=u(e).$implicit,h=d();return f(h.goToEdit(s,p.id))}),n(),c(31,ft,1,6,"button",74)(32,gt,1,1,"button",35),n()()()}if(r&2){let e=i.$implicit,t=d();l("pSelectableRow",e),o(4),T(" ",t.getInitials(e.nom_complet)," "),o(3),y(e.nom_complet),o(2),y(e.reference),o(4),y(re(14,18,e.phone,"INT")),o(3),l("ngIf",e.type_label),o(),l("ngIf",!e.type_label),o(3),fe(_e("fi fi-",e.code_pays==null?null:e.code_pays.toLowerCase()," text-xl")),o(3),y(e.ville),o(2),y(e.quartier),o(2),l("value",e.is_active?"Actif":"Inactif")("severity",e.is_active?"success":"danger"),o(3),l("pTooltip",t.canUpdate?"Modifier":"Voir")("disabled",!t.canUpdate),o(),l("ngIf",t.canUpdate),o(),l("ngIf",t.canDelete)}}function ht(r,i){r&1&&(a(0,"tr")(1,"td",77)(2,"div",78),g(3,"i",79),a(4,"span"),m(5,"Aucun prestataire trouv\xE9"),n()()()())}var R=class r{constructor(i,e,t,s,p,h){this.prestataireService=i;this.router=e;this.messageService=t;this.confirmationService=s;this.authService=p;this.document=h;this.canCreate=this.authService.hasPermission("prestataires.create"),this.canUpdate=this.authService.hasPermission("prestataires.update"),this.canDelete=this.authService.hasPermission("prestataires.delete")}prestataires=[];selectedPrestataire=null;loading=!1;selectedStatus=null;mobileSearchTerm="";mobilePageSize=10;mobileVisibleCount=this.mobilePageSize;mobileBreakpoint=768;mobilePwaClass="prestateurs-mobile-pwa";statusOptions=[{label:"Actif",value:!0},{label:"Inactif",value:!1}];mobileStatusMenuItems=[{label:"Tous les statuts",command:()=>this.applyMobileStatusFilter(null)},{label:"Actif",command:()=>this.applyMobileStatusFilter(!0)},{label:"Inactif",command:()=>this.applyMobileStatusFilter(!1)}];canCreate=!1;canUpdate=!1;canDelete=!1;ngOnInit(){this.loadPrestataires(),this.syncMobilePwaMode()}ngOnDestroy(){this.document.body.classList.remove(this.mobilePwaClass)}onWindowResize(){this.syncMobilePwaMode()}goHome(){this.router.navigate(["/"])}onMobileSearchChange(){this.mobileVisibleCount=this.mobilePageSize}get mobileFilteredPrestataires(){let i=this.mobileSearchTerm.trim().toLowerCase();return i?this.prestataires.filter(e=>e.nom_complet&&e.nom_complet.toLowerCase().includes(i)||e.email&&e.email.toLowerCase().includes(i)||e.phone&&e.phone.replace(/\s/g,"").includes(i)||e.reference&&e.reference.toLowerCase().includes(i)||e.type_label&&e.type_label.toLowerCase().includes(i)):this.prestataires}get mobileVisiblePrestataires(){return this.mobileFilteredPrestataires.slice(0,this.mobileVisibleCount)}get canLoadMoreMobile(){return this.mobileVisibleCount<this.mobileFilteredPrestataires.length}loadMoreMobile(){this.mobileVisibleCount+=this.mobilePageSize}trackByPrestataireId(i,e){return e.id}syncMobilePwaMode(){typeof window>"u"||(window.innerWidth<=this.mobileBreakpoint?this.document.body.classList.add(this.mobilePwaClass):this.document.body.classList.remove(this.mobilePwaClass))}loadPrestataires(){this.loading=!0;let i=this.selectedStatus!==null?{is_active:this.selectedStatus}:void 0;this.prestataireService.getPrestataires(i).subscribe({next:e=>{e.success&&(this.prestataires=Array.isArray(e.data)?e.data:e.data.data,this.mobileVisibleCount=this.mobilePageSize),this.loading=!1},error:e=>{console.error("Erreur lors du chargement des prestataires:",e),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger les prestataires"}),this.loading=!1}})}onGlobalFilter(i,e){i.filterGlobal(e.target.value,"contains")}filterByStatus(){this.loadPrestataires()}applyMobileStatusFilter(i){this.selectedStatus=i,this.loadPrestataires()}navigateToCreate(){this.router.navigate(["contacts/prestateurs/new"])}onRowSelect(i){this.router.navigate(["contacts/prestateurs/edit",i.data.id])}goToEdit(i,e){i.stopPropagation(),this.router.navigate(["contacts/prestateurs/edit/",e])}toggleStatus(i,e){i.stopPropagation();let s=this.prestataires.find(p=>p.id===e)?.is_active?"d\xE9sactiver":"activer";this.confirmationService.confirm({message:`Voulez-vous vraiment ${s} ce prestataire ?`,header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>{this.prestataireService.togglePrestataireStatus(e).subscribe({next:p=>{p.success&&(this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:p.message}),this.loadPrestataires())},error:p=>{console.error("Erreur:",p),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de changer le statut du prestataire"})}})}})}deletePrestataire(i,e){i.stopPropagation(),this.confirmationService.confirm({message:"\xCAtes-vous s\xFBr de vouloir supprimer ce prestataire ? Cette action est irr\xE9versible.",header:"Confirmation de suppression",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui, supprimer",rejectLabel:"Annuler",acceptButtonStyleClass:"p-button-danger",accept:()=>{this.prestataireService.deletePrestataire(e).subscribe({next:t=>{t.success&&(this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Prestataire supprim\xE9 avec succ\xE8s"}),this.loadPrestataires())},error:t=>{console.error("Erreur:",t),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de supprimer le prestataire"})}})}})}getInitials(i){if(!i)return"??";let e=i.trim().split(" ");return e.length>=2?(e[0][0]+e[e.length-1][0]).toUpperCase():i.substring(0,2).toUpperCase()}formatPhone(i){return i?i.replace(/^\+\d{1,3}/,"").trim().replace(/(\d{2})(?=\d)/g,"$1 "):"-"}getTypeSeverity(i){return i?{machiniste:"info",mecanicien:"warn",consultant:"success",fournisseur:"danger"}[i]:"secondary"}static \u0275fac=function(e){return new(e||r)(v(V),v(O),v(S),v(W),v(we),v(pe))};static \u0275cmp=w({type:r,selectors:[["app-prestateurs-liste"]],hostBindings:function(e,t){e&1&&_("resize",function(){return t.onWindowResize()},de)},features:[I([S,W])],decls:33,vars:20,consts:[["statusMenu",""],["mobileListState",""],["dt",""],["caption",""],["header",""],["body",""],["emptymessage",""],[1,"prestateurs-mobile-app"],[1,"mobile-header"],["pButton","","pRipple","","icon","pi pi-arrow-left","aria-label","Retour \xE0 l'accueil",1,"p-button-rounded","p-button-text","mobile-back",3,"click"],[1,"mobile-title-wrap"],[1,"mobile-title"],[1,"mobile-subtitle"],["appendTo","body","styleClass","mobile-status-menu",3,"model","popup"],["pButton","","pRipple","","icon","pi pi-filter","aria-label","Filtrer par statut",1,"p-button-rounded","p-button-text","mobile-add",3,"click"],[1,"mobile-scroll"],[1,"mobile-search"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Nom, email, t\xE9l\xE9phone...",1,"w-full",3,"ngModelChange","ngModel"],["class","mobile-list",4,"ngIf","ngIfElse"],["class","mobile-load-more",4,"ngIf"],["type","button","class","mobile-fab","aria-label","Nouveau prestataire",3,"click",4,"ngIf"],[1,"card","prestateurs-desktop"],["paginatorDropdownAppendTo","body","responsiveLayout","scroll","currentPageReportTemplate","  {first} / {last} de {totalRecords} entr\xE9es","selectionMode","single","styleClass","cursor-pointer",3,"selectionChange","onRowSelect","value","paginator","rows","showCurrentPageReport","loading","rowsPerPageOptions","globalFilterFields","selection","rowHover"],[1,"mobile-list"],["class","mobile-user-card",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mobile-user-card",3,"click"],["aria-hidden","true",1,"mobile-card-avatar"],[1,"mobile-card-body"],[1,"mobile-card-name"],[1,"mobile-card-meta"],[1,"mobile-card-footer"],["styleClass","mobile-status-tag",3,"value","severity"],[1,"mobile-card-actions"],["pButton","","pRipple","","icon","pi pi-eye","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","pTooltip","disabled"],["pButton","","pRipple","","icon","pi pi-trash","class","p-button-rounded p-button-text p-button-danger p-button-sm","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-trash","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-danger","p-button-sm",3,"click","pTooltip"],["class","mobile-state",4,"ngIf"],[1,"mobile-state"],[1,"mobile-load-more"],["pButton","","label","Charger plus","icon","pi pi-angle-down",1,"mobile-load-more-btn",3,"click"],["type","button","aria-label","Nouveau prestataire",1,"mobile-fab",3,"click"],[1,"pi","pi-user-plus"],[1,"flex","flex-wrap","gap-2","items-center","justify-between"],[1,"w-full","sm:w-80","order-1","sm:order-0"],["pInputText","","type","text","placeholder","Rechercher un prestataire...",1,"w-full",3,"input"],[1,"flex","gap-2","w-full","sm:w-auto","flex-order-0","sm:flex-order-1"],["placeholder","Tous les statuts",3,"ngModelChange","onChange","options","ngModel","showClear"],["pButton","","outlined","","class","flex-shrink-0","icon","pi pi-user-plus","label","Nouveau",3,"click",4,"ngIf"],["pButton","","outlined","","icon","pi pi-user-plus","label","Nouveau",1,"flex-shrink-0",3,"click"],["pSortableColumn","nom_complet",1,"white-space-nowrap",2,"width","25%"],[1,"flex","items-center","gap-2"],["field","nom_complet"],["pSortableColumn","phone",1,"white-space-nowrap",2,"width","15%"],["field","phone"],["pSortableColumn","type",1,"white-space-nowrap",2,"width","12%"],["field","type"],["pSortableColumn","pays",1,"white-space-nowrap",2,"width","18%"],["field","pays"],["pSortableColumn","is_active",1,"white-space-nowrap",2,"width","10%"],["field","is_active"],[1,"white-space-nowrap",2,"width","10%"],[3,"pSelectableRow"],[1,"flex","items-center","justify-center","w-10","h-10","rounded-full","bg-primary-100","text-primary-700","font-semibold"],[1,"font-semibold"],[1,"text-sm","text-surface-500","mt-1"],[1,"flex","items-center","gap-1"],[1,"text-surface-700"],[3,"value","severity",4,"ngIf"],["class","text-surface-400",4,"ngIf"],[1,"font-medium"],[1,"text-sm","text-surface-500"],[3,"value","severity"],[1,"flex","gap-2"],["pButton","","pRipple","","class","p-button-rounded p-button-text p-button-sm","tooltipPosition","top",3,"icon","p-button-success","p-button-danger","pTooltip","click",4,"ngIf"],[1,"text-surface-400"],["pButton","","pRipple","","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","icon","pTooltip"],["colspan","6",1,"text-center","py-8"],[1,"flex","flex-col","items-center","gap-3","text-surface-500"],[1,"pi","pi-users","text-4xl"]],template:function(e,t){if(e&1){let s=b();g(0,"p-confirmDialog"),a(1,"div",7)(2,"header",8)(3,"button",9),_("click",function(){return u(s),f(t.goHome())}),n(),a(4,"div",10)(5,"h1",11),m(6,"Prestataires"),n(),a(7,"p",12),m(8),n()(),g(9,"p-menu",13,0),a(11,"button",14),_("click",function(h){u(s);let Je=N(10);return f(Je.toggle(h))}),n()(),a(12,"div",15)(13,"section",16)(14,"p-icon-field"),g(15,"p-inputicon",17),a(16,"input",18),C("ngModelChange",function(h){return u(s),x(t.mobileSearchTerm,h)||(t.mobileSearchTerm=h),f(h)}),_("ngModelChange",function(){return u(s),f(t.onMobileSearchChange())}),n()()(),c(17,rt,2,2,"section",19)(18,ot,2,2,"ng-template",null,1,k)(20,st,2,0,"div",20),n(),c(21,lt,2,0,"button",21),n(),a(22,"div",22)(23,"p-table",23,2),C("selectionChange",function(h){return u(s),x(t.selectedPrestataire,h)||(t.selectedPrestataire=h),f(h)}),_("onRowSelect",function(h){return u(s),f(t.onRowSelect(h))}),c(25,mt,7,7,"ng-template",null,3,k)(27,dt,23,0,"ng-template",null,4,k)(29,_t,33,21,"ng-template",null,5,k)(31,ht,6,0,"ng-template",null,6,k),n()()}if(e&2){let s=N(19);o(8),ge("",t.mobileFilteredPrestataires.length," prestataire",t.mobileFilteredPrestataires.length!==1?"s":""),o(),l("model",t.mobileStatusMenuItems)("popup",!0),o(7),P("ngModel",t.mobileSearchTerm),o(),l("ngIf",!t.loading&&t.mobileVisiblePrestataires.length)("ngIfElse",s),o(3),l("ngIf",!t.loading&&t.canLoadMoreMobile),o(),l("ngIf",t.canCreate),o(2),l("value",t.prestataires)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("loading",t.loading)("rowsPerPageOptions",B(18,Ze))("globalFilterFields",B(19,$e)),P("selection",t.selectedPrestataire),l("rowHover",!0)}},dependencies:[M,he,F,G,A,z,j,Ve,Ie,ke,Oe,Fe,ye,q,J,Y,H,U,Pe,xe,De,Le,Se,Ce,Me,Q,Ne,Re,Te,Ee,We],styles:["[_nghost-%COMP%]{display:block}.prestateurs-mobile-app[_ngcontent-%COMP%]{display:none}@media screen and (max-width: 768px){[_nghost-%COMP%]{--mobile-primary: #5f6bff;--mobile-text: #334155;--mobile-muted: #7f8ca3;--mobile-card: #ffffff;--mobile-border: #e2e8f0}.prestateurs-desktop[_ngcontent-%COMP%]{display:none}.prestateurs-mobile-app[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;min-height:100dvh;height:100vh;height:100dvh;overflow:hidden;margin-top:calc(-.25rem - env(safe-area-inset-top));margin-left:-.875rem;margin-right:-.875rem;margin-bottom:calc(-.875rem - env(safe-area-inset-bottom));padding:0 .875rem env(safe-area-inset-bottom);padding-left:calc(.875rem + env(safe-area-inset-left));padding-right:calc(.875rem + env(safe-area-inset-right));background:#f8fafc;animation:_ngcontent-%COMP%_mobileFade .24s ease-out}.mobile-header[_ngcontent-%COMP%]{flex-shrink:0;display:flex;align-items:center;gap:.55rem;margin:0 -.875rem;padding:calc(.5rem + env(safe-area-inset-top)) calc(.875rem + env(safe-area-inset-right)) .6rem calc(.875rem + env(safe-area-inset-left));background:var(--mobile-card);border-bottom:1px solid var(--mobile-border);box-shadow:0 1px 3px #0f172a0f;position:sticky;top:0;z-index:30}.mobile-scroll[_ngcontent-%COMP%]{flex:1;min-height:0;overflow-y:auto;-webkit-overflow-scrolling:touch;padding-top:.75rem;padding-bottom:calc(4rem + env(safe-area-inset-bottom))}.mobile-back[_ngcontent-%COMP%], .mobile-add[_ngcontent-%COMP%]{width:2.25rem;height:2.25rem;border-radius:50%;flex-shrink:0;color:var(--mobile-primary)!important;background:#5f6bff1a!important}.mobile-title-wrap[_ngcontent-%COMP%]{flex:1;min-width:0}.mobile-title[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:700;color:var(--mobile-text)}.mobile-subtitle[_ngcontent-%COMP%]{margin:.15rem 0 0;font-size:.8rem;font-weight:500;color:var(--mobile-muted)}.mobile-search[_ngcontent-%COMP%]{background:var(--mobile-card);border:1px solid var(--mobile-border);border-radius:.75rem;padding:.4rem .6rem}.mobile-search[_ngcontent-%COMP%]   .p-iconfield[_ngcontent-%COMP%], .mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]{width:100%}.mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]{border:0;box-shadow:none;background:transparent;font-size:.95rem}.mobile-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.6rem;margin-top:1rem}.mobile-user-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.875rem;background:var(--mobile-card);border:1px solid var(--mobile-border);border-radius:.875rem;padding:.875rem;box-shadow:0 1px 3px #0000000d;cursor:pointer;transition:box-shadow .2s ease}.mobile-user-card[_ngcontent-%COMP%]:active{box-shadow:0 2px 8px #00000014}.mobile-card-avatar[_ngcontent-%COMP%]{width:2.75rem;height:2.75rem;min-width:2.75rem;min-height:2.75rem;border-radius:50%;background:linear-gradient(135deg,var(--mobile-primary) 0%,#7c8aff 100%);color:#fff;font-size:.8rem;font-weight:700;display:flex;align-items:center;justify-content:center}.mobile-card-body[_ngcontent-%COMP%]{flex:1;min-width:0}.mobile-card-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:var(--mobile-text);line-height:1.3}.mobile-card-meta[_ngcontent-%COMP%]{font-size:.85rem;color:var(--mobile-muted);margin-top:.2rem}.mobile-card-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:.5rem;margin-top:.5rem;flex-wrap:wrap}.mobile-card-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.mobile-card-actions[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]{width:2rem;height:2rem}[_nghost-%COMP%]     .mobile-status-tag{font-size:.75rem;padding:.2rem .5rem;border-radius:999px}.mobile-state[_ngcontent-%COMP%]{margin-top:1rem;background:var(--mobile-card);border:1px dashed var(--mobile-border);border-radius:.875rem;padding:1.5rem;text-align:center;color:var(--mobile-muted);font-size:.9rem}.mobile-load-more[_ngcontent-%COMP%]{padding-top:.5rem}.mobile-load-more-btn[_ngcontent-%COMP%]{width:100%;border-radius:999px;font-weight:600}.mobile-fab[_ngcontent-%COMP%]{position:fixed;bottom:calc(1rem + env(safe-area-inset-bottom));right:calc(1rem + env(safe-area-inset-right));z-index:25;width:3.5rem;height:3.5rem;min-width:3.5rem;min-height:3.5rem;padding:0;border:none;border-radius:50%;background:var(--mobile-primary);color:#fff;box-shadow:0 4px 14px #5f6bff66;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease;-webkit-tap-highlight-color:transparent}.mobile-fab[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1.35rem}.mobile-fab[_ngcontent-%COMP%]:active{transform:scale(.96)}.app-dark   [_nghost-%COMP%]{--mobile-primary: var(--p-primary-400);--mobile-text: var(--p-surface-100);--mobile-muted: var(--p-surface-400);--mobile-card: var(--p-surface-800);--mobile-border: var(--p-surface-600)}.app-dark[_nghost-%COMP%]   .prestateurs-mobile-app[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .prestateurs-mobile-app[_ngcontent-%COMP%]{background:var(--p-surface-950)}.app-dark[_nghost-%COMP%]   .mobile-header[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-header[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0003}.app-dark[_nghost-%COMP%]   .mobile-user-card[_ngcontent-%COMP%]:active, .app-dark   [_nghost-%COMP%]   .mobile-user-card[_ngcontent-%COMP%]:active{box-shadow:0 2px 8px #00000040}.app-dark[_nghost-%COMP%]   .mobile-state[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-state[_ngcontent-%COMP%]{background:var(--p-surface-800);border-color:var(--p-surface-600);color:var(--p-surface-400)}}@keyframes _ngcontent-%COMP%_mobileFade{0%{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}"]})};var Ye=[{value:"machiniste",label:"Machiniste"},{value:"mecanicien",label:"M\xE9canicien"},{value:"consultant",label:"Consultant"},{value:"fournisseur",label:"Fournisseur"}];function bt(r,i){r&1&&(a(0,"span",31),m(1,"*"),n())}function vt(r,i){r&1&&(a(0,"small",31),m(1," Type obligatoire. "),n())}function yt(r,i){r&1&&(a(0,"span",31),m(1,"*"),n())}function Pt(r,i){r&1&&(a(0,"small",31),m(1," Raison sociale obligatoire. "),n())}function xt(r,i){if(r&1){let e=b();a(0,"div",8)(1,"label",32),m(2," Raison sociale "),c(3,yt,2,0,"span",10),n(),a(4,"input",33),C("ngModelChange",function(s){u(e);let p=d();return x(p.model.raison_sociale,s)||(p.model.raison_sociale=s),f(s)}),n(),c(5,Pt,2,0,"small",10),n()}if(r&2){let e=d();o(3),l("ngIf",e.isEditing),o(),P("ngModel",e.model.raison_sociale),l("invalid",e.submitted&&!(e.model.raison_sociale!=null&&e.model.raison_sociale.trim()))("disabled",e.fieldsDisabled),o(),l("ngIf",e.submitted&&!(e.model.raison_sociale!=null&&e.model.raison_sociale.trim())&&e.isEditing)}}function Ct(r,i){r&1&&(a(0,"span",31),m(1,"*"),n())}function St(r,i){r&1&&(a(0,"small",31),m(1," Nom obligatoire. "),n())}function wt(r,i){if(r&1){let e=b();a(0,"div",25)(1,"label",34),m(2," Nom "),c(3,Ct,2,0,"span",10),n(),a(4,"input",35),C("ngModelChange",function(s){u(e);let p=d();return x(p.model.nom,s)||(p.model.nom=s),f(s)}),n(),c(5,St,2,0,"small",10),n()}if(r&2){let e=d();o(3),l("ngIf",e.isEditing),o(),P("ngModel",e.model.nom),l("invalid",e.submitted&&!(e.model.nom!=null&&e.model.nom.trim()))("disabled",e.fieldsDisabled),o(),l("ngIf",e.submitted&&!(e.model.nom!=null&&e.model.nom.trim())&&e.isEditing)}}function Mt(r,i){r&1&&(a(0,"span",31),m(1,"*"),n())}function Et(r,i){r&1&&(a(0,"small",31),m(1," Pr\xE9nom obligatoire. "),n())}function Tt(r,i){if(r&1){let e=b();a(0,"div",25)(1,"label",36),m(2," Pr\xE9nom "),c(3,Mt,2,0,"span",10),n(),a(4,"input",37),C("ngModelChange",function(s){u(e);let p=d();return x(p.model.prenom,s)||(p.model.prenom=s),f(s)}),n(),c(5,Et,2,0,"small",10),n()}if(r&2){let e=d();o(3),l("ngIf",e.isEditing),o(),P("ngModel",e.model.prenom),l("invalid",e.submitted&&!(e.model.prenom!=null&&e.model.prenom.trim()))("disabled",e.fieldsDisabled),o(),l("ngIf",e.submitted&&!(e.model.prenom!=null&&e.model.prenom.trim())&&e.isEditing)}}function It(r,i){r&1&&(a(0,"span",31),m(1,"*"),n())}function kt(r,i){if(r&1&&(a(0,"div",38),g(1,"img",39),a(2,"span",40),m(3),n(),a(4,"span"),m(5),n()()),r&2){let e=i.$implicit;o(),l("src",e.flag,ee)("alt",e.name),o(2),y(e.dialCode),o(2),y(e.name)}}function Ft(r,i){if(r&1&&(a(0,"div",38),g(1,"img",39),a(2,"span",40),m(3),n(),a(4,"span"),m(5),n()()),r&2){let e=d().$implicit;o(),l("src",e.flag,ee)("alt",e.name),o(2),y(e.dialCode),o(2),y(e.name)}}function Ot(r,i){if(r&1&&c(0,Ft,6,4,"div",41),r&2){let e=i.$implicit;l("ngIf",e)}}function Vt(r,i){r&1&&(a(0,"span",31),m(1,"*"),n())}function Lt(r,i){r&1&&(a(0,"small",42),m(1," T\xE9l\xE9phone obligatoire. "),n())}function Dt(r,i){if(r&1&&(a(0,"small",42),m(1),n()),r&2){let e=d();o(),T(" ",e.phoneError," ")}}function Rt(r,i){r&1&&(a(0,"span",31),m(1,"*"),n())}function Nt(r,i){r&1&&(a(0,"small",31),m(1," Ville obligatoire. "),n())}function Bt(r,i){r&1&&(a(0,"span",31),m(1,"*"),n())}function Wt(r,i){r&1&&(a(0,"small",31),m(1," Quartier obligatoire. "),n())}function At(r,i){if(r&1){let e=b();a(0,"div",43)(1,"button",44),_("click",function(){u(e);let s=d();return f(s.onSubmit())}),n(),a(2,"button",45),_("click",function(){u(e);let s=d();return f(s.onCancel())}),n()()}if(r&2){let e=d();o(),l("label",e.mode==="create"?"Enregistrer":"Sauvegarder")("loading",e.loading)("disabled",!e.isValid()||e.loading),o(),l("disabled",e.loading)}}var L=class r{mode="create";initialData=null;loading=!1;submitForm=new te;cancel=new te;submitted=!1;isEditing=!1;model={};type_piece_identite=[];prestataireTypes=Ye;phoneError=null;phoneCountry="GN";countries=Ge;ngOnInit(){this.type_piece_identite=[{name:"Carte d'identit\xE9",code:"CI"},{name:"Passport",code:"PASSPORT"},{name:"Permis de conduire",code:"PERMIS"}],this.initializeModel()}ngOnChanges(i){if(i.initialData){let e=i.initialData;e.currentValue&&Object.keys(e.currentValue).length>0&&(console.log("NgOnChanges - Nouvelles donn\xE9es:",e.currentValue),this.initializeModel())}}initializeModel(){console.log("InitializeModel appel\xE9 avec:",this.initialData),this.model=this.initialData?E({},this.initialData):{},this.mode==="create"&&!this.model.ville?.trim()&&(this.model.ville="Conakry"),console.log("Model apr\xE8s initialisation:",this.model),this.mode==="create"?this.isEditing=!0:this.mode==="edit"&&this.initialData&&(this.isEditing=!0),this.model.code_pays?(this.phoneCountry=this.model.code_pays,console.log("Pays d\xE9tect\xE9 depuis code_pays:",this.phoneCountry)):this.model.phone&&(this.detectPhoneCountry(this.model.phone),console.log("Pays d\xE9tect\xE9 depuis phone:",this.phoneCountry)),this.submitted=!1,this.phoneError=null}detectPhoneCountry(i){try{let e=ne(i);e&&e.country&&(this.phoneCountry=e.country)}catch{}}validatePhone(){if(!this.model.phone?.trim())return this.phoneError="T\xE9l\xE9phone obligatoire.",!1;try{if(!je(this.model.phone,this.phoneCountry))return this.phoneError=`Num\xE9ro invalide pour ${this.getCountryName(this.phoneCountry)}.`,!1;let e=ne(this.model.phone,this.phoneCountry);return e?(this.model.phone=e.formatInternational(),this.model.code_pays=this.phoneCountry,this.model.pays=this.getCountryName(this.phoneCountry),this.phoneError=null,!0):(this.phoneError="Format de num\xE9ro invalide.",!1)}catch{return this.phoneError="Format de num\xE9ro invalide.",!1}}getCountryName(i){let e=this.countries.find(t=>t.code===i);return e?e.name:i}getSelectedCountryDialCode(){let i=this.countries.find(e=>e.code===this.phoneCountry);return i?i.dialCode:""}getCountryFlag(i){let e=this.countries.find(t=>t.code===i);return e?e.flag:""}onCountryChange(){this.model.phone&&this.validatePhone()}onPhoneInput(){this.submitted&&this.validatePhone()}onPhoneBlur(){this.model.phone?.trim()&&this.validatePhone()}isValid(){if(!this.model.type)return!1;if(this.model.type==="fournisseur"){if(!!!(this.model.raison_sociale?.trim()&&this.model.phone?.trim()&&this.model.ville?.trim()&&this.model.quartier?.trim()))return!1}else if(!!!(this.model.nom?.trim()&&this.model.prenom?.trim()&&this.model.phone?.trim()&&this.model.ville?.trim()&&this.model.quartier?.trim()))return!1;return this.validatePhone()}enableEditing(){this.isEditing=!0}cancelEditing(){this.isEditing=!1,this.submitted=!1,this.phoneError=null,this.model=this.initialData?E({},this.initialData):{},this.model.code_pays?this.phoneCountry=this.model.code_pays:this.model.phone&&this.detectPhoneCountry(this.model.phone)}onSubmit(){this.submitted=!0,this.isValid()&&this.submitForm.emit(E({},this.model))}onCancel(){this.cancel.emit()}get fieldsDisabled(){return this.mode==="edit"&&!this.isEditing||this.loading}get formTitle(){if(this.mode==="create")return"Ajout prestataire";let i=this.model.reference?.trim();return"Modification prestataire"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=w({type:r,selectors:[["app-prestateurs-from"]],inputs:{mode:"mode",initialData:"initialData",loading:"loading"},outputs:{submitForm:"submitForm",cancel:"cancel"},features:[me],decls:49,vars:31,consts:[[1,"card"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-surface-900","dark:text-surface-0","text-xl","font-bold"],[1,"grid","grid-cols-12","gap-4"],[1,"col-span-12","lg:col-span-2"],[1,"text-surface-900","dark:text-surface-0","font-medium","text-xl","mb-4"],[1,"m-0","p-0","text-surface-600","dark:text-surface-200","leading-normal","mr-4"],[1,"col-span-12","lg:col-span-10"],[1,"mb-6","col-span-12","md:col-span-12"],["for","type",1,"font-medium","text-surface-900","dark:text-surface-0","mb-2","block"],["class","text-red-500",4,"ngIf"],["id","type","optionLabel","label","optionValue","value","placeholder","S\xE9lectionner un type","fluid","",3,"ngModelChange","ngModel","options","disabled","invalid"],["class","mb-6 col-span-12 md:col-span-12",4,"ngIf"],["class","mb-6 col-span-12 md:col-span-6",4,"ngIf"],[1,"mb-6","col-span-12"],[1,"grid","grid-cols-12","gap-3"],[1,"col-span-12","md:col-span-4"],["for","codePays",1,"font-medium","text-surface-900","dark:text-surface-0","mb-3","block"],["id","codePays","optionLabel","name","optionValue","code","placeholder","S\xE9lectionner un pays","fluid","",3,"ngModelChange","onChange","ngModel","options","disabled"],["pTemplate","item"],["pTemplate","selectedItem"],[1,"col-span-12","md:col-span-8"],["for","phone",1,"font-medium","text-surface-900","dark:text-surface-0","mb-3","block"],["id","phone","type","tel","pInputText","","fluid","","placeholder","Exemple: 622 00 00 00",3,"ngModelChange","input","blur","ngModel","invalid","disabled"],["class","text-red-500 block mt-2",4,"ngIf"],[1,"mb-6","col-span-12","md:col-span-6"],["for","ville",1,"font-medium","text-surface-900","dark:text-surface-0","mb-2","block"],["id","ville","type","text","pInputText","","fluid","",3,"ngModelChange","ngModel","invalid","disabled"],["for","quartier",1,"font-medium","text-surface-900","dark:text-surface-0","mb-2","block"],["id","quartier","type","text","pInputText","","fluid","",3,"ngModelChange","ngModel","invalid","disabled"],["class","col-span-12 flex gap-2 prestateurs-form-actions",4,"ngIf"],[1,"text-red-500"],["for","raison_sociale",1,"font-medium","text-surface-900","dark:text-surface-0","mb-2","block"],["id","raison_sociale","type","text","pInputText","","fluid","",3,"ngModelChange","ngModel","invalid","disabled"],["for","nom",1,"font-medium","text-surface-900","dark:text-surface-0","mb-2","block"],["id","nom","type","text","pInputText","","fluid","",3,"ngModelChange","ngModel","invalid","disabled"],["for","prenom",1,"font-medium","text-surface-900","dark:text-surface-0","mb-2","block"],["id","prenom","type","text","pInputText","","fluid","",3,"ngModelChange","ngModel","invalid","disabled"],[1,"flex","items-center","gap-2"],[1,"w-5","h-auto","rounded-sm",3,"src","alt"],[1,"font-semibold","text-primary"],["class","flex items-center gap-2",4,"ngIf"],[1,"text-red-500","block","mt-2"],[1,"col-span-12","flex","gap-2","prestateurs-form-actions"],["pButton","","pRipple","","icon","pi pi-check",1,"w-auto","prestateurs-form-submit",3,"click","label","loading","disabled"],["pButton","","pRipple","","label","Annuler","icon","pi pi-times","severity","secondary",1,"w-auto","prestateurs-form-cancel",3,"click","disabled"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"div",1)(2,"span",2),m(3),n()(),a(4,"div",3)(5,"div",4),g(6,"div",5),a(7,"p",6),m(8," Les champs s'affiche en fonctin du type de prestateur. "),n()(),a(9,"div",7)(10,"div",3)(11,"div",8)(12,"label",9),m(13," Type de prestataire "),c(14,bt,2,0,"span",10),n(),a(15,"p-select",11),C("ngModelChange",function(p){return x(t.model.type,p)||(t.model.type=p),p}),n(),c(16,vt,2,0,"small",10),n(),c(17,xt,6,5,"div",12)(18,wt,6,5,"div",13)(19,Tt,6,5,"div",13),a(20,"div",14)(21,"div",15)(22,"div",16)(23,"label",17),m(24," Pays "),c(25,It,2,0,"span",10),n(),a(26,"p-select",18),C("ngModelChange",function(p){return x(t.phoneCountry,p)||(t.phoneCountry=p),p}),_("onChange",function(){return t.onCountryChange()}),c(27,kt,6,4,"ng-template",19)(28,Ot,1,1,"ng-template",20),n()(),a(29,"div",21)(30,"label",22),m(31," T\xE9l\xE9phone "),c(32,Vt,2,0,"span",10),n(),a(33,"input",23),C("ngModelChange",function(p){return x(t.model.phone,p)||(t.model.phone=p),p}),_("input",function(){return t.onPhoneInput()})("blur",function(){return t.onPhoneBlur()}),n()()(),c(34,Lt,2,0,"small",24)(35,Dt,2,1,"small",24),n(),a(36,"div",25)(37,"label",26),m(38," Ville "),c(39,Rt,2,0,"span",10),n(),a(40,"input",27),C("ngModelChange",function(p){return x(t.model.ville,p)||(t.model.ville=p),p}),n(),c(41,Nt,2,0,"small",10),n(),a(42,"div",25)(43,"label",28),m(44," Quartier "),c(45,Bt,2,0,"span",10),n(),a(46,"input",29),C("ngModelChange",function(p){return x(t.model.quartier,p)||(t.model.quartier=p),p}),n(),c(47,Wt,2,0,"small",10),n(),c(48,At,3,4,"div",30),n()()()()),e&2&&(o(3),T(" ",t.formTitle," "),o(11),l("ngIf",t.isEditing),o(),P("ngModel",t.model.type),l("options",t.prestataireTypes)("disabled",t.fieldsDisabled)("invalid",t.submitted&&!t.model.type),o(),l("ngIf",t.submitted&&!t.model.type&&t.isEditing),o(),l("ngIf",t.model.type==="fournisseur"),o(),l("ngIf",t.model.type!=="fournisseur"),o(),l("ngIf",t.model.type!=="fournisseur"),o(6),l("ngIf",t.isEditing),o(),P("ngModel",t.phoneCountry),l("options",t.countries)("disabled",t.fieldsDisabled),o(6),l("ngIf",t.isEditing),o(),P("ngModel",t.model.phone),l("invalid",(t.submitted||t.phoneError)&&(!(t.model.phone!=null&&t.model.phone.trim())||!!t.phoneError))("disabled",t.fieldsDisabled),o(),l("ngIf",t.submitted&&!(t.model.phone!=null&&t.model.phone.trim())&&t.isEditing),o(),l("ngIf",t.phoneError&&(t.model.phone==null?null:t.model.phone.trim())&&t.isEditing),o(4),l("ngIf",t.isEditing),o(),P("ngModel",t.model.ville),l("invalid",t.submitted&&!(t.model.ville!=null&&t.model.ville.trim()))("disabled",t.fieldsDisabled),o(),l("ngIf",t.submitted&&!(t.model.ville!=null&&t.model.ville.trim())&&t.isEditing),o(4),l("ngIf",t.isEditing),o(),P("ngModel",t.model.quartier),l("invalid",t.submitted&&!(t.model.quartier!=null&&t.model.quartier.trim()))("disabled",t.fieldsDisabled),o(),l("ngIf",t.submitted&&!(t.model.quartier!=null&&t.model.quartier.trim())&&t.isEditing),o(),l("ngIf",t.isEditing))},dependencies:[M,F,Q,q,Be,Ae,ve,J,Y,ze,H,U,G,A,z,j],encapsulation:2})};var Z=class r{constructor(i,e,t){this.prestataireService=i;this.messageService=e;this.router=t}loading=!1;onCancel(){this.router.navigate(["contacts/prestateurs"])}onSubmit(i){this.loading=!0;let e={nom:i.nom||"",prenom:i.prenom||"",phone:i.phone||"",pays:i.pays||"Guin\xE9e",code_pays:i.code_pays||"GN",code_phone_pays:this.getCodePhonePays(i.code_pays||"GN"),ville:i.ville||"",quartier:i.quartier||void 0,adresse:i.adresse||void 0,raison_sociale:i.raison_sociale||void 0,email:i.email||void 0,specialite:i.specialite||void 0,type:i.type||void 0,tarif_horaire:i.tarif_horaire||void 0,notes:i.notes||void 0};console.log(e),this.prestataireService.createPrestataire(e).subscribe({next:t=>{t.success&&(this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Prestataire cr\xE9\xE9 avec succ\xE8s"}),setTimeout(()=>{this.router.navigate(["contacts/prestateurs"])},1500)),this.loading=!1},error:t=>{console.error("Erreur lors de la cr\xE9ation:",t),this.messageService.add({severity:"error",summary:"Erreur",detail:t.error?.message||"Erreur lors de la cr\xE9ation du prestataire"}),this.loading=!1}})}getCodePhonePays(i){return{GN:"+224",SL:"+232",LR:"+231",CI:"+225",SN:"+221",ML:"+223",BF:"+226",NE:"+227",TG:"+228",BJ:"+229",GH:"+233",NG:"+234",GM:"+220",GW:"+245",CV:"+238",MR:"+222",FR:"+33",BE:"+32",CH:"+41",LU:"+352",CA:"+1",US:"+1"}[i]||"+224"}static \u0275fac=function(e){return new(e||r)(v(V),v(S),v(O))};static \u0275cmp=w({type:r,selectors:[["app-prestateurs-new"]],features:[I([S])],decls:2,vars:2,consts:[[3,"submitForm","cancel","mode","loading"]],template:function(e,t){e&1&&(g(0,"p-toast"),a(1,"app-prestateurs-from",0),_("submitForm",function(p){return t.onSubmit(p)})("cancel",function(){return t.onCancel()}),n()),e&2&&(o(),l("mode","create")("loading",t.loading))},dependencies:[M,L,X,K],encapsulation:2})};function jt(r,i){r&1&&(a(0,"div",9),g(1,"i",10),n())}function Gt(r,i){if(r&1){let e=b();a(0,"app-prestateurs-from",11),_("submitForm",function(s){u(e);let p=d();return f(p.onSubmit(s))})("cancel",function(){u(e);let s=d();return f(s.onCancel())}),n()}if(r&2){let e=d();l("mode","edit")("initialData",e.prestateursData)("loading",e.loading)}}var $=class r{constructor(i,e,t,s){this.route=i;this.router=e;this.prestataireService=t;this.messageService=s}loading=!1;prestateurId=null;prestateursData=null;ngOnInit(){let i=this.route.snapshot.paramMap.get("id");i&&(this.prestateurId=parseInt(i,10),this.loadPrestataire(this.prestateurId))}loadPrestataire(i){this.loading=!0,this.prestataireService.getPrestataire(i).subscribe({next:e=>{if(e.success&&e.data){let t=e.data;this.prestateursData={id:t.id,reference:t.reference,type:t.type||void 0,nom:t.nom,prenom:t.prenom,raison_sociale:t.raison_sociale||void 0,phone:t.phone,email:t.email||void 0,pays:t.pays,code_pays:t.code_pays,code_phone_pays:t.code_phone_pays,ville:t.ville,quartier:t.quartier||void 0,adresse:t.adresse||void 0,specialite:t.specialite||void 0,tarif_horaire:t.tarif_horaire||void 0,notes:t.notes||void 0}}this.loading=!1},error:e=>{console.error("Erreur lors du chargement:",e),this.messageService.add({severity:"error",summary:"Erreur",detail:"Erreur lors du chargement du prestataire"}),this.loading=!1}})}onSubmit(i){if(!this.prestateurId)return;this.loading=!0;let e={nom:i.nom,prenom:i.prenom,phone:i.phone,pays:i.pays,code_pays:i.code_pays,code_phone_pays:this.getCodePhonePays(i.code_pays||"GN"),ville:i.ville,quartier:i.quartier||void 0,adresse:i.adresse||void 0,raison_sociale:i.raison_sociale||void 0,email:i.email||void 0,specialite:i.specialite||void 0,type:i.type||void 0,tarif_horaire:i.tarif_horaire||void 0,notes:i.notes||void 0};this.prestataireService.updatePrestataire(this.prestateurId,e).subscribe({next:t=>{t.success&&(this.prestateursData=le(E({},i),{reference:i.reference||this.prestateursData?.reference}),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Prestataire modifi\xE9 avec succ\xE8s"})),this.loading=!1},error:t=>{console.error("Erreur lors de la modification:",t),this.messageService.add({severity:"error",summary:"Erreur",detail:t.error?.message||"Erreur lors de la modification du prestataire"}),this.loading=!1}})}onCancel(){this.router.navigate(["contacts/prestateurs"])}getCodePhonePays(i){return{GN:"+224",SL:"+232",LR:"+231",CI:"+225",SN:"+221",ML:"+223",BF:"+226",NE:"+227",TG:"+228",BJ:"+229",GH:"+233",NG:"+234",GM:"+220",GW:"+245",CV:"+238",MR:"+222",FR:"+33",BE:"+32",CH:"+41",LU:"+352",CA:"+1",US:"+1"}[i]||"+224"}static \u0275fac=function(e){return new(e||r)(v(be),v(O),v(V),v(S))};static \u0275cmp=w({type:r,selectors:[["app-prestateurs-edit"]],features:[I([S])],decls:11,vars:2,consts:[[1,"edit-page"],[1,"edit-mobile-header"],["type","button","aria-label","Retour \xE0 la liste",1,"edit-back",3,"click"],[1,"pi","pi-arrow-left"],[1,"edit-title"],[1,"edit-header-spacer"],[1,"edit-content"],["class","flex justify-center items-center h-96",4,"ngIf"],[3,"mode","initialData","loading","submitForm","cancel",4,"ngIf"],[1,"flex","justify-center","items-center","h-96"],[1,"pi","pi-spin","pi-spinner","text-4xl","text-primary"],[3,"submitForm","cancel","mode","initialData","loading"]],template:function(e,t){e&1&&(g(0,"p-toast"),a(1,"div",0)(2,"header",1)(3,"button",2),_("click",function(){return t.onCancel()}),g(4,"i",3),n(),a(5,"h1",4),m(6,"Modifier le prestataire"),n(),g(7,"span",5),n(),a(8,"div",6),c(9,jt,2,0,"div",7)(10,Gt,1,3,"app-prestateurs-from",8),n()()),e&2&&(o(9),l("ngIf",t.loading&&!t.prestateursData),o(),l("ngIf",t.prestateursData))},dependencies:[M,F,L,X,K],styles:["[_nghost-%COMP%]{display:block}.edit-mobile-header[_ngcontent-%COMP%]{display:none}.edit-content[_ngcontent-%COMP%]{padding:1rem}@media screen and (max-width: 768px){.edit-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;min-height:100dvh;margin:calc(-.25rem - env(safe-area-inset-top)) -.875rem calc(-.875rem - env(safe-area-inset-bottom));margin-left:-.875rem;margin-right:-.875rem;padding:0;padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right);padding-bottom:env(safe-area-inset-bottom)}.edit-mobile-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex-shrink:0;padding:calc(.5rem + env(safe-area-inset-top)) .75rem .6rem calc(.875rem + env(safe-area-inset-left));padding-right:calc(.875rem + env(safe-area-inset-right));background:var(--surface-card);border-bottom:1px solid var(--surface-border);box-shadow:0 1px 3px #0000000f;position:sticky;top:0;z-index:25}.edit-back[_ngcontent-%COMP%]{width:2.25rem;height:2.25rem;min-width:2.25rem;border:none;border-radius:50%;background:var(--p-primary-50);color:var(--p-primary-500);display:flex;align-items:center;justify-content:center;cursor:pointer;-webkit-tap-highlight-color:transparent}.edit-back[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1.1rem}.edit-title[_ngcontent-%COMP%]{flex:1;margin:0;font-size:1.15rem;font-weight:700;color:var(--text-color);min-width:0}.edit-header-spacer[_ngcontent-%COMP%]{width:2.25rem;min-width:2.25rem}.edit-content[_ngcontent-%COMP%]{flex:1;min-height:0;overflow-y:auto;-webkit-overflow-scrolling:touch;padding:.875rem;padding-bottom:calc(1rem + env(safe-area-inset-bottom))}}"]})};var tr=[{path:"",component:R,canActivate:[D],data:{permissions:["prestataires.read"]}},{path:"prestateurs",component:R,canActivate:[D],data:{permissions:["prestataires.read"]}},{path:"new",component:Z,canActivate:[D],data:{permissions:["prestataires.create"]}},{path:"edit/:id",component:$,canActivate:[D],data:{permissions:["prestataires.update"]}},{path:"**",redirectTo:"/notfound"}];export{tr as default};
