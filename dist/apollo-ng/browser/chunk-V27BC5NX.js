import{b as ut}from"./chunk-6RJTZISX.js";import{b as dt}from"./chunk-QTPK4WUM.js";import{a as qe,b as Ge}from"./chunk-OAYELUTM.js";import{a as ct,b as pt}from"./chunk-WEJXN6OG.js";import"./chunk-N5VHCF4T.js";import"./chunk-KAWCBAUU.js";import{b as mt}from"./chunk-DPE5ICRY.js";import{a as $e,b as et}from"./chunk-IMZITBI5.js";import{a as lt,b as st}from"./chunk-6MAGWI7U.js";import{a as ot,b as at}from"./chunk-LOBJQVB7.js";import{a as tt,b as it}from"./chunk-3HDW43E7.js";import{a as Qe,d as Ye,e as Ke,h as Je,i as Xe,k as Ze}from"./chunk-KYBPPGZP.js";import"./chunk-KKEZTC3T.js";import"./chunk-QAU7W4US.js";import"./chunk-GO7AEQHW.js";import"./chunk-44MNQRCX.js";import{b as me,c as ue}from"./chunk-FHJ3HI6Y.js";import"./chunk-MGFZT6L3.js";import{a as nt,b as rt}from"./chunk-2M2YESUI.js";import"./chunk-Q737E3VB.js";import"./chunk-GVSJPEUD.js";import"./chunk-CQGFVLY5.js";import"./chunk-ZOHIMUT6.js";import"./chunk-TB7JIXSI.js";import{a as z,b as j}from"./chunk-D4ZZGRXJ.js";import"./chunk-USWDVUUM.js";import"./chunk-KHGHC55C.js";import{a as H}from"./chunk-72QBRNRN.js";import{a as ze,b as je}from"./chunk-2EPSW4YJ.js";import"./chunk-MYGUYXAJ.js";import{b as He}from"./chunk-UWJ6EXCC.js";import"./chunk-NIW5LLYW.js";import{b as Te,d as N}from"./chunk-RPS5NP6I.js";import"./chunk-TZVXXQOJ.js";import{a as Ee,d as Ie}from"./chunk-PPJOJKS5.js";import{c as se,d as Le,e as de}from"./chunk-P557RNKH.js";import"./chunk-PALTTDOF.js";import{c as ce,d as pe}from"./chunk-WF73AWMM.js";import"./chunk-SXW2RLBH.js";import"./chunk-LSUA6MZX.js";import"./chunk-M2LTT3HJ.js";import"./chunk-JYP5AZVX.js";import"./chunk-T7HI4VPR.js";import{a as Re,b as Ae,c as Ue,d as Be}from"./chunk-II7RVJNR.js";import{a as re,b as oe}from"./chunk-PW7MMR7K.js";import{b as ee,e as te,h as ie,n as Ve,p as ne}from"./chunk-3LUOICNH.js";import{a as We,b as Ne}from"./chunk-3G6KBQ3S.js";import"./chunk-D7FY7VLK.js";import"./chunk-BODZH67C.js";import"./chunk-7UZYWCAJ.js";import{i as ae,j as le}from"./chunk-IK72ORTM.js";import{a as Fe,b as De}from"./chunk-Z2XDSDL7.js";import{la as $,pa as w}from"./chunk-344GK45C.js";import{j as ke,k as W,v as D}from"./chunk-6PXXCRY5.js";import"./chunk-4O3FVBGX.js";import{$ as m,$b as S,Ab as _,Hb as b,Ja as T,La as A,Lb as f,Mb as c,Na as s,Qb as J,R as Me,Rb as X,Sa as K,Sb as Z,V as we,Vb as U,Xb as Se,Ya as y,Yb as ve,_b as p,aa as u,ac as B,bb as V,bc as Pe,dc as h,ea as R,ec as v,fc as P,hb as g,hc as F,ic as G,ma as Oe,o as M,u as ye,wc as O,xb as d,yb as a,zb as r}from"./chunk-E5DLUAUS.js";import{a as I,b as Y,c as he}from"./chunk-GAL4ENT6.js";var L={materiel:"Mat\xE9riel",service:"Service",fabricable:"Fabricable",achat_vente:"Achat/Vente"},k={brouillon:"Brouillon",actif:"Actif",inactif:"Inactif",archive:"Archiv\xE9",rupture_stock:"Rupture de stock"},ge={brouillon:"secondary",actif:"success",inactif:"danger",archive:"danger",rupture_stock:"warn"};var C=class n{id=0;nom="";code="";prix_usine=null;prix_vente=null;prix_achat=null;qte_stock=0;cout=null;statut="brouillon";type="materiel";in_stock=!0;is_archived=!1;archived_at=null;description=null;image_url=null;created_by=null;updated_by=null;deleted_by=null;archived_by=null;created_at="";updated_at="";deleted_at=null;creator;updater;archiver;deleter;created_by_name;updated_by_name;archived_by_name;deleted_by_name;constructor(t){t&&Object.assign(this,t)}getImageUrl(t="assets/demo/images/no-product.png"){return this.image_url?this.image_url.startsWith("http://")||this.image_url.startsWith("https://")?this.image_url:`assets/demo/images/produits/${this.image_url}`:t}formatPrix(t,e="GNF"){return`${(typeof t=="number"?t:0).toLocaleString("fr-FR")} ${e}`}static fromApi(t){return new n(Y(I({},t),{prix_usine:t?.prix_usine!==null&&t?.prix_usine!==void 0?Number(t.prix_usine):null,prix_vente:t?.prix_vente!==null&&t?.prix_vente!==void 0?Number(t.prix_vente):null,prix_achat:t?.prix_achat!==null&&t?.prix_achat!==void 0?Number(t.prix_achat):null,cout:t?.cout!==null&&t?.cout!==void 0?Number(t.cout):null}))}static fromApiArray(t){return t.map(e=>n.fromApi(e))}};var E=class n{constructor(t){this.http=t}apiUrl=`${ze.apiUrl}/produits`;getAll(){return this.http.get(this.apiUrl).pipe(M(t=>C.fromApiArray(t.data)))}getArchived(){return this.http.get(`${this.apiUrl}/archived`).pipe(M(t=>C.fromApiArray(t.data)))}search(t){let e=new Ee;return t.search&&(e=e.set("search",t.search)),t.type&&(e=e.set("type",t.type)),t.statut&&(e=e.set("statut",t.statut)),t.in_stock!==void 0&&(e=e.set("in_stock",t.in_stock.toString())),t.page&&(e=e.set("page",t.page.toString())),t.per_page&&(e=e.set("per_page",t.per_page.toString())),t.sort_by&&(e=e.set("sort_by",t.sort_by)),t.sort_order&&(e=e.set("sort_order",t.sort_order)),this.http.get(`${this.apiUrl}/search`,{params:e}).pipe(M(i=>Y(I({},i),{data:C.fromApiArray(i.data)})))}getStatistics(){return this.http.get(`${this.apiUrl}/statistics`).pipe(M(t=>t.data))}getById(t){return this.http.get(`${this.apiUrl}/${t}`).pipe(M(e=>C.fromApi(e.data)))}create(t){let o=t,{image:e}=o,i=he(o,["image"]);return this.http.post(this.apiUrl,i).pipe(M(l=>C.fromApi(l.data)))}update(t,e){let l=e,{image:i}=l,o=he(l,["image"]);return this.http.put(`${this.apiUrl}/${t}`,o).pipe(M(x=>C.fromApi(x.data)))}uploadProduitImage(t,e){let i=new FormData;return i.append("image",e,e.name),this.http.post(`${this.apiUrl}/${t}/image`,i).pipe(M(o=>C.fromApi(o.data)))}deleteProduitImage(t){return this.http.delete(`${this.apiUrl}/${t}/image`).pipe(M(e=>C.fromApi(e.data)))}delete(t){return this.http.delete(`${this.apiUrl}/${t}`)}updateStock(t,e){return this.http.patch(`${this.apiUrl}/${t}/stock`,e).pipe(M(i=>C.fromApi(i.data)))}changeStatus(t,e){return this.http.patch(`${this.apiUrl}/${t}/status`,e).pipe(M(i=>C.fromApi(i.data)))}archive(t){return this.http.patch(`${this.apiUrl}/${t}/archive`,{}).pipe(M(e=>C.fromApi(e.data)))}unarchive(t){return this.http.patch(`${this.apiUrl}/${t}/unarchive`,{}).pipe(M(e=>C.fromApi(e.data)))}static \u0275fac=function(e){return new(e||n)(we(Ie))};static \u0275prov=Me({token:n,factory:n.\u0275fac,providedIn:"root"})};var Mt=["dt"],wt=()=>({"min-width":"75rem"}),Ot=()=>[10,20,30],St=()=>({width:"720px",maxWidth:"95vw"}),kt=()=>({width:"450px"});function Et(n,t){if(n&1&&_(0,"img",44),n&2){let e=c().$implicit;d("src",e.getImageUrl(),T)("alt",e.nom)}}function It(n,t){n&1&&(a(0,"div",45),_(1,"i",46),r())}function Tt(n,t){if(n&1){let e=b();a(0,"p-button",47),f("click",function(o){m(e);let l=c().$implicit,x=c(2);return o.stopPropagation(),u(x.deleteProduct(l))}),r()}n&2&&d("rounded",!0)("outlined",!0)}function Vt(n,t){if(n&1){let e=b();a(0,"article",29),f("click",function(o){let l=m(e).$implicit,x=c(2);return u(x.goToEditProduit(o,l.id))}),a(1,"div",30),g(2,Et,1,2,"img",31)(3,It,2,0,"div",32),r(),a(4,"div",33)(5,"div",34)(6,"div",35)(7,"div",36),p(8),r(),a(9,"div",37),p(10),r()(),_(11,"p-tag",38),r(),a(12,"div",39)(13,"span",40),p(14),r(),a(15,"div",41)(16,"button",42),f("click",function(o){let l=m(e).$implicit,x=c(2);return u(x.goToEditProduit(o,l.id))}),r(),g(17,Tt,1,2,"p-button",43),r()()()()}if(n&2){let e=t.$implicit,i=c(2);s(2),d("ngIf",e.image_url),s(),d("ngIf",!e.image_url),s(5),S(e.code||"Sans code"),s(2),S(e.nom),s(),d("value",i.getStatutLabel(e.statut))("severity",i.getStatutSeverity(e.statut)),s(3),Pe("",e.qte_stock," en stock \xB7 ",i.formatCurrency(e.prix_vente)),s(2),d("pTooltip",i.canUpdate?"Modifier":"Voir")("disabled",!i.canUpdate),s(),d("ngIf",i.canDelete)}}function Ft(n,t){if(n&1&&(a(0,"section",27),g(1,Vt,18,11,"article",28),r()),n&2){let e=c();s(),d("ngForOf",e.mobileVisibleProduits)("ngForTrackBy",e.trackByProduitId)}}function Dt(n,t){n&1&&(a(0,"div",49),p(1,"Chargement des produits..."),r())}function Lt(n,t){n&1&&(a(0,"div",49),p(1,"Aucun produit trouve."),r())}function Rt(n,t){if(n&1&&g(0,Dt,2,0,"div",48)(1,Lt,2,0,"div",48),n&2){let e=c();d("ngIf",e.loading),s(),d("ngIf",!e.loading&&!e.mobileFilteredProduits.length)}}function At(n,t){if(n&1){let e=b();a(0,"div",50)(1,"p-button",51),f("onClick",function(){m(e);let o=c();return u(o.loadMoreMobile())}),r()()}}function Ut(n,t){if(n&1){let e=b();a(0,"button",52),f("click",function(){m(e);let o=c();return u(o.goToNewProduits())}),_(1,"i",53),a(2,"span",54),p(3,"Nouveau produit"),r()()}}function Bt(n,t){if(n&1){let e=b();a(0,"p-button",57),f("onClick",function(){m(e);let o=c(2);return u(o.goToNewProduits())}),r()}if(n&2){let e=c(2);d("disabled",!e.canCreate)}}function Wt(n,t){if(n&1){let e=b();a(0,"p-button",58),f("onClick",function(){m(e);let o=c(2);return u(o.deleteSelectedProducts())}),r()}if(n&2){let e=c(2);d("disabled",!e.selectedProduits||!e.selectedProduits.length)}}function Nt(n,t){if(n&1&&g(0,Bt,1,1,"p-button",55)(1,Wt,1,1,"p-button",56),n&2){let e=c();d("ngIf",e.canCreate),s(),d("ngIf",e.canDelete)}}function zt(n,t){if(n&1){let e=b();a(0,"p-button",59),f("onClick",function(){m(e);let o=c();return u(o.exportCSV())}),r()}}function jt(n,t){if(n&1){let e=b();a(0,"div",60)(1,"h5",61),p(2,"Gestion des Produits"),r(),a(3,"p-iconfield"),_(4,"p-inputicon",18),a(5,"input",62),f("input",function(o){m(e);let l=c(),x=U(27);return u(l.onGlobalFilter(x,o))}),r()()()}}function qt(n,t){n&1&&(a(0,"tr")(1,"th",63),_(2,"p-tableHeaderCheckbox"),r(),a(3,"th",64),p(4,"Image"),r(),a(5,"th",65)(6,"span",66),p(7,"Code "),_(8,"p-sortIcon",67),r()(),a(9,"th",68)(10,"span",66),p(11,"Nom "),_(12,"p-sortIcon",69),r()(),a(13,"th",70)(14,"span",66),p(15,"Type "),_(16,"p-sortIcon",71),r()(),a(17,"th",72)(18,"span",66),p(19,"Qt\xE9 "),_(20,"p-sortIcon",73),r()(),a(21,"th",74)(22,"span",66),p(23,"Status "),_(24,"p-sortIcon",75),r()(),a(25,"th",76),p(26,"Action"),r()())}function Gt(n,t){if(n&1&&_(0,"img",84),n&2){let e=c().$implicit;d("src",e.getImageUrl(),T)("alt",e.nom)}}function Ht(n,t){n&1&&_(0,"i",85)}function Qt(n,t){if(n&1){let e=b();a(0,"p-button",86),f("click",function(){m(e);let o=c().$implicit,l=c();return u(l.deleteProduct(o))}),r()}n&2&&d("rounded",!0)("outlined",!0)}function Yt(n,t){if(n&1){let e=b();a(0,"tr")(1,"td",63),_(2,"p-tableCheckbox",77),r(),a(3,"td",64),g(4,Gt,1,2,"img",78)(5,Ht,1,0,"i",79),r(),a(6,"td",76),p(7),r(),a(8,"td",80),p(9),r(),a(10,"td"),p(11),r(),a(12,"td"),p(13),r(),a(14,"td"),_(15,"p-tag",81),r(),a(16,"td")(17,"button",82),f("click",function(o){let l=m(e).$implicit,x=c();return u(x.goToEditProduit(o,l.id))}),r(),g(18,Qt,1,2,"p-button",83),r()()}if(n&2){let e=t.$implicit,i=c();s(2),d("value",e),s(2),d("ngIf",e.image_url),s(),d("ngIf",!e.image_url),s(2),S(e.code),s(2),S(e.nom),s(2),S(e.type),s(2),S(e.qte_stock),s(2),d("value",i.getStatutLabel(e.statut))("severity",i.getStatutSeverity(e.statut)),s(2),d("pTooltip",i.canUpdate?"Modifier":"Voir")("disabled",!i.canUpdate),s(),d("ngIf",i.canDelete)}}function Kt(n,t){if(n&1){let e=b();a(0,"div",109)(1,"label",110),p(2,"Code"),r(),a(3,"input",111),P("ngModelChange",function(o){m(e);let l=c(2);return v(l.produit.code,o)||(l.produit.code=o),u(o)}),r()()}if(n&2){let e=c(2);s(3),h("ngModel",e.produit.code),d("disabled",!0)}}function Jt(n,t){n&1&&(a(0,"small",112),p(1,"Type obligatoire."),r())}function Xt(n,t){n&1&&(a(0,"small",112),p(1,"Nom obligatoire."),r())}function Zt(n,t){if(n&1){let e=b();a(0,"div")(1,"label",113),p(2,"Statut"),r(),a(3,"p-select",114),P("ngModelChange",function(o){m(e);let l=c(2);return v(l.produit.statut,o)||(l.produit.statut=o),u(o)}),r()()}if(n&2){let e=c(2);s(3),h("ngModel",e.produit.statut),d("options",e.statutOptions)}}function $t(n,t){if(n&1){let e=b();g(0,Kt,4,2,"div",87),a(1,"div",88)(2,"div")(3,"label",89),p(4,"Type"),r(),a(5,"p-select",90),P("ngModelChange",function(o){m(e);let l=c();return v(l.produit.type,o)||(l.produit.type=o),u(o)}),r(),g(6,Jt,2,0,"small",91),r(),a(7,"div")(8,"label",92),p(9,"Nom"),r(),a(10,"input",93),P("ngModelChange",function(o){m(e);let l=c();return v(l.produit.nom,o)||(l.produit.nom=o),u(o)}),r(),g(11,Xt,2,0,"small",91),r(),a(12,"div")(13,"label",94),p(14,"Description"),r(),a(15,"textarea",95),P("ngModelChange",function(o){m(e);let l=c();return v(l.produit.description,o)||(l.produit.description=o),u(o)}),r()(),g(16,Zt,4,2,"div",96),a(17,"div",97)(18,"div",98)(19,"label",99),p(20,"Quantit\xE9"),r(),a(21,"p-inputnumber",100),P("ngModelChange",function(o){m(e);let l=c();return v(l.produit.qte_stock,o)||(l.produit.qte_stock=o),u(o)}),r()(),a(22,"div",98)(23,"label",101),p(24,"Co\xFBt"),r(),a(25,"p-inputnumber",102),P("ngModelChange",function(o){m(e);let l=c();return v(l.produit.cout,o)||(l.produit.cout=o),u(o)}),r()()(),a(26,"div",97)(27,"div",98)(28,"label",103),p(29,"Prix achat"),r(),a(30,"p-inputnumber",104),P("ngModelChange",function(o){m(e);let l=c();return v(l.produit.prix_achat,o)||(l.produit.prix_achat=o),u(o)}),r()(),a(31,"div",98)(32,"label",105),p(33,"Prix vente"),r(),a(34,"p-inputnumber",106),P("ngModelChange",function(o){m(e);let l=c();return v(l.produit.prix_vente,o)||(l.produit.prix_vente=o),u(o)}),r()()(),a(35,"div")(36,"label",107),p(37,"Prix usine"),r(),a(38,"p-inputnumber",108),P("ngModelChange",function(o){m(e);let l=c();return v(l.produit.prix_usine,o)||(l.produit.prix_usine=o),u(o)}),r()()()}if(n&2){let e=c();d("ngIf",e.produit==null?null:e.produit.id),s(5),h("ngModel",e.produit.type),d("options",e.typeOptions),s(),d("ngIf",e.submitted&&!e.produit.type),s(4),h("ngModel",e.produit.nom),s(),d("ngIf",e.submitted&&!(e.produit.nom!=null&&e.produit.nom.trim())),s(4),h("ngModel",e.produit.description),s(),d("ngIf",e.produit==null?null:e.produit.id),s(5),h("ngModel",e.produit.qte_stock),s(4),h("ngModel",e.produit.cout),s(5),h("ngModel",e.produit.prix_achat),s(4),h("ngModel",e.produit.prix_vente),s(4),h("ngModel",e.produit.prix_usine)}}function ei(n,t){if(n&1){let e=b();a(0,"p-button",115),f("click",function(){m(e);let o=c();return u(o.hideDialog())}),r(),a(1,"p-button",116),f("click",function(){m(e);let o=c();return u(o.saveProduit())}),r()}if(n&2){let e=c();d("disabled",e.saving),s(),d("disabled",e.saving)("loading",e.saving)}}var Q=class n{constructor(t,e,i,o,l,x){this.router=t;this.produitService=e;this.messageService=i;this.confirmationService=o;this.authService=l;this.document=x;this.canCreate=this.authService.hasPermission("produits.create"),this.canUpdate=this.authService.hasPermission("produits.update"),this.canDelete=this.authService.hasPermission("produits.delete")}produits=[];produit=new C;loading=!0;saving=!1;filterFields=["code","nom","description","type","statut","qte_stock"];produitDialog=!1;selectedProduits;submitted=!1;typeOptions=[];statutOptions=[];dt;exportColumns;cols;canCreate=!1;canUpdate=!1;canDelete=!1;mobileSearchTerm="";mobilePageSize=8;mobileVisibleCount=this.mobilePageSize;mobileBreakpoint=768;mobilePwaClass="produits-mobile-pwa";exportCSV(){this.dt.exportCSV()}ngOnInit(){this.initOptions(),this.initColumns(),this.loadProduits(),this.syncMobilePwaMode()}ngOnDestroy(){this.clearMobilePwaMode()}onWindowResize(){this.syncMobilePwaMode()}loadProduits(){this.loading=!0,this.produitService.getAll().subscribe({next:t=>{this.produits=t,this.resetMobilePagination(),this.loading=!1},error:t=>{console.error("Erreur lors du chargement des produits :",t),this.loading=!1,this.showApiError(t,"Chargement des produits impossible")}})}initOptions(){this.typeOptions=Object.entries(L).map(([t,e])=>({label:e,value:t})),this.statutOptions=Object.entries(k).map(([t,e])=>({label:e,value:t}))}initColumns(){this.cols=[{field:"code",header:"Code",customExportHeader:"Product Code"},{field:"nom",header:"Nom"},{field:"image",header:"Image"},{field:"prix_vente",header:"Prix"},{field:"type",header:"Type"}],this.exportColumns=this.cols.map(t=>({title:t.header,dataKey:t.field}))}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}onMobileSearchChange(t){this.mobileVisibleCount=this.mobilePageSize}get mobileFilteredProduits(){let t=this.mobileSearchTerm.trim().toLowerCase();return t?this.produits.filter(e=>[e.code,e.nom,e.description,this.getTypeLabel(e.type),this.getStatutLabel(e.statut),e.qte_stock].some(o=>this.searchableValue(o).includes(t))):this.produits}get mobileVisibleProduits(){return this.mobileFilteredProduits.slice(0,this.mobileVisibleCount)}get canLoadMoreMobile(){return this.mobileVisibleCount<this.mobileFilteredProduits.length}loadMoreMobile(){this.mobileVisibleCount+=this.mobilePageSize}trackByProduitId(t,e){return e.id||e.code||t}openNew(){this.produit=new C,this.submitted=!1,this.produitDialog=!0}editProduct(t){this.produit=new C(I({},t)),this.produitDialog=!0}deleteSelectedProducts(){this.confirmationService.confirm({message:"Are you sure you want to delete the selected products?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{let t=(this.selectedProduits??[]).map(e=>e.id).filter(e=>!!e);t.length!==0&&ye(t.map(e=>this.produitService.delete(e))).subscribe({next:()=>{this.produits=this.produits.filter(e=>!t.includes(e.id)),this.selectedProduits=null,this.messageService.add({severity:"success",summary:"Successful",detail:"Products Deleted",life:3e3})},error:e=>{console.error("Erreur lors de la suppression des produits :",e),this.showApiError(e,"Suppression impossible")}})}})}hideDialog(){this.produitDialog=!1,this.submitted=!1}deleteProduct(t){this.confirmationService.confirm({message:"Are you sure you want to delete "+(t.nom||"this product")+"?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{t.id&&this.produitService.delete(t.id).subscribe({next:()=>{this.produits=this.produits.filter(e=>e.id!==t.id),this.messageService.add({severity:"success",summary:"Successful",detail:"Product Deleted",life:3e3})},error:e=>{console.error("Erreur lors de la suppression du produit :",e),this.showApiError(e,"Suppression impossible")}})}})}getSeverity(t){switch(t){case"INSTOCK":return"success";case"LOWSTOCK":return"warn";case"OUTOFSTOCK":return"danger";default:return"info"}}getStatutSeverity(t){return t?ge[t]??ge.brouillon:ge.brouillon}getStatutLabel(t){return t?k[t]??k.brouillon:k.brouillon}getTypeLabel(t){return t?L[t]??t:"-"}formatCurrency(t){return typeof t!="number"?"-":`${new Intl.NumberFormat("fr-GN",{maximumFractionDigits:0}).format(t)} GNF`}saveProduit(){if(this.submitted=!0,!this.produit.nom?.trim()||!this.produit.type||this.saving)return;this.saving=!0;let t={nom:this.produit.nom.trim(),type:this.produit.type,qte_stock:this.produit.qte_stock??0,statut:this.produit.statut,cout:this.produit.cout??void 0,description:this.produit.description??void 0,prix_usine:this.produit.prix_usine??void 0,prix_vente:this.produit.prix_vente??void 0,prix_achat:this.produit.prix_achat??void 0},e=!!this.produit.id;(e?this.produitService.update(this.produit.id,t):this.produitService.create(t)).subscribe({next:()=>{this.produitDialog=!1,this.produit=new C,this.submitted=!1,this.saving=!1,this.loadProduits(),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:e?"Produit mis \xE0 jour":"Produit cr\xE9\xE9",life:3e3})},error:o=>{this.saving=!1,this.showApiError(o,"Sauvegarde impossible")}})}showApiError(t,e){let i="Erreur",o=this.extractErrorMessage(t,e);t.status===422&&t.error?.errors?Object.values(t.error.errors).flat().forEach(x=>{this.messageService.add({severity:"error",summary:"Validation",detail:x,life:5e3})}):this.messageService.add({severity:"error",summary:i,detail:o,life:5e3})}extractErrorMessage(t,e){return typeof t?.error?.message=="string"&&t.error.message.trim().length>0?t.error.message:typeof t?.message=="string"&&t.message.trim().length>0?t.message:e}goToNewProduits(){this.router.navigate(["/produits/produits-new"])}goHome(){this.router.navigate(["/"])}goToEditProduit(t,e){t.stopPropagation(),this.router.navigate(["/produits/produits-edit",e])}resetMobilePagination(){this.mobileVisibleCount=this.mobilePageSize}searchableValue(t){return t==null?"":String(t).toLowerCase()}syncMobilePwaMode(){typeof window>"u"||(window.innerWidth<=this.mobileBreakpoint?this.document.body.classList.add(this.mobilePwaClass):this.clearMobilePwaMode())}clearMobilePwaMode(){this.document.body.classList.remove(this.mobilePwaClass)}static \u0275fac=function(e){return new(e||n)(y(N),y(E),y(w),y($),y(je),y(R))};static \u0275cmp=V({type:n,selectors:[["app-produits-liste"]],viewQuery:function(e,i){if(e&1&&J(Mt,5),e&2){let o;X(o=Z())&&(i.dt=o.first)}},hostBindings:function(e,i){e&1&&f("resize",function(){return i.onWindowResize()},A)},features:[F([w,E,$])],decls:40,vars:29,consts:[["mobileListState",""],["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["content",""],["footer",""],[1,"produits-mobile-app"],[1,"mobile-header"],["pButton","","pRipple","","icon","pi pi-arrow-left","aria-label","Retour \xE0 l'accueil",1,"p-button-rounded","p-button-text","mobile-back",3,"click"],[1,"mobile-title-wrap"],[1,"mobile-title"],[1,"mobile-subtitle"],["pButton","","pRipple","","icon","pi pi-upload","aria-label","Export",1,"p-button-rounded","p-button-text","mobile-add",3,"click"],[1,"mobile-scroll"],[1,"mobile-search"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Rechercher un produit...",3,"ngModelChange","ngModel"],["class","mobile-list",4,"ngIf","ngIfElse"],["class","mobile-load-more",4,"ngIf"],["type","button","class","mobile-fab","aria-label","Nouveau produit",3,"click",4,"ngIf"],[1,"card","produits-desktop"],["styleClass","mb-12"],["dataKey","id","currentPageReportTemplate","  {first} \xE0 {last} sur {totalRecords} produits",3,"selectionChange","value","loading","rows","columns","paginator","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions"],[3,"visibleChange","visible","header","modal"],[1,"mobile-list"],["class","mobile-produit-card",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mobile-produit-card",3,"click"],[1,"mobile-card-media"],["class","mobile-card-thumb",3,"src","alt",4,"ngIf"],["class","mobile-card-image-placeholder","aria-hidden","true",4,"ngIf"],[1,"mobile-card-body"],[1,"mobile-card-top"],[1,"mobile-card-main"],[1,"mobile-code"],[1,"mobile-name"],["styleClass","mobile-status-tag",3,"value","severity"],[1,"mobile-card-footer"],[1,"mobile-card-summary"],[1,"mobile-card-actions"],["pButton","","pRipple","","icon","pi pi-eye","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm","mobile-eye-action",3,"click","pTooltip","disabled"],["icon","pi pi-trash","severity","danger","styleClass","mobile-delete-action",3,"rounded","outlined","click",4,"ngIf"],[1,"mobile-card-thumb",3,"src","alt"],["aria-hidden","true",1,"mobile-card-image-placeholder"],[1,"pi","pi-box"],["icon","pi pi-trash","severity","danger","styleClass","mobile-delete-action",3,"click","rounded","outlined"],["class","mobile-state",4,"ngIf"],[1,"mobile-state"],[1,"mobile-load-more"],["label","Charger plus","icon","pi pi-angle-down","styleClass","mobile-load-more-btn",3,"onClick"],["type","button","aria-label","Nouveau produit",1,"mobile-fab",3,"click"],[1,"pi","pi-plus"],[1,"mobile-fab-label"],["label","Nouveau","icon","pi pi-plus","severity","secondary","class","mr-2",3,"disabled","onClick",4,"ngIf"],["severity","secondary","label","Delete","icon","pi pi-trash","outlined","",3,"disabled","onClick",4,"ngIf"],["label","Nouveau","icon","pi pi-plus","severity","secondary",1,"mr-2",3,"onClick","disabled"],["severity","secondary","label","Delete","icon","pi pi-trash","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],[1,"flex","items-center","justify-between"],[1,"m-0"],["pInputText","","type","text","placeholder","Rechercher...",3,"input"],[2,"width","3rem"],[2,"width","5rem"],["pSortableColumn","code",2,"min-width","16rem"],[1,"flex","items-center","gap-2"],["field","code"],["pSortableColumn","nom",2,"min-width","16rem"],["field","nom"],["pSortableColumn","type",2,"min-width","10rem"],["field","type"],["pSortableColumn","qte_stock",2,"min-width","12rem"],["field","qte_stock"],["pSortableColumn","statut",2,"min-width","12rem"],["field","statut"],[2,"min-width","12rem"],[3,"value"],["style","width: 48px; height: 48px; object-fit: contain;","class","rounded border border-surface-200",3,"src","alt",4,"ngIf"],["class","pi pi-image text-surface-300 text-2xl",4,"ngIf"],[2,"min-width","16rem"],[3,"value","severity"],["pButton","","pRipple","","icon","pi pi-eye","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm","mr-2",3,"click","pTooltip","disabled"],["icon","pi pi-trash","severity","danger",3,"rounded","outlined","click",4,"ngIf"],[1,"rounded","border","border-surface-200",2,"width","48px","height","48px","object-fit","contain",3,"src","alt"],[1,"pi","pi-image","text-surface-300","text-2xl"],["icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"],["class","mb-4",4,"ngIf"],[1,"flex","flex-col","gap-6"],["for","type",1,"block","font-bold","mb-4"],["inputId","type","optionLabel","label","optionValue","value","placeholder","S\xE9lectionner un type","fluid","",3,"ngModelChange","ngModel","options"],["class","text-red-500",4,"ngIf"],["for","nom",1,"block","font-bold","mb-4"],["type","text","pInputText","","id","nom","required","","autofocus","","fluid","",3,"ngModelChange","ngModel"],["for","description",1,"block","font-bold","mb-4"],["id","description","pTextarea","","rows","3","cols","20","fluid","",3,"ngModelChange","ngModel"],[4,"ngIf"],[1,"grid","grid-cols-12","gap-4"],[1,"col-span-6"],["for","qte_stock",1,"block","font-bold","mb-4"],["id","qte_stock","fluid","",3,"ngModelChange","ngModel"],["for","cout",1,"block","font-bold","mb-4"],["id","cout","mode","currency","currency","GNF","locale","fr-GN","fluid","",3,"ngModelChange","ngModel"],["for","prix_achat",1,"block","font-bold","mb-4"],["id","prix_achat","mode","currency","currency","GNF","locale","fr-GN","fluid","",3,"ngModelChange","ngModel"],["for","prix_vente",1,"block","font-bold","mb-4"],["id","prix_vente","mode","currency","currency","GNF","locale","fr-GN","fluid","",3,"ngModelChange","ngModel"],["for","prix_usine",1,"block","font-bold","mb-4"],["id","prix_usine","mode","currency","currency","GNF","locale","fr-GN","fluid","",3,"ngModelChange","ngModel"],[1,"mb-4"],["for","code",1,"block","font-bold","mb-4"],["type","text","pInputText","","id","code","fluid","",3,"ngModelChange","ngModel","disabled"],[1,"text-red-500"],["for","statut",1,"block","font-bold","mb-4"],["inputId","statut","optionLabel","label","optionValue","value","placeholder","S\xE9lectionner un statut","fluid","",3,"ngModelChange","ngModel","options"],["label","Annuler","icon","pi pi-times","text","",3,"click","disabled"],["label","Enregistrer","icon","pi pi-check",3,"click","disabled","loading"]],template:function(e,i){if(e&1){let o=b();_(0,"p-toast"),a(1,"div",9)(2,"header",10)(3,"button",11),f("click",function(){return m(o),u(i.goHome())}),r(),a(4,"div",12)(5,"h1",13),p(6,"Produits"),r(),a(7,"p",14),p(8),r()(),a(9,"button",15),f("click",function(){return m(o),u(i.exportCSV())}),r()(),a(10,"div",16)(11,"section",17)(12,"p-iconfield"),_(13,"p-inputicon",18),a(14,"input",19),P("ngModelChange",function(x){return m(o),v(i.mobileSearchTerm,x)||(i.mobileSearchTerm=x),u(x)}),f("ngModelChange",function(x){return m(o),u(i.onMobileSearchChange(x))}),r()()(),g(15,Ft,2,2,"section",20)(16,Rt,2,2,"ng-template",null,0,O)(18,At,2,0,"div",21),r(),g(19,Ut,4,0,"button",22),r(),a(20,"div",23)(21,"p-toolbar",24),g(22,Nt,2,2,"ng-template",null,1,O)(24,zt,1,0,"ng-template",null,2,O),r(),a(26,"p-table",25,3),P("selectionChange",function(x){return m(o),v(i.selectedProduits,x)||(i.selectedProduits=x),u(x)}),g(28,jt,6,0,"ng-template",null,4,O)(30,qt,27,0,"ng-template",null,5,O)(32,Yt,19,12,"ng-template",null,6,O),r()(),a(34,"p-dialog",26),P("visibleChange",function(x){return m(o),v(i.produitDialog,x)||(i.produitDialog=x),u(x)}),g(35,$t,39,13,"ng-template",null,7,O)(37,ei,2,3,"ng-template",null,8,O),r(),_(39,"p-confirmdialog")}if(e&2){let o=U(17);s(8),Pe("",i.mobileFilteredProduits.length," produit",i.mobileFilteredProduits.length>1?"s":""),s(6),h("ngModel",i.mobileSearchTerm),s(),d("ngIf",!i.loading&&i.mobileVisibleProduits.length)("ngIfElse",o),s(3),d("ngIf",!i.loading&&i.canLoadMoreMobile),s(),d("ngIf",i.canCreate),s(7),d("value",i.produits)("loading",i.loading)("rows",10)("columns",i.cols)("paginator",!0)("globalFilterFields",i.filterFields)("tableStyle",G(25,wt)),h("selection",i.selectedProduits),d("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",G(26,Ot)),s(8),ve(G(27,St)),h("visible",i.produitDialog),d("header",i.produit!=null&&i.produit.id?"Modifier un produit":"Nouveau produit")("modal",!0),s(5),ve(G(28,kt))}},dependencies:[D,ke,W,Ze,Qe,Ye,Ke,Je,Xe,ne,ee,te,Ve,ie,de,se,Le,le,ae,j,z,et,$e,dt,oe,re,st,lt,pe,ce,He,ue,me,it,tt,rt,nt,Be,Ue,Ae,Re,at,ot,Ne,We],styles:["[_nghost-%COMP%]{display:block}.produits-mobile-app[_ngcontent-%COMP%]{display:none}@media screen and (max-width: 768px){[_nghost-%COMP%]{--mobile-primary: #5f6bff;--mobile-text: #334155;--mobile-muted: #7f8ca3;--mobile-card: #f9fbff;--mobile-border: #dbe2ee}.produits-desktop[_ngcontent-%COMP%]{display:none}.produits-mobile-app[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;min-height:100dvh;height:100vh;height:100dvh;overflow:hidden;margin-top:calc(-.25rem - env(safe-area-inset-top));margin-left:-.875rem;margin-right:-.875rem;margin-bottom:calc(-.875rem - env(safe-area-inset-bottom));padding:0 .875rem env(safe-area-inset-bottom);padding-left:calc(.875rem + env(safe-area-inset-left));padding-right:calc(.875rem + env(safe-area-inset-right));background:linear-gradient(180deg,#f3f5f9,#eaedf4 58%,#e5eaf1);animation:_ngcontent-%COMP%_mobileFade .24s ease-out}.mobile-header[_ngcontent-%COMP%]{flex-shrink:0;display:flex;align-items:center;gap:.55rem;margin:0 -.875rem;padding:calc(.5rem + env(safe-area-inset-top)) calc(.875rem + env(safe-area-inset-right)) .6rem calc(.875rem + env(safe-area-inset-left));background:var(--mobile-card);border-bottom:1px solid var(--mobile-border);box-shadow:0 1px 3px #0f172a0f;position:sticky;top:0;z-index:30}.mobile-scroll[_ngcontent-%COMP%]{flex:1;min-height:0;overflow-y:auto;-webkit-overflow-scrolling:touch;padding-top:.75rem;padding-bottom:calc(4rem + env(safe-area-inset-bottom))}.mobile-back[_ngcontent-%COMP%], .mobile-add[_ngcontent-%COMP%]{width:2.15rem;height:2.15rem;border-radius:999px;flex-shrink:0;color:var(--mobile-primary)!important;background:#5f6bff1a!important}.mobile-title-wrap[_ngcontent-%COMP%]{flex:1;min-width:0;text-align:center}.mobile-title[_ngcontent-%COMP%]{margin:0;font-size:1.35rem;line-height:1.1;font-weight:800;color:var(--mobile-text)}.mobile-subtitle[_ngcontent-%COMP%]{margin:.2rem 0 0;font-size:.76rem;font-weight:600;color:var(--mobile-muted)}.mobile-search[_ngcontent-%COMP%]{background:#f7f9fd;border:1.5px solid var(--mobile-border);border-radius:.95rem;padding:.35rem .55rem;box-shadow:inset 0 1px #ffffffb3}.mobile-search[_ngcontent-%COMP%]   .p-iconfield[_ngcontent-%COMP%], .mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]{width:100%}.mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]{border:0;box-shadow:none;background:transparent;color:var(--mobile-text);font-size:.96rem}.mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]::placeholder{color:#92a0b7}.mobile-quick-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.4rem;padding:0 .15rem}.mobile-quick-actions[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]{flex:1}.mobile-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.65rem;margin-top:1rem}.mobile-produit-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem;background:var(--mobile-card);border:1px solid var(--mobile-border);border-radius:1rem;padding:.9rem;box-shadow:0 10px 24px #0f172a0f;cursor:pointer;transition:box-shadow .2s ease}.mobile-produit-card[_ngcontent-%COMP%]:active{box-shadow:0 4px 12px #0f172a14}.mobile-card-media[_ngcontent-%COMP%]{flex-shrink:0}.mobile-card-thumb[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:.65rem;object-fit:contain;border:1px solid var(--mobile-border);background:#fff}.mobile-card-image-placeholder[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:.65rem;background:#eef1f6;border:1px solid var(--mobile-border);display:flex;align-items:center;justify-content:center}.mobile-card-image-placeholder[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1.5rem;color:#92a0b7}.mobile-card-body[_ngcontent-%COMP%]{flex:1;min-width:0}.mobile-card-top[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;gap:.5rem;margin-bottom:.4rem}.mobile-card-main[_ngcontent-%COMP%]{flex:1;min-width:0}.mobile-code[_ngcontent-%COMP%]{margin-bottom:.1rem;font-size:.72rem;line-height:1.2;color:#8b98b0;letter-spacing:.02em;font-weight:700}.mobile-name[_ngcontent-%COMP%]{font-size:1rem;line-height:1.25;font-weight:700;color:var(--mobile-text);word-break:break-word}.mobile-card-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:.5rem;flex-wrap:wrap}.mobile-card-summary[_ngcontent-%COMP%]{font-size:.8rem;color:var(--mobile-muted);font-weight:600}.mobile-card-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.35rem}.mobile-eye-action[_ngcontent-%COMP%]{width:2.05rem;height:2.05rem;color:var(--mobile-primary)!important}.mobile-state[_ngcontent-%COMP%]{margin-top:1rem;background:#f8faff;border:1px dashed var(--mobile-border);border-radius:1rem;padding:1rem;text-align:center;color:var(--mobile-muted);font-size:.9rem}.mobile-load-more[_ngcontent-%COMP%]{padding-top:.4rem}.mobile-fab[_ngcontent-%COMP%]{position:fixed;bottom:calc(1rem + env(safe-area-inset-bottom));right:calc(1rem + env(safe-area-inset-right));z-index:25;width:3.5rem;height:3.5rem;min-width:3.5rem;min-height:3.5rem;padding:0;border:none;border-radius:50%;background:var(--mobile-primary);color:#fff;box-shadow:0 4px 14px #5f6bff73;display:flex;align-items:center;justify-content:center;gap:.35rem;font-weight:700;font-size:.9rem;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease;-webkit-tap-highlight-color:transparent}.mobile-fab[_ngcontent-%COMP%]:active{transform:scale(.96)}.mobile-fab[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1.35rem}.mobile-fab-label[_ngcontent-%COMP%]{display:none}}@media screen and (max-width: 768px) and (min-width: 400px){.mobile-fab[_ngcontent-%COMP%]{width:auto;height:3rem;min-height:3rem;padding:0 1.25rem;border-radius:999px}.mobile-fab-label[_ngcontent-%COMP%]{display:inline}}@media screen and (max-width: 768px){[_nghost-%COMP%]     .mobile-action-btn{width:100%;justify-content:flex-start;border:0!important;background:transparent!important;color:#4f5d79!important;padding:.35rem .45rem!important;font-weight:700;border-radius:.7rem;box-shadow:none!important}[_nghost-%COMP%]     .mobile-action-btn .p-button-icon{color:var(--mobile-primary);font-size:.95rem}[_nghost-%COMP%]     .mobile-action-btn .p-button-label{font-size:.95rem}[_nghost-%COMP%]     .mobile-status-tag{font-size:.79rem;font-weight:700;border-radius:.55rem;padding:.22rem .55rem}[_nghost-%COMP%]     .mobile-status-tag.p-tag-success{background:#d9f7e5;color:#168f4a}[_nghost-%COMP%]     .mobile-status-tag.p-tag-warn, [_nghost-%COMP%]     .mobile-status-tag.p-tag-warning{background:#ffe8d3;color:#dc6408}[_nghost-%COMP%]     .mobile-status-tag.p-tag-danger{background:#ffe3e1;color:#dd3f39}[_nghost-%COMP%]     .mobile-status-tag.p-tag-secondary{background:#e8edf6;color:#64748b}[_nghost-%COMP%]     .mobile-delete-action{width:2.05rem;height:2.05rem;border-radius:999px!important;border-color:#ffb9b4!important;color:#ef4444!important;background:#ffffffe6!important}[_nghost-%COMP%]     .mobile-delete-action .p-button-icon{font-size:.84rem}[_nghost-%COMP%]     .mobile-load-more-btn{width:100%;border-radius:999px;justify-content:center;font-weight:700;border:1px solid #cfd7ff;background:#eef2ff;color:#4f5df4}.app-dark   [_nghost-%COMP%]{--mobile-primary: var(--p-primary-400);--mobile-text: var(--p-surface-100);--mobile-muted: var(--p-surface-400);--mobile-card: var(--p-surface-800);--mobile-border: var(--p-surface-600)}.app-dark[_nghost-%COMP%]   .produits-mobile-app[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .produits-mobile-app[_ngcontent-%COMP%]{background:var(--p-surface-950)}.app-dark[_nghost-%COMP%]   .mobile-header[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-header[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0003}.app-dark[_nghost-%COMP%]   .mobile-search[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-search[_ngcontent-%COMP%]{background:var(--p-surface-800);border-color:var(--p-surface-600);box-shadow:none}.app-dark[_nghost-%COMP%]   .mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]::placeholder, .app-dark   [_nghost-%COMP%]   .mobile-search[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]::placeholder{color:var(--p-surface-500)}.app-dark[_nghost-%COMP%]   .mobile-produit-card[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-produit-card[_ngcontent-%COMP%]{box-shadow:0 4px 12px #00000026}.app-dark[_nghost-%COMP%]   .mobile-produit-card[_ngcontent-%COMP%]:active, .app-dark   [_nghost-%COMP%]   .mobile-produit-card[_ngcontent-%COMP%]:active{box-shadow:0 4px 12px #00000040}.app-dark[_nghost-%COMP%]   .mobile-card-image-placeholder[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-card-image-placeholder[_ngcontent-%COMP%]{background:var(--p-surface-700);border-color:var(--p-surface-600)}.app-dark[_nghost-%COMP%]   .mobile-card-image-placeholder[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-card-image-placeholder[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .mobile-code[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-code[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .mobile-state[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .mobile-state[_ngcontent-%COMP%]{background:var(--p-surface-800);border-color:var(--p-surface-600);color:var(--p-surface-400)}.app-dark   [_nghost-%COMP%]     .mobile-action-btn{color:var(--p-surface-300)!important}.app-dark   [_nghost-%COMP%]     .mobile-action-btn .p-button-icon{color:var(--p-primary-400)}.app-dark   [_nghost-%COMP%]     .mobile-status-tag.p-tag-success{background:#05966933;color:#34d399}.app-dark   [_nghost-%COMP%]     .mobile-status-tag.p-tag-warn, .app-dark   [_nghost-%COMP%]     .mobile-status-tag.p-tag-warning{background:#d9770633;color:#fbbf24}.app-dark   [_nghost-%COMP%]     .mobile-status-tag.p-tag-danger{background:#dc262633;color:#f87171}.app-dark   [_nghost-%COMP%]     .mobile-status-tag.p-tag-secondary{background:var(--p-surface-700);color:var(--p-surface-300)}.app-dark   [_nghost-%COMP%]     .mobile-delete-action{border-color:var(--p-surface-600)!important;background:var(--p-surface-700)!important;color:#f87171!important}.app-dark   [_nghost-%COMP%]     .mobile-load-more-btn{border-color:var(--p-surface-600);background:var(--p-surface-800);color:var(--p-primary-400)}}@keyframes _ngcontent-%COMP%_mobileFade{0%{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}"]})};var ti=["buttonEl"];function ii(n,t){if(n&1){let e=b();a(0,"button",72),f("click",function(){m(e);let o=c();return u(o.enableEditing())}),r()}}function ni(n,t){n&1&&(a(0,"div",75),_(1,"i",76),a(2,"span"),p(3,"Ajouter une photo"),r()())}function ri(n,t){if(n&1){let e=b();a(0,"button",82),f("click",function(o){m(e);let l=c(4);return u(l.removeImage(o))}),_(1,"i",83),r()}}function oi(n,t){n&1&&(a(0,"div",84),_(1,"i",85),r())}function ai(n,t){if(n&1){let e=b();a(0,"div",86)(1,"p",87),p(2,"Supprimer cette image ?"),r(),a(3,"div",88)(4,"button",89),f("click",function(o){m(e);let l=c(4);return u(l.confirmDeleteImage(o))}),r(),a(5,"button",90),f("click",function(o){m(e);let l=c(4);return u(l.cancelDeleteImage(o))}),r()()()}}function li(n,t){if(n&1&&(a(0,"div",77),_(1,"img",78),g(2,ri,2,0,"button",79)(3,oi,2,0,"div",80)(4,ai,6,0,"div",81),r()),n&2){let e=c(3);s(),d("src",e.imagePreview||e.product.getImageUrl(),T),s(),d("ngIf",!e.fieldsDisabled&&!e.confirmingDelete&&!e.loading),s(),d("ngIf",e.loading&&e.selectedImageFile),s(),d("ngIf",e.confirmingDelete)}}function si(n,t){if(n&1){let e=b();a(0,"div",74),f("click",function(){m(e),c();let o=U(2),l=c();return u(!l.fieldsDisabled&&o.advancedFileInput.nativeElement.click())}),g(1,ni,4,0,"div",14)(2,li,5,4,"div",13),r()}if(n&2){let e=c(2);s(),d("ngIf",!e.imagePreview&&!e.product.image_url),s(),d("ngIf",e.imagePreview||e.product.image_url)}}function di(n,t){if(n&1){let e=b();a(0,"div")(1,"p-fileUpload",73,0),f("onSelect",function(o){m(e);let l=c();return u(l.onUpload(o))}),g(3,si,3,2,"ng-template",null,1,O),r()()}if(n&2){let e=c();s(),d("customUpload",!0)("multiple",!1)("showUploadButton",!1)("showCancelButton",!1)("auto",!0)("disabled",e.fieldsDisabled)}}function ci(n,t){if(n&1&&(a(0,"small",95),_(1,"i",96),p(2),r()),n&2){let e=c(2);s(2),B("",e.imageError," ")}}function pi(n,t){if(n&1&&(a(0,"div",91)(1,"small",92),_(2,"i",93),p(3,"JPG, PNG, WebP \u2014 5 Mo max "),r(),g(4,ci,3,1,"small",94),r()),n&2){let e=c();s(4),d("ngIf",e.imageError)}}function mi(n,t){if(n&1&&(a(0,"div",77),_(1,"img",78),r()),n&2){let e=c();s(),d("src",e.product.getImageUrl(),T)}}function ui(n,t){n&1&&(a(0,"div",75),_(1,"i",97),a(2,"span"),p(3,"Aucune image"),r()())}function gi(n,t){n&1&&(a(0,"small",98),p(1," Nom du produit obligatoire. "),r())}function _i(n,t){n&1&&(a(0,"small",98),p(1," Obligatoire "),r())}function fi(n,t){if(n&1){let e=b();a(0,"div",21)(1,"span",22),p(2,"Achat"),r(),a(3,"p-inputnumber",99),P("ngModelChange",function(o){m(e);let l=c();return v(l.product.prix_achat,o)||(l.product.prix_achat=o),u(o)}),r(),g(4,_i,2,0,"small",17),r()}if(n&2){let e=c();s(3),h("ngModel",e.product.prix_achat),d("min",0)("disabled",e.fieldsDisabled)("invalid",e.submitted&&e.isPrixAchatRequired()&&e.isPriceMissing(e.product.prix_achat)),s(),d("ngIf",e.submitted&&e.isPrixAchatRequired()&&e.isPriceMissing(e.product.prix_achat)&&e.isEditing)}}function bi(n,t){n&1&&(a(0,"small",98),p(1," Obligatoire "),r())}function hi(n,t){if(n&1){let e=b();a(0,"div",21)(1,"span",22),p(2,"Vente"),r(),a(3,"p-inputnumber",99),P("ngModelChange",function(o){m(e);let l=c();return v(l.product.prix_vente,o)||(l.product.prix_vente=o),u(o)}),r(),g(4,bi,2,0,"small",17),r()}if(n&2){let e=c();s(3),h("ngModel",e.product.prix_vente),d("min",0)("disabled",e.fieldsDisabled)("invalid",e.submitted&&e.isPrixVenteRequired()&&e.isPriceMissing(e.product.prix_vente)),s(),d("ngIf",e.submitted&&e.isPrixVenteRequired()&&e.isPriceMissing(e.product.prix_vente)&&e.isEditing)}}function vi(n,t){n&1&&(a(0,"small",98),p(1," Obligatoire "),r())}function Pi(n,t){if(n&1){let e=b();a(0,"div",21)(1,"span",22),p(2,"Usine"),r(),a(3,"p-inputnumber",99),P("ngModelChange",function(o){m(e);let l=c();return v(l.product.prix_usine,o)||(l.product.prix_usine=o),u(o)}),r(),g(4,vi,2,0,"small",17),r()}if(n&2){let e=c();s(3),h("ngModel",e.product.prix_usine),d("min",0)("disabled",e.fieldsDisabled)("invalid",e.submitted&&e.isPrixUsineRequired()&&e.isPriceMissing(e.product.prix_usine)),s(),d("ngIf",e.submitted&&e.isPrixUsineRequired()&&e.isPriceMissing(e.product.prix_usine)&&e.isEditing)}}function xi(n,t){n&1&&(a(0,"div",100),_(1,"i",101),p(2," Au moins un prix requis pour un service. "),r())}function Ci(n,t){n&1&&(a(0,"small",102),_(1,"i",47),p(2," Stock non g\xE9r\xE9 pour les services "),r())}function yi(n,t){if(n&1){let e=b();a(0,"div",103)(1,"button",104),f("click",function(){m(e);let o=c();return u(o.onSubmit())}),r(),a(2,"button",105),f("click",function(){m(e);let o=c();return u(o.mode==="create"?o.onCancel():o.cancelEditing())}),r()()}if(n&2){let e=c();s(),d("label",e.mode==="create"?"Enregistrer":"Sauvegarder")("loading",e.loading)("disabled",!e.isValid()||e.loading),s(),d("disabled",e.loading)}}function Mi(n,t){if(n&1){let e=b();a(0,"button",106),f("click",function(){m(e);let o=c();return u(o.enableEditing())}),r()}}function wi(n,t){n&1&&(a(0,"span",98),p(1,"*"),r())}function Oi(n,t){n&1&&(a(0,"span",98),p(1,"*"),r())}function Si(n,t){n&1&&(a(0,"small",98),p(1," Nom du produit obligatoire. "),r())}function ki(n,t){n&1&&(a(0,"small",98),p(1," Prix d'achat obligatoire pour ce type. "),r())}function Ei(n,t){if(n&1){let e=b();a(0,"div",107)(1,"p-inputnumber",108),P("ngModelChange",function(o){m(e);let l=c();return v(l.product.prix_achat,o)||(l.product.prix_achat=o),u(o)}),r(),g(2,ki,2,0,"small",17),r()}if(n&2){let e=c();s(),h("ngModel",e.product.prix_achat),d("min",0)("disabled",e.fieldsDisabled)("invalid",e.submitted&&e.isPrixAchatRequired()&&e.isPriceMissing(e.product.prix_achat)),s(),d("ngIf",e.submitted&&e.isPrixAchatRequired()&&e.isPriceMissing(e.product.prix_achat)&&e.isEditing)}}function Ii(n,t){n&1&&(a(0,"small",98),p(1," Prix de vente obligatoire pour ce type. "),r())}function Ti(n,t){if(n&1){let e=b();a(0,"div",107)(1,"p-inputnumber",109),P("ngModelChange",function(o){m(e);let l=c();return v(l.product.prix_vente,o)||(l.product.prix_vente=o),u(o)}),r(),g(2,Ii,2,0,"small",17),r()}if(n&2){let e=c();s(),h("ngModel",e.product.prix_vente),d("min",0)("disabled",e.fieldsDisabled)("invalid",e.submitted&&e.isPrixVenteRequired()&&e.isPriceMissing(e.product.prix_vente)),s(),d("ngIf",e.submitted&&e.isPrixVenteRequired()&&e.isPriceMissing(e.product.prix_vente)&&e.isEditing)}}function Vi(n,t){n&1&&(a(0,"small",98),p(1,' Prix usine obligatoire pour "Fabricable". '),r())}function Fi(n,t){if(n&1){let e=b();a(0,"div",107)(1,"p-inputnumber",110),P("ngModelChange",function(o){m(e);let l=c();return v(l.product.prix_usine,o)||(l.product.prix_usine=o),u(o)}),r(),g(2,Vi,2,0,"small",17),r()}if(n&2){let e=c();s(),h("ngModel",e.product.prix_usine),d("min",0)("disabled",e.fieldsDisabled)("invalid",e.submitted&&e.isPrixUsineRequired()&&e.isPriceMissing(e.product.prix_usine)),s(),d("ngIf",e.submitted&&e.isPrixUsineRequired()&&e.isPriceMissing(e.product.prix_usine)&&e.isEditing)}}function Di(n,t){n&1&&(a(0,"div",111),_(1,"i",112),p(2," Pour un service, renseignez au moins un prix : achat ou vente. "),r())}function Li(n,t){n&1&&(a(0,"div",119),_(1,"i",120),a(2,"span",121),p(3,"Ajouter une image"),r(),a(4,"span",122),p(5,"Cliquez pour s\xE9lectionner"),r()())}function Ri(n,t){if(n&1){let e=b();a(0,"button",129),f("click",function(o){m(e);let l=c(4);return u(l.removeImage(o))}),_(1,"i",83),r()}}function Ai(n,t){n&1&&(a(0,"div",130),_(1,"i",131),r())}function Ui(n,t){if(n&1){let e=b();a(0,"div",132)(1,"p",133),p(2,"Supprimer cette image ?"),r(),a(3,"div",134)(4,"button",89),f("click",function(o){m(e);let l=c(4);return u(l.confirmDeleteImage(o))}),r(),a(5,"button",90),f("click",function(o){m(e);let l=c(4);return u(l.cancelDeleteImage(o))}),r()()()}}function Bi(n,t){if(n&1&&(a(0,"div",123)(1,"div",124),_(2,"img",125),g(3,Ri,2,0,"button",126)(4,Ai,2,0,"div",127)(5,Ui,6,0,"div",128),r()()),n&2){let e=c(3);s(2),d("src",e.imagePreview||e.product.getImageUrl(),T),s(),d("ngIf",!e.fieldsDisabled&&!e.confirmingDelete&&!e.loading),s(),d("ngIf",e.loading&&e.selectedImageFile),s(),d("ngIf",e.confirmingDelete)}}function Wi(n,t){if(n&1){let e=b();a(0,"div",116),f("click",function(){m(e),c();let o=U(2),l=c();return u(!l.fieldsDisabled&&o.advancedFileInput.nativeElement.click())}),g(1,Li,6,0,"div",117)(2,Bi,6,4,"div",118),r()}if(n&2){let e=c(2);s(),d("ngIf",!e.imagePreview&&!e.product.image_url),s(),d("ngIf",e.imagePreview||e.product.image_url)}}function Ni(n,t){if(n&1&&(a(0,"small",135),_(1,"i",96),p(2),r()),n&2){let e=c(2);s(2),B("",e.imageError," ")}}function zi(n,t){if(n&1){let e=b();a(0,"div")(1,"p-fileUpload",113,2),f("onSelect",function(o){m(e);let l=c();return u(l.onUpload(o))}),g(3,Wi,3,2,"ng-template",null,1,O),r(),a(5,"small",114),_(6,"i",93),p(7,"JPG, PNG, WebP \u2014 5 Mo max "),r(),g(8,Ni,3,1,"small",115),r()}if(n&2){let e=c();s(),d("customUpload",!0)("multiple",!1)("showUploadButton",!1)("showCancelButton",!1)("auto",!0)("disabled",e.fieldsDisabled),s(7),d("ngIf",e.imageError)}}function ji(n,t){if(n&1&&(a(0,"div",136),_(1,"img",125),r()),n&2){let e=c();s(),d("src",e.product.getImageUrl(),T)}}function qi(n,t){n&1&&(a(0,"small",137),_(1,"i",93),p(2,"Le stock n'est pas g\xE9r\xE9 pour les services. "),r())}function Gi(n,t){if(n&1){let e=b();a(0,"div",138)(1,"div",139)(2,"button",140),f("click",function(){m(e);let o=c();return u(o.onSubmit())}),r(),a(3,"button",141),f("click",function(){m(e);let o=c();return u(o.mode==="create"?o.onCancel():o.cancelEditing())}),r()()()}if(n&2){let e=c();s(2),d("label",e.mode==="create"?"Enregistrer":"Sauvegarder")("loading",e.loading)("disabled",!e.isValid()||e.loading),s(),d("disabled",e.loading)}}var q=class n{static ALLOWED_TYPES=["image/jpeg","image/png","image/webp"];static MAX_SIZE=5*1024*1024;buttonEl;mode="create";initialData=null;loading=!1;submitForm=new K;cancel=new K;deleteImage=new K;submitted=!1;isEditing=!1;typeOptions=[{label:L.materiel,value:"materiel"},{label:L.service,value:"service"},{label:L.fabricable,value:"fabricable"},{label:L.achat_vente,value:"achat_vente"}];statutOptions=[{label:k.brouillon,value:"brouillon"},{label:k.actif,value:"actif"},{label:k.inactif,value:"inactif"},{label:k.rupture_stock,value:"rupture_stock"}];product=new C({nom:"",code:"",prix_usine:null,prix_achat:null,prix_vente:null,qte_stock:0,cout:null,statut:"actif",type:"materiel",in_stock:!0,is_archived:!1,description:null,image_url:null});selectedImageFile=null;imagePreview=null;imageError=null;confirmingDelete=!1;ngOnInit(){this.initialData&&(this.product=new C(this.initialData),this.imagePreview=this.initialData.image_url),this.mode==="create"&&(this.isEditing=!0)}isPrixUsineVisible(){return this.product.type==="fabricable"}isPrixUsineRequired(){return this.product.type==="fabricable"}isPrixAchatVisible(){return["materiel","service","achat_vente"].includes(this.product.type)}isPrixVenteVisible(){return["service","fabricable","achat_vente"].includes(this.product.type)}isPrixVenteRequired(){return["fabricable","achat_vente"].includes(this.product.type)}ngOnChanges(t){t.initialData?.currentValue&&(this.revokePreviewUrl(),this.product=new C(t.initialData.currentValue),this.imagePreview=t.initialData.currentValue.image_url??null,this.mode==="edit"&&(this.isEditing=!1,this.submitted=!1,this.selectedImageFile=null,this.imageError=null,this.confirmingDelete=!1)),t.mode?.currentValue==="create"&&(this.isEditing=!0)}isPrixAchatRequired(){return["materiel","achat_vente"].includes(this.product.type)}isQteStockDisabled(){return this.product.type==="service"||this.fieldsDisabled}isValidPrice(t){return typeof t=="number"&&t>=0}isPriceMissing(t){return t==null}hasServicePrice(){return this.isValidPrice(this.product.prix_achat)||this.isValidPrice(this.product.prix_vente)}showServicePriceError(){return this.submitted&&this.isEditing&&this.product.type==="service"&&!this.hasServicePrice()}get isActifSwitch(){return this.product.statut==="actif"}onStatutToggleChange(t){this.product.statut=t?"actif":"inactif"}onTypeChange(){this.isPrixUsineVisible()||(this.product.prix_usine=null),this.isPrixAchatVisible()||(this.product.prix_achat=null),this.isPrixVenteVisible()||(this.product.prix_vente=null),this.product.type==="service"&&(this.product.qte_stock=0)}isValid(){return!(!this.product.nom?.trim()||!this.product.type||this.isPrixUsineRequired()&&!this.isValidPrice(this.product.prix_usine)||this.isPrixVenteRequired()&&!this.isValidPrice(this.product.prix_vente)||this.isPrixAchatRequired()&&!this.isValidPrice(this.product.prix_achat)||this.product.type==="service"&&!this.hasServicePrice())}enableEditing(){this.isEditing=!0}cancelEditing(){this.isEditing=!1,this.submitted=!1,this.selectedImageFile=null,this.initialData?(this.product=new C(this.initialData),this.imagePreview=this.initialData.image_url):this.resetForm()}onUpload(t){if(!t?.files?.length)return;let e=t.files[0];if(this.imageError=null,!n.ALLOWED_TYPES.includes(e.type)){this.imageError="Format non support\xE9. Utilisez JPG, PNG ou WebP.";return}if(e.size>n.MAX_SIZE){this.imageError="Fichier trop volumineux. Taille max : 5 Mo.";return}this.revokePreviewUrl(),this.selectedImageFile=e,this.imagePreview=URL.createObjectURL(e)}removeImage(t){t.stopPropagation(),this.selectedImageFile?(this.revokePreviewUrl(),this.selectedImageFile=null,this.imagePreview=null,this.imageError=null):this.product.image_url&&(this.confirmingDelete=!0)}confirmDeleteImage(t){t.stopPropagation(),this.confirmingDelete=!1,this.product.image_url=null,this.imagePreview=null,this.deleteImage.emit()}cancelDeleteImage(t){t.stopPropagation(),this.confirmingDelete=!1}revokePreviewUrl(){this.imagePreview?.startsWith("blob:")&&URL.revokeObjectURL(this.imagePreview)}ngOnDestroy(){this.revokePreviewUrl()}onSubmit(){if(this.submitted=!0,!this.isValid())return;let t={nom:this.product.nom.trim(),type:this.product.type,qte_stock:this.product.qte_stock,description:this.product.description?.trim()||void 0,cout:this.product.cout??void 0};t.statut=this.product.statut,this.product.prix_usine!==null&&(t.prix_usine=this.product.prix_usine),this.product.prix_vente!==null&&(t.prix_vente=this.product.prix_vente),this.product.prix_achat!==null&&(t.prix_achat=this.product.prix_achat),this.selectedImageFile&&(t.image=this.selectedImageFile),this.submitForm.emit(t)}onCancel(){this.cancel.emit()}get fieldsDisabled(){return this.mode==="edit"&&!this.isEditing||this.loading}getPrixHelperText(){switch(this.product.type){case"materiel":return"Prix d'achat obligatoire";case"service":return"Pour un service, renseignez au moins un prix : achat ou vente";case"fabricable":return"Prix usine et prix de vente obligatoires";case"achat_vente":return"Prix d'achat et prix de vente obligatoires";default:return"S\xC3\xA9lectionnez un type de produit"}}resetForm(){this.revokePreviewUrl(),this.submitted=!1,this.selectedImageFile=null,this.imagePreview=null,this.imageError=null,this.product=new C({nom:"",code:"",prix_usine:null,prix_achat:null,prix_vente:null,qte_stock:0,cout:null,statut:"actif",type:"materiel",in_stock:!0,is_archived:!1,description:null,image_url:null})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-produits-form"]],viewQuery:function(e,i){if(e&1&&J(ti,5),e&2){let o;X(o=Z())&&(i.buttonEl=o)}},inputs:{mode:"mode",initialData:"initialData",loading:"loading"},outputs:{submitForm:"submitForm",cancel:"cancel",deleteImage:"deleteImage"},features:[F([w]),Oe],decls:114,vars:61,consts:[["mobileFileUploader",""],["content",""],["fileUploader",""],[1,"card","product-form"],[1,"mobile-form-container"],[1,"mobile-form-header"],["pButton","","pRipple","","icon","pi pi-arrow-left",1,"p-button-rounded","p-button-text","mobile-form-back",3,"click"],[1,"mobile-form-title-wrap"],[1,"mobile-form-title"],["pButton","","pRipple","","icon","pi pi-pencil","class","p-button-rounded p-button-text mobile-form-edit",3,"click",4,"ngIf"],[1,"mobile-image-card"],[4,"ngIf"],["class","px-3 pb-2",4,"ngIf"],["class","mobile-upload-preview",4,"ngIf"],["class","mobile-upload-placeholder",4,"ngIf"],[1,"mobile-section-card"],["pInputText","","type","text","placeholder","Nom du produit","fluid","",3,"ngModelChange","ngModel","disabled","invalid"],["class","text-red-500",4,"ngIf"],[1,"mobile-field-label"],[1,"mobile-price-grid"],["class","mobile-price-item",4,"ngIf"],[1,"mobile-price-item"],[1,"mobile-price-label"],["mode","currency","currency","GNF","locale","fr-GN","placeholder","0","fluid","",3,"ngModelChange","ngModel","min","disabled"],["class","mobile-service-alert",4,"ngIf"],[1,"mobile-meta-row"],[1,"mobile-meta-field"],["placeholder","Type","fluid","",3,"ngModelChange","onChange","options","ngModel","disabled"],["placeholder","0","fluid","",3,"ngModelChange","ngModel","showButtons","min","disabled"],["class","mobile-info-hint",4,"ngIf"],[1,"mobile-section-card","mobile-status-row"],[1,"mobile-status-label"],[1,"mobile-status-value"],[1,"ml-auto",3,"ngModelChange","ngModel","disabled"],["class","mobile-bottom-actions",4,"ngIf"],[1,"desktop-form-container"],[1,"flex","justify-between","items-start","gap-4","mb-8","form-header"],[1,"block","text-surface-900","dark:text-surface-0","font-bold","text-2xl"],[1,"text-surface-500","dark:text-surface-300"],["pButton","","pRipple","","label","Modifier","icon","pi pi-pencil","severity","warn","class","w-auto",3,"click",4,"ngIf"],[1,"grid","grid-cols-12","gap-6","flex-wrap"],[1,"col-span-12","lg:col-span-8"],[1,"form-section","mb-4"],[1,"type-selector-block"],[1,"form-field-label"],["placeholder","S\xE9lectionner un type","fluid","",3,"ngModelChange","onChange","options","ngModel","disabled"],[1,"form-field-hint"],[1,"pi","pi-info-circle"],[1,"grid","grid-cols-12","gap-5","mt-4"],[1,"col-span-12"],["for","nom",1,"form-field-label"],["id","nom","pInputText","","type","text","fluid","",3,"ngModelChange","ngModel","disabled","invalid"],[1,"prix-section-header"],[1,"flex","gap-4"],["class","flex-1 min-w-0 price-field-anim",4,"ngIf"],[1,"prix-helper-text"],["class","col-span-12 service-alert",4,"ngIf"],[1,"form-section"],[1,"section-title"],[1,"pi","pi-image","mr-2"],["class","flex justify-center mt-2",4,"ngIf"],[1,"col-span-12","lg:col-span-4","flex","flex-col","gap-y-4","mt-7"],[1,"border","border-surface-200","dark:border-surface-700","rounded"],[1,"text-surface-900","dark:text-surface-0","font-bold","block","border-b","border-surface-200","dark:border-surface-700","p-4"],[1,"p-4"],[1,"bg-surface-100","dark:bg-surface-700","py-2","px-4","flex","items-center","rounded"],[1,"text-black/90","dark:text-surface-0!","font-bold","mr-4"],[1,"text-black/60","dark:text-surface-0!","font-semibold"],["inputId","cout","mode","currency","currency","GNF","locale","fr-GN","placeholder","Co\xFBt","fluid","",3,"ngModelChange","ngModel","min","disabled"],["class","text-gray-500 block mt-2 mb-2 ml-4",4,"ngIf"],[1,"sticky","top-6","flex","flex-col","gap-4"],["class","form-section p-4",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-text","mobile-form-edit",3,"click"],["name","image","accept","image/*","styleClass","mobile-uploader",3,"onSelect","customUpload","multiple","showUploadButton","showCancelButton","auto","disabled"],[1,"mobile-upload-zone",3,"click"],[1,"mobile-upload-placeholder"],[1,"pi","pi-camera"],[1,"mobile-upload-preview"],["alt","Image du produit",3,"src"],["pButton","","pRipple","","rounded","","type","button","severity","danger","class","mobile-remove-img",3,"click",4,"ngIf"],["class","mobile-upload-loading",4,"ngIf"],["class","mobile-delete-confirm",4,"ngIf"],["pButton","","pRipple","","rounded","","type","button","severity","danger",1,"mobile-remove-img",3,"click"],[1,"pi","pi-times"],[1,"mobile-upload-loading"],[1,"pi","pi-spin","pi-spinner","text-white","text-3xl"],[1,"mobile-delete-confirm"],[1,"text-white","text-sm","font-semibold","mb-3","text-center"],[1,"flex","gap-2","justify-center"],["pButton","","type","button","severity","danger","size","small","label","Supprimer",3,"click"],["pButton","","type","button","severity","secondary","size","small","label","Annuler",3,"click"],[1,"px-3","pb-2"],[1,"block","text-center","text-surface-400"],[1,"pi","pi-info-circle","mr-1"],["class","block text-center text-red-500 mt-1",4,"ngIf"],[1,"block","text-center","text-red-500","mt-1"],[1,"pi","pi-exclamation-circle","mr-1"],[1,"pi","pi-image"],[1,"text-red-500"],["mode","currency","currency","GNF","locale","fr-GN","placeholder","0","fluid","",3,"ngModelChange","ngModel","min","disabled","invalid"],[1,"mobile-service-alert"],[1,"pi","pi-exclamation-circle"],[1,"mobile-info-hint"],[1,"mobile-bottom-actions"],["pButton","","pRipple","","icon","pi pi-check",1,"mobile-btn-save",3,"click","label","loading","disabled"],["pButton","","pRipple","","label","Annuler","icon","pi pi-times","severity","secondary",1,"mobile-btn-cancel",3,"click","disabled"],["pButton","","pRipple","","label","Modifier","icon","pi pi-pencil","severity","warn",1,"w-auto",3,"click"],[1,"flex-1","min-w-0","price-field-anim"],["inputId","prix_achat","mode","currency","currency","GNF","locale","fr-GN","placeholder","Prix d'achat","fluid","",3,"ngModelChange","ngModel","min","disabled","invalid"],["inputId","prix_vente","mode","currency","currency","GNF","locale","fr-GN","placeholder","Prix de vente","fluid","",3,"ngModelChange","ngModel","min","disabled","invalid"],["inputId","prix_usine","mode","currency","currency","GNF","locale","fr-GN","placeholder","Prix usine","fluid","",3,"ngModelChange","ngModel","min","disabled","invalid"],[1,"col-span-12","service-alert"],[1,"pi","pi-exclamation-circle","mr-2"],["name","image","accept","image/*","styleClass","product-uploader border border-surface-200 dark:border-surface-700 bg-surface-0 dark:bg-surface-900 p-0 rounded-lg",3,"onSelect","customUpload","multiple","showUploadButton","showCancelButton","auto","disabled"],[1,"block","mt-2","text-surface-400"],["class","block mt-1 text-red-500",4,"ngIf"],[1,"w-full","py-4","upload-dropzone",3,"click"],["class","h-48 flex flex-col justify-center items-center",4,"ngIf"],["class","relative w-full flex justify-center py-3",4,"ngIf"],[1,"h-48","flex","flex-col","justify-center","items-center"],[1,"pi","pi-image","text-primary","text-4xl","mb-4"],[1,"block","font-semibold","text-surface-900","dark:text-surface-0","text-lg"],[1,"text-surface-500","text-sm","mt-1"],[1,"relative","w-full","flex","justify-center","py-3"],[1,"relative","inline-block"],["alt","Image du produit",1,"max-h-72","rounded","shadow","object-contain",3,"src"],["pButton","","pRipple","","rounded","","type","button","severity","danger","class","absolute -top-2 -right-2",3,"click",4,"ngIf"],["class","absolute inset-0 flex items-center justify-center bg-surface-0/80 dark:bg-surface-900/80 rounded",4,"ngIf"],["class","absolute inset-0 flex flex-col items-center justify-center rounded","style","background: rgba(0,0,0,0.65);",4,"ngIf"],["pButton","","pRipple","","rounded","","type","button","severity","danger",1,"absolute","-top-2","-right-2",3,"click"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-surface-0/80","dark:bg-surface-900/80","rounded"],[1,"pi","pi-spin","pi-spinner","text-primary","text-3xl"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","rounded",2,"background","rgba(0,0,0,0.65)"],[1,"text-white","text-sm","font-semibold","mb-3","px-3","text-center"],[1,"flex","gap-2"],[1,"block","mt-1","text-red-500"],[1,"flex","justify-center","mt-2"],[1,"text-gray-500","block","mt-2","mb-2","ml-4"],[1,"form-section","p-4"],[1,"flex","gap-3"],["pButton","","pRipple","","icon","pi pi-check",1,"flex-1",3,"click","label","loading","disabled"],["pButton","","pRipple","","label","Annuler","icon","pi pi-times","severity","secondary",1,"flex-1",3,"click","disabled"]],template:function(e,i){e&1&&(a(0,"div",3)(1,"div",4)(2,"header",5)(3,"button",6),f("click",function(){return i.onCancel()}),r(),a(4,"div",7)(5,"h1",8),p(6),r()(),g(7,ii,1,0,"button",9),r(),a(8,"div",10),g(9,di,5,6,"div",11)(10,pi,5,1,"div",12)(11,mi,2,1,"div",13)(12,ui,4,0,"div",14),r(),a(13,"div",15)(14,"input",16),P("ngModelChange",function(l){return v(i.product.nom,l)||(i.product.nom=l),l}),r(),g(15,gi,2,0,"small",17),r(),a(16,"div",15)(17,"label",18),p(18,"Prix"),r(),a(19,"div",19),g(20,fi,5,5,"div",20)(21,hi,5,5,"div",20),a(22,"div",21)(23,"span",22),p(24,"Co\xFBt"),r(),a(25,"p-inputnumber",23),P("ngModelChange",function(l){return v(i.product.cout,l)||(i.product.cout=l),l}),r()(),g(26,Pi,5,5,"div",20),r(),g(27,xi,3,0,"div",24),r(),a(28,"div",15)(29,"div",25)(30,"div",26)(31,"label",18),p(32,"Type"),r(),a(33,"p-select",27),P("ngModelChange",function(l){return v(i.product.type,l)||(i.product.type=l),l}),f("onChange",function(){return i.onTypeChange()}),r()(),a(34,"div",26)(35,"label",18),p(36,"Stock"),r(),a(37,"p-inputnumber",28),P("ngModelChange",function(l){return v(i.product.qte_stock,l)||(i.product.qte_stock=l),l}),r()()(),g(38,Ci,3,0,"small",29),r(),a(39,"div",30)(40,"span",31),p(41,"Status"),r(),a(42,"span",32),p(43),r(),a(44,"p-toggleswitch",33),f("ngModelChange",function(l){return i.onStatutToggleChange(l)}),r()(),g(45,yi,3,4,"div",34),r(),a(46,"div",35)(47,"div",36)(48,"div")(49,"span",37),p(50),r(),a(51,"small",38),p(52," Renseignez les informations principales, les prix et le statut de publication. "),r()(),g(53,Mi,1,0,"button",39),r(),a(54,"p-fluid",40)(55,"div",41)(56,"div",42)(57,"div",43)(58,"label",44),p(59," Type de produit "),g(60,wi,2,0,"span",17),r(),a(61,"p-select",45),P("ngModelChange",function(l){return v(i.product.type,l)||(i.product.type=l),l}),f("onChange",function(){return i.onTypeChange()}),r(),a(62,"small",46),_(63,"i",47),p(64," Le type d\xE9termine les champs de prix et la gestion du stock. "),r()(),a(65,"div",48)(66,"div",49)(67,"label",50),p(68,"Nom du produit "),g(69,Oi,2,0,"span",17),r(),a(70,"input",51),P("ngModelChange",function(l){return v(i.product.nom,l)||(i.product.nom=l),l}),r(),g(71,Si,2,0,"small",17),r(),a(72,"div",49)(73,"div",52)(74,"label",44),p(75,"Prix"),r()(),a(76,"div",53),g(77,Ei,3,5,"div",54)(78,Ti,3,5,"div",54)(79,Fi,3,5,"div",54),r(),a(80,"small",55),_(81,"i",47),p(82),r()(),g(83,Di,3,0,"div",56),r()(),a(84,"div",57)(85,"div",58),_(86,"i",59),p(87," Visuel du produit "),r(),g(88,zi,9,7,"div",11)(89,ji,2,1,"div",60),r()(),a(90,"div",61)(91,"div",62)(92,"span",63),p(93,"Etat du produit"),r(),a(94,"div",64)(95,"div",65)(96,"span",66),p(97,"Status:"),r(),a(98,"span",67),p(99),r(),a(100,"p-toggleswitch",33),f("ngModelChange",function(l){return i.onStatutToggleChange(l)}),r()()()(),a(101,"div",62)(102,"span",63),p(103,"Co\xFBt"),r(),a(104,"div",64)(105,"p-inputnumber",68),P("ngModelChange",function(l){return v(i.product.cout,l)||(i.product.cout=l),l}),r()()(),a(106,"div",62)(107,"span",63),p(108,"Quantit\xE9 en stock"),r(),a(109,"div",64)(110,"p-inputnumber",28),P("ngModelChange",function(l){return v(i.product.qte_stock,l)||(i.product.qte_stock=l),l}),r()(),g(111,qi,3,0,"small",69),r(),a(112,"div",70),g(113,Gi,4,4,"div",71),r()()()()()),e&2&&(s(6),B(" ",i.mode==="create"?"Nouveau produit":"D\xE9tails du produit"," "),s(),d("ngIf",i.mode==="edit"&&!i.isEditing),s(2),d("ngIf",i.isEditing),s(),d("ngIf",i.isEditing),s(),d("ngIf",!i.isEditing&&i.product.image_url),s(),d("ngIf",!i.isEditing&&!i.product.image_url),s(2),h("ngModel",i.product.nom),d("disabled",i.fieldsDisabled)("invalid",i.submitted&&!(i.product.nom!=null&&i.product.nom.trim())),s(),d("ngIf",i.submitted&&!(i.product.nom!=null&&i.product.nom.trim())&&i.isEditing),s(5),d("ngIf",i.isPrixAchatVisible()),s(),d("ngIf",i.isPrixVenteVisible()),s(4),h("ngModel",i.product.cout),d("min",0)("disabled",i.fieldsDisabled),s(),d("ngIf",i.isPrixUsineVisible()),s(),d("ngIf",i.showServicePriceError()),s(6),d("options",i.typeOptions),h("ngModel",i.product.type),d("disabled",i.fieldsDisabled),s(4),h("ngModel",i.product.qte_stock),d("showButtons",!0)("min",0)("disabled",i.isQteStockDisabled()),s(),d("ngIf",i.product.type==="service"),s(4),Se("active",i.isActifSwitch),s(),S(i.isActifSwitch?"Actif":"Inactif"),s(),d("ngModel",i.isActifSwitch)("disabled",i.fieldsDisabled),s(),d("ngIf",i.isEditing),s(5),B(" ",i.mode==="create"?"Cr\xE9er un produit":"D\xE9tails du produit"," "),s(3),d("ngIf",i.mode==="edit"&&!i.isEditing),s(7),d("ngIf",i.isEditing),s(),d("options",i.typeOptions),h("ngModel",i.product.type),d("disabled",i.fieldsDisabled),s(8),d("ngIf",i.isEditing),s(),h("ngModel",i.product.nom),d("disabled",i.fieldsDisabled)("invalid",i.submitted&&!(i.product.nom!=null&&i.product.nom.trim())),s(),d("ngIf",i.submitted&&!(i.product.nom!=null&&i.product.nom.trim())&&i.isEditing),s(6),d("ngIf",i.isPrixAchatVisible()),s(),d("ngIf",i.isPrixVenteVisible()),s(),d("ngIf",i.isPrixUsineVisible()),s(3),B(" ",i.getPrixHelperText()," "),s(),d("ngIf",i.showServicePriceError()),s(5),d("ngIf",i.isEditing),s(),d("ngIf",!i.isEditing&&i.product.image_url),s(10),S(i.isActifSwitch?"Actif":"Inactif"),s(),d("ngModel",i.isActifSwitch)("disabled",i.fieldsDisabled),s(5),h("ngModel",i.product.cout),d("min",0)("disabled",i.fieldsDisabled),s(5),h("ngModel",i.product.qte_stock),d("showButtons",!0)("min",0)("disabled",i.isQteStockDisabled()),s(),d("ngIf",i.product.type==="service"),s(2),d("ngIf",i.isEditing))},dependencies:[D,W,ut,oe,re,ne,ee,te,ie,pt,ct,de,se,pe,ce,Ge,qe,le,ae,mt,De,Fe,ue,me],styles:[".product-form[_ngcontent-%COMP%]   .mobile-form-container[_ngcontent-%COMP%]{display:none}.product-form[_ngcontent-%COMP%]   .form-header[_ngcontent-%COMP%]{border-bottom:1px solid var(--surface-200);padding-bottom:1rem}.product-form[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]{border:1px solid var(--surface-200);border-radius:.875rem;background:var(--surface-0);padding:1.25rem}.product-form[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{display:inline-flex;align-items:center;margin-bottom:1rem;font-weight:700;color:var(--text-color)}.product-form[_ngcontent-%COMP%]   .side-title[_ngcontent-%COMP%]{font-weight:700;color:var(--text-color);padding:1rem 1rem .875rem;border-bottom:1px solid var(--surface-200);background:color-mix(in srgb,var(--surface-50) 70%,transparent)}.product-form[_ngcontent-%COMP%]   .helper-chip[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--blue-100) 50%,transparent);border-radius:999px;padding:.35rem .7rem;font-weight:500}.product-form[_ngcontent-%COMP%]   .status-pill[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-size:.8rem;font-weight:700;border-radius:999px;padding:.2rem .6rem}.product-form[_ngcontent-%COMP%]   .status-pill-active[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.product-form[_ngcontent-%COMP%]   .status-pill-inactive[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.product-form[_ngcontent-%COMP%]   .service-alert[_ngcontent-%COMP%]{display:flex;align-items:center;color:#991b1b;background:#fef2f2;border:1px solid #fecaca;border-radius:.5rem;padding:.65rem .8rem;font-size:.9rem}.product-form[_ngcontent-%COMP%]   .upload-dropzone[_ngcontent-%COMP%]{cursor:pointer;border-radius:.75rem;transition:background-color .2s ease}.product-form[_ngcontent-%COMP%]   .upload-dropzone[_ngcontent-%COMP%]:hover{background:color-mix(in srgb,var(--primary-50) 35%,transparent)}.product-form[_ngcontent-%COMP%]   .type-selector-block[_ngcontent-%COMP%]{padding-bottom:.75rem;border-bottom:1px solid var(--surface-200)}.product-form[_ngcontent-%COMP%]   .form-field-label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:var(--surface-900);margin-bottom:.5rem}.product-form[_ngcontent-%COMP%]   .form-field-hint[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;margin-top:.4rem;font-size:.78rem;color:#94a3b8}.product-form[_ngcontent-%COMP%]   .form-field-hint[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.7rem}.product-form[_ngcontent-%COMP%]   .prix-section-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:.5rem}.product-form[_ngcontent-%COMP%]   .prix-helper-text[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;margin-top:.6rem;font-size:.78rem;color:#94a3b8}.product-form[_ngcontent-%COMP%]   .prix-helper-text[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.7rem}.product-form[_ngcontent-%COMP%]   .price-field-anim[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_priceFieldFade .18s ease-out}@keyframes _ngcontent-%COMP%_priceFieldFade{0%{opacity:0;transform:translateY(-4px)}to{opacity:1;transform:translateY(0)}}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .type-selector-block[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .type-selector-block[_ngcontent-%COMP%]{border-bottom-color:var(--p-surface-700)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .form-field-label[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .form-field-label[_ngcontent-%COMP%]{color:var(--p-surface-0)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .form-field-hint[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .form-field-hint[_ngcontent-%COMP%], .app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .prix-helper-text[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .prix-helper-text[_ngcontent-%COMP%]{color:var(--p-surface-500)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .status-pill-active[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .status-pill-active[_ngcontent-%COMP%]{background:#05966933;color:#34d399}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .status-pill-inactive[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .status-pill-inactive[_ngcontent-%COMP%]{background:#d9770633;color:#fbbf24}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .service-alert[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .service-alert[_ngcontent-%COMP%]{background:#dc262626;border-color:var(--p-surface-600);color:#f87171}@media screen and (max-width: 768px){.product-form[_ngcontent-%COMP%]{border:0!important;border-radius:0!important;box-shadow:none!important;background:#f8f9fc!important;margin:-.5rem -.875rem calc(-.5rem - env(safe-area-inset-bottom));padding:0;min-height:100dvh}.product-form[_ngcontent-%COMP%]   .mobile-form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;padding:calc(.75rem + env(safe-area-inset-top)) 1rem calc(5.5rem + env(safe-area-inset-bottom));animation:_ngcontent-%COMP%_mobileFade .24s ease-out}.product-form[_ngcontent-%COMP%]   .desktop-form-container[_ngcontent-%COMP%]{display:none!important}.product-form[_ngcontent-%COMP%]   .mobile-form-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding-bottom:.25rem}.product-form[_ngcontent-%COMP%]   .mobile-form-back[_ngcontent-%COMP%], .product-form[_ngcontent-%COMP%]   .mobile-form-edit[_ngcontent-%COMP%]{width:2.25rem;height:2.25rem;border-radius:999px;flex-shrink:0;color:#1e293b!important;background:transparent!important;border:0!important;box-shadow:none!important}.product-form[_ngcontent-%COMP%]   .mobile-form-title-wrap[_ngcontent-%COMP%]{flex:1;min-width:0}.product-form[_ngcontent-%COMP%]   .mobile-form-title[_ngcontent-%COMP%]{margin:0;font-size:1.15rem;font-weight:700;color:#1e293b;letter-spacing:-.01em;text-align:center}.product-form[_ngcontent-%COMP%]   .mobile-image-card[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;overflow:hidden;box-shadow:0 1px 3px #0000000f,0 4px 12px #0000000a}.product-form   [_nghost-%COMP%]     .mobile-uploader{border:0!important;background:transparent!important;box-shadow:none!important}.product-form   [_nghost-%COMP%]     .mobile-uploader .p-fileupload-header{display:none}.product-form   [_nghost-%COMP%]     .mobile-uploader .p-fileupload-file-list{display:none}.product-form   [_nghost-%COMP%]     .mobile-uploader .p-fileupload-content{padding:0;border:0;min-height:auto;height:auto!important}.product-form[_ngcontent-%COMP%]   .mobile-upload-zone[_ngcontent-%COMP%]{cursor:pointer;min-height:11rem}.product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:11rem;color:#94a3b8;gap:.5rem}.product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem;color:#cbd5e1}.product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600}.product-form[_ngcontent-%COMP%]   .mobile-upload-preview[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;padding:.75rem}.product-form[_ngcontent-%COMP%]   .mobile-upload-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:12rem;width:auto;border-radius:.75rem;object-fit:contain}.product-form[_ngcontent-%COMP%]   .mobile-remove-img[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem;width:1.75rem!important;height:1.75rem!important;border-radius:999px!important}.product-form[_ngcontent-%COMP%]   .mobile-remove-img[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.7rem}.product-form[_ngcontent-%COMP%]   .mobile-upload-loading[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:#00000073;border-radius:.75rem}.product-form[_ngcontent-%COMP%]   .mobile-delete-confirm[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:.75rem;background:#000000a6;padding:1rem}.product-form[_ngcontent-%COMP%]   .mobile-section-card[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;padding:1rem;box-shadow:0 1px 3px #0000000f,0 4px 12px #0000000a}.product-form[_ngcontent-%COMP%]   .mobile-field-label[_ngcontent-%COMP%]{display:block;font-size:.7rem;font-weight:700;color:#94a3b8;text-transform:uppercase;letter-spacing:.06em;margin-bottom:.5rem}.product-form[_ngcontent-%COMP%]   .mobile-price-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}.product-form[_ngcontent-%COMP%]   .mobile-price-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.product-form[_ngcontent-%COMP%]   .mobile-price-label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;color:#64748b}.product-form[_ngcontent-%COMP%]   .mobile-service-alert[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.35rem;margin-top:.6rem;padding:.5rem .65rem;background:#fef2f2;border:1px solid #fecaca;border-radius:.65rem;font-size:.8rem;color:#991b1b}.product-form[_ngcontent-%COMP%]   .mobile-meta-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}.product-form[_ngcontent-%COMP%]   .mobile-meta-field[_ngcontent-%COMP%]{display:flex;flex-direction:column}.product-form[_ngcontent-%COMP%]   .mobile-info-hint[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;margin-top:.5rem;font-size:.75rem;color:#94a3b8;font-weight:500}.product-form[_ngcontent-%COMP%]   .mobile-status-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.product-form[_ngcontent-%COMP%]   .mobile-status-label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:700;color:#334155}.product-form[_ngcontent-%COMP%]   .mobile-status-value[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#94a3b8}.product-form[_ngcontent-%COMP%]   .mobile-status-value.active[_ngcontent-%COMP%]{color:#16a34a}.product-form   [_nghost-%COMP%]     .p-inputtext, .product-form   [_nghost-%COMP%]     .p-inputnumber-input, .product-form   [_nghost-%COMP%]     .p-select-label{font-size:16px!important;min-height:2.65rem}.product-form[_ngcontent-%COMP%]   .mobile-bottom-actions[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;z-index:50;display:flex;gap:.5rem;padding:.75rem 1rem calc(.75rem + env(safe-area-inset-bottom));background:#ffffffeb;backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border-top:1px solid #e2e8f0}.product-form[_ngcontent-%COMP%]   .mobile-btn-save[_ngcontent-%COMP%]{flex:1;border-radius:.75rem!important;font-weight:700!important;min-height:2.75rem}.product-form[_ngcontent-%COMP%]   .mobile-btn-cancel[_ngcontent-%COMP%]{flex:0 0 auto;border-radius:.75rem!important;font-weight:600!important;min-height:2.75rem}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]{background:var(--p-surface-950)!important}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-form-back[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-form-back[_ngcontent-%COMP%], .app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-form-edit[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-form-edit[_ngcontent-%COMP%]{color:var(--p-surface-100)!important}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-form-title[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-form-title[_ngcontent-%COMP%]{color:var(--p-surface-0)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-image-card[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-image-card[_ngcontent-%COMP%]{background:var(--p-surface-800);box-shadow:0 1px 3px #0003}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-upload-placeholder[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--p-surface-500)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-section-card[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-section-card[_ngcontent-%COMP%]{background:var(--p-surface-800);box-shadow:0 1px 3px #00000026}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-field-label[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-field-label[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-price-label[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-price-label[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-service-alert[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-service-alert[_ngcontent-%COMP%]{background:#dc262626;border-color:var(--p-surface-600);color:#f87171}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-info-hint[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-info-hint[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-status-label[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-status-label[_ngcontent-%COMP%]{color:var(--p-surface-200)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-status-value[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-status-value[_ngcontent-%COMP%]{color:var(--p-surface-400)}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-status-value.active[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-status-value.active[_ngcontent-%COMP%]{color:#34d399}.app-dark[_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-bottom-actions[_ngcontent-%COMP%], .app-dark   [_nghost-%COMP%]   .product-form[_ngcontent-%COMP%]   .mobile-bottom-actions[_ngcontent-%COMP%]{background:#0f172aeb;border-top-color:var(--p-surface-700)}}@keyframes _ngcontent-%COMP%_mobileFade{0%{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}","[_nghost-%COMP%]     .p-fileupload-header{display:none}[_nghost-%COMP%]     .p-fileupload-file-list{display:none}[_nghost-%COMP%]     .p-fileupload-content{height:20rem}"]})};var fe=class n{constructor(t,e,i,o){this.router=t;this.messageService=e;this.produitService=i;this.document=o}loading=!1;mobileBreakpoint=768;mobilePwaClass="produits-mobile-pwa";ngOnInit(){this.updateMobilePwaMode()}ngOnDestroy(){this.document.body.classList.remove(this.mobilePwaClass)}onResize(){this.updateMobilePwaMode()}updateMobilePwaMode(){typeof window>"u"||(window.innerWidth<=this.mobileBreakpoint?this.document.body.classList.add(this.mobilePwaClass):this.document.body.classList.remove(this.mobilePwaClass))}onSubmitForm(t){this.loading=!0;let e=t.image??null;this.produitService.create(t).subscribe({next:i=>{e&&i.id?this.uploadImageAfterCreate(i,e):this.handleSuccess("Produit cr\xE9\xE9 avec succ\xE8s",i)},error:i=>this.handleError("Erreur lors de la cr\xE9ation du produit",i)})}uploadImageAfterCreate(t,e){this.produitService.uploadProduitImage(t.id,e).subscribe({next:i=>{this.handleSuccess("Produit cr\xE9\xE9 avec succ\xE8s",i)},error:()=>{this.messageService.add({severity:"warn",summary:"Attention",detail:"Produit cr\xE9\xE9, mais l'image n'a pas pu \xEAtre envoy\xE9e.",life:5e3}),this.loading=!1,this.router.navigate(["/produits/produits-edit",t.id])}})}onCancel(){this.router.navigate(["/produits"])}handleSuccess(t,e){if(this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:t,life:2e3}),this.loading=!1,e?.id){this.router.navigate(["/produits/produits-edit",e.id]);return}this.router.navigate(["/produits"])}handleError(t,e){let i=e?.error?.message||t;e?.status===422&&e?.error?.errors?Object.values(e.error.errors).flat().forEach(l=>{this.messageService.add({severity:"error",summary:i,detail:l,life:5e3})}):this.messageService.add({severity:"error",summary:"Erreur",detail:i,life:5e3}),this.loading=!1,console.error(e)}static \u0275fac=function(e){return new(e||n)(y(N),y(w),y(E),y(R))};static \u0275cmp=V({type:n,selectors:[["app-produits-new"]],hostBindings:function(e,i){e&1&&f("resize",function(){return i.onResize()},A)},features:[F([w])],decls:2,vars:1,consts:[["mode","create",3,"submitForm","cancel","loading"]],template:function(e,i){e&1&&(_(0,"p-toast"),a(1,"app-produits-form",0),f("submitForm",function(l){return i.onSubmitForm(l)})("cancel",function(){return i.onCancel()}),r()),e&2&&(s(),d("loading",i.loading))},dependencies:[D,q,j,z],encapsulation:2})};function Hi(n,t){if(n&1){let e=b();a(0,"app-produits-form",1),f("submitForm",function(o){m(e);let l=c();return u(l.onSubmitForm(o))})("cancel",function(){m(e);let o=c();return u(o.onCancel())})("deleteImage",function(){m(e);let o=c();return u(o.onDeleteImage())}),r()}if(n&2){let e=c();d("initialData",e.initialData)("loading",e.loading)}}var be=class n{constructor(t,e,i,o,l){this.route=t;this.router=e;this.produitService=i;this.messageService=o;this.document=l}loading=!1;produitId=null;initialData=null;mobileBreakpoint=768;mobilePwaClass="produits-mobile-pwa";ngOnInit(){this.updateMobilePwaMode();let t=this.route.snapshot.paramMap.get("id"),e=t?Number(t):NaN;if(!Number.isFinite(e)||e<=0){this.router.navigate(["/produits"]);return}this.produitId=e,this.loadProduit(e)}onSubmitForm(t){if(!this.produitId)return;this.loading=!0;let e=t.image??null;this.produitService.update(this.produitId,t).subscribe({next:i=>{e?this.uploadImageAfterUpdate(i,e):(this.initialData=i,this.loading=!1,this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Produit modifi\xE9 avec succ\xE8s",life:3e3}))},error:i=>{this.loading=!1,this.showApiError(i,"Erreur lors de la modification du produit")}})}onDeleteImage(){this.produitId&&(this.loading=!0,this.produitService.deleteProduitImage(this.produitId).subscribe({next:t=>{this.initialData=t,this.loading=!1,this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Image supprim\xE9e avec succ\xE8s",life:3e3})},error:t=>{this.initialData=I({},this.initialData),this.loading=!1,this.showApiError(t,"Impossible de supprimer l'image")}}))}uploadImageAfterUpdate(t,e){this.produitService.uploadProduitImage(t.id,e).subscribe({next:i=>{this.initialData=i,this.loading=!1,this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Produit modifi\xE9 avec succ\xE8s",life:3e3})},error:()=>{this.initialData=t,this.loading=!1,this.messageService.add({severity:"warn",summary:"Attention",detail:"Produit modifi\xE9, mais l'image n'a pas pu \xEAtre envoy\xE9e.",life:5e3})}})}onCancel(){this.router.navigate(["/produits"])}loadProduit(t){this.loading=!0,this.produitService.getById(t).subscribe({next:e=>{this.initialData=e,this.loading=!1},error:e=>{this.loading=!1,this.showApiError(e,"Erreur lors du chargement du produit")}})}ngOnDestroy(){this.document.body.classList.remove(this.mobilePwaClass)}onResize(){this.updateMobilePwaMode()}updateMobilePwaMode(){typeof window>"u"||(window.innerWidth<=this.mobileBreakpoint?this.document.body.classList.add(this.mobilePwaClass):this.document.body.classList.remove(this.mobilePwaClass))}showApiError(t,e){let i=t?.error?.message||e;this.messageService.add({severity:"error",summary:"Erreur",detail:i,life:5e3})}static \u0275fac=function(e){return new(e||n)(y(Te),y(N),y(E),y(w),y(R))};static \u0275cmp=V({type:n,selectors:[["app-produits-edit"]],hostBindings:function(e,i){e&1&&f("resize",function(){return i.onResize()},A)},features:[F([w])],decls:2,vars:1,consts:[["mode","edit",3,"initialData","loading","submitForm","cancel","deleteImage",4,"ngIf"],["mode","edit",3,"submitForm","cancel","deleteImage","initialData","loading"]],template:function(e,i){e&1&&(_(0,"p-toast"),g(1,Hi,1,2,"app-produits-form",0)),e&2&&(s(),d("ngIf",i.initialData))},dependencies:[D,W,q,j,z],encapsulation:2})};var jr=[{path:"",component:Q,canActivate:[H],data:{permissions:["produits.read"]}},{path:"produits",component:Q,canActivate:[H],data:{permissions:["produits.read"]}},{path:"produits-new",component:fe,canActivate:[H],data:{permissions:["produits.create"]}},{path:"produits-edit/:id",component:be,canActivate:[H],data:{permissions:["produits.update"]}},{path:"**",redirectTo:"/notfound"}];export{jr as default};
