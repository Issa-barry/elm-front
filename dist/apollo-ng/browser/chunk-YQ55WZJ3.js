import{a as Ve}from"./chunk-IMEHSH2Q.js";import{a as ut}from"./chunk-6MPWZMCU.js";import{a as lt,b as st}from"./chunk-XLX4KHCH.js";import{a as pt,b as dt}from"./chunk-LK4T7DDW.js";import{a as se,b as ce}from"./chunk-DHO5ZECZ.js";import{a as ge,b as _e}from"./chunk-BS6LNNLV.js";import{a as de,b as ue}from"./chunk-NW5N26ZF.js";import{a as Re,b as le}from"./chunk-FCSZSTKZ.js";import"./chunk-62XMJ7OZ.js";import{a as me,b as pe}from"./chunk-NXMTA3Z5.js";import{b as rt,d as ke}from"./chunk-22WVEZDH.js";import"./chunk-6UNS6ATT.js";import"./chunk-VBF7BBWX.js";import{a as te,d as ie,e as ne,h as Oe,i as Fe,k as ae}from"./chunk-CZQFGBIP.js";import"./chunk-DKGKIQYD.js";import"./chunk-6R56UM77.js";import{a as De,b as Ie}from"./chunk-UATLNJ6A.js";import"./chunk-L2T5JW7K.js";import"./chunk-C35SDHAO.js";import"./chunk-IENEWIOW.js";import{b as Z,c as J}from"./chunk-V7HYCLOH.js";import"./chunk-GCJYWVBV.js";import"./chunk-PZUT5QF4.js";import{c as $,d as ee}from"./chunk-QK2KLPR7.js";import"./chunk-IQ3I63NM.js";import"./chunk-KAT22IHP.js";import"./chunk-2MYVVGAW.js";import"./chunk-VRCAH26M.js";import"./chunk-4O43JDMY.js";import"./chunk-LNM7OC6P.js";import{a as re,b as oe}from"./chunk-BFGT4G5C.js";import"./chunk-D3EQSYXL.js";import{a as ct,b as mt}from"./chunk-FR7DTH2N.js";import"./chunk-E6N6EGUJ.js";import"./chunk-2PEJZBD7.js";import{a as we,b as Y,c as Me,d as X}from"./chunk-BDIOYTKC.js";import{a as Se,b as z}from"./chunk-H5W5OS5D.js";import{b as B,e as j,h as H,m as ot,o as U}from"./chunk-CRGNDKCR.js";import{a as Ee,b as Te}from"./chunk-BGXPLMJT.js";import{a as ye,c as at}from"./chunk-CSKRJUWU.js";import"./chunk-UWIKY6DF.js";import{c as K,d as Q}from"./chunk-6I65RIIA.js";import"./chunk-BODZH67C.js";import"./chunk-7UZYWCAJ.js";import"./chunk-UAZ37PIZ.js";import{j as G}from"./chunk-ZN2HQ4SK.js";import"./chunk-SEL7WNEU.js";import{la as w,pa as M}from"./chunk-6ETCFPPD.js";import{k as A,s as nt,u as O}from"./chunk-6PDKYY6Q.js";import"./chunk-4O3FVBGX.js";import{$ as d,$b as N,Ab as T,Bb as I,Cb as Ze,Gb as v,Ja as je,Kb as b,Lb as m,Ma as s,Pb as ve,Qb as xe,R as Ge,Ra as Xe,Rb as Ce,Ub as q,V as Ke,Vb as Je,Wb as $e,Xa as k,Xb as E,Yb as Pe,Zb as l,_b as g,aa as u,ab as D,ac as et,ba as Qe,ca as Ye,cc as C,dc as P,ec as y,gb as f,gc as V,hc as S,ia as L,rc as tt,tc as it,wb as p,wc as x,xb as n,yb as i,zb as _}from"./chunk-KCZYDF4B.js";import{a as ze}from"./chunk-GAL4ENT6.js";var It=["dt"],Ot=()=>({"min-width":"75rem"}),Ft=()=>[10,20,30],gt=()=>({width:"450px"});function Vt(a,t){if(a&1){let e=v();n(0,"p-button",12),b("onClick",function(){d(e);let r=m();return u(r.openNew())}),i(),n(1,"p-button",13),b("onClick",function(){d(e);let r=m();return u(r.deleteSelectedProducts())}),i()}if(a&2){let e=m();s(),p("disabled",!e.selectedProducts||!e.selectedProducts.length)}}function Rt(a,t){if(a&1){let e=v();n(0,"p-button",14),b("onClick",function(){d(e);let r=m();return u(r.exportCSV())}),i()}}function Wt(a,t){if(a&1){let e=v();n(0,"div",15)(1,"h5",16),l(2,"Manage Products"),i(),n(3,"p-iconfield"),_(4,"p-inputicon",17),n(5,"input",18),b("input",function(r){d(e);let c=m(),h=q(7);return u(c.onGlobalFilter(h,r))}),i()()()}}function Lt(a,t){a&1&&(n(0,"tr")(1,"th",19),_(2,"p-tableHeaderCheckbox"),i(),n(3,"th",20)(4,"span",21),l(5,"Code "),_(6,"p-sortIcon",22),i()(),n(7,"th",23)(8,"span",21),l(9,"Name "),_(10,"p-sortIcon",24),i()(),n(11,"th"),l(12,"Image"),i(),n(13,"th",25)(14,"span",21),l(15,"Price "),_(16,"p-sortIcon",26),i()(),n(17,"th",27)(18,"span",21),l(19,"Category "),_(20,"p-sortIcon",28),i()(),n(21,"th",29)(22,"span",21),l(23,"Reviews "),_(24,"p-sortIcon",30),i()(),n(25,"th",31)(26,"span",21),l(27,"Status "),_(28,"p-sortIcon",32),i()(),_(29,"th",33),i())}function qt(a,t){if(a&1){let e=v();n(0,"tr")(1,"td",19),_(2,"p-tableCheckbox",34),i(),n(3,"td",33),l(4),i(),n(5,"td",35),l(6),i(),n(7,"td"),_(8,"img",36),i(),n(9,"td"),l(10),tt(11,"currency"),i(),n(12,"td"),l(13),i(),n(14,"td")(15,"p-rating",37),y("ngModelChange",function(r){let c=d(e).$implicit;return P(c.rating,r)||(c.rating=r),u(r)}),i()(),n(16,"td"),_(17,"p-tag",38),i(),n(18,"td")(19,"p-button",39),b("click",function(){let r=d(e).$implicit,c=m();return u(c.editProduct(r))}),i(),n(20,"p-button",40),b("click",function(){let r=d(e).$implicit,c=m();return u(c.deleteProduct(r))}),i()()()}if(a&2){let e=t.$implicit,o=m();s(2),p("value",e),s(2),g(e.code),s(2),g(e.name),s(2),p("src","/demo/images/product/"+e.image,je)("alt",e.name),s(2),g(it(11,15,e.price,"USD")),s(3),g(e.category),s(2),C("ngModel",e.rating),p("readonly",!0),s(2),p("value",e.inventoryStatus)("severity",o.getSeverity(e.inventoryStatus)),s(2),p("rounded",!0)("outlined",!0),s(),p("rounded",!0)("outlined",!0)}}function Nt(a,t){if(a&1&&_(0,"img",66),a&2){let e=m(2);p("src","/demo/images/product/"+e.product.image,je)("alt",e.product.image)}}function At(a,t){a&1&&(n(0,"small",67),l(1,"Name is required."),i())}function Bt(a,t){if(a&1){let e=v();n(0,"div",41),f(1,Nt,1,2,"img",42),n(2,"div")(3,"label",43),l(4,"Name"),i(),n(5,"input",44),y("ngModelChange",function(r){d(e);let c=m();return P(c.product.name,r)||(c.product.name=r),u(r)}),i(),f(6,At,2,0,"small",45),i(),n(7,"div")(8,"label",46),l(9,"Description"),i(),n(10,"textarea",47),y("ngModelChange",function(r){d(e);let c=m();return P(c.product.description,r)||(c.product.description=r),u(r)}),i()(),n(11,"div")(12,"label",48),l(13,"Inventory Status"),i(),n(14,"p-select",49),y("ngModelChange",function(r){d(e);let c=m();return P(c.product.inventoryStatus,r)||(c.product.inventoryStatus=r),u(r)}),i()(),n(15,"div")(16,"span",50),l(17,"Category"),i(),n(18,"div",51)(19,"div",52)(20,"p-radiobutton",53),y("ngModelChange",function(r){d(e);let c=m();return P(c.product.category,r)||(c.product.category=r),u(r)}),i(),n(21,"label",54),l(22,"Accessories"),i()(),n(23,"div",52)(24,"p-radiobutton",55),y("ngModelChange",function(r){d(e);let c=m();return P(c.product.category,r)||(c.product.category=r),u(r)}),i(),n(25,"label",56),l(26,"Clothing"),i()(),n(27,"div",52)(28,"p-radiobutton",57),y("ngModelChange",function(r){d(e);let c=m();return P(c.product.category,r)||(c.product.category=r),u(r)}),i(),n(29,"label",58),l(30,"Electronics"),i()(),n(31,"div",52)(32,"p-radiobutton",59),y("ngModelChange",function(r){d(e);let c=m();return P(c.product.category,r)||(c.product.category=r),u(r)}),i(),n(33,"label",60),l(34,"Fitness"),i()()()(),n(35,"div",51)(36,"div",61)(37,"label",62),l(38,"Price"),i(),n(39,"p-inputnumber",63),y("ngModelChange",function(r){d(e);let c=m();return P(c.product.price,r)||(c.product.price=r),u(r)}),i()(),n(40,"div",61)(41,"label",64),l(42,"Quantity"),i(),n(43,"p-inputnumber",65),y("ngModelChange",function(r){d(e);let c=m();return P(c.product.quantity,r)||(c.product.quantity=r),u(r)}),i()()()()}if(a&2){let e=m();s(),p("ngIf",e.product.image),s(4),C("ngModel",e.product.name),s(),p("ngIf",e.submitted&&!e.product.name),s(4),C("ngModel",e.product.description),s(4),C("ngModel",e.product.inventoryStatus),p("options",e.statuses),s(6),C("ngModel",e.product.category),s(4),C("ngModel",e.product.category),s(4),C("ngModel",e.product.category),s(4),C("ngModel",e.product.category),s(7),C("ngModel",e.product.price),s(4),C("ngModel",e.product.quantity)}}function jt(a,t){if(a&1){let e=v();n(0,"p-button",68),b("click",function(){d(e);let r=m();return u(r.hideDialog())}),i(),n(1,"p-button",69),b("click",function(){d(e);let r=m();return u(r.saveProduct())}),i()}}var We=class a{constructor(t,e,o){this.productService=t;this.messageService=e;this.confirmationService=o}filterFields=["code","name","description","price","quantity","inventoryStatus","category","rating","image"];productDialog=!1;products=L([]);product;selectedProducts;submitted=!1;statuses;dt;exportColumns;cols;exportCSV(){this.dt.exportCSV()}ngOnInit(){this.loadDemoData()}loadDemoData(){this.productService.getProducts().then(t=>{this.products.set(t)}),this.statuses=[{label:"INSTOCK",value:"instock"},{label:"LOWSTOCK",value:"lowstock"},{label:"OUTOFSTOCK",value:"outofstock"}],this.cols=[{field:"code",header:"Code",customExportHeader:"Product Code"},{field:"name",header:"Name"},{field:"image",header:"Image"},{field:"price",header:"Price"},{field:"category",header:"Category"}],this.exportColumns=this.cols.map(t=>({title:t.header,dataKey:t.field}))}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}openNew(){this.product={},this.submitted=!1,this.productDialog=!0}editProduct(t){this.product=ze({},t),this.productDialog=!0}deleteSelectedProducts(){this.confirmationService.confirm({message:"Are you sure you want to delete the selected products?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this.products.set(this.products().filter(t=>!this.selectedProducts?.includes(t))),this.selectedProducts=null,this.messageService.add({severity:"success",summary:"Successful",detail:"Products Deleted",life:3e3})}})}hideDialog(){this.productDialog=!1,this.submitted=!1}deleteProduct(t){this.confirmationService.confirm({message:"Are you sure you want to delete "+t.name+"?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this.products.set(this.products().filter(e=>e.id!==t.id)),this.product={},this.messageService.add({severity:"success",summary:"Successful",detail:"Product Deleted",life:3e3})}})}findIndexById(t){let e=-1;for(let o=0;o<this.products().length;o++)if(this.products()[o].id===t){e=o;break}return e}createId(){let t="";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<5;o++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}getSeverity(t){switch(t){case"INSTOCK":return"success";case"LOWSTOCK":return"warn";case"OUTOFSTOCK":return"danger";default:return"info"}}saveProduct(){this.submitted=!0;let t=this.products();this.product.name?.trim()&&(this.product.id?(t[this.findIndexById(this.product.id)]=this.product,this.products.set([...t]),this.messageService.add({severity:"success",summary:"Successful",detail:"Product Updated",life:3e3})):(this.product.id=this.createId(),this.product.image="product-placeholder.svg",this.messageService.add({severity:"success",summary:"Successful",detail:"Product Created",life:3e3}),this.products.set([...t,this.product])),this.productDialog=!1,this.product={})}static \u0275fac=function(e){return new(e||a)(k(Ve),k(M),k(w))};static \u0275cmp=D({type:a,selectors:[["app-packing-paiement"]],viewQuery:function(e,o){if(e&1&&ve(It,5),e&2){let r;xe(r=Ce())&&(o.dt=r.first)}},features:[V([M,w])],decls:20,vars:20,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["content",""],["footer",""],[1,"card"],["styleClass","mb-12"],["dataKey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} products",3,"selectionChange","value","rows","columns","paginator","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions"],["header","Product Details",3,"visibleChange","visible","modal"],["label","New","icon","pi pi-plus","severity","secondary",1,"mr-2",3,"onClick"],["severity","secondary","label","Delete","icon","pi pi-trash","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[2,"width","3rem"],["pSortableColumn","code",2,"min-width","16rem"],[1,"flex","items-center","gap-2"],["field","code"],["pSortableColumn","name",2,"min-width","16rem"],["field","name"],["pSortableColumn","price",2,"min-width","8rem"],["field","price"],["pSortableColumn","category",2,"min-width","10rem"],["field","category"],["pSortableColumn","rating",2,"min-width","12rem"],["field","rating"],["pSortableColumn","inventoryStatus",2,"min-width","12rem"],["field","inventoryStatus"],[2,"min-width","12rem"],[3,"value"],[2,"min-width","16rem"],[1,"rounded",2,"width","64px",3,"src","alt"],[3,"ngModelChange","ngModel","readonly"],[3,"value","severity"],["icon","pi pi-pencil",1,"mr-2",3,"click","rounded","outlined"],["icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"],[1,"flex","flex-col","gap-6"],["class","block m-auto pb-6",3,"src","alt",4,"ngIf"],["for","name",1,"block","font-bold","mb-4"],["type","text","pInputText","","id","name","required","","autofocus","","fluid","",3,"ngModelChange","ngModel"],["class","text-red-500",4,"ngIf"],["for","description",1,"block","font-bold","mb-4"],["id","description","pTextarea","","required","","rows","3","cols","20","fluid","",3,"ngModelChange","ngModel"],["for","inventoryStatus",1,"block","font-bold","mb-4"],["inputId","inventoryStatus","optionLabel","label","optionValue","label","placeholder","Select a Status","fluid","",3,"ngModelChange","ngModel","options"],[1,"block","font-bold","mb-6"],[1,"grid","grid-cols-12","gap-4"],[1,"flex","items-center","gap-2","col-span-6"],["id","category1","name","category","value","Accessories",3,"ngModelChange","ngModel"],["for","category1"],["id","category2","name","category","value","Clothing",3,"ngModelChange","ngModel"],["for","category2"],["id","category3","name","category","value","Electronics",3,"ngModelChange","ngModel"],["for","category3"],["id","category4","name","category","value","Fitness",3,"ngModelChange","ngModel"],["for","category4"],[1,"col-span-6"],["for","price",1,"block","font-bold","mb-4"],["id","price","mode","currency","currency","USD","locale","en-US","fluid","",3,"ngModelChange","ngModel"],["for","quantity",1,"block","font-bold","mb-4"],["id","quantity","fluid","",3,"ngModelChange","ngModel"],[1,"block","m-auto","pb-6",3,"src","alt"],[1,"text-red-500"],["label","Cancel","icon","pi pi-times","text","",3,"click"],["label","Save","icon","pi pi-check",3,"click"]],template:function(e,o){if(e&1){let r=v();n(0,"div",8)(1,"p-toolbar",9),f(2,Vt,2,1,"ng-template",null,0,x)(4,Rt,1,0,"ng-template",null,1,x),i(),n(6,"p-table",10,2),y("selectionChange",function(h){return d(r),P(o.selectedProducts,h)||(o.selectedProducts=h),u(h)}),f(8,Wt,6,0,"ng-template",null,3,x)(10,Lt,30,0,"ng-template",null,4,x)(12,qt,21,18,"ng-template",null,5,x),i()(),n(14,"p-dialog",11),y("visibleChange",function(h){return d(r),P(o.productDialog,h)||(o.productDialog=h),u(h)}),f(15,Bt,44,12,"ng-template",null,6,x)(17,jt,2,0,"ng-template",null,7,x),i(),_(19,"p-confirmdialog")}e&2&&(s(6),p("value",o.products())("rows",10)("columns",o.cols)("paginator",!0)("globalFilterFields",o.filterFields)("tableStyle",S(16,Ot)),C("selection",o.selectedProducts),p("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",S(17,Ft)),s(8),E(S(18,gt)),C("visible",o.productDialog),p("modal",!0),s(5),E(S(19,gt)))},dependencies:[O,A,ae,te,ie,ne,Oe,Fe,U,B,j,ot,H,Q,K,G,le,ce,se,dt,pt,z,Se,pe,me,ee,$,mt,ct,J,Z,ue,de,oe,re,X,Me,Y,we,_e,ge,nt],styles:[".packing-paiement-container[_ngcontent-%COMP%]{min-height:calc(100vh - 9rem);background-color:var(--surface-ground);padding:1.5rem}.packing-paiement-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:1.5rem}.packing-paiement-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary-color)}.packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-md-6[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-lg-3[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]{height:100%;border-radius:12px;border:1px solid;transition:transform .2s ease,box-shadow .2s ease}.packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:hover, .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-md-6[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:hover, .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-lg-3[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]   .border-circle[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-md-6[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]   .border-circle[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-lg-3[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]   .border-circle[_ngcontent-%COMP%]{min-width:3.5rem;min-height:3.5rem}.packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]:nth-child(1)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-md-6[_ngcontent-%COMP%]:nth-child(1)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-lg-3[_ngcontent-%COMP%]:nth-child(1)   .card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e3f2fd,#bbdefb);border-color:#90caf9}.packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]:nth-child(2)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-md-6[_ngcontent-%COMP%]:nth-child(2)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-lg-3[_ngcontent-%COMP%]:nth-child(2)   .card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e8f5e9,#c8e6c9);border-color:#81c784}.packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]:nth-child(3)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-md-6[_ngcontent-%COMP%]:nth-child(3)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-lg-3[_ngcontent-%COMP%]:nth-child(3)   .card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff3e0,#ffe0b2);border-color:#ffb74d}.packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]:nth-child(4)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-md-6[_ngcontent-%COMP%]:nth-child(4)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-lg-3[_ngcontent-%COMP%]:nth-child(4)   .card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffebee,#ffcdd2);border-color:#e57373}.packing-paiement-container   [_nghost-%COMP%]     .p-card{border-radius:12px;box-shadow:0 2px 8px #00000014;border:1px solid var(--surface-border)}.packing-paiement-container   [_nghost-%COMP%]     .p-card .p-card-body{padding:0}.packing-paiement-container   [_nghost-%COMP%]     .p-card .p-card-content{padding:0}.packing-paiement-container   [_nghost-%COMP%]     .p-toolbar{background:var(--surface-50);border:none;border-bottom:1px solid var(--surface-border);padding:1.25rem 1.5rem;border-radius:12px 12px 0 0}.packing-paiement-container   [_nghost-%COMP%]     .p-toolbar .p-button{font-weight:600;padding:.625rem 1.25rem}.packing-paiement-container   [_nghost-%COMP%]     .p-toolbar .p-button.p-button-danger{background:linear-gradient(135deg,#ef5350,#e53935);border-color:#e53935}.packing-paiement-container   [_nghost-%COMP%]     .p-toolbar .p-button.p-button-success{background:linear-gradient(135deg,#66bb6a,#43a047);border-color:#43a047}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable{border-radius:0 0 12px 12px;overflow:hidden}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-header{background:var(--surface-0);padding:1.25rem 1.5rem;border-bottom:1px solid var(--surface-border)}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-header .p-input-icon-left{width:100%}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-header .p-input-icon-left input{width:100%;padding:.75rem 1rem .75rem 2.5rem;border-radius:8px;border:1px solid var(--surface-300);font-size:.95rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-header .p-input-icon-left input:focus{border-color:var(--primary-color);box-shadow:0 0 0 .2rem var(--primary-50)}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-header .p-input-icon-left i{top:50%;transform:translateY(-50%);left:.85rem;color:var(--text-color-secondary)}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-header .p-button-outlined{border-color:var(--surface-300);color:var(--text-color)}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-header .p-button-outlined:hover{background:var(--surface-100);border-color:var(--surface-400)}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th{background:var(--surface-50);color:var(--text-color);font-weight:600;font-size:.85rem;text-transform:uppercase;letter-spacing:.5px;padding:1rem 1.25rem;border-bottom:2px solid var(--surface-200)}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th:first-child{padding-left:1.5rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th .p-sortable-column-icon{color:var(--text-color-secondary)}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th.p-highlight{background:var(--primary-50);color:var(--primary-color)}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th.p-highlight .p-sortable-column-icon{color:var(--primary-color)}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr{transition:background-color .15s ease}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background:var(--surface-50)!important}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:1rem 1.25rem;border-bottom:1px solid var(--surface-100);font-size:.95rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td:first-child{padding-left:1.5rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .font-semibold{font-size:.95rem;font-weight:600}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .text-sm{font-size:.85rem;margin-top:.25rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .p-chip{padding:.5rem .875rem;font-weight:600;font-size:.875rem;border-radius:6px}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .p-tag{font-weight:600;font-size:.8rem;padding:.375rem .75rem;border-radius:6px}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .p-button{width:2.5rem;height:2.5rem;transition:all .2s ease}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .p-button:hover{transform:scale(1.1)}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .p-button.p-button-info:hover{background:var(--blue-100);color:var(--blue-600)}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .p-button.p-button-success:hover{background:var(--green-100);color:var(--green-600)}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .p-button:disabled{opacity:.4;cursor:not-allowed}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .p-button:disabled:hover{transform:none}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-emptymessage td{padding:3rem 1.5rem;text-align:center}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-emptymessage td i{opacity:.3;margin-bottom:1rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-emptymessage td p{opacity:.5}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-paginator{background:var(--surface-0);border-top:1px solid var(--surface-border);padding:1rem 1.5rem;border-radius:0 0 12px 12px}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-paginator .p-paginator-current{color:var(--text-color-secondary);font-size:.9rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-paginator .p-paginator-pages .p-paginator-page{min-width:2.5rem;height:2.5rem;border-radius:6px;font-weight:500}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-paginator .p-paginator-pages .p-paginator-page.p-highlight{background:var(--primary-color);color:#fff}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog{border-radius:12px;box-shadow:0 10px 40px #00000026}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-header{background:var(--surface-50);border-bottom:1px solid var(--surface-border);padding:1.5rem;border-radius:12px 12px 0 0}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-header .p-dialog-title{font-size:1.25rem;font-weight:600}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content{padding:1.5rem}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .surface-50{border-radius:8px;border:1px solid var(--surface-200)}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .p-divider{margin:1.5rem 0}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field{margin-bottom:1.5rem}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field:last-child{margin-bottom:0}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field .p-float-label label{font-weight:500;color:var(--text-color-secondary)}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field .p-inputnumber, .packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field .p-datepicker, .packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field .p-select, .packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field input[pInputText]{width:100%}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field .p-inputnumber input, .packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field .p-datepicker input, .packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field .p-select input, .packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field input[pInputText] input{width:100%;padding:.75rem 1rem;border-radius:8px;border:1px solid var(--surface-300);font-size:.95rem}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field .p-inputnumber input:focus, .packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field .p-datepicker input:focus, .packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field .p-select input:focus, .packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field input[pInputText] input:focus{border-color:var(--primary-color);box-shadow:0 0 0 .2rem var(--primary-50)}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-content .field small{display:block;margin-top:.5rem;font-size:.85rem;color:var(--text-color-secondary)}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-footer{background:var(--surface-50);border-top:1px solid var(--surface-border);padding:1.25rem 1.5rem;border-radius:0 0 12px 12px}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-footer .p-button{padding:.75rem 1.5rem;font-weight:600;border-radius:8px}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-footer .p-button.p-button-outlined{border-color:var(--surface-300);color:var(--text-color)}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-footer .p-button.p-button-outlined:hover{background:var(--surface-100)}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog .p-dialog-footer .p-button:not(.p-button-outlined){background:linear-gradient(135deg,var(--primary-500) 0%,var(--primary-600) 100%);border-color:var(--primary-600)}.packing-paiement-container   [_nghost-%COMP%]     .p-toast .p-toast-message{border-radius:8px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.packing-paiement-container   [_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-success{background:#66bb6af2;border:1px solid #66bb6a}.packing-paiement-container   [_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-warn{background:#ffb74df2;border:1px solid #ffb74d}.packing-paiement-container   [_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-error{background:#ef5350f2;border:1px solid #ef5350}.packing-paiement-container   [_nghost-%COMP%]     .p-toast .p-toast-message.p-toast-message-info{background:#42a5f5f2;border:1px solid #42a5f5}.packing-paiement-container   [_nghost-%COMP%]     .p-skeleton{background:linear-gradient(90deg,var(--surface-200) 25%,var(--surface-100) 50%,var(--surface-200) 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_skeleton-loading 1.5s ease-in-out infinite}@media (prefers-color-scheme: dark){.packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]:nth-child(1)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-md-6[_ngcontent-%COMP%]:nth-child(1)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-lg-3[_ngcontent-%COMP%]:nth-child(1)   .card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1976d233,#1976d24d)}.packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]:nth-child(2)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-md-6[_ngcontent-%COMP%]:nth-child(2)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-lg-3[_ngcontent-%COMP%]:nth-child(2)   .card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#388e3c33,#388e3c4d)}.packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]:nth-child(3)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-md-6[_ngcontent-%COMP%]:nth-child(3)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-lg-3[_ngcontent-%COMP%]:nth-child(3)   .card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff980033,#ff98004d)}.packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]:nth-child(4)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-md-6[_ngcontent-%COMP%]:nth-child(4)   .card[_ngcontent-%COMP%], .packing-paiement-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .col-lg-3[_ngcontent-%COMP%]:nth-child(4)   .card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d32f2f33,#d32f2f4d)}}@keyframes _ngcontent-%COMP%_skeleton-loading{0%{background-position:200% 0}to{background-position:-200% 0}}@media screen and (max-width: 960px){.packing-paiement-container[_ngcontent-%COMP%]{padding:1rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th{padding:.75rem;font-size:.8rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th:first-child{padding-left:1rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:.75rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td:first-child{padding-left:1rem}.packing-paiement-container   [_nghost-%COMP%]     .p-toolbar{padding:1rem;flex-wrap:wrap;gap:.5rem}}@media screen and (max-width: 640px){.packing-paiement-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th, .packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:.5rem;font-size:.85rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th:first-child, .packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td:first-child{padding-left:.75rem}.packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th:nth-child(3), .packing-paiement-container   [_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td:nth-child(3){display:none}.packing-paiement-container   [_nghost-%COMP%]     .p-dialog{width:95vw!important;margin:.5rem}}"]})};var F={especes:"Esp\xE8ces",virement:"Virement bancaire",cheque:"Ch\xE8que",mobile_money:"Mobile Money"},Ht={impayee:"Impay\xE9e",partielle:"Partiellement pay\xE9e",payee:"Pay\xE9e",annulee:"Annul\xE9e"},Mt={impayee:"danger",partielle:"warn",payee:"success",annulee:"secondary"};var W=class{id;reference;prestataire_id;periode_debut;periode_fin;montant_total;nb_packings;statut;notes;created_by;created_at;updated_at;deleted_at;statut_label;prestataire_nom;montant_verse;montant_restant;prestataire;packings;versements;creator;constructor(t={}){this.id=t.id??0,this.reference=t.reference??"",this.prestataire_id=t.prestataire_id??0,this.periode_debut=t.periode_debut??"",this.periode_fin=t.periode_fin??"",this.montant_total=t.montant_total??0,this.nb_packings=t.nb_packings??0,this.statut=t.statut??"impayee",this.notes=t.notes??null,this.created_by=t.created_by??null,this.created_at=t.created_at??"",this.updated_at=t.updated_at??"",this.deleted_at=t.deleted_at??null,this.statut_label=t.statut_label??Ht[this.statut]??"",this.prestataire_nom=t.prestataire_nom??null,this.montant_verse=t.montant_verse??0,this.montant_restant=t.montant_restant??0,this.prestataire=t.prestataire,this.packings=t.packings,this.versements=t.versements,this.creator=t.creator}},He=class{prestataire_id;prestataire_nom;prestataire_phone;prestataire_type;nb_packings_non_factures;montant_non_facture;nb_factures_en_cours;montant_facture;montant_verse;montant_restant_facture;montant_total_du;statut;constructor(t={}){this.prestataire_id=t.prestataire_id??0,this.prestataire_nom=t.prestataire_nom??"",this.prestataire_phone=t.prestataire_phone??"",this.prestataire_type=t.prestataire_type??"",this.nb_packings_non_factures=t.nb_packings_non_factures??0,this.montant_non_facture=t.montant_non_facture??0,this.nb_factures_en_cours=t.nb_factures_en_cours??0,this.montant_facture=t.montant_facture??0,this.montant_verse=t.montant_verse??0,this.montant_restant_facture=t.montant_restant_facture??0,this.montant_total_du=t.montant_total_du??0,this.statut=this.montant_total_du===0?"solde":this.montant_verse>0?"partiel":"impaye"}},fe=class{periode_debut;periode_fin;nb_prestataires;total_non_facture;total_facture;total_verse;total_restant_facture;montant_global_du;montant_total;prestataires;constructor(t={}){this.periode_debut=t.periode_debut??null,this.periode_fin=t.periode_fin??null,this.nb_prestataires=t.nb_prestataires??0,this.total_non_facture=t.total_non_facture??0,this.total_facture=t.total_facture??0,this.total_verse=t.total_verse??0,this.total_restant_facture=t.total_restant_facture??0,this.montant_global_du=t.montant_global_du??0,this.montant_total=this.total_facture+this.total_non_facture,this.prestataires=(t.prestataires??[]).map(e=>new He(e))}},qe=class{prestataire_id;periode_debut;periode_fin;nb_packings;montant_total;total_rouleaux;packings;constructor(t={}){this.prestataire_id=t.prestataire_id??0,this.periode_debut=t.periode_debut??"",this.periode_fin=t.periode_fin??"",this.nb_packings=t.nb_packings??0,this.montant_total=t.montant_total??0,this.total_rouleaux=t.total_rouleaux??0,this.packings=t.packings??[]}};var R=class a{constructor(t){this.http=t}apiUrl=`${ut.apiUrl}/facture-packings`;getFactures(t){let e=new ye;return t&&(t.prestataire_id&&(e=e.set("prestataire_id",t.prestataire_id.toString())),t.periode_debut&&(e=e.set("periode_debut",t.periode_debut)),t.periode_fin&&(e=e.set("periode_fin",t.periode_fin)),t.statut&&(e=e.set("statut",t.statut)),t.soldee!==void 0&&(e=e.set("soldee",t.soldee.toString())),t.search&&(e=e.set("search",t.search)),t.sort_by&&(e=e.set("sort_by",t.sort_by)),t.sort_order&&(e=e.set("sort_order",t.sort_order)),t.per_page&&(e=e.set("per_page",t.per_page.toString()))),this.http.get(this.apiUrl,{params:e})}getFacture(t){return this.http.get(`${this.apiUrl}/${t}`)}getPreview(t,e,o){let r=new ye().set("prestataire_id",t.toString()).set("periode_debut",e).set("periode_fin",o);return this.http.get(`${this.apiUrl}/preview`,{params:r})}getComptabilite(t){let e=new ye;return t&&(t.periode_debut&&(e=e.set("periode_debut",t.periode_debut)),t.periode_fin&&(e=e.set("periode_fin",t.periode_fin)),t.prestataire_id&&(e=e.set("prestataire_id",t.prestataire_id.toString()))),this.http.get(`${this.apiUrl}/comptabilite`,{params:e})}createFacture(t){return this.http.post(this.apiUrl,t)}deleteFacture(t){return this.http.delete(`${this.apiUrl}/${t}`)}getVersements(t){return this.http.get(`${this.apiUrl}/${t}/versements`)}createVersement(t,e){return this.http.post(`${this.apiUrl}/${t}/versements`,e)}deleteVersement(t,e){return this.http.delete(`${this.apiUrl}/${t}/versements/${e}`)}static \u0275fac=function(e){return new(e||a)(Ke(at))};static \u0275prov=Ge({token:a,factory:a.\u0275fac,providedIn:"root"})};var Ne=class a{constructor(t){this.paiementService=t}summary=null;ngOnInit(){this.loadStats()}loadStats(){this.paiementService.getComptabilite().subscribe({next:t=>{this.summary=new fe(t.data)}})}formatCurrency(t){return new Intl.NumberFormat("fr-FR",{style:"decimal",minimumFractionDigits:0}).format(t)+" GNF"}static \u0275fac=function(e){return new(e||a)(k(R))};static \u0275cmp=D({type:a,selectors:[["app-stats-comptabilite-packing-widget"]],hostVars:2,hostBindings:function(e,o){e&2&&Je("display","contents")},decls:29,vars:4,consts:[[1,"col-span-12","md:col-span-6","xl:col-span-3"],[1,"card","relative","overflow-hidden","h-40"],["id","visual","viewBox","0 0 900 600","xmlns","http://www.w3.org/2000/svg","xmlnsXlink","http://www.w3.org/1999/xlink","version","1.1","preserveAspectRatio","none",1,"absolute","left-0","top-0","h-full","w-full"],["x","0","y","0","width","900","height","600","fill","var(--p-primary-600)"],["d","M0 400L30 386.5C60 373 120 346 180 334.8C240 323.7 300 328.3 360 345.2C420 362 480 391 540 392C600 393 660 366 720 355.2C780 344.3 840 349.7 870 352.3L900 355L900 601L870 601C840 601 780 601 720 601C660 601 600 601 540 601C480 601 420 601 360 601C300 601 240 601 180 601C120 601 60 601 30 601L0 601Z","fill","var(--p-primary-500)","strokeLinecap","round","strokeLinejoin","miter"],[1,"z-20","relative","text-white"],[1,"text-xl","font-semibold","mb-4"],[1,"text-2xl","mb-8","font-bold"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-surface-900","dark:text-surface-0","text-xl","font-semibold"],[1,"text-2xl","text-green-600","mb-8","font-bold"],[1,"card","relative","overflow-hidden","h-40","flex","flex-col","items-center","justify-center"],[1,"text-surface-900","dark:text-surface-0","text-lg","mb-6","font-medium"],[1,"text-2xl","text-orange-500","font-bold"],[1,"text-2xl","text-primary","font-bold"]],template:function(e,o){e&1&&(T(0,"div",0)(1,"div",1),Qe(),T(2,"svg",2),Ze(3,"rect",3)(4,"path",4),I(),Ye(),T(5,"div",5)(6,"div",6),l(7,"Montant Total"),I(),T(8,"div",7),l(9),I()()()(),T(10,"div",0)(11,"div",1)(12,"div",8)(13,"div",9),l(14,"Total pay\xE9"),I()(),T(15,"div",10),l(16),I()()(),T(17,"div",0)(18,"div",11)(19,"span",12),l(20,"Reste \xE0 payer"),I(),T(21,"span",13),l(22),I()()(),T(23,"div",0)(24,"div",11)(25,"span",12),l(26,"Prestataires"),I(),T(27,"span",14),l(28),I()()()),e&2&&(s(9),g(o.summary?o.formatCurrency(o.summary.montant_total):"..."),s(7),g(o.summary?o.formatCurrency(o.summary.total_verse):"..."),s(6),g(o.summary?o.formatCurrency(o.summary.montant_global_du):"..."),s(6),g(o.summary?o.summary.nb_prestataires:"..."))},dependencies:[O],encapsulation:2})};var Qt=["dt"],Yt=()=>({"min-width":"90rem"}),Xt=()=>[10,20,30],Zt=()=>({width:"850px"}),Jt=()=>({width:"550px"}),$t=()=>({width:"750px"}),ei=()=>({width:"450px"});function ti(a,t){if(a&1){let e=v();n(0,"div",14)(1,"div")(2,"label",15),l(3,"P\xE9riode d\xE9but"),i(),n(4,"p-datepicker",16),y("ngModelChange",function(r){d(e);let c=m();return P(c.filtrePeriodeDebut,r)||(c.filtrePeriodeDebut=r),u(r)}),i()(),n(5,"div")(6,"label",15),l(7,"P\xE9riode fin"),i(),n(8,"p-datepicker",17),y("ngModelChange",function(r){d(e);let c=m();return P(c.filtrePeriodeFin,r)||(c.filtrePeriodeFin=r),u(r)}),i()(),n(9,"div")(10,"label",15),l(11,"Statut"),i(),n(12,"p-select",18),y("ngModelChange",function(r){d(e);let c=m();return P(c.filtreStatut,r)||(c.filtreStatut=r),u(r)}),b("onChange",function(){d(e);let r=m();return u(r.applyStatutFilter())}),i()(),n(13,"div",19)(14,"p-button",20),b("onClick",function(){d(e);let r=m();return u(r.loadComptabilite())}),i()()()}if(a&2){let e=m();s(4),C("ngModel",e.filtrePeriodeDebut),p("showIcon",!0),s(4),C("ngModel",e.filtrePeriodeFin),p("showIcon",!0),s(4),C("ngModel",e.filtreStatut),p("options",e.statutOptions)}}function ii(a,t){if(a&1){let e=v();n(0,"p-button",21),b("onClick",function(){d(e);let r=m();return u(r.exportCSV())}),i()}}function ni(a,t){if(a&1){let e=v();n(0,"div",22)(1,"h5",23),l(2,"Comptabilit\xE9 Packings - R\xE9capitulatif par prestataire"),i(),n(3,"p-iconfield"),_(4,"p-inputicon",24),n(5,"input",25),b("input",function(r){d(e);let c=m(),h=q(8);return u(c.onGlobalFilter(h,r))}),i()()()}}function ai(a,t){a&1&&(n(0,"tr")(1,"th",26),_(2,"p-tableHeaderCheckbox"),i(),n(3,"th",27)(4,"span",28),l(5,"Prestataire "),_(6,"p-sortIcon",29),i()(),n(7,"th",30),l(8,"T\xE9l\xE9phone"),i(),n(9,"th",31)(10,"span",28),l(11,"Total "),_(12,"p-sortIcon",32),i()(),n(13,"th",33)(14,"span",28),l(15,"Pay\xE9 "),_(16,"p-sortIcon",34),i()(),n(17,"th",35)(18,"span",28),l(19,"Total d\xFB "),_(20,"p-sortIcon",36),i()(),n(21,"th",37)(22,"span",28),l(23,"Statut "),_(24,"p-sortIcon",38),i()(),_(25,"th",30),i())}function ri(a,t){a&1&&_(0,"p-tag",49)}function oi(a,t){a&1&&_(0,"p-tag",50)}function li(a,t){a&1&&_(0,"p-tag",51)}function si(a,t){if(a&1){let e=v();n(0,"p-button",52),b("click",function(){d(e);let r=m().$implicit,c=m();return u(c.openPreview(r))}),i()}a&2&&p("rounded",!0)("outlined",!0)}function ci(a,t){if(a&1){let e=v();n(0,"tr")(1,"td",26),_(2,"p-tableCheckbox",39),i(),n(3,"td")(4,"span",40),l(5),i()(),n(6,"td"),l(7),i(),n(8,"td",41),l(9),i(),n(10,"td",42),l(11),i(),n(12,"td")(13,"span"),l(14),i()(),n(15,"td"),f(16,ri,1,0,"p-tag",43)(17,oi,1,0,"p-tag",44)(18,li,1,0,"p-tag",45),i(),n(19,"td")(20,"p-button",46),b("click",function(){let r=d(e).$implicit,c=m();return u(c.goToDetail(r))}),i(),n(21,"p-button",47),b("click",function(){let r=d(e).$implicit,c=m();return u(c.openVersement(r))}),i(),f(22,si,1,2,"p-button",48),i()()}if(a&2){let e=t.$implicit,o=m();s(2),p("value",e),s(3),g(e.prestataire_nom),s(2),g(e.prestataire_phone),s(2),g(o.formatCurrency(e.montant_facture)),s(2),g(o.formatCurrency(e.montant_verse)),s(2),Pe(e.montant_restant_facture>0?"text-orange-500 font-semibold":""),s(),N(" ",o.formatCurrency(e.montant_restant_facture)," "),s(2),p("ngIf",e.statut==="impaye"),s(),p("ngIf",e.statut==="partiel"),s(),p("ngIf",e.statut==="solde"),s(2),p("rounded",!0)("outlined",!0),s(),p("rounded",!0)("outlined",!0),s(),p("ngIf",e.nb_packings_non_factures>0)}}function mi(a,t){a&1&&(n(0,"tr")(1,"th"),l(2,"R\xE9f\xE9rence"),i(),n(3,"th"),l(4,"D\xE9but"),i(),n(5,"th"),l(6,"Fin"),i(),n(7,"th"),l(8,"Rouleaux"),i(),n(9,"th"),l(10,"Montant"),i()())}function pi(a,t){if(a&1&&(n(0,"tr")(1,"td"),l(2),i(),n(3,"td"),l(4),i(),n(5,"td"),l(6),i(),n(7,"td"),l(8),i(),n(9,"td",57),l(10),i()()),a&2){let e=t.$implicit,o=m(3);s(2),g(e.reference),s(2),g(o.formatDateDisplay(e.date_debut)),s(2),g(o.formatDateDisplay(e.date_fin)),s(2),g(e.nb_rouleaux),s(2),g(o.formatCurrency(e.montant))}}function di(a,t){if(a&1&&(n(0,"div",55)(1,"div",56)(2,"div")(3,"span",57),l(4),i(),l(5," packing(s) - "),n(6,"span",57),l(7),i(),l(8," rouleaux "),i(),n(9,"div",58),l(10),i()(),n(11,"p-table",59),f(12,mi,11,0,"ng-template",null,4,x)(14,pi,11,5,"ng-template",null,5,x),i()()),a&2){let e=m(2);s(4),g(e.previewData.nb_packings),s(3),g(e.previewData.total_rouleaux),s(3),g(e.formatCurrency(e.previewData.montant_total)),s(),p("value",e.previewData.packings)("rows",10)("paginator",e.previewData.packings.length>10)("rowHover",!0)}}function ui(a,t){a&1&&(n(0,"div",60),_(1,"i",61),i())}function gi(a,t){if(a&1&&f(0,di,16,7,"div",53)(1,ui,2,0,"div",54),a&2){let e=m();p("ngIf",e.previewData),s(),p("ngIf",e.previewLoading)}}function _i(a,t){if(a&1){let e=v();n(0,"p-button",64),b("click",function(){d(e);let r=m(2);return r.previewDialog=!1,u(r.openVersement(r.selectedItem))}),i()}}function fi(a,t){if(a&1){let e=v();n(0,"p-button",62),b("click",function(){d(e);let r=m();return u(r.previewDialog=!1)}),i(),f(1,_i,1,0,"p-button",63)}if(a&2){let e=m();s(),p("ngIf",e.selectedItem)}}function bi(a,t){if(a&1&&_(0,"p-tag",71),a&2){let e=m(3);p("value",e.selectedItem.prestataire_type)}}function hi(a,t){a&1&&(n(0,"div",72),_(1,"i",73),i())}function vi(a,t){if(a&1){let e=v();n(0,"div",74)(1,"p",75),l(2),i(),n(3,"p-button",76),b("click",function(){d(e);let r=m(3);return u(r.facturerNonFactures())}),i()()}if(a&2){let e=m(3);s(2),N("",e.selectedItem.nb_packings_non_factures," packing(s) \xE0 facturer avant de payer"),s(),p("loading",e.facturerLoading)}}function xi(a,t){if(a&1){let e=v();n(0,"div",94)(1,"span",95),l(2),i(),n(3,"p-button",96),b("click",function(){d(e);let r=m(4);return u(r.facturerNonFactures())}),i()()}if(a&2){let e=m(4);s(2),N("",e.selectedItem.nb_packings_non_factures," packing(s) non factur\xE9(s)"),s(),p("outlined",!0)("loading",e.facturerLoading)}}function Ci(a,t){if(a&1){let e=v();n(0,"div",97)(1,"label",89),l(2,"Facture"),i(),n(3,"p-select",98),y("ngModelChange",function(r){d(e);let c=m(4);return P(c.selectedFacture,r)||(c.selectedFacture=r),u(r)}),b("onChange",function(){d(e);let r=m(4);return u(r.onFactureChange())}),i()()}if(a&2){let e=m(4);s(3),C("ngModel",e.selectedFacture),p("options",e.facturesPrestataire)}}function Pi(a,t){if(a&1){let e=v();n(0,"div",28)(1,"p-toggleswitch",99),y("ngModelChange",function(r){d(e);let c=m(4);return P(c.showFacturesPayees,r)||(c.showFacturesPayees=r),u(r)}),b("onChange",function(){d(e);let r=m(4);return u(r.onToggleShowPayees())}),i(),n(2,"label",95),l(3,"Pay\xE9es"),i()()}if(a&2){let e=m(4);s(),C("ngModel",e.showFacturesPayees)}}function yi(a,t){a&1&&(n(0,"small",100),l(1,"Requis."),i())}function ki(a,t){if(a&1){let e=v();n(0,"div"),f(1,xi,4,3,"div",77),n(2,"div",78),f(3,Ci,4,2,"div",79)(4,Pi,4,1,"div",80),i(),n(5,"div",81)(6,"div",82)(7,"span",83),l(8),i(),_(9,"p-tag",84),i(),n(10,"div",85)(11,"div")(12,"span",86),l(13,"Total facture"),i(),n(14,"div",57),l(15),i()(),n(16,"div")(17,"span",86),l(18,"Vers\xE9"),i(),n(19,"div",87),l(20),i()(),n(21,"div")(22,"span",86),l(23,"Restant"),i(),n(24,"div",88),l(25),i()()()(),n(26,"div",55)(27,"div")(28,"label",89),l(29,"Montant \xE0 verser"),i(),n(30,"p-inputnumber",90),y("ngModelChange",function(r){d(e);let c=m(3);return P(c.versementData.montant,r)||(c.versementData.montant=r),u(r)}),i(),f(31,yi,2,0,"small",91),i(),n(32,"div")(33,"label",89),l(34,"Mode de paiement"),i(),n(35,"p-select",92),y("ngModelChange",function(r){d(e);let c=m(3);return P(c.versementData.mode_paiement,r)||(c.versementData.mode_paiement=r),u(r)}),i()(),n(36,"div")(37,"label",89),l(38,"Notes"),i(),n(39,"textarea",93),y("ngModelChange",function(r){d(e);let c=m(3);return P(c.versementData.notes,r)||(c.versementData.notes=r),u(r)}),i()()()()}if(a&2){let e=m(3);s(),p("ngIf",e.selectedItem.nb_packings_non_factures>0),s(2),p("ngIf",e.facturesPrestataire.length>1),s(),p("ngIf",e.allFacturesPrestataire.length>e.facturesPrestataire.length||e.showFacturesPayees),s(4),g(e.selectedFacture.reference),s(),p("value",e.selectedFacture.statut_label)("severity",e.selectedFacture.statut==="payee"?"success":e.selectedFacture.statut==="impayee"?"danger":"warn"),s(6),g(e.formatCurrency(e.selectedFacture.montant_total)),s(5),g(e.formatCurrency(e.selectedFacture.montant_verse)),s(5),g(e.formatCurrency(e.selectedFacture.montant_restant)),s(5),C("ngModel",e.versementData.montant),p("min",1)("max",e.selectedFacture.montant_restant)("useGrouping",!0),s(),p("ngIf",e.versementSubmitted&&!e.versementData.montant),s(4),C("ngModel",e.versementData.mode_paiement),p("options",e.modesPaiement),s(4),C("ngModel",e.versementData.notes)}}function Si(a,t){a&1&&(n(0,"div",101),l(1," Aucun paiement en cours. "),i())}function wi(a,t){if(a&1&&(n(0,"div",55)(1,"div",22)(2,"span",65),l(3),i(),f(4,bi,1,1,"p-tag",66),i(),f(5,hi,2,0,"div",67)(6,vi,4,2,"div",68)(7,ki,40,17,"div",69)(8,Si,2,0,"div",70),i()),a&2){let e=m(2);s(3),g(e.selectedItem.prestataire_nom),s(),p("ngIf",e.selectedItem.prestataire_type),s(),p("ngIf",e.versementLoading),s(),p("ngIf",!e.versementLoading&&e.facturesPrestataire.length===0&&e.selectedItem.nb_packings_non_factures>0),s(),p("ngIf",!e.versementLoading&&e.selectedFacture),s(),p("ngIf",!e.versementLoading&&e.facturesPrestataire.length===0&&e.selectedItem.nb_packings_non_factures===0)}}function Mi(a,t){if(a&1&&f(0,wi,9,6,"div",53),a&2){let e=m();p("ngIf",e.selectedItem)}}function Ei(a,t){if(a&1){let e=v();n(0,"p-button",102),b("click",function(){d(e);let r=m();return u(r.hideVersementDialog())}),i(),n(1,"p-button",103),b("click",function(){d(e);let r=m();return u(r.saveVersement())}),i()}if(a&2){let e=m();p("disabled",e.versementSaving),s(),p("disabled",e.versementSaving||!e.selectedFacture)("loading",e.versementSaving)}}function Ti(a,t){a&1&&(n(0,"div",60),_(1,"i",61),i())}function Di(a,t){a&1&&(n(0,"tr")(1,"th"),l(2,"Date"),i(),n(3,"th"),l(4,"Montant"),i(),n(5,"th"),l(6,"Mode"),i(),n(7,"th"),l(8,"Notes"),i(),_(9,"th"),i())}function Ii(a,t){if(a&1){let e=v();n(0,"tr")(1,"td"),l(2),i(),n(3,"td",110),l(4),i(),n(5,"td"),l(6),i(),n(7,"td"),l(8),i(),n(9,"td")(10,"p-button",111),b("click",function(){let r=d(e).$implicit,c=m(4);return u(c.confirmDeleteVersement(c.historiqueData.facture_id,r))}),i()()()}if(a&2){let e=t.$implicit,o=m(4);s(2),g(o.formatDateDisplay(e.date_versement)),s(2),g(o.formatCurrency(e.montant)),s(2),g(e.mode_paiement_label),s(2),g(e.notes||"-"),s(2),p("rounded",!0)("outlined",!0)("text",!0)}}function Oi(a,t){if(a&1&&(n(0,"p-table",109),f(1,Di,10,0,"ng-template",null,4,x)(3,Ii,11,7,"ng-template",null,5,x),i()),a&2){let e=m(3);p("value",e.historiqueData.versements)("rowHover",!0)}}function Fi(a,t){a&1&&(n(0,"div",101),l(1," Aucun versement enregistr\xE9. "),i())}function Vi(a,t){if(a&1&&(n(0,"div",55)(1,"div",104)(2,"div",105)(3,"span",65),l(4),i(),_(5,"p-tag",84),i(),n(6,"div",106)(7,"div",107)(8,"span",83),l(9,"Montant total"),i(),n(10,"div",57),l(11),i()(),n(12,"div",107)(13,"span",83),l(14,"Vers\xE9"),i(),n(15,"div",87),l(16),i()(),n(17,"div",107)(18,"span",83),l(19,"Restant"),i(),n(20,"div",88),l(21),i()()()(),f(22,Oi,5,2,"p-table",108)(23,Fi,2,0,"div",70),i()),a&2){let e=m(2);s(4),g(e.historiqueData.reference),s(),p("value",e.historiqueData.is_soldee?"Sold\xE9":"En cours")("severity",e.historiqueData.is_soldee?"success":"warn"),s(6),g(e.formatCurrency(e.historiqueData.montant_total)),s(5),g(e.formatCurrency(e.historiqueData.montant_verse)),s(5),g(e.formatCurrency(e.historiqueData.montant_restant)),s(),p("ngIf",e.historiqueData.versements.length>0),s(),p("ngIf",e.historiqueData.versements.length===0)}}function Ri(a,t){if(a&1&&f(0,Ti,2,0,"div",54)(1,Vi,24,8,"div",53),a&2){let e=m();p("ngIf",e.historiqueLoading),s(),p("ngIf",e.historiqueData)}}function Wi(a,t){if(a&1){let e=v();n(0,"p-button",62),b("click",function(){d(e);let r=m();return u(r.historiqueDialog=!1)}),i()}}var Ae=class a{constructor(t,e,o,r){this.router=t;this.factureService=e;this.messageService=o;this.confirmationService=r}dataChanged=new Xe;filterFields=["prestataire_nom","prestataire_phone","montant_total_du"];prestataires=L([]);selectedPrestataires=null;comptaSummary=null;loading=!1;filtrePeriodeDebut=null;filtrePeriodeFin=null;filtreStatut=null;statutOptions=[{label:"Tous",value:null},{label:"Impay\xE9",value:"impaye"},{label:"Partiel",value:"partiel"},{label:"Sold\xE9",value:"solde"}];selectedItem=null;modesPaiement=[{label:F.especes,value:"especes"},{label:F.virement,value:"virement"},{label:F.cheque,value:"cheque"},{label:F.mobile_money,value:"mobile_money"}];previewDialog=!1;previewData=null;previewLoading=!1;versementDialog=!1;facturerLoading=!1;allFacturesPrestataire=[];facturesPrestataire=[];showFacturesPayees=!1;selectedFacture=null;versementData={montant:null,date_versement:null,mode_paiement:"especes",notes:""};versementLoading=!1;versementSaving=!1;versementSubmitted=!1;historiqueDialog=!1;historiqueData=null;historiqueLoading=!1;dt;exportColumns;cols;ngOnInit(){this.loadComptabilite(),this.initColumns()}initColumns(){this.cols=[{field:"prestataire_nom",header:"Prestataire"},{field:"prestataire_phone",header:"T\xE9l\xE9phone"},{field:"nb_packings_non_factures",header:"Non factur\xE9s"},{field:"montant_non_facture",header:"Mnt non factur\xE9"},{field:"montant_facture",header:"Factur\xE9"},{field:"montant_verse",header:"Vers\xE9"},{field:"montant_restant_facture",header:"Reste facture"},{field:"montant_total_du",header:"Total d\xFB"}],this.exportColumns=this.cols.map(t=>({title:t.header,dataKey:t.field}))}loadComptabilite(){this.loading=!0;let t={};this.filtrePeriodeDebut&&(t.periode_debut=this.formatDate(this.filtrePeriodeDebut)),this.filtrePeriodeFin&&(t.periode_fin=this.formatDate(this.filtrePeriodeFin)),this.factureService.getComptabilite(t).subscribe({next:e=>{this.comptaSummary=new fe(e.data),this.applyStatutFilter(),this.loading=!1,this.dataChanged.emit()},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger la comptabilit\xE9",life:3e3}),this.loading=!1}})}applyStatutFilter(){this.comptaSummary&&(this.filtreStatut?this.prestataires.set(this.comptaSummary.prestataires.filter(t=>t.statut===this.filtreStatut)):this.prestataires.set(this.comptaSummary.prestataires))}exportCSV(){this.dt.exportCSV()}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}openPreview(t){let e=this.filtrePeriodeDebut?this.formatDate(this.filtrePeriodeDebut):"2000-01-01",o=this.filtrePeriodeFin?this.formatDate(this.filtrePeriodeFin):"2099-12-31";this.selectedItem=t,this.previewDialog=!0,this.previewLoading=!0,this.previewData=null,this.factureService.getPreview(t.prestataire_id,e,o).subscribe({next:r=>{this.previewData=new qe(r.data),this.previewLoading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger la pr\xE9visualisation",life:3e3}),this.previewLoading=!1,this.previewDialog=!1}})}facturerNonFactures(){if(!this.selectedItem||this.facturerLoading)return;this.facturerLoading=!0;let t=this.filtrePeriodeDebut?this.formatDate(this.filtrePeriodeDebut):"2000-01-01",e=this.filtrePeriodeFin?this.formatDate(this.filtrePeriodeFin):"2099-12-31",o={prestataire_id:this.selectedItem.prestataire_id,periode_debut:t,periode_fin:e};this.factureService.createFacture(o).subscribe({next:r=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`Facture ${r.data.reference} cr\xE9\xE9e`,life:3e3}),this.facturerLoading=!1,this.selectedItem&&(this.selectedItem.nb_packings_non_factures=0,this.selectedItem.montant_non_facture=0),this.reloadFacturesInDialog(),this.loadComptabilite()},error:r=>{let c=r?.error?.message||"Impossible de cr\xE9er la facture";this.messageService.add({severity:"error",summary:"Erreur",detail:c,life:5e3}),this.facturerLoading=!1}})}reloadFacturesInDialog(){this.selectedItem&&this.factureService.getFactures({prestataire_id:this.selectedItem.prestataire_id}).subscribe({next:t=>{this.allFacturesPrestataire=(t.data||[]).map(e=>new W(e)),this.applyFacturesFilter(),this.facturesPrestataire.length>0&&(this.selectedFacture=this.facturesPrestataire[0])}})}applyFacturesFilter(){this.showFacturesPayees?this.facturesPrestataire=[...this.allFacturesPrestataire]:this.facturesPrestataire=this.allFacturesPrestataire.filter(t=>t.statut==="impayee"||t.statut==="partielle")}onToggleShowPayees(){let t=this.selectedFacture;this.applyFacturesFilter(),t&&this.facturesPrestataire.find(e=>e.id===t.id)?this.selectedFacture=this.facturesPrestataire.find(e=>e.id===t.id):this.facturesPrestataire.length>0?(this.selectedFacture=this.facturesPrestataire[0],this.onFactureChange()):this.selectedFacture=null}openVersement(t){this.selectedItem=t,this.selectedFacture=null,this.versementDialog=!0,this.versementLoading=!0,this.versementSubmitted=!1,this.showFacturesPayees=!1,this.allFacturesPrestataire=[],this.facturesPrestataire=[],this.resetVersementForm(),this.factureService.getFactures({prestataire_id:t.prestataire_id}).subscribe({next:e=>{this.allFacturesPrestataire=(e.data||[]).map(o=>new W(o)),this.applyFacturesFilter(),this.facturesPrestataire.length>0&&(this.selectedFacture=this.facturesPrestataire[0],this.versementData.montant=this.selectedFacture.montant_restant),this.versementLoading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger les factures",life:3e3}),this.versementLoading=!1,this.versementDialog=!1}})}resetVersementForm(){this.versementData={montant:null,date_versement:new Date,mode_paiement:"especes",notes:""},this.versementSubmitted=!1}onFactureChange(){this.selectedFacture&&(this.versementData.montant=this.selectedFacture.montant_restant)}hideVersementDialog(){this.versementDialog=!1,this.selectedFacture=null,this.versementSubmitted=!1}saveVersement(){if(this.versementSubmitted=!0,!this.selectedFacture||!this.versementData.montant||!this.versementData.date_versement||this.versementSaving)return;this.versementSaving=!0;let t={montant:this.versementData.montant,date_versement:this.formatDate(this.versementData.date_versement),mode_paiement:this.versementData.mode_paiement,notes:this.versementData.notes||void 0};this.factureService.createVersement(this.selectedFacture.id,t).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`Versement de ${this.formatCurrency(t.montant)} enregistr\xE9`,life:3e3}),this.versementSaving=!1,this.versementDialog=!1,this.loadComptabilite()},error:e=>{let o=e?.error?.message||"Impossible d'enregistrer le versement";this.messageService.add({severity:"error",summary:"Erreur",detail:o,life:5e3}),this.versementSaving=!1}})}openHistorique(t){this.historiqueDialog=!0,this.historiqueLoading=!0,this.historiqueData=null,this.factureService.getVersements(t.id).subscribe({next:e=>{this.historiqueData=e.data,this.historiqueLoading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger les versements",life:3e3}),this.historiqueLoading=!1,this.historiqueDialog=!1}})}confirmDeleteVersement(t,e){this.confirmationService.confirm({message:`Supprimer le versement de ${this.formatCurrency(e.montant)} ?`,header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptLabel:"Supprimer",rejectLabel:"Annuler",accept:()=>{this.factureService.deleteVersement(t,e.id).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Versement supprim\xE9",life:3e3}),this.historiqueData&&this.openHistorique({id:t}),this.loadComptabilite()},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de supprimer le versement",life:3e3})}})}})}formatDate(t){return t?typeof t=="string"?t:new Date(t).toISOString().split("T")[0]:""}formatCurrency(t){return new Intl.NumberFormat("fr-FR",{style:"decimal",minimumFractionDigits:0}).format(t)+" GNF"}formatDateDisplay(t){return t?new Date(t).toLocaleDateString("fr-FR"):""}goToDetail(t){this.router.navigate(["/comptabilite/comptabilite-packing-detail"],{queryParams:{prestataire_id:t.prestataire_id,prestataire_nom:t.prestataire_nom}})}static \u0275fac=function(e){return new(e||a)(k(ke),k(R),k(M),k(w))};static \u0275cmp=D({type:a,selectors:[["app-comptabilite-packing-tableau"]],viewQuery:function(e,o){if(e&1&&ve(Qt,5),e&2){let r;xe(r=Ce())&&(o.dt=r.first)}},outputs:{dataChanged:"dataChanged"},features:[V([M,w])],decls:31,vars:31,consts:[["start",""],["end",""],["dt",""],["caption",""],["header",""],["body",""],["content",""],["footer",""],[1,"card"],["styleClass","mb-12"],["dataKey","prestataire_id","currentPageReportTemplate","  {first} \xE0 {last} sur {totalRecords} prestataires",3,"selectionChange","value","rows","columns","paginator","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions","loading"],["header","Pr\xE9visualisation des packings",3,"visibleChange","visible","modal"],["header","Payer",3,"visibleChange","visible","modal"],["header","Historique des versements",3,"visibleChange","visible","modal"],[1,"flex","items-center","gap-4"],[1,"block","text-sm","font-medium","mb-1"],["dateFormat","dd/mm/yy","placeholder","D\xE9but","inputStyleClass","w-full","styleClass","w-48",3,"ngModelChange","ngModel","showIcon"],["dateFormat","dd/mm/yy","placeholder","Fin","inputStyleClass","w-full","styleClass","w-48",3,"ngModelChange","ngModel","showIcon"],["optionLabel","label","optionValue","value","placeholder","Tous","styleClass","w-40",3,"ngModelChange","onChange","ngModel","options"],[1,"flex","items-end","h-full","pt-5"],["label","Filtrer","icon","pi pi-filter","severity","secondary",3,"onClick"],["label","Export","icon","pi pi-download","severity","secondary",3,"onClick"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Rechercher...",3,"input"],[2,"width","3rem"],["pSortableColumn","prestataire_nom",2,"min-width","14rem"],[1,"flex","items-center","gap-2"],["field","prestataire_nom"],[2,"min-width","10rem"],["pSortableColumn","montant_non_facture",2,"min-width","10rem"],["field","montant_non_facture"],["pSortableColumn","montant_facture",2,"min-width","10rem"],["field","montant_facture"],["pSortableColumn","montant_total_du",2,"min-width","12rem"],["field","montant_total_du"],["pSortableColumn","statut",2,"min-width","12rem"],["field","statut"],[3,"value"],[1,"font-semibold"],[1,"font-bold","text-primary","text-lg"],[1,"text-green-600","font-semibold"],["value","Impay\xE9","severity","danger",4,"ngIf"],["value","Partiel","severity","warn",4,"ngIf"],["value","Sold\xE9","severity","success",4,"ngIf"],["icon","pi pi-eye","severity","info","pTooltip","D\xE9tail",1,"mr-2",3,"click","rounded","outlined"],["icon","pi pi-wallet","severity","success","pTooltip","Payer",1,"mr-2",3,"click","rounded","outlined"],["icon","pi pi-file","severity","warn","pTooltip","Facturer",3,"rounded","outlined","click",4,"ngIf"],["value","Impay\xE9","severity","danger"],["value","Partiel","severity","warn"],["value","Sold\xE9","severity","success"],["icon","pi pi-file","severity","warn","pTooltip","Facturer",3,"click","rounded","outlined"],["class","flex flex-col gap-4",4,"ngIf"],["class","flex items-center justify-center p-8",4,"ngIf"],[1,"flex","flex-col","gap-4"],[1,"flex","items-center","justify-between","bg-surface-100","dark:bg-surface-800","rounded-lg","p-4"],[1,"font-bold"],[1,"text-xl","font-bold","text-primary"],[3,"value","rows","paginator","rowHover"],[1,"flex","items-center","justify-center","p-8"],[1,"pi","pi-spin","pi-spinner","text-4xl"],["label","Fermer","icon","pi pi-times","text","",3,"click"],["label","Payer","icon","pi pi-wallet","severity","success",3,"click",4,"ngIf"],["label","Payer","icon","pi pi-wallet","severity","success",3,"click"],[1,"font-bold","text-lg"],["severity","info",3,"value",4,"ngIf"],["class","flex items-center justify-center p-6",4,"ngIf"],["class","text-center p-4",4,"ngIf"],[4,"ngIf"],["class","text-center p-4 text-surface-500",4,"ngIf"],["severity","info",3,"value"],[1,"flex","items-center","justify-center","p-6"],[1,"pi","pi-spin","pi-spinner","text-3xl"],[1,"text-center","p-4"],[1,"mb-4","text-surface-500"],["label","Facturer","icon","pi pi-money-bill","severity","warn",3,"click","loading"],["class","flex items-center justify-between bg-orange-50 dark:bg-orange-900/20 rounded-lg p-3 mb-4",4,"ngIf"],[1,"flex","items-center","justify-between","mb-4"],["class","flex-1 mr-4",4,"ngIf"],["class","flex items-center gap-2",4,"ngIf"],[1,"bg-surface-100","dark:bg-surface-800","rounded-lg","p-3","mb-4"],[1,"flex","items-center","justify-between","mb-1"],[1,"text-sm","text-surface-500"],[3,"value","severity"],[1,"grid","grid-cols-3","gap-2","mt-2"],[1,"text-xs","text-surface-500"],[1,"font-bold","text-green-600"],[1,"font-bold","text-orange-500"],[1,"block","font-bold","mb-2"],["suffix"," GNF","locale","fr-FR","inputStyleClass","w-full","styleClass","w-full",3,"ngModelChange","ngModel","min","max","useGrouping"],["class","text-red-500",4,"ngIf"],["optionLabel","label","optionValue","value","styleClass","w-full",3,"ngModelChange","ngModel","options"],["pTextarea","","rows","2",1,"w-full",3,"ngModelChange","ngModel"],[1,"flex","items-center","justify-between","bg-orange-50","dark:bg-orange-900/20","rounded-lg","p-3","mb-4"],[1,"text-sm"],["label","Facturer","size","small","severity","warn",3,"click","outlined","loading"],[1,"flex-1","mr-4"],["optionLabel","reference","placeholder","S\xE9lectionner","styleClass","w-full",3,"ngModelChange","onChange","ngModel","options"],[3,"ngModelChange","onChange","ngModel"],[1,"text-red-500"],[1,"text-center","p-4","text-surface-500"],["label","Annuler","icon","pi pi-times","text","",3,"click","disabled"],["label","Payer","icon","pi pi-check","severity","success",3,"click","disabled","loading"],[1,"bg-surface-100","dark:bg-surface-800","rounded-lg","p-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"grid","grid-cols-12","gap-4"],[1,"col-span-4"],[3,"value","rowHover",4,"ngIf"],[3,"value","rowHover"],[1,"text-green-600","font-bold"],["icon","pi pi-trash","severity","danger","pTooltip","Supprimer",3,"click","rounded","outlined","text"]],template:function(e,o){if(e&1){let r=v();_(0,"p-toast"),n(1,"div",8)(2,"p-toolbar",9),f(3,ti,15,6,"ng-template",null,0,x)(5,ii,1,0,"ng-template",null,1,x),i(),n(7,"p-table",10,2),y("selectionChange",function(h){return d(r),P(o.selectedPrestataires,h)||(o.selectedPrestataires=h),u(h)}),f(9,ni,6,0,"ng-template",null,3,x)(11,ai,26,0,"ng-template",null,4,x)(13,ci,23,16,"ng-template",null,5,x),i()(),n(15,"p-dialog",11),y("visibleChange",function(h){return d(r),P(o.previewDialog,h)||(o.previewDialog=h),u(h)}),f(16,gi,2,2,"ng-template",null,6,x)(18,fi,2,1,"ng-template",null,7,x),i(),n(20,"p-dialog",12),y("visibleChange",function(h){return d(r),P(o.versementDialog,h)||(o.versementDialog=h),u(h)}),f(21,Mi,1,1,"ng-template",null,6,x)(23,Ei,2,3,"ng-template",null,7,x),i(),n(25,"p-dialog",13),y("visibleChange",function(h){return d(r),P(o.historiqueDialog,h)||(o.historiqueDialog=h),u(h)}),f(26,Ri,2,2,"ng-template",null,6,x)(28,Wi,1,0,"ng-template",null,7,x),i(),_(30,"p-confirmdialog")}e&2&&(s(7),p("value",o.prestataires())("rows",10)("columns",o.cols)("paginator",!0)("globalFilterFields",o.filterFields)("tableStyle",S(25,Yt)),C("selection",o.selectedPrestataires),p("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",S(26,Xt))("loading",o.loading),s(8),E(S(27,Zt)),C("visible",o.previewDialog),p("modal",!0),s(5),E(S(28,Jt)),C("visible",o.versementDialog),p("modal",!0),s(5),E(S(29,$t)),C("visible",o.historiqueDialog),p("modal",!0),s(5),E(S(30,ei)))},dependencies:[O,A,ae,te,ie,ne,Oe,Fe,U,B,j,H,Q,K,G,le,Re,ce,se,z,Se,ee,$,ue,de,oe,re,X,Me,Y,we,_e,ge,Ie,De,pe,me,Te,Ee,J,Z,st,lt],encapsulation:2})};var he=class a{ngOnInit(){}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=D({type:a,selectors:[["app-comptabilite-packing-liste"]],features:[V([M,w,Ve])],decls:4,vars:0,consts:[["statsWidget",""],[1,"grid","grid-cols-12","gap-8","mb-8"],[3,"dataChanged"]],template:function(e,o){if(e&1){let r=v();n(0,"div",1),_(1,"app-stats-comptabilite-packing-widget",null,0),i(),n(3,"app-comptabilite-packing-tableau",2),b("dataChanged",function(){d(r);let h=q(2);return u(h.loadStats())}),i()}},dependencies:[O,Ne,Ae],encapsulation:2})};var Li=()=>[10,20,30],qi=()=>({width:"500px"}),Ni=()=>({width:"750px"}),Ai=()=>({width:"450px"});function Bi(a,t){if(a&1){let e=v();n(0,"div",19)(1,"p-button",20),b("click",function(){d(e);let r=m();return u(r.goBack())}),i(),n(2,"div")(3,"h4",21),l(4),i(),n(5,"span",22),l(6,"D\xE9tail des factures"),i()()()}if(a&2){let e=m();s(),p("rounded",!0)("outlined",!0),s(3),g(e.prestataireNom)}}function ji(a,t){a&1&&(n(0,"div",23)(1,"h5",24),l(2,"Factures"),i()())}function Hi(a,t){a&1&&(n(0,"tr")(1,"th",25)(2,"span",26),l(3,"R\xE9f\xE9rence "),_(4,"p-sortIcon",27),i()(),n(5,"th",28)(6,"span",26),l(7,"P\xE9riode "),_(8,"p-sortIcon",29),i()(),n(9,"th",30),l(10,"Packings"),i(),n(11,"th",31)(12,"span",26),l(13,"Montant "),_(14,"p-sortIcon",32),i()(),n(15,"th",33)(16,"span",26),l(17,"Vers\xE9 "),_(18,"p-sortIcon",34),i()(),n(19,"th",35),l(20,"Restant"),i(),n(21,"th",36)(22,"span",26),l(23,"Statut "),_(24,"p-sortIcon",37),i()(),_(25,"th",38),i())}function Ui(a,t){if(a&1){let e=v();n(0,"p-button",48),b("click",function(){d(e);let r=m().$implicit,c=m();return u(c.openVersement(r))}),i()}a&2&&p("rounded",!0)("outlined",!0)}function zi(a,t){if(a&1){let e=v();n(0,"p-button",49),b("click",function(){d(e);let r=m().$implicit,c=m();return u(c.confirmDeleteFacture(r))}),i()}a&2&&p("rounded",!0)("outlined",!0)}function Gi(a,t){if(a&1){let e=v();n(0,"tr")(1,"td",39),l(2),i(),n(3,"td")(4,"span",40),l(5),i()(),n(6,"td"),l(7),i(),n(8,"td",41),l(9),i(),n(10,"td",42),l(11),i(),n(12,"td")(13,"span"),l(14),i()(),n(15,"td"),_(16,"p-tag",43),i(),n(17,"td")(18,"div",44),f(19,Ui,1,2,"p-button",45),n(20,"p-button",46),b("click",function(){let r=d(e).$implicit,c=m();return u(c.openHistorique(r))}),i(),f(21,zi,1,2,"p-button",47),i()()()}if(a&2){let e=t.$implicit,o=m();s(2),g(e.reference),s(3),et("",o.formatDateDisplay(e.periode_debut)," - ",o.formatDateDisplay(e.periode_fin)),s(2),g(e.nb_packings),s(2),g(o.formatCurrency(e.montant_total)),s(2),g(o.formatCurrency(e.montant_verse)),s(2),Pe(e.montant_restant>0?"text-orange-500 font-semibold":"text-green-600"),s(),N(" ",o.formatCurrency(e.montant_restant)," "),s(2),p("value",e.statut_label)("severity",o.getStatutSeverity(e.statut)),s(3),p("ngIf",e.statut!=="payee"),s(),p("rounded",!0)("outlined",!0),s(),p("ngIf",e.montant_verse===0)}}function Ki(a,t){a&1&&(n(0,"tr")(1,"td",50),l(2," Aucune facture pour ce prestataire. "),i()())}function Qi(a,t){a&1&&(n(0,"small",65),l(1,"Montant requis."),i())}function Yi(a,t){a&1&&(n(0,"small",65),l(1,"Date requise."),i())}function Xi(a,t){if(a&1){let e=v();n(0,"div",52)(1,"div",53)(2,"div",54)(3,"span",41),l(4),i(),_(5,"p-tag",43),i(),n(6,"div",55)(7,"div")(8,"span",56),l(9,"Total"),i(),n(10,"div",41),l(11),i()(),n(12,"div")(13,"span",56),l(14,"Vers\xE9"),i(),n(15,"div",57),l(16),i()(),n(17,"div")(18,"span",56),l(19,"Restant"),i(),n(20,"div",58),l(21),i()()()(),n(22,"div",52)(23,"div")(24,"label",59),l(25,"Montant \xE0 verser"),i(),n(26,"p-inputnumber",60),y("ngModelChange",function(r){d(e);let c=m(2);return P(c.versementData.montant,r)||(c.versementData.montant=r),u(r)}),i(),f(27,Qi,2,0,"small",61),i(),n(28,"div")(29,"label",59),l(30,"Date du versement"),i(),n(31,"p-datepicker",62),y("ngModelChange",function(r){d(e);let c=m(2);return P(c.versementData.date_versement,r)||(c.versementData.date_versement=r),u(r)}),i(),f(32,Yi,2,0,"small",61),i(),n(33,"div")(34,"label",59),l(35,"Mode de paiement"),i(),n(36,"p-select",63),y("ngModelChange",function(r){d(e);let c=m(2);return P(c.versementData.mode_paiement,r)||(c.versementData.mode_paiement=r),u(r)}),i()(),n(37,"div")(38,"label",59),l(39,"Notes"),i(),n(40,"textarea",64),y("ngModelChange",function(r){d(e);let c=m(2);return P(c.versementData.notes,r)||(c.versementData.notes=r),u(r)}),i()()()()}if(a&2){let e=m(2);s(4),g(e.selectedFacture.reference),s(),p("value",e.selectedFacture.statut_label)("severity",e.getStatutSeverity(e.selectedFacture.statut)),s(6),g(e.formatCurrency(e.selectedFacture.montant_total)),s(5),g(e.formatCurrency(e.selectedFacture.montant_verse)),s(5),g(e.formatCurrency(e.selectedFacture.montant_restant)),s(5),C("ngModel",e.versementData.montant),p("min",1)("max",e.selectedFacture.montant_restant)("useGrouping",!0),s(),p("ngIf",e.versementSubmitted&&!e.versementData.montant),s(4),C("ngModel",e.versementData.date_versement),p("showIcon",!0),s(),p("ngIf",e.versementSubmitted&&!e.versementData.date_versement),s(4),C("ngModel",e.versementData.mode_paiement),p("options",e.modesPaiement),s(4),C("ngModel",e.versementData.notes)}}function Zi(a,t){if(a&1&&f(0,Xi,41,17,"div",51),a&2){let e=m();p("ngIf",e.selectedFacture)}}function Ji(a,t){if(a&1){let e=v();n(0,"p-button",66),b("click",function(){d(e);let r=m();return u(r.hideVersementDialog())}),i(),n(1,"p-button",67),b("click",function(){d(e);let r=m();return u(r.saveVersement())}),i()}if(a&2){let e=m();p("disabled",e.versementSaving),s(),p("disabled",e.versementSaving)("loading",e.versementSaving)}}function $i(a,t){a&1&&(n(0,"div",69),_(1,"i",70),i())}function en(a,t){a&1&&(n(0,"tr")(1,"th"),l(2,"Date"),i(),n(3,"th"),l(4,"Montant"),i(),n(5,"th"),l(6,"Mode"),i(),n(7,"th"),l(8,"Notes"),i(),_(9,"th"),i())}function tn(a,t){if(a&1){let e=v();n(0,"tr")(1,"td"),l(2),i(),n(3,"td",78),l(4),i(),n(5,"td"),l(6),i(),n(7,"td"),l(8),i(),n(9,"td")(10,"p-button",79),b("click",function(){let r=d(e).$implicit,c=m(4);return u(c.confirmDeleteVersement(c.historiqueData.facture_id,r))}),i()()()}if(a&2){let e=t.$implicit,o=m(4);s(2),g(o.formatDateDisplay(e.date_versement)),s(2),g(o.formatCurrency(e.montant)),s(2),g(e.mode_paiement_label),s(2),g(e.notes||"-"),s(2),p("rounded",!0)("outlined",!0)("text",!0)}}function nn(a,t){if(a&1&&(n(0,"p-table",77),f(1,en,10,0,"ng-template",null,2,x)(3,tn,11,7,"ng-template",null,3,x),i()),a&2){let e=m(3);p("value",e.historiqueData.versements)("rowHover",!0)}}function an(a,t){a&1&&(n(0,"div",80),l(1," Aucun versement enregistr\xE9. "),i())}function rn(a,t){if(a&1&&(n(0,"div",52)(1,"div",71)(2,"div",72)(3,"span",73),l(4),i(),_(5,"p-tag",43),i(),n(6,"div",74)(7,"div",10)(8,"span",22),l(9,"Montant total"),i(),n(10,"div",41),l(11),i()(),n(12,"div",10)(13,"span",22),l(14,"Vers\xE9"),i(),n(15,"div",57),l(16),i()(),n(17,"div",10)(18,"span",22),l(19,"Restant"),i(),n(20,"div",58),l(21),i()()()(),f(22,nn,5,2,"p-table",75)(23,an,2,0,"div",76),i()),a&2){let e=m(2);s(4),g(e.historiqueData.reference),s(),p("value",e.historiqueData.is_soldee?"Sold\xE9":"En cours")("severity",e.historiqueData.is_soldee?"success":"warn"),s(6),g(e.formatCurrency(e.historiqueData.montant_total)),s(5),g(e.formatCurrency(e.historiqueData.montant_verse)),s(5),g(e.formatCurrency(e.historiqueData.montant_restant)),s(),p("ngIf",e.historiqueData.versements.length>0),s(),p("ngIf",e.historiqueData.versements.length===0)}}function on(a,t){if(a&1&&f(0,$i,2,0,"div",68)(1,rn,24,8,"div",51),a&2){let e=m();p("ngIf",e.historiqueLoading),s(),p("ngIf",e.historiqueData)}}function ln(a,t){if(a&1){let e=v();n(0,"p-button",81),b("click",function(){d(e);let r=m();return u(r.historiqueDialog=!1)}),i()}}var Be=class a{constructor(t,e,o,r,c){this.route=t;this.router=e;this.factureService=o;this.messageService=r;this.confirmationService=c}prestataireId=0;prestataireNom="";factures=L([]);loading=!1;totalFacture=0;totalVerse=0;totalRestant=0;versementDialog=!1;selectedFacture=null;versementData={montant:null,date_versement:new Date,mode_paiement:"especes",notes:""};versementSaving=!1;versementSubmitted=!1;modesPaiement=[{label:F.especes,value:"especes"},{label:F.virement,value:"virement"},{label:F.cheque,value:"cheque"},{label:F.mobile_money,value:"mobile_money"}];historiqueDialog=!1;historiqueData=null;historiqueLoading=!1;ngOnInit(){this.route.queryParams.subscribe(t=>{this.prestataireId=+t.prestataire_id||0,this.prestataireNom=t.prestataire_nom||"",this.prestataireId&&this.loadFactures()})}loadFactures(){this.loading=!0,this.factureService.getFactures({prestataire_id:this.prestataireId}).subscribe({next:t=>{let e=(t.data||[]).map(o=>new W(o));this.factures.set(e),this.calculateTotals(e),this.loading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger les factures",life:3e3}),this.loading=!1}})}calculateTotals(t){this.totalFacture=t.reduce((e,o)=>e+o.montant_total,0),this.totalVerse=t.reduce((e,o)=>e+o.montant_verse,0),this.totalRestant=t.reduce((e,o)=>e+o.montant_restant,0)}openVersement(t){this.selectedFacture=t,this.versementDialog=!0,this.versementSubmitted=!1,this.versementData={montant:t.montant_restant,date_versement:new Date,mode_paiement:"especes",notes:""}}hideVersementDialog(){this.versementDialog=!1,this.selectedFacture=null,this.versementSubmitted=!1}saveVersement(){if(this.versementSubmitted=!0,!this.selectedFacture||!this.versementData.montant||!this.versementData.date_versement||this.versementSaving)return;this.versementSaving=!0;let t={montant:this.versementData.montant,date_versement:this.formatDate(this.versementData.date_versement),mode_paiement:this.versementData.mode_paiement,notes:this.versementData.notes||void 0};this.factureService.createVersement(this.selectedFacture.id,t).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`Versement de ${this.formatCurrency(t.montant)} enregistr\xE9`,life:3e3}),this.versementSaving=!1,this.versementDialog=!1,this.loadFactures()},error:e=>{let o=e?.error?.message||"Impossible d'enregistrer le versement";this.messageService.add({severity:"error",summary:"Erreur",detail:o,life:5e3}),this.versementSaving=!1}})}openHistorique(t){this.historiqueDialog=!0,this.historiqueLoading=!0,this.historiqueData=null,this.factureService.getVersements(t.id).subscribe({next:e=>{this.historiqueData=e.data,this.historiqueLoading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger les versements",life:3e3}),this.historiqueLoading=!1,this.historiqueDialog=!1}})}confirmDeleteVersement(t,e){this.confirmationService.confirm({message:`Supprimer le versement de ${this.formatCurrency(e.montant)} ?`,header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptLabel:"Supprimer",rejectLabel:"Annuler",accept:()=>{this.factureService.deleteVersement(t,e.id).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Versement supprim\xE9",life:3e3}),this.historiqueData&&this.openHistorique({id:t}),this.loadFactures()},error:()=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de supprimer le versement",life:3e3})}})}})}confirmDeleteFacture(t){this.confirmationService.confirm({message:`Supprimer la facture ${t.reference} ?`,header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptLabel:"Supprimer",rejectLabel:"Annuler",accept:()=>{this.factureService.deleteFacture(t.id).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Facture supprim\xE9e",life:3e3}),this.loadFactures()},error:e=>{let o=e?.error?.message||"Impossible de supprimer la facture";this.messageService.add({severity:"error",summary:"Erreur",detail:o,life:5e3})}})}})}getStatutSeverity(t){return Mt[t]??"info"}formatDate(t){return t?typeof t=="string"?t:new Date(t).toISOString().split("T")[0]:""}formatCurrency(t){return new Intl.NumberFormat("fr-FR",{style:"decimal",minimumFractionDigits:0}).format(t)+" GNF"}formatDateDisplay(t){return t?new Date(t).toLocaleDateString("fr-FR"):""}goBack(){this.router.navigate(["/comptabilite/comptabilite-packing-liste"])}static \u0275fac=function(e){return new(e||a)(k(rt),k(ke),k(R),k(M),k(w))};static \u0275cmp=D({type:a,selectors:[["app-comptabilite-packing-detail"]],features:[V([M,w])],decls:44,vars:26,consts:[["start",""],["caption",""],["header",""],["body",""],["emptymessage",""],["content",""],["footer",""],[1,"card"],["styleClass","mb-6"],[1,"grid","grid-cols-12","gap-4","mb-6"],[1,"col-span-4"],[1,"bg-surface-100","dark:bg-surface-800","rounded-lg","p-4","text-center"],[1,"text-sm","text-surface-500","block","mb-1"],[1,"text-xl","font-bold","text-primary"],[1,"text-xl","font-bold","text-green-600"],[1,"text-xl","font-bold"],["dataKey","id","currentPageReportTemplate","  {first} \xE0 {last} sur {totalRecords} factures",3,"value","rows","paginator","rowHover","showCurrentPageReport","rowsPerPageOptions","loading"],["header","Enregistrer un versement",3,"visibleChange","visible","modal"],["header","Historique des versements",3,"visibleChange","visible","modal"],[1,"flex","items-center","gap-4"],["icon","pi pi-arrow-left","severity","secondary","pTooltip","Retour",3,"click","rounded","outlined"],[1,"m-0","font-bold"],[1,"text-sm","text-surface-500"],[1,"flex","items-center","justify-between"],[1,"m-0"],["pSortableColumn","reference",2,"min-width","12rem"],[1,"flex","items-center","gap-2"],["field","reference"],["pSortableColumn","periode_debut",2,"min-width","10rem"],["field","periode_debut"],[2,"min-width","6rem"],["pSortableColumn","montant_total",2,"min-width","10rem"],["field","montant_total"],["pSortableColumn","montant_verse",2,"min-width","10rem"],["field","montant_verse"],[2,"min-width","10rem"],["pSortableColumn","statut",2,"min-width","10rem"],["field","statut"],[2,"min-width","12rem"],[1,"font-semibold"],[1,"text-sm"],[1,"font-bold"],[1,"text-green-600","font-semibold"],[3,"value","severity"],[1,"flex","gap-2"],["icon","pi pi-wallet","severity","success","pTooltip","Payer",3,"rounded","outlined","click",4,"ngIf"],["icon","pi pi-list","severity","info","pTooltip","Historique versements",3,"click","rounded","outlined"],["icon","pi pi-trash","severity","danger","pTooltip","Supprimer",3,"rounded","outlined","click",4,"ngIf"],["icon","pi pi-wallet","severity","success","pTooltip","Payer",3,"click","rounded","outlined"],["icon","pi pi-trash","severity","danger","pTooltip","Supprimer",3,"click","rounded","outlined"],["colspan","8",1,"text-center","p-8","text-surface-500"],["class","flex flex-col gap-4",4,"ngIf"],[1,"flex","flex-col","gap-4"],[1,"bg-surface-100","dark:bg-surface-800","rounded-lg","p-3"],[1,"flex","items-center","justify-between","mb-1"],[1,"grid","grid-cols-3","gap-2","mt-2"],[1,"text-xs","text-surface-500"],[1,"font-bold","text-green-600"],[1,"font-bold","text-orange-500"],[1,"block","font-bold","mb-2"],["suffix"," GNF","locale","fr-FR","inputStyleClass","w-full","styleClass","w-full",3,"ngModelChange","ngModel","min","max","useGrouping"],["class","text-red-500",4,"ngIf"],["dateFormat","dd/mm/yy","styleClass","w-full",3,"ngModelChange","ngModel","showIcon"],["optionLabel","label","optionValue","value","styleClass","w-full",3,"ngModelChange","ngModel","options"],["pTextarea","","rows","2",1,"w-full",3,"ngModelChange","ngModel"],[1,"text-red-500"],["label","Annuler","icon","pi pi-times","text","",3,"click","disabled"],["label","Payer","icon","pi pi-check","severity","success",3,"click","disabled","loading"],["class","flex items-center justify-center p-8",4,"ngIf"],[1,"flex","items-center","justify-center","p-8"],[1,"pi","pi-spin","pi-spinner","text-4xl"],[1,"bg-surface-100","dark:bg-surface-800","rounded-lg","p-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-bold","text-lg"],[1,"grid","grid-cols-12","gap-4"],[3,"value","rowHover",4,"ngIf"],["class","text-center p-4 text-surface-500",4,"ngIf"],[3,"value","rowHover"],[1,"text-green-600","font-bold"],["icon","pi pi-trash","severity","danger","pTooltip","Supprimer",3,"click","rounded","outlined","text"],[1,"text-center","p-4","text-surface-500"],["label","Fermer","icon","pi pi-times","text","",3,"click"]],template:function(e,o){if(e&1){let r=v();_(0,"p-toast"),n(1,"div",7)(2,"p-toolbar",8),f(3,Bi,7,3,"ng-template",null,0,x),i(),n(5,"div",9)(6,"div",10)(7,"div",11)(8,"span",12),l(9,"Total factur\xE9"),i(),n(10,"span",13),l(11),i()()(),n(12,"div",10)(13,"div",11)(14,"span",12),l(15,"Total vers\xE9"),i(),n(16,"span",14),l(17),i()()(),n(18,"div",10)(19,"div",11)(20,"span",12),l(21,"Reste \xE0 payer"),i(),n(22,"span",15),l(23),i()()()(),n(24,"p-table",16),f(25,ji,3,0,"ng-template",null,1,x)(27,Hi,26,0,"ng-template",null,2,x)(29,Gi,22,15,"ng-template",null,3,x)(31,Ki,3,0,"ng-template",null,4,x),i()(),n(33,"p-dialog",17),y("visibleChange",function(h){return d(r),P(o.versementDialog,h)||(o.versementDialog=h),u(h)}),f(34,Zi,1,1,"ng-template",null,5,x)(36,Ji,2,3,"ng-template",null,6,x),i(),n(38,"p-dialog",18),y("visibleChange",function(h){return d(r),P(o.historiqueDialog,h)||(o.historiqueDialog=h),u(h)}),f(39,on,2,2,"ng-template",null,5,x)(41,ln,1,0,"ng-template",null,6,x),i(),_(43,"p-confirmdialog")}e&2&&(s(11),g(o.formatCurrency(o.totalFacture)),s(6),g(o.formatCurrency(o.totalVerse)),s(5),$e("text-orange-500",o.totalRestant>0),s(),g(o.formatCurrency(o.totalRestant)),s(),p("value",o.factures())("rows",10)("paginator",!0)("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",S(22,Li))("loading",o.loading),s(9),E(S(23,qi)),C("visible",o.versementDialog),p("modal",!0),s(5),E(S(24,Ni)),C("visible",o.historiqueDialog),p("modal",!0),s(5),E(S(25,Ai)))},dependencies:[O,A,ae,te,ie,ne,U,B,j,H,Q,K,G,le,Re,ce,se,z,ee,$,J,Z,ue,de,oe,re,X,Y,_e,ge,Ie,De,pe,me,Te,Ee],encapsulation:2})};var mr=[{path:"",component:he},{path:"comptabilite-packing-liste",component:he},{path:"comptabilite-packing-detail",component:Be},{path:"comptabilite-packing-paiement",component:We},{path:"**",redirectTo:"/notfound"}];export{mr as default};
